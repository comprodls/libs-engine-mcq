/**
 * @license RequireJS text 2.0.7 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*! jQuery UI - v1.12.1 - 2016-09-14
* http://jqueryui.com
* Includes: widget.js, position.js, data.js, disable-selection.js, effect.js, effects/effect-blind.js, effects/effect-bounce.js, effects/effect-clip.js, effects/effect-drop.js, effects/effect-explode.js, effects/effect-fade.js, effects/effect-fold.js, effects/effect-highlight.js, effects/effect-puff.js, effects/effect-pulsate.js, effects/effect-scale.js, effects/effect-shake.js, effects/effect-size.js, effects/effect-slide.js, effects/effect-transfer.js, focusable.js, form-reset-mixin.js, jquery-1-7.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/accordion.js, widgets/autocomplete.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/datepicker.js, widgets/dialog.js, widgets/draggable.js, widgets/droppable.js, widgets/menu.js, widgets/mouse.js, widgets/progressbar.js, widgets/resizable.js, widgets/selectable.js, widgets/selectmenu.js, widgets/slider.js, widgets/sortable.js, widgets/spinner.js, widgets/tabs.js, widgets/tooltip.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */

/*!
 * jQuery UI Widget 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Position 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */

/*!
 * jQuery UI :data 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Disable Selection 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */

/*!
 * jQuery UI Effects Blind 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Bounce 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Clip 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Drop 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Explode 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Fade 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Fold 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Highlight 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Size 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Scale 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Puff 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Pulsate 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Shake 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Slide 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Effects Transfer 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Focusable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Form Reset Mixin 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Support for jQuery core 1.7.x 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 */

/*!
 * jQuery UI Keycode 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Labels 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Scroll Parent 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Tabbable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Unique ID 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Accordion 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Menu 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Autocomplete 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Controlgroup 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Checkboxradio 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Button 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Datepicker 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Mouse 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Draggable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Resizable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Dialog 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Droppable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Progressbar 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Selectable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Selectmenu 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Slider 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Sortable 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Spinner 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Tabs 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

/*!
 * jQuery UI Tooltip 1.12.1
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */

// license: MIT

// Fine Uploader 5.13.0 - (c) 2013-present Widen Enterprises, Inc. MIT licensed. http://fineuploader.com

define("text",["module"],function(module){"use strict";var text,fs,Cc,Ci,progIds=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],xmlRegExp=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,bodyRegExp=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,hasLocation="undefined"!=typeof location&&location.href,defaultProtocol=hasLocation&&location.protocol&&location.protocol.replace(/\:/,""),defaultHostName=hasLocation&&location.hostname,defaultPort=hasLocation&&(location.port||void 0),buildMap={},masterConfig=module.config&&module.config()||{};return text={version:"2.0.7",strip:function(content){if(content){content=content.replace(xmlRegExp,"");var matches=content.match(bodyRegExp);matches&&(content=matches[1])}else content="";return content},jsEscape:function(content){return content.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:masterConfig.createXhr||function(){var xhr,i,progId;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(i=0;i<3;i+=1){progId=progIds[i];try{xhr=new ActiveXObject(progId)}catch(e){}if(xhr){progIds=[progId];break}}return xhr},parseName:function(name){var modName,ext,temp,strip=!1,index=name.indexOf("."),isRelative=0===name.indexOf("./")||0===name.indexOf("../");return-1!==index&&(!isRelative||index>1)?(modName=name.substring(0,index),ext=name.substring(index+1,name.length)):modName=name,temp=ext||modName,index=temp.indexOf("!"),-1!==index&&(strip="strip"===temp.substring(index+1),temp=temp.substring(0,index),ext?ext=temp:modName=temp),{moduleName:modName,ext:ext,strip:strip}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(url,protocol,hostname,port){var uProtocol,uHostName,uPort,match=text.xdRegExp.exec(url);return!match||(uProtocol=match[2],uHostName=match[3],uHostName=uHostName.split(":"),uPort=uHostName[1],uHostName=uHostName[0],!(uProtocol&&uProtocol!==protocol||uHostName&&uHostName.toLowerCase()!==hostname.toLowerCase()||(uPort||uHostName)&&uPort!==port))},finishLoad:function(name,strip,content,onLoad){content=strip?text.strip(content):content,masterConfig.isBuild&&(buildMap[name]=content),onLoad(content)},load:function(name,req,onLoad,config){if(config.isBuild&&!config.inlineText)return void onLoad();masterConfig.isBuild=config.isBuild;var parsed=text.parseName(name),nonStripName=parsed.moduleName+(parsed.ext?"."+parsed.ext:""),url=req.toUrl(nonStripName),useXhr=masterConfig.useXhr||text.useXhr;!hasLocation||useXhr(url,defaultProtocol,defaultHostName,defaultPort)?text.get(url,function(content){text.finishLoad(name,parsed.strip,content,onLoad)},function(err){onLoad.error&&onLoad.error(err)}):req([nonStripName],function(content){text.finishLoad(parsed.moduleName+"."+parsed.ext,parsed.strip,content,onLoad)})},write:function(pluginName,moduleName,write,config){if(buildMap.hasOwnProperty(moduleName)){var content=text.jsEscape(buildMap[moduleName]);write.asModule(pluginName+"!"+moduleName,"define(function () { return '"+content+"';});\n")}},writeFile:function(pluginName,moduleName,req,write,config){var parsed=text.parseName(moduleName),extPart=parsed.ext?"."+parsed.ext:"",nonStripName=parsed.moduleName+extPart,fileName=req.toUrl(parsed.moduleName+extPart)+".js";text.load(nonStripName,req,function(value){var textWrite=function(contents){return write(fileName,contents)};textWrite.asModule=function(moduleName,contents){return write.asModule(moduleName,fileName,contents)},text.write(pluginName,nonStripName,textWrite,config)},config)}},"node"===masterConfig.env||!masterConfig.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(fs=require.nodeRequire("fs"),text.get=function(url,callback,errback){try{var file=fs.readFileSync(url,"utf8");0===file.indexOf("\ufeff")&&(file=file.substring(1)),callback(file)}catch(e){errback(e)}}):"xhr"===masterConfig.env||!masterConfig.env&&text.createXhr()?text.get=function(url,callback,errback,headers){var header,xhr=text.createXhr();if(xhr.open("GET",url,!0),headers)for(header in headers)headers.hasOwnProperty(header)&&xhr.setRequestHeader(header.toLowerCase(),headers[header]);masterConfig.onXhr&&masterConfig.onXhr(xhr,url),xhr.onreadystatechange=function(evt){var status,err;4===xhr.readyState&&(status=xhr.status,status>399&&status<600?(err=new Error(url+" HTTP status: "+status),err.xhr=xhr,errback(err)):callback(xhr.responseText),masterConfig.onXhrComplete&&masterConfig.onXhrComplete(xhr,url))},xhr.send(null)}:"rhino"===masterConfig.env||!masterConfig.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?text.get=function(url,callback){var stringBuffer,line,file=new java.io.File(url),lineSeparator=java.lang.System.getProperty("line.separator"),input=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file),"utf-8")),content="";try{for(stringBuffer=new java.lang.StringBuffer,line=input.readLine(),line&&line.length()&&65279===line.charAt(0)&&(line=line.substring(1)),null!==line&&stringBuffer.append(line);null!==(line=input.readLine());)stringBuffer.append(lineSeparator),stringBuffer.append(line);content=String(stringBuffer.toString())}finally{input.close()}callback(content)}:("xpconnect"===masterConfig.env||!masterConfig.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(Cc=Components.classes,Ci=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),text.get=function(url,callback){var inStream,convertStream,readData={},fileObj=new FileUtils.File(url);try{inStream=Cc["@mozilla.org/network/file-input-stream;1"].createInstance(Ci.nsIFileInputStream),inStream.init(fileObj,1,0,!1),convertStream=Cc["@mozilla.org/intl/converter-input-stream;1"].createInstance(Ci.nsIConverterInputStream),convertStream.init(inStream,"utf-8",inStream.available(),Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),convertStream.readString(inStream.available(),readData),convertStream.close(),inStream.close(),callback(readData.value)}catch(e){throw new Error((fileObj&&fileObj.path||"")+": "+e)}}),text}),define("text!../html/mcq-editor.html",[],function(){return'\x3c!-- Engine Editor Template --\x3e\r\n<div class="mcq-body main-container" id="mcq-editor">\r\n  <main class="main global">\r\n    <section id="question" class="section question">\r\n      \x3c!-- Loop over all instructions text --\x3e\r\n      <div class="section-box">\r\n        <div class="row">\r\n          <div class="col-sm-12">\r\n            <header>\r\n              <h4 class="headerlabel font-semibold color-gray">Question Text</h4>\r\n            </header>\r\n          </div>\r\n          \x3c!-- Loop over all question data text --\x3e\r\n          <div class="col-sm-12 mt-sm">\r\n            <div class="text-box vertical-bottom-align" rv-each-qdata="editorContent.content.canvas.data.questiondata">\r\n              <span class="pull-left icon-pencil bottom">\r\n                <i class="fa fa-pencil"></i>\r\n              </span>\r\n              <div rv-content-editable="qdata.text" style="width: 100%;" data-text="Please Enter Question Test here." class="pl-md border-bottom-dashed"\r\n                role="button">\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <section id="instruction" class="section instruction border-bottom-shadow">\r\n      <div class="section-box mt-sm">\r\n        <div class="row">\r\n          <div class="col-sm-12" id="instructionLabel" rv-hide="isInstructionEmpty">\r\n            <header>\r\n              <h4 class="headerlabel font-semibold color-gray">Instruction Text</h4>\r\n            </header>\r\n          </div>\r\n          <div class="col-sm-12">\r\n            <ul class="list-unstyled nested-list">\r\n              <li class="text-box colborder mt-sm mb-add-offset" rv-each-instruction="editorContent.content.instructions" rv-instructionIndex="%instruction%">\r\n                <div class="vertical-bottom-align">\r\n                  <span class="pull-left icon-pencil">\r\n                    <i class="fa fa-pencil"></i>\r\n                  </span>\r\n                  <div rv-content-editable="instruction.text" style="width: 100%;" data-text=\'Placeholder Instruction text. Update "Me" with a valid Instruction text for this question.\'\r\n                    class="pr-3pc pl-md border-bottom-dashed" role="button"></div>\r\n                  <span class="pull-right icon-horizontal-align">\r\n                    <a class="color-lightgray fa fa-times outline-none" data-toggle="tooltip" title="Click to remove this option" rv-on-click="removeInstruction | args instruction %instruction%"></a>\r\n                  </span>\r\n                </div>\r\n              </li>\r\n          </div>\r\n          </ul>\r\n        </div>\r\n        <div class="row mb-add-offset">\r\n          <div class="col-sm-12 dropdown">\r\n            <button class="btn btn-default btn-sm dropdown-toggle" type="button" id="menu1" data-toggle="dropdown">+ Add\r\n            </button>\r\n            <ul class="dropdown-menu" role="menu" id="instructionmenu" aria-labelledby="menu1" style="left: 15px;">\r\n              <li class="border-bottom-dashed" role="presentation">\r\n                <a class=\'dropdown-toggle disabled\' role="menuitem" href="#" rv-on-click="addInstruction">Instruction Text</a>\r\n              </li>\r\n              <li class="border-bottom-dashed" role="presentation">\r\n                <a class=\'dropdown-toggle disabled\' role="menuitem" href="#">Description Text</a>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <section id="answer-choice" class="section answer border-bottom-shadow">\r\n      <div class="section-box">\r\n        <div class="row no-margin-left" rv-each-interact="editorContent.content.interactions">\r\n          <header>\r\n            <h4 class="headerlabel font-semibold color-gray">Answer Options\r\n              <span class="dropdown font-medium ml-md">\r\n                <a class="dropdown-toggle color-lightgray text-underline font-normal" data-toggle="dropdown" aria-expanded="false">\r\n                  <span rv-text="interact.type | interactTypeVal"></span>\r\n                  <b class="caret">\r\n                  </b>\r\n                </a>\r\n                <ul class="dropdown-menu">\r\n                  <li rv-class-active=\'mcqsr\'>\r\n                    <a id="MCQSR" rv-text="\'MCQSR\' | interactTypeVal" rv-on-click="changeQuestionType |  args \'MCQSR\' interact"></a>\r\n                  </li>\r\n                  <li rv-class-active=\'mcqmr\'>\r\n                    <a id="MCQMR" rv-text="\'MCQMR\' | interactTypeVal" rv-on-click="changeQuestionType |  args \'MCQMR\' interact"></a>\r\n                  </li>\r\n                </ul>\r\n              </span>\r\n            </h4>\r\n          </header>\r\n          \x3c!-- Loop over all questiondata inside interaction --\x3e\r\n          <div class="col-sm-12 questions-editor mt-md" id="mcq-mr" rv-if="editorContent.MCQMR">\r\n\r\n            <ul class="list-unstyled nested-list editor sortable">\r\n              \x3c!-- Loop over all options inside interaction  (mcq Array)--\x3e\r\n              <li class="vertical-center-align col-xs-12 col-sm-12 bg-white mt-md mb-add-offset" rv-each-element="interact.answeroptions"\r\n                rv-class-highlight="element.customAttribs.isCorrect" rv-elementIndex="element.customAttribs.index" rv-interactIndex="%interact%">\r\n                <div>\r\n                  <label class="checkbox optionlabel" rv-for="%element% | idcreator element.customAttribs.id">\r\n                    <i class="square-icon choices"></i>\r\n                  </label>\r\n                  <input type="checkbox" name="optionsRadios" rv-id="%element% | idcreator element.customAttribs.id" class="hide-option mcq-option"\r\n                    rv-key="element.customAttribs.key" rv-checked="element.customAttribs.isCorrect" />\r\n                </div>\r\n                <div class="vertical-bottom-align" style="width: 100%">\r\n                  <span class="ml-xl pull-left mt-xs option-icon-pencil">\r\n                    <i class="fa fa-pencil"></i>\r\n                  </span>\r\n                  <div rv-content-editable="element.customAttribs.value" data-text="Placeholder answer option text. Please update with valid answer option text"\r\n                    class="option-div adjusted-width pr-7pc pl-md border-bottom-dashed" role="button"></div>\r\n                  <span class="pull-right  icon-box vertical-align-self">\r\n                    <a rv-class-linkenabled="interact.editlink.enabled" rv-class-linkdisabled="interact.editlink.disabled" class="color-lightgray drag-icon fa fa-times outline-none mr-1em"\r\n                      data-toggle="tooltip" title="Click to remove this option" rv-on-click="removeItem | args element %interact%"></a>\r\n                    <a rv-class-linkenabled="interact.editlink.enabled" rv-class-linkdisabled="interact.editlink.disabled" class="color-lightgray drag-icon fa fa-bars outline-none "\r\n                      data-toggle="tooltip" title="Click & drag move this option"></a>\r\n                  </span>\r\n                </div>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n          <div class="col-sm-12  questions-editor mt-md" id="mcq-sr" rv-if="editorContent.MCQSR">\r\n            <ul class="list-unstyled nested-list editor sortable">\r\n              \x3c!-- Loop over all options inside interaction  (mcq Array)--\x3e\r\n              <li class="vertical-center-align col-xs-12 col-sm-12 bg-white mt-md mb-add-offset" rv-each-element="interact.answeroptions"\r\n                rv-class-highlight="element.customAttribs.isCorrect" rv-elementIndex="element.customAttribs.index" rv-interactIndex="%interact%">\r\n                <div>\r\n                  <label class="radio optionlabel" rv-for="%element% | idcreator element.customAttribs.id">\r\n                    <i class="round-icon choices"></i>\r\n                  </label>\r\n                  <input type="radio" name="optionsRadios" rv-id="%element% | idcreator element.customAttribs.id" class="hide-option mcq-option"\r\n                    rv-key="element.customAttribs.key" rv-checked="element.customAttribs.isCorrect" />\r\n                </div>\r\n                <div class="vertical-bottom-align" style="width: 100%">\r\n                  <span class="ml-xl pull-left mt-xs option-icon-pencil">\r\n                    <i class="fa fa-pencil"></i>\r\n                  </span>\r\n                  <div rv-content-editable="element.customAttribs.value" data-text="Placeholder answer option text. Please update with valid answer option text"\r\n                    class="option-div adjusted-width pr-7pc pl-md border-bottom-dashed" role="button"></div>\r\n                  <span class="pull-right  icon-box vertical-align-self">\r\n                    <a rv-class-linkenabled="interact.editlink.enabled" rv-class-linkdisabled="interact.editlink.disabled" class="drag-icon fa fa-times outline-none mr-1em"\r\n                      data-toggle="tooltip" title="Click to remove this option" rv-on-click="removeItem | args element %interact%"></a>\r\n                    <a rv-class-linkenabled="interact.editlink.enabled" rv-class-linkdisabled="interact.editlink.disabled" class="drag-icon fa fa-bars outline-none "\r\n                      data-toggle="tooltip" title="Click & drag move this option"></a>\r\n                  </span>\r\n                </div>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n          <a class="add-item ml-xxl" rv-on-click="addItem | args %interact%">\r\n            <button type="button" class="btn btn-default btn-sm mb-sm">\r\n              </span>+ Add</button>\r\n          </a>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <section id="feedback" class="section feedback  border-bottom-shadow">\r\n      <div class="section-box">\r\n        <div class="row mt-sm mb-sm">\r\n          <div class="col-sm-12" rv-hide="editorContent.enableFeedBack">\r\n            <a class="enable-feedback">\r\n              <button type="button" class="btn btn-default active-btn border-dashed" rv-on-click="showFeedBack">\r\n                <h4 class="font-semibold color-gray">Enable Feedback</h4>\r\n              </button>\r\n            </a>\r\n          </div>\r\n          <div class="col-sm-12" rv-show="editorContent.enableFeedBack">\r\n            <div>\r\n              <header>\r\n                <h4 class="headerlabel font-semibold color-gray">Feedback</h4>\r\n              </header>\r\n            </div>\r\n            <ul class="list-unstyled nested-list">\r\n              <li class="vertical-center-align col-xs-12 col-sm-12 bg-white mt-md mb-add-offset" rv-each-element="editorContent.feedback.global">\r\n                <div class="pl-sm">\r\n                  <div class="radio">\r\n                    <i class="round-icon feedback" rv-addclass=\'element.customAttribs.icon\'></i>\r\n                  </div>\r\n                </div>\r\n                <div class="vertical-bottom-align" style="width: 100%">\r\n                  <span class="ml-xl pull-left mt-xs option-icon-pencil">\r\n                    <i class="fa fa-pencil"></i>\r\n                  </span>\r\n                  <div rv-content-editable="element.customAttribs.value" style="width: 100%;" data-text=\'Placeholder Feedback text. Update "Me" with a valid Feedback text for this question.\'\r\n                    class="pr-3pc pl-md border-bottom-dashed" role="button"></div>\r\n                  <span class="pull-right icon-horizontal-align">\r\n                    <a class="color-lightgray fa fa-times outline-none" data-toggle="tooltip" title="Click to remove this option" rv-on-click="removeFeedback | args %element%"></a>\r\n                  </span>\r\n\r\n                </div>\r\n              </li>\r\n            </ul>\r\n            <div class="col-sm-12 dropdown">\r\n              <button class="btn btn-default btn-sm dropdown-toggle ml-xxl" rv-class-disabled="enableFeedback.hide" type="button" id="menu2"\r\n                data-toggle="dropdown">+ Add\r\n              </button>\r\n              <ul class="dropdown-menu" id="feedbackmenu" role="menu" aria-labelledby="menu1" style="left: 75px;">\r\n                <li class="" rv-show="feedback.showDropdown" role="presentation" rv-each-feedback="feedbackPresets">\r\n                  <a class=\'dropdown-toggle disabled\' role="menuitem" rv-on-click="addFeedback | args feedback %feedback% " rv-text="feedback.value"></a>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          \x3c!-- a class="add-item ml-xxl" rv-on-click="">\r\n                  <button type="button" class="btn btn-default btn-sm mt-sm mb-sm"></span>+ Add</button>\r\n            </a --\x3e\r\n        </div>\r\n      </div>\r\n\r\n    </section>\r\n    <section id="media" class="section border-bottom-shadow">\r\n      <div class="section-box">\r\n        <div class="row mt-sm mb-sm">\r\n          <div class="col-sm-12">\r\n            <a class="enable-media">\r\n              <button type="button" class="btn btn-default active-btn border-dashed">\r\n                <h4 class="color-gray font-semibold">Enable Media & Assets</h4>\r\n              </button>\r\n            </a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <div id="uploader"></div>\r\n\r\n    <script type="text/template" id="qq-template">\r\n      <div class="qq-uploader-selector qq-uploader qq-gallery" qq-drop-area-text="Drop files here">\r\n          <div class="progress qq-total-progress-bar-container-selector qq-total-progress-bar-container">\r\n              <div role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" class="progress-bar bar qq-total-progress-bar-selector qq-progress-bar qq-total-progress-bar"></div>\r\n          </div>\r\n          <div class="qq-upload-drop-area-selector qq-upload-drop-area" qq-hide-dropzone>\r\n              <span class="qq-upload-drop-area-text-selector"></span>\r\n          </div>\r\n          <div class="qq-upload-button-selector qq-upload-button border-dashed btn btn-default" style="min-width:150px;">\r\n              <div>Upload a file</div>\r\n          </div>\r\n          <span class="qq-drop-processing-selector qq-drop-processing">\r\n              <span>Processing dropped files...</span>\r\n              <span class="qq-drop-processing-spinner-selector qq-drop-processing-spinner"></span>\r\n          </span>\r\n          <ul class="qq-upload-list-selector qq-upload-list" role="region" aria-live="polite" aria-relevant="additions removals">\r\n              <li>\r\n                  <span role="status" class="qq-upload-status-text-selector qq-upload-status-text"></span>\r\n                  <div class="progress qq-progress-bar-container-selector qq-progress-bar-container">\r\n                      <div role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" class="progress-bar bar qq-progress-bar-selector qq-progress-bar"></div>\r\n                  </div>\r\n                  <span class="qq-upload-spinner-selector qq-upload-spinner"></span>\r\n                  <div class="qq-thumbnail-wrapper">\r\n                      <img class="qq-thumbnail-selector" qq-max-size="120" qq-server-scale>\r\n                  </div>\r\n                  <button type="button" class="qq-upload-cancel-selector qq-upload-cancel">X</button>\r\n                  <button type="button" class="qq-upload-retry-selector qq-upload-retry">\r\n                      <span class="qq-btn qq-retry-icon" aria-label="Retry"></span>\r\n                      Retry\r\n                  </button>\r\n                  <div class="qq-file-info">\r\n                      <div class="qq-file-name">\r\n                          <span class="qq-upload-file-selector qq-upload-file"></span>\r\n                          <span class="qq-edit-filename-icon-selector qq-btn qq-edit-filename-icon" aria-label="Edit filename"></span>\r\n                      </div>\r\n                      <input class="qq-edit-filename-selector qq-edit-filename" tabindex="0" type="text">\r\n                      <span class="qq-upload-size-selector qq-upload-size"></span>\r\n                      <button type="button" class="qq-btn qq-upload-delete-selector qq-upload-delete">\r\n                          <span class="qq-btn qq-delete-icon" aria-label="Delete"></span>\r\n                      </button>\r\n                      <button type="button" class="qq-btn qq-upload-pause-selector qq-upload-pause">\r\n                          <span class="qq-btn qq-pause-icon" aria-label="Pause"></span>\r\n                      </button>\r\n                      <button type="button" class="qq-btn qq-upload-continue-selector qq-upload-continue">\r\n                          <span class="qq-btn qq-continue-icon" aria-label="Continue"></span>\r\n                      </button>\r\n                  </div>\r\n              </li>\r\n          </ul>\r\n          <dialog class="qq-alert-dialog-selector">\r\n              <div class="qq-dialog-message-selector"></div>\r\n              <div class="qq-dialog-buttons">\r\n                  <button type="button" class="qq-cancel-button-selector">Close</button>\r\n              </div>\r\n          </dialog>\r\n          <dialog class="qq-confirm-dialog-selector">\r\n              <div class="qq-dialog-message-selector"></div>\r\n              <div class="qq-dialog-buttons">\r\n                  <button type="button" class="qq-cancel-button-selector">No</button>\r\n                  <button type="button" class="qq-ok-button-selector">Yes</button>\r\n              </div>\r\n          </dialog>\r\n          <dialog class="qq-prompt-dialog-selector">\r\n              <div class="qq-dialog-message-selector"></div>\r\n              <input type="text">\r\n              <div class="qq-dialog-buttons">\r\n                  <button type="button" class="qq-cancel-button-selector">Cancel</button>\r\n                  <button type="button" class="qq-ok-button-selector">Ok</button>\r\n              </div>\r\n          </dialog>\r\n      </div>\r\n  <\/script>\r\n  </main>\r\n</div>'}),define("css",[],function(){if("undefined"==typeof window)return{load:function(n,r,load){load()}};var head=document.getElementsByTagName("head")[0],engine=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,useImportLoad=!1,useOnload=!0;engine[1]||engine[7]?useImportLoad=parseInt(engine[1])<6||parseInt(engine[7])<=9:engine[2]||engine[8]?useOnload=!1:engine[4]&&(useImportLoad=parseInt(engine[4])<18);var cssAPI={};cssAPI.pluginBuilder="./css-builder";var curStyle,curSheet,ieCurCallback,createStyle=function(){curStyle=document.createElement("style"),head.appendChild(curStyle),curSheet=curStyle.styleSheet||curStyle.sheet},ieCnt=0,ieLoads=[],createIeLoad=function(url){curSheet.addImport(url),curStyle.onload=function(){processIeLoad()},31==++ieCnt&&(createStyle(),ieCnt=0)},processIeLoad=function(){ieCurCallback();var nextLoad=ieLoads.shift();if(!nextLoad)return void(ieCurCallback=null);ieCurCallback=nextLoad[1],createIeLoad(nextLoad[0])},importLoad=function(url,callback){if(curSheet&&curSheet.addImport||createStyle(),curSheet&&curSheet.addImport)ieCurCallback?ieLoads.push([url,callback]):(createIeLoad(url),ieCurCallback=callback);else{curStyle.textContent='@import "'+url+'";';var loadInterval=setInterval(function(){try{curStyle.sheet.cssRules,clearInterval(loadInterval),callback()}catch(e){}},10)}},linkLoad=function(url,callback){var link=document.createElement("link");if(link.type="text/css",link.rel="stylesheet",useOnload)link.onload=function(){link.onload=function(){},setTimeout(callback,7)};else var loadInterval=setInterval(function(){for(var i=0;i<document.styleSheets.length;i++){if(document.styleSheets[i].href==link.href)return clearInterval(loadInterval),callback()}},10);link.href=url,head.appendChild(link)};return cssAPI.normalize=function(name,normalize){return".css"==name.substr(name.length-4,4)&&(name=name.substr(0,name.length-4)),normalize(name)},cssAPI.load=function(cssId,req,load,config){(useImportLoad?importLoad:linkLoad)(req.toUrl(cssId+".css"),load)},cssAPI}),define("css!../../bower_components/fine-uploader/dist/fine-uploader-gallery.min",[],function(){}),define("css!../css/mcq-editor",[],function(){}),function(factory){"function"==typeof define&&define.amd?define("jquery-ui",["jquery"],factory):factory(jQuery)}(function($){function visible(element){for(var visibility=element.css("visibility");"inherit"===visibility;)element=element.parent(),visibility=element.css("visibility");return"hidden"!==visibility}function datepicker_getZindex(elem){for(var position,value;elem.length&&elem[0]!==document;){if(("absolute"===(position=elem.css("position"))||"relative"===position||"fixed"===position)&&(value=parseInt(elem.css("zIndex"),10),!isNaN(value)&&0!==value))return value;elem=elem.parent()}return 0}function Datepicker(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.regional.en=$.extend(!0,{},this.regional[""]),this.regional["en-US"]=$.extend(!0,{},this.regional.en),this.dpDiv=datepicker_bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function datepicker_bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.on("mouseout",selector,function(){$(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",selector,datepicker_handleMouseover)}function datepicker_handleMouseover(){$.datepicker._isDisabledDatepicker(datepicker_instActive.inline?datepicker_instActive.dpDiv.parent()[0]:datepicker_instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&$(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&$(this).addClass("ui-datepicker-next-hover"))}function datepicker_extendRemove(target,props){$.extend(target,props);for(var name in props)null==props[name]&&(target[name]=props[name]);return target}function spinnerModifer(fn){return function(){var previous=this.element.val();fn.apply(this,arguments),this._refresh(),previous!==this.element.val()&&this._trigger("change")}}$.ui=$.ui||{};var widgetUuid=($.ui.version="1.12.1",0),widgetSlice=Array.prototype.slice;$.cleanData=function(orig){return function(elems){var events,elem,i;for(i=0;null!=(elem=elems[i]);i++)try{events=$._data(elem,"events"),events&&events.remove&&$(elem).triggerHandler("remove")}catch(e){}orig(elems)}}($.cleanData),$.widget=function(name,base,prototype){var existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];var fullName=namespace+"-"+name;return prototype||(prototype=base,base=$.Widget),$.isArray(prototype)&&(prototype=$.extend.apply(null,[{}].concat(prototype))),$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)},$[namespace]=$[namespace]||{},existingConstructor=$[namespace][name],constructor=$[namespace][name]=function(options,element){if(!this._createWidget)return new constructor(options,element);arguments.length&&this._createWidget(options,element)},$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]}),basePrototype=new base,basePrototype.options=$.widget.extend({},basePrototype.options),
$.each(prototype,function(prop,value){if(!$.isFunction(value))return void(proxiedPrototype[prop]=value);proxiedPrototype[prop]=function(){function _super(){return base.prototype[prop].apply(this,arguments)}function _superApply(args){return base.prototype[prop].apply(this,args)}return function(){var returnValue,__super=this._super,__superApply=this._superApply;return this._super=_super,this._superApply=_superApply,returnValue=value.apply(this,arguments),this._super=__super,this._superApply=__superApply,returnValue}}()}),constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix||name:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName}),existingConstructor?($.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)}),delete existingConstructor._childConstructors):base._childConstructors.push(constructor),$.widget.bridge(name,constructor),constructor},$.widget.extend=function(target){for(var key,value,input=widgetSlice.call(arguments,1),inputIndex=0,inputLength=input.length;inputIndex<inputLength;inputIndex++)for(key in input[inputIndex])value=input[inputIndex][key],input[inputIndex].hasOwnProperty(key)&&void 0!==value&&($.isPlainObject(value)?target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value):target[key]=value);return target},$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall="string"==typeof options,args=widgetSlice.call(arguments,1),returnValue=this;return isMethodCall?this.length||"instance"!==options?this.each(function(){var methodValue,instance=$.data(this,fullName);return"instance"===options?(returnValue=instance,!1):instance?$.isFunction(instance[options])&&"_"!==options.charAt(0)?(methodValue=instance[options].apply(instance,args),methodValue!==instance&&void 0!==methodValue?(returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue,!1):void 0):$.error("no such method '"+options+"' for "+name+" widget instance"):$.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'")}):returnValue=void 0:(args.length&&(options=$.widget.extend.apply(null,[options].concat(args))),this.each(function(){var instance=$.data(this,fullName);instance?(instance.option(options||{}),instance._init&&instance._init()):$.data(this,fullName,new object(options,this))})),returnValue}},$.Widget=function(){},$.Widget._childConstructors=[],$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0],this.element=$(element),this.uuid=widgetUuid++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=$(),this.hoverable=$(),this.focusable=$(),this.classesElementLookup={},element!==this&&($.data(element,this.widgetFullName,this),this._on(!0,this.element,{remove:function(event){event.target===element&&this.destroy()}}),this.document=$(element.style?element.ownerDocument:element.document||element),this.window=$(this.document[0].defaultView||this.document[0].parentWindow)),this.options=$.widget.extend({},this.options,this._getCreateOptions(),options),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){var that=this;this._destroy(),$.each(this.classesElementLookup,function(key,value){that._removeClass(value,key)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var parts,curOption,i,options=key;if(0===arguments.length)return $.widget.extend({},this.options);if("string"==typeof key)if(options={},parts=key.split("."),key=parts.shift(),parts.length){for(curOption=options[key]=$.widget.extend({},this.options[key]),i=0;i<parts.length-1;i++)curOption[parts[i]]=curOption[parts[i]]||{},curOption=curOption[parts[i]];if(key=parts.pop(),1===arguments.length)return void 0===curOption[key]?null:curOption[key];curOption[key]=value}else{if(1===arguments.length)return void 0===this.options[key]?null:this.options[key];options[key]=value}return this._setOptions(options),this},_setOptions:function(options){var key;for(key in options)this._setOption(key,options[key]);return this},_setOption:function(key,value){return"classes"===key&&this._setOptionClasses(value),this.options[key]=value,"disabled"===key&&this._setOptionDisabled(value),this},_setOptionClasses:function(value){var classKey,elements,currentElements;for(classKey in value)currentElements=this.classesElementLookup[classKey],value[classKey]!==this.options.classes[classKey]&&currentElements&&currentElements.length&&(elements=$(currentElements.get()),this._removeClass(currentElements,classKey),elements.addClass(this._classes({element:elements,keys:classKey,classes:value,add:!0})))},_setOptionDisabled:function(value){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!value),value&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(options){function processClassString(classes,checkOption){var current,i;for(i=0;i<classes.length;i++)current=that.classesElementLookup[classes[i]]||$(),current=$(options.add?$.unique(current.get().concat(options.element.get())):current.not(options.element).get()),that.classesElementLookup[classes[i]]=current,full.push(classes[i]),checkOption&&options.classes[classes[i]]&&full.push(options.classes[classes[i]])}var full=[],that=this;return options=$.extend({element:this.element,classes:this.options.classes||{}},options),this._on(options.element,{remove:"_untrackClassesElement"}),options.keys&&processClassString(options.keys.match(/\S+/g)||[],!0),options.extra&&processClassString(options.extra.match(/\S+/g)||[]),full.join(" ")},_untrackClassesElement:function(event){var that=this;$.each(that.classesElementLookup,function(key,value){-1!==$.inArray(event.target,value)&&(that.classesElementLookup[key]=$(value.not(event.target).get()))})},_removeClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!1)},_addClass:function(element,keys,extra){return this._toggleClass(element,keys,extra,!0)},_toggleClass:function(element,keys,extra,add){add="boolean"==typeof add?add:extra;var shift="string"==typeof element||null===element,options={extra:shift?keys:extra,keys:shift?element:keys,element:shift?this.element:element,add:add};return options.element.toggleClass(this._classes(options),add),this},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;"boolean"!=typeof suppressDisabledCheck&&(handlers=element,element=suppressDisabledCheck,suppressDisabledCheck=!1),handlers?(element=delegateElement=$(element),this.bindings=this.bindings.add(element)):(handlers=element,element=this.element,delegateElement=this.widget()),$.each(handlers,function(event,handler){function handlerProxy(){if(suppressDisabledCheck||!0!==instance.options.disabled&&!$(this).hasClass("ui-state-disabled"))return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}"string"!=typeof handler&&(handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++);var match=event.match(/^([\w:-]*)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];selector?delegateElement.on(eventName,selector,handlerProxy):element.on(eventName,handlerProxy)})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,element.off(eventName).off(eventName),this.bindings=$(this.bindings.not(element).get()),this.focusable=$(this.focusable.not(element).get()),this.hoverable=$(this.hoverable.not(element).get())},_delay:function(handler,delay){function handlerProxy(){return("string"==typeof handler?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element),this._on(element,{mouseenter:function(event){this._addClass($(event.currentTarget),null,"ui-state-hover")},mouseleave:function(event){this._removeClass($(event.currentTarget),null,"ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element),this._on(element,{focusin:function(event){this._addClass($(event.currentTarget),null,"ui-state-focus")},focusout:function(event){this._removeClass($(event.currentTarget),null,"ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];if(data=data||{},event=$.Event(event),event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase(),event.target=this.element[0],orig=event.originalEvent)for(prop in orig)prop in event||(event[prop]=orig[prop]);return this.element.trigger(event,data),!($.isFunction(callback)&&!1===callback.apply(this.element[0],[event].concat(data))||event.isDefaultPrevented())}},$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){"string"==typeof options&&(options={effect:options});var hasOptions,effectName=options?!0===options||"number"==typeof options?defaultEffect:options.effect||defaultEffect:method;options=options||{},"number"==typeof options&&(options={duration:options}),hasOptions=!$.isEmptyObject(options),options.complete=callback,options.delay&&element.delay(options.delay),hasOptions&&$.effects&&$.effects.effect[effectName]?element[method](options):effectName!==method&&element[effectName]?element[effectName](options.duration,options.easing,callback):element.queue(function(next){$(this)[method](),callback&&callback.call(element[0]),next()})}});$.widget;!function(){function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}function parseCss(element,property){return parseInt($.css(element,property),10)||0}function getDimensions(elem){var raw=elem[0];return 9===raw.nodeType?{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}:$.isWindow(raw)?{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}:raw.preventDefault?{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}:{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}var cachedScrollbarWidth,max=Math.max,abs=Math.abs,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;$.position={scrollbarWidth:function(){if(void 0!==cachedScrollbarWidth)return cachedScrollbarWidth;var w1,w2,div=$("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];return $("body").append(div),w1=innerDiv.offsetWidth,div.css("overflow","scroll"),w2=innerDiv.offsetWidth,w1===w2&&(w2=div[0].clientWidth),div.remove(),cachedScrollbarWidth=w1-w2},getScrollInfo:function(within){var overflowX=within.isWindow||within.isDocument?"":within.element.css("overflow-x"),overflowY=within.isWindow||within.isDocument?"":within.element.css("overflow-y"),hasOverflowX="scroll"===overflowX||"auto"===overflowX&&within.width<within.element[0].scrollWidth;return{width:"scroll"===overflowY||"auto"===overflowY&&within.height<within.element[0].scrollHeight?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]),isDocument=!!withinElement[0]&&9===withinElement[0].nodeType;return{element:withinElement,isWindow:isWindow,isDocument:isDocument,offset:isWindow||isDocument?{left:0,top:0}:$(element).offset(),scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:withinElement.outerWidth(),height:withinElement.outerHeight()}}},$.fn.position=function(options){if(!options||!options.of)return _position.apply(this,arguments);options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};return dimensions=getDimensions(target),target[0].preventDefault&&(options.at="left top"),targetWidth=dimensions.width,targetHeight=dimensions.height,targetOffset=dimensions.offset,basePosition=$.extend({},targetOffset),$.each(["my","at"],function(){var horizontalOffset,verticalOffset,pos=(options[this]||"").split(" ");1===pos.length&&(pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]),pos[0]=rhorizontal.test(pos[0])?pos[0]:"center",pos[1]=rvertical.test(pos[1])?pos[1]:"center",horizontalOffset=roffset.exec(pos[0]),verticalOffset=roffset.exec(pos[1]),offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0],options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]}),1===collision.length&&(collision[1]=collision[0]),"right"===options.at[0]?basePosition.left+=targetWidth:"center"===options.at[0]&&(basePosition.left+=targetWidth/2),"bottom"===options.at[1]?basePosition.top+=targetHeight:"center"===options.at[1]&&(basePosition.top+=targetHeight/2),atOffset=getOffsets(offsets.at,targetWidth,targetHeight),basePosition.left+=atOffset[0],basePosition.top+=atOffset[1],this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());"right"===options.my[0]?position.left-=elemWidth:"center"===options.my[0]&&(position.left-=elemWidth/2),"bottom"===options.my[1]?position.top-=elemHeight:"center"===options.my[1]&&(position.top-=elemHeight/2),position.left+=myOffset[0],position.top+=myOffset[1],collisionPosition={marginLeft:marginLeft,marginTop:marginTop},$.each(["left","top"],function(i,dir){$.ui.position[collision[i]]&&$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}),options.using&&(using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};targetWidth<elemWidth&&abs(left+right)<targetWidth&&(feedback.horizontal="center"),targetHeight<elemHeight&&abs(top+bottom)<targetHeight&&(feedback.vertical="middle"),max(abs(left),abs(right))>max(abs(top),abs(bottom))?feedback.important="horizontal":feedback.important="vertical",options.using.call(this,props,feedback)}),elem.offset($.extend(position,{using:using}))})},$.ui.position={fit:{left:function(position,data){var newOverRight,within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset;data.collisionWidth>outerWidth?overLeft>0&&overRight<=0?(newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset,position.left+=overLeft-newOverRight):position.left=overRight>0&&overLeft<=0?withinOffset:overLeft>overRight?withinOffset+outerWidth-data.collisionWidth:withinOffset:overLeft>0?position.left+=overLeft:overRight>0?position.left-=overRight:position.left=max(position.left-collisionPosLeft,position.left)},top:function(position,data){var newOverBottom,within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset;data.collisionHeight>outerHeight?overTop>0&&overBottom<=0?(newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset,position.top+=overTop-newOverBottom):position.top=overBottom>0&&overTop<=0?withinOffset:overTop>overBottom?withinOffset+outerHeight-data.collisionHeight:withinOffset:overTop>0?position.top+=overTop:overBottom>0?position.top-=overBottom:position.top=max(position.top-collisionPosTop,position.top)}},flip:{left:function(position,data){var newOverRight,newOverLeft,within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset="left"===data.my[0]?-data.elemWidth:"right"===data.my[0]?data.elemWidth:0,atOffset="left"===data.at[0]?data.targetWidth:"right"===data.at[0]?-data.targetWidth:0,offset=-2*data.offset[0];overLeft<0?((newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset)<0||newOverRight<abs(overLeft))&&(position.left+=myOffset+atOffset+offset):overRight>0&&((newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft)>0||abs(newOverLeft)<overRight)&&(position.left+=myOffset+atOffset+offset)},top:function(position,data){var newOverTop,newOverBottom,within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top="top"===data.my[1],myOffset=top?-data.elemHeight:"bottom"===data.my[1]?data.elemHeight:0,atOffset="top"===data.at[1]?data.targetHeight:"bottom"===data.at[1]?-data.targetHeight:0,offset=-2*data.offset[1];overTop<0?((newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset)<0||newOverBottom<abs(overTop))&&(position.top+=myOffset+atOffset+offset):overBottom>0&&((newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop)>0||abs(newOverTop)<overBottom)&&(position.top+=myOffset+atOffset+offset)}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments),$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments),$.ui.position.fit.top.apply(this,arguments)}}}}();var dataSpaceAnimated=($.ui.position,$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])}}),$.fn.extend({disableSelection:function(){var eventType="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(eventType+".ui-disableSelection",function(event){event.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}}),"ui-effects-animated"),jQuery=$;$.effects={effect:{}},function(jQuery,undefined){function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};return null==value?allowEmpty||!prop.def?null:prop.def:(value=type.floor?~~value:parseFloat(value),isNaN(value)?prop.def:type.mod?(value+type.mod)%type.mod:0>value?0:type.max<value?type.max:value)}function stringParse(string){var inst=color(),rgba=inst._rgba=[];return string=string.toLowerCase(),each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values)return parsed=inst[spaceName](values),inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache],rgba=inst._rgba=parsed._rgba,!1}),rgba.length?("0,0,0,0"===rgba.join()&&jQuery.extend(rgba,colors.transparent),inst):colors[string]}function hue2rgb(p,q,h){return h=(h+1)%1,6*h<1?p+(q-p)*h*6:2*h<1?q:3*h<2?p+(q-p)*(2/3-h)*6:p}var colors,rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],execResult[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]]}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha)},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},support=color.support={},supportElem=jQuery("<p>")[0],each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)",support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1,each(spaces,function(spaceName,space){space.cache="_"+spaceName,space.props.alpha={idx:3,type:"percent",def:1}}),color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(void 0===red)return this._rgba=[null,null,null,null],this;(red.jquery||red.nodeType)&&(red=jQuery(red).css(green),green=void 0);var inst=this,type=jQuery.type(red),rgba=this._rgba=[];return void 0!==green&&(red=[red,green,blue,alpha],type="array"),"string"===type?this.parse(stringParse(red)||colors._default):"array"===type?(each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop)}),this):"object"===type?(red instanceof color?each(spaces,function(spaceName,space){red[space.cache]&&(inst[space.cache]=red[space.cache].slice())}):each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if("alpha"===key||null==red[key])return;inst[cache]=space.to(inst._rgba)}inst[cache][prop.idx]=clamp(red[key],prop,!0)}),inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0&&(inst[cache][3]=1,space.from&&(inst._rgba=space.from(inst[cache])))}),this):void 0},is:function(compare){var is=color(compare),same=!0,inst=this;return each(spaces,function(_,space){var localCache,isCache=is[space.cache];return isCache&&(localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[],each(space.props,function(_,prop){if(null!=isCache[prop.idx])return same=isCache[prop.idx]===localCache[prop.idx]})),same}),same},_space:function(){var used=[],inst=this;return each(spaces,function(spaceName,space){inst[space.cache]&&used.push(spaceName)}),used.pop()},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=0===this.alpha()?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();return end=end[space.cache],each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};null!==endValue&&(null===startValue?result[index]=endValue:(type.mod&&(endValue-startValue>type.mod/2?startValue+=type.mod:startValue-endValue>type.mod/2&&(startValue-=type.mod)),result[index]=clamp((endValue-startValue)*distance+startValue,prop)))}),this[spaceName](result)},blend:function(opaque){if(1===this._rgba[3])return this;var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v}))},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return null==v?i>2?1:0:v});return 1===rgba[3]&&(rgba.pop(),prefix="rgb("),prefix+rgba.join()+")"},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){return null==v&&(v=i>2?1:0),i&&i<3&&(v=Math.round(100*v)+"%"),v});return 1===hsla[3]&&(hsla.pop(),prefix="hsl("),prefix+hsla.join()+")"},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();return includeAlpha&&rgba.push(~~(255*alpha)),"#"+jQuery.map(rgba,function(v){return v=(v||0).toString(16),1===v.length?"0"+v:v}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),color.fn.parse.prototype=color.fn,spaces.hsla.to=function(rgba){if(null==rgba[0]||null==rgba[1]||null==rgba[2])return[null,null,null,rgba[3]];var h,s,r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=.5*add;return h=min===max?0:r===max?60*(g-b)/diff+360:g===max?60*(b-r)/diff+120:60*(r-g)/diff+240,s=0===diff?0:l<=.5?diff/add:diff/(2-add),[Math.round(h)%360,s,l,null==a?1:a]},spaces.hsla.from=function(hsla){if(null==hsla[0]||null==hsla[1]||null==hsla[2])return[null,null,null,hsla[3]];var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(255*hue2rgb(p,q,h+1/3)),Math.round(255*hue2rgb(p,q,h)),Math.round(255*hue2rgb(p,q,h-1/3)),a]},each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]&&(this[cache]=to(this._rgba)),void 0===value)return this[cache].slice();var ret,type=jQuery.type(value),arr="array"===type||"object"===type?value:arguments,local=this[cache].slice();return each(props,function(key,prop){var val=arr["object"===type?key:prop.idx];null==val&&(val=local[prop.idx]),local[prop.idx]=clamp(val,prop)}),from?(ret=color(from(local)),ret[cache]=local,ret):color(local)},each(props,function(key,prop){color.fn[key]||(color.fn[key]=function(value){var match,vtype=jQuery.type(value),fn="alpha"===key?this._hsla?"hsla":"rgba":spaceName,local=this[fn](),cur=local[prop.idx];return"undefined"===vtype?cur:("function"===vtype&&(value=value.call(this,cur),vtype=jQuery.type(value)),null==value&&prop.empty?this:("string"===vtype&&(match=rplusequals.exec(value))&&(value=cur+parseFloat(match[2])*("+"===match[1]?1:-1)),local[prop.idx]=value,this[fn](local)))})})}),color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if("transparent"!==value&&("string"!==jQuery.type(value)||(parsed=stringParse(value)))){if(value=color(parsed||value),!support.rgba&&1!==value._rgba[3]){for(curElem="backgroundColor"===hook?elem.parentNode:elem;(""===backgroundColor||"transparent"===backgroundColor)&&curElem&&curElem.style;)try{backgroundColor=jQuery.css(curElem,"backgroundColor"),curElem=curElem.parentNode}catch(e){}value=value.blend(backgroundColor&&"transparent"!==backgroundColor?backgroundColor:"_default")}value=value.toRgbaString()}try{elem.style[hook]=value}catch(e){}}},jQuery.fx.step[hook]=function(fx){fx.colorInit||(fx.start=color(fx.elem,hook),fx.end=color(fx.end),fx.colorInit=!0),jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos))}})},color.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),jQuery.cssHooks.borderColor={expand:function(value){var expanded={};return each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value}),expanded}},colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]])for(len=style.length;len--;)key=style[len],"string"==typeof style[key]&&(styles[$.camelCase(key)]=style[key]);else for(key in style)"string"==typeof style[key]&&(styles[key]=style[key]);return styles}function styleDifference(oldStyle,newStyle){var name,value,diff={};for(name in newStyle)value=newStyle[name],oldStyle[name]!==value&&(shorthandStyles[name]||!$.fx.step[name]&&isNaN(parseFloat(value))||(diff[name]=value));return diff}var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){("none"!==fx.end&&!fx.setAttr||1===fx.pos&&!fx.setAttr)&&(jQuery.style(fx.elem,prop,fx.end),fx.setAttr=!0)}}),$.fn.addBack||($.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}),$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var applyClassChange,animated=$(this),baseClass=animated.attr("class")||"",allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){return{el:$(this),start:getElementStyles(this)}}),applyClassChange=function(){$.each(classAnimationActions,function(i,action){value[action]&&animated[action+"Class"](value[action])})},applyClassChange(),allAnimations=allAnimations.map(function(){return this.end=getElementStyles(this.el[0]),this.diff=styleDifference(this.start,this.end),this}),animated.attr("class",baseClass),allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:!1,complete:function(){dfd.resolve(styleInfo)}});return this.el.animate(this.diff,opts),dfd.promise()}),$.when.apply($,allAnimations.get()).done(function(){applyClassChange(),$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"")})}),
o.complete.call(animated[0])})})},$.fn.extend({addClass:function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.addClass),removeClass:function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments)}}($.fn.removeClass),toggleClass:function(orig){return function(classNames,force,speed,easing,callback){return"boolean"==typeof force||void 0===force?speed?$.effects.animateClass.call(this,force?{add:classNames}:{remove:classNames},speed,easing,callback):orig.apply(this,arguments):$.effects.animateClass.call(this,{toggle:classNames},force,speed,easing)}}($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback)}})}(),function(){function _normalizeArguments(effect,options,speed,callback){return $.isPlainObject(effect)&&(options=effect,effect=effect.effect),effect={effect:effect},null==options&&(options={}),$.isFunction(options)&&(callback=options,speed=null,options={}),("number"==typeof options||$.fx.speeds[options])&&(callback=speed,speed=options,options={}),$.isFunction(speed)&&(callback=speed,speed=null),options&&$.extend(effect,options),speed=speed||options.duration,effect.duration=$.fx.off?0:"number"==typeof speed?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default,effect.complete=callback||options.complete,effect}function standardAnimationOption(option){return!(option&&"number"!=typeof option&&!$.fx.speeds[option])||("string"==typeof option&&!$.effects.effect[option]||(!!$.isFunction(option)||"object"==typeof option&&!option.effect))}function parseClip(str,element){var outerWidth=element.outerWidth(),outerHeight=element.outerHeight(),clipRegex=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/,values=clipRegex.exec(str)||["",0,outerWidth,outerHeight,0];return{top:parseFloat(values[1])||0,right:"auto"===values[2]?outerWidth:parseFloat(values[2]),bottom:"auto"===values[3]?outerHeight:parseFloat(values[3]),left:parseFloat(values[4])||0}}$.expr&&$.expr.filters&&$.expr.filters.animated&&($.expr.filters.animated=function(orig){return function(elem){return!!$(elem).data(dataSpaceAnimated)||orig(elem)}}($.expr.filters.animated)),!1!==$.uiBackCompat&&$.extend($.effects,{save:function(element,set){for(var i=0,length=set.length;i<length;i++)null!==set[i]&&element.data("ui-effects-"+set[i],element[0].style[set[i]])},restore:function(element,set){for(var val,i=0,length=set.length;i<length;i++)null!==set[i]&&(val=element.data("ui-effects-"+set[i]),element.css(set[i],val))},setMode:function(el,mode){return"toggle"===mode&&(mode=el.is(":hidden")?"show":"hide"),mode},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper"))return element.parent();var props={width:element.outerWidth(!0),height:element.outerHeight(!0),float:element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id}catch(e){active=document.body}return element.wrap(wrapper),(element[0]===active||$.contains(element[0],active))&&$(active).trigger("focus"),wrapper=element.parent(),"static"===element.css("position")?(wrapper.css({position:"relative"}),element.css({position:"relative"})):($.extend(props,{position:element.css("position"),zIndex:element.css("z-index")}),$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos),isNaN(parseInt(props[pos],10))&&(props[pos]="auto")}),element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),element.css(size),wrapper.css(props).show()},removeWrapper:function(element){var active=document.activeElement;return element.parent().is(".ui-effects-wrapper")&&(element.parent().replaceWith(element),(element[0]===active||$.contains(element[0],active))&&$(active).trigger("focus")),element}}),$.extend($.effects,{version:"1.12.1",define:function(name,mode,effect){return effect||(effect=mode,mode="effect"),$.effects.effect[name]=effect,$.effects.effect[name].mode=mode,effect},scaledDimensions:function(element,percent,direction){if(0===percent)return{height:0,width:0,outerHeight:0,outerWidth:0};var x="horizontal"!==direction?(percent||100)/100:1,y="vertical"!==direction?(percent||100)/100:1;return{height:element.height()*y,width:element.width()*x,outerHeight:element.outerHeight()*y,outerWidth:element.outerWidth()*x}},clipToBox:function(animation){return{width:animation.clip.right-animation.clip.left,height:animation.clip.bottom-animation.clip.top,left:animation.clip.left,top:animation.clip.top}},unshift:function(element,queueLength,count){var queue=element.queue();queueLength>1&&queue.splice.apply(queue,[1,0].concat(queue.splice(queueLength,count))),element.dequeue()},saveStyle:function(element){element.data("ui-effects-style",element[0].style.cssText)},restoreStyle:function(element){element[0].style.cssText=element.data("ui-effects-style")||"",element.removeData("ui-effects-style")},mode:function(element,mode){var hidden=element.is(":hidden");return"toggle"===mode&&(mode=hidden?"show":"hide"),(hidden?"hide"===mode:"show"===mode)&&(mode="none"),mode},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height}switch(origin[1]){case"left":x=0;break;case"center":x=.5;break;case"right":x=1;break;default:x=origin[1]/original.width}return{x:x,y:y}},createPlaceholder:function(element){var placeholder,cssPosition=element.css("position"),position=element.position();return element.css({marginTop:element.css("marginTop"),marginBottom:element.css("marginBottom"),marginLeft:element.css("marginLeft"),marginRight:element.css("marginRight")}).outerWidth(element.outerWidth()).outerHeight(element.outerHeight()),/^(static|relative)/.test(cssPosition)&&(cssPosition="absolute",placeholder=$("<"+element[0].nodeName+">").insertAfter(element).css({display:/^(inline|ruby)/.test(element.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:element.css("marginTop"),marginBottom:element.css("marginBottom"),marginLeft:element.css("marginLeft"),marginRight:element.css("marginRight"),float:element.css("float")}).outerWidth(element.outerWidth()).outerHeight(element.outerHeight()).addClass("ui-effects-placeholder"),element.data("ui-effects-placeholder",placeholder)),element.css({position:cssPosition,left:position.left,top:position.top}),placeholder},removePlaceholder:function(element){var dataKey="ui-effects-placeholder",placeholder=element.data(dataKey);placeholder&&(placeholder.remove(),element.removeData(dataKey))},cleanUp:function(element){$.effects.restoreStyle(element),$.effects.removePlaceholder(element)},setTransition:function(element,list,factor,value){return value=value||{},$.each(list,function(i,x){var unit=element.cssUnit(x);unit[0]>0&&(value[x]=unit[0]*factor+unit[1])}),value}}),$.fn.extend({effect:function(){function run(next){function cleanup(){elem.removeData(dataSpaceAnimated),$.effects.cleanUp(elem),"hide"===args.mode&&elem.hide(),done()}function done(){$.isFunction(complete)&&complete.call(elem[0]),$.isFunction(next)&&next()}var elem=$(this);args.mode=modes.shift(),!1===$.uiBackCompat||defaultMode?"none"===args.mode?(elem[mode](),done()):effectMethod.call(elem[0],args,cleanup):(elem.is(":hidden")?"hide"===mode:"show"===mode)?(elem[mode](),done()):effectMethod.call(elem[0],args,done)}var args=_normalizeArguments.apply(this,arguments),effectMethod=$.effects.effect[args.effect],defaultMode=effectMethod.mode,queue=args.queue,queueName=queue||"fx",complete=args.complete,mode=args.mode,modes=[],prefilter=function(next){var el=$(this),normalizedMode=$.effects.mode(el,mode)||defaultMode;el.data(dataSpaceAnimated,!0),modes.push(normalizedMode),defaultMode&&("show"===normalizedMode||normalizedMode===defaultMode&&"hide"===normalizedMode)&&el.show(),defaultMode&&"none"===normalizedMode||$.effects.saveStyle(el),$.isFunction(next)&&next()};return $.fx.off||!effectMethod?mode?this[mode](args.duration,complete):this.each(function(){complete&&complete.call(this)}):!1===queue?this.each(prefilter).each(run):this.queue(queueName,prefilter).queue(queueName,run)},show:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="show",this.effect.call(this,args)}}($.fn.show),hide:function(orig){return function(option){if(standardAnimationOption(option))return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="hide",this.effect.call(this,args)}}($.fn.hide),toggle:function(orig){return function(option){if(standardAnimationOption(option)||"boolean"==typeof option)return orig.apply(this,arguments);var args=_normalizeArguments.apply(this,arguments);return args.mode="toggle",this.effect.call(this,args)}}($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];return $.each(["em","px","%","pt"],function(i,unit){style.indexOf(unit)>0&&(val=[parseFloat(style),unit])}),val},cssClip:function(clipObj){return clipObj?this.css("clip","rect("+clipObj.top+"px "+clipObj.right+"px "+clipObj.bottom+"px "+clipObj.left+"px)"):parseClip(this.css("clip"),this)},transfer:function(options,done){var element=$(this),target=$(options.to),targetFixed="fixed"===target.css("position"),body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=element.offset(),transfer=$("<div class='ui-effects-transfer'></div>").appendTo("body").addClass(options.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:element.innerHeight(),width:element.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,options.duration,options.easing,function(){transfer.remove(),$.isFunction(done)&&done()})}}),$.fx.step.clip=function(fx){fx.clipInit||(fx.start=$(fx.elem).cssClip(),"string"==typeof fx.end&&(fx.end=parseClip(fx.end,fx.elem)),fx.clipInit=!0),$(fx.elem).cssClip({top:fx.pos*(fx.end.top-fx.start.top)+fx.start.top,right:fx.pos*(fx.end.right-fx.start.right)+fx.start.right,bottom:fx.pos*(fx.end.bottom-fx.start.bottom)+fx.start.bottom,left:fx.pos*(fx.end.left-fx.start.left)+fx.start.left})}}(),function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2)}}),$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI/2)},Circ:function(p){return 1-Math.sqrt(1-p*p)},Elastic:function(p){return 0===p||1===p?p:-Math.pow(2,8*(p-1))*Math.sin((80*(p-1)-7.5)*Math.PI/15)},Back:function(p){return p*p*(3*p-2)},Bounce:function(p){for(var pow2,bounce=4;p<((pow2=Math.pow(2,--bounce))-1)/11;);return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((3*pow2-2)/22-p,2)}}),$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn,$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p)},$.easing["easeInOut"+name]=function(p){return p<.5?easeIn(2*p)/2:1-easeIn(-2*p+2)/2}})}();$.effects,$.effects.define("blind","hide",function(options,done){var map={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},element=$(this),direction=options.direction||"up",start=element.cssClip(),animate={clip:$.extend({},start)},placeholder=$.effects.createPlaceholder(element);animate.clip[map[direction][0]]=animate.clip[map[direction][1]],"show"===options.mode&&(element.cssClip(animate.clip),placeholder&&placeholder.css($.effects.clipToBox(animate)),animate.clip=start),placeholder&&placeholder.animate($.effects.clipToBox(animate),options.duration,options.easing),element.animate(animate,{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("bounce",function(options,done){var upAnim,downAnim,refValue,element=$(this),mode=options.mode,hide="hide"===mode,show="show"===mode,direction=options.direction||"up",distance=options.distance,times=options.times||5,anims=2*times+(show||hide?1:0),speed=options.duration/anims,easing=options.easing,ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction,i=0,queuelen=element.queue().length;for($.effects.createPlaceholder(element),refValue=element.css(ref),distance||(distance=element["top"===ref?"outerHeight":"outerWidth"]()/3),show&&(downAnim={opacity:1},downAnim[ref]=refValue,element.css("opacity",0).css(ref,motion?2*-distance:2*distance).animate(downAnim,speed,easing)),hide&&(distance/=Math.pow(2,times-1)),downAnim={},downAnim[ref]=refValue;i<times;i++)upAnim={},upAnim[ref]=(motion?"-=":"+=")+distance,element.animate(upAnim,speed,easing).animate(downAnim,speed,easing),distance=hide?2*distance:distance/2;hide&&(upAnim={opacity:0},upAnim[ref]=(motion?"-=":"+=")+distance,element.animate(upAnim,speed,easing)),element.queue(done),$.effects.unshift(element,queuelen,anims+1)}),$.effects.define("clip","hide",function(options,done){var start,animate={},element=$(this),direction=options.direction||"vertical",both="both"===direction,horizontal=both||"horizontal"===direction,vertical=both||"vertical"===direction;start=element.cssClip(),animate.clip={top:vertical?(start.bottom-start.top)/2:start.top,right:horizontal?(start.right-start.left)/2:start.right,bottom:vertical?(start.bottom-start.top)/2:start.bottom,left:horizontal?(start.right-start.left)/2:start.left},$.effects.createPlaceholder(element),"show"===options.mode&&(element.cssClip(animate.clip),animate.clip=start),element.animate(animate,{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("drop","hide",function(options,done){var distance,element=$(this),mode=options.mode,show="show"===mode,direction=options.direction||"left",ref="up"===direction||"down"===direction?"top":"left",motion="up"===direction||"left"===direction?"-=":"+=",oppositeMotion="+="===motion?"-=":"+=",animation={opacity:0};$.effects.createPlaceholder(element),distance=options.distance||element["top"===ref?"outerHeight":"outerWidth"](!0)/2,animation[ref]=motion+distance,show&&(element.css(animation),animation[ref]=oppositeMotion+distance,animation.opacity=1),element.animate(animation,{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("explode","hide",function(options,done){function childComplete(){pieces.push(this),pieces.length===rows*cells&&animComplete()}function animComplete(){element.css({visibility:"visible"}),$(pieces).remove(),done()}var i,j,left,top,mx,my,rows=options.pieces?Math.round(Math.sqrt(options.pieces)):3,cells=rows,element=$(this),mode=options.mode,show="show"===mode,offset=element.show().css("visibility","hidden").offset(),width=Math.ceil(element.outerWidth()/cells),height=Math.ceil(element.outerHeight()/rows),pieces=[];for(i=0;i<rows;i++)for(top=offset.top+i*height,my=i-(rows-1)/2,j=0;j<cells;j++)left=offset.left+j*width,mx=j-(cells-1)/2,element.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*width,top:-i*height}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width,height:height,left:left+(show?mx*width:0),top:top+(show?my*height:0),opacity:show?0:1}).animate({left:left+(show?0:mx*width),top:top+(show?0:my*height),opacity:show?1:0},options.duration||500,options.easing,childComplete)}),$.effects.define("fade","toggle",function(options,done){var show="show"===options.mode;$(this).css("opacity",show?0:1).animate({opacity:show?1:0},{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("fold","hide",function(options,done){var element=$(this),mode=options.mode,show="show"===mode,hide="hide"===mode,size=options.size||15,percent=/([0-9]+)%/.exec(size),horizFirst=!!options.horizFirst,ref=horizFirst?["right","bottom"]:["bottom","right"],duration=options.duration/2,placeholder=$.effects.createPlaceholder(element),start=element.cssClip(),animation1={clip:$.extend({},start)},animation2={clip:$.extend({},start)},distance=[start[ref[0]],start[ref[1]]],queuelen=element.queue().length;percent&&(size=parseInt(percent[1],10)/100*distance[hide?0:1]),animation1.clip[ref[0]]=size,animation2.clip[ref[0]]=size,animation2.clip[ref[1]]=0,show&&(element.cssClip(animation2.clip),placeholder&&placeholder.css($.effects.clipToBox(animation2)),animation2.clip=start),element.queue(function(next){placeholder&&placeholder.animate($.effects.clipToBox(animation1),duration,options.easing).animate($.effects.clipToBox(animation2),duration,options.easing),next()}).animate(animation1,duration,options.easing).animate(animation2,duration,options.easing).queue(done),$.effects.unshift(element,queuelen,4)}),$.effects.define("highlight","show",function(options,done){var element=$(this),animation={backgroundColor:element.css("backgroundColor")};"hide"===options.mode&&(animation.opacity=0),$.effects.saveStyle(element),element.css({backgroundImage:"none",backgroundColor:options.color||"#ffff99"}).animate(animation,{queue:!1,duration:options.duration,easing:options.easing,complete:done})}),$.effects.define("size",function(options,done){var baseline,factor,temp,element=$(this),cProps=["fontSize"],vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],mode=options.mode,restore="effect"!==mode,scale=options.scale||"both",origin=options.origin||["middle","center"],position=element.css("position"),pos=element.position(),original=$.effects.scaledDimensions(element),from=options.from||original,to=options.to||$.effects.scaledDimensions(element,0);$.effects.createPlaceholder(element),"show"===mode&&(temp=from,from=to,to=temp),factor={from:{y:from.height/original.height,x:from.width/original.width},to:{y:to.height/original.height,x:to.width/original.width}},"box"!==scale&&"both"!==scale||(factor.from.y!==factor.to.y&&(from=$.effects.setTransition(element,vProps,factor.from.y,from),to=$.effects.setTransition(element,vProps,factor.to.y,to)),factor.from.x!==factor.to.x&&(from=$.effects.setTransition(element,hProps,factor.from.x,from),to=$.effects.setTransition(element,hProps,factor.to.x,to))),"content"!==scale&&"both"!==scale||factor.from.y!==factor.to.y&&(from=$.effects.setTransition(element,cProps,factor.from.y,from),to=$.effects.setTransition(element,cProps,factor.to.y,to)),origin&&(baseline=$.effects.getBaseline(origin,original),from.top=(original.outerHeight-from.outerHeight)*baseline.y+pos.top,from.left=(original.outerWidth-from.outerWidth)*baseline.x+pos.left,to.top=(original.outerHeight-to.outerHeight)*baseline.y+pos.top,to.left=(original.outerWidth-to.outerWidth)*baseline.x+pos.left),element.css(from),"content"!==scale&&"both"!==scale||(vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps),hProps=hProps.concat(["marginLeft","marginRight"]),element.find("*[width]").each(function(){var child=$(this),childOriginal=$.effects.scaledDimensions(child),childFrom={height:childOriginal.height*factor.from.y,width:childOriginal.width*factor.from.x,outerHeight:childOriginal.outerHeight*factor.from.y,outerWidth:childOriginal.outerWidth*factor.from.x},childTo={height:childOriginal.height*factor.to.y,width:childOriginal.width*factor.to.x,outerHeight:childOriginal.height*factor.to.y,outerWidth:childOriginal.width*factor.to.x};factor.from.y!==factor.to.y&&(childFrom=$.effects.setTransition(child,vProps,factor.from.y,childFrom),childTo=$.effects.setTransition(child,vProps,factor.to.y,childTo)),factor.from.x!==factor.to.x&&(childFrom=$.effects.setTransition(child,hProps,factor.from.x,childFrom),childTo=$.effects.setTransition(child,hProps,factor.to.x,childTo)),restore&&$.effects.saveStyle(child),child.css(childFrom),child.animate(childTo,options.duration,options.easing,function(){restore&&$.effects.restoreStyle(child)})})),element.animate(to,{queue:!1,duration:options.duration,easing:options.easing,complete:function(){var offset=element.offset();0===to.opacity&&element.css("opacity",from.opacity),restore||(element.css("position","static"===position?"relative":position).offset(offset),$.effects.saveStyle(element)),done()}})}),$.effects.define("scale",function(options,done){var el=$(this),mode=options.mode,percent=parseInt(options.percent,10)||(0===parseInt(options.percent,10)?0:"effect"!==mode?0:100),newOptions=$.extend(!0,{from:$.effects.scaledDimensions(el),to:$.effects.scaledDimensions(el,percent,options.direction||"both"),origin:options.origin||["middle","center"]},options);options.fade&&(newOptions.from.opacity=1,newOptions.to.opacity=0),$.effects.effect.size.call(this,newOptions,done)}),$.effects.define("puff","hide",function(options,done){var newOptions=$.extend(!0,{},options,{fade:!0,percent:parseInt(options.percent,10)||150});$.effects.effect.scale.call(this,newOptions,done)}),$.effects.define("pulsate","show",function(options,done){var element=$(this),mode=options.mode,show="show"===mode,hide="hide"===mode,showhide=show||hide,anims=2*(options.times||5)+(showhide?1:0),duration=options.duration/anims,animateTo=0,i=1,queuelen=element.queue().length;for(!show&&element.is(":visible")||(element.css("opacity",0).show(),animateTo=1);i<anims;i++)element.animate({opacity:animateTo},duration,options.easing),animateTo=1-animateTo;element.animate({opacity:animateTo},duration,options.easing),element.queue(done),$.effects.unshift(element,queuelen,anims+1)}),$.effects.define("shake",function(options,done){var i=1,element=$(this),direction=options.direction||"left",distance=options.distance||20,times=options.times||3,anims=2*times+1,speed=Math.round(options.duration/anims),ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,animation={},animation1={},animation2={},queuelen=element.queue().length;for($.effects.createPlaceholder(element),animation[ref]=(positiveMotion?"-=":"+=")+distance,animation1[ref]=(positiveMotion?"+=":"-=")+2*distance,animation2[ref]=(positiveMotion?"-=":"+=")+2*distance,element.animate(animation,speed,options.easing);i<times;i++)element.animate(animation1,speed,options.easing).animate(animation2,speed,options.easing);element.animate(animation1,speed,options.easing).animate(animation,speed/2,options.easing).queue(done),$.effects.unshift(element,queuelen,anims+1)}),$.effects.define("slide","show",function(options,done){var startClip,startRef,element=$(this),map={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},mode=options.mode,direction=options.direction||"left",ref="up"===direction||"down"===direction?"top":"left",positiveMotion="up"===direction||"left"===direction,distance=options.distance||element["top"===ref?"outerHeight":"outerWidth"](!0),animation={};$.effects.createPlaceholder(element),startClip=element.cssClip(),startRef=element.position()[ref],animation[ref]=(positiveMotion?-1:1)*distance+startRef,animation.clip=element.cssClip(),animation.clip[map[direction][1]]=animation.clip[map[direction][0]],"show"===mode&&(element.cssClip(animation.clip),element.css(ref,animation[ref]),animation.clip=startClip,animation[ref]=startRef),element.animate(animation,{queue:!1,duration:options.duration,easing:options.easing,complete:done})});!1!==$.uiBackCompat&&$.effects.define("transfer",function(options,done){$(this).transfer(options,done)});$.ui.focusable=function(element,hasTabindex){var map,mapName,img,focusableIfVisible,fieldset,nodeName=element.nodeName.toLowerCase();return"area"===nodeName?(map=element.parentNode,mapName=map.name,!(!element.href||!mapName||"map"!==map.nodeName.toLowerCase())&&(img=$("img[usemap='#"+mapName+"']"),img.length>0&&img.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(nodeName)?(focusableIfVisible=!element.disabled)&&(fieldset=$(element).closest("fieldset")[0])&&(focusableIfVisible=!fieldset.disabled):focusableIfVisible="a"===nodeName?element.href||hasTabindex:hasTabindex,focusableIfVisible&&$(element).is(":visible")&&visible($(element)))},$.extend($.expr[":"],{focusable:function(element){return $.ui.focusable(element,null!=$.attr(element,"tabindex"))}});$.ui.focusable,$.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):$(this[0].form)},$.ui.formResetMixin={_formResetHandler:function(){var form=$(this);setTimeout(function(){var instances=form.data("ui-form-reset-instances");$.each(instances,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var instances=this.form.data("ui-form-reset-instances")||[];instances.length||this.form.on("reset.ui-form-reset",this._formResetHandler),instances.push(this),this.form.data("ui-form-reset-instances",instances)}},_unbindFormResetHandler:function(){if(this.form.length){var instances=this.form.data("ui-form-reset-instances");instances.splice($.inArray(this,instances),1),instances.length?this.form.data("ui-form-reset-instances",instances):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}};"1.7"===$.fn.jquery.substring(0,3)&&($.each(["Width","Height"],function(i,name){function reduce(elem,size,border,margin){return $.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0,border&&(size-=parseFloat($.css(elem,"border"+this+"Width"))||0),margin&&(size-=parseFloat($.css(elem,"margin"+this))||0)}),size}var side="Width"===name?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};$.fn["inner"+name]=function(size){return void 0===size?orig["inner"+name].call(this):this.each(function(){$(this).css(type,reduce(this,size)+"px")})},$.fn["outer"+name]=function(size,margin){return"number"!=typeof size?orig["outer"+name].call(this,size):this.each(function(){$(this).css(type,reduce(this,size,!0,margin)+"px")})}}),$.fn.addBack=function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))});$.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},$.ui.escapeSelector=function(){var selectorEscape=/([!"#$%&'()*+,.\/:;<=>?@[\]^`{|}~])/g;return function(selector){return selector.replace(selectorEscape,"\\$1")}}(),$.fn.labels=function(){var ancestor,selector,id,labels,ancestors;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(labels=this.eq(0).parents("label"),id=this.attr("id"),id&&(ancestor=this.eq(0).parents().last(),ancestors=ancestor.add(ancestor.length?ancestor.siblings():this.siblings()),selector="label[for='"+$.ui.escapeSelector(id)+"']",labels=labels.add(ancestors.find(selector).addBack(selector))),this.pushStack(labels))},$.fn.scrollParent=function(includeHidden){var position=this.css("position"),excludeStaticParent="absolute"===position,overflowRegex=includeHidden?/(auto|scroll|hidden)/:/(auto|scroll)/,scrollParent=this.parents().filter(function(){var parent=$(this);return(!excludeStaticParent||"static"!==parent.css("position"))&&overflowRegex.test(parent.css("overflow")+parent.css("overflow-y")+parent.css("overflow-x"))}).eq(0);return"fixed"!==position&&scrollParent.length?scrollParent:$(this[0].ownerDocument||document)},$.extend($.expr[":"],{tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),hasTabindex=null!=tabIndex;return(!hasTabindex||tabIndex>=0)&&$.ui.focusable(element,hasTabindex)}}),$.fn.extend({uniqueId:function(){var uuid=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++uuid)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&$(this).removeAttr("id")})}}),$.widget("ui.accordion",{version:"1.12.1",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:"> li > :first-child, > :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var options=this.options;this.prevShow=this.prevHide=$(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),options.collapsible||!1!==options.active&&null!=options.active||(options.active=0),this._processPanels(),options.active<0&&(options.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():$()}},_createIcons:function(){var icon,children,icons=this.options.icons;icons&&(icon=$("<span>"),this._addClass(icon,"ui-accordion-header-icon","ui-icon "+icons.header),icon.prependTo(this.headers),children=this.active.children(".ui-accordion-header-icon"),this._removeClass(children,icons.header)._addClass(children,null,icons.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var contents;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),contents=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&contents.css("height","")},_setOption:function(key,value){if("active"===key)return void this._activate(value);"event"===key&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(value)),this._super(key,value),"collapsible"!==key||value||!1!==this.options.active||this._activate(0),"icons"===key&&(this._destroyIcons(),value&&this._createIcons())},_setOptionDisabled:function(value){this._super(value),this.element.attr("aria-disabled",value),this._toggleClass(null,"ui-state-disabled",!!value),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!value)},_keydown:function(event){if(!event.altKey&&!event.ctrlKey){var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=!1;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event);break;case keyCode.HOME:toFocus=this.headers[0];break;case keyCode.END:toFocus=this.headers[length-1]}toFocus&&($(event.target).attr("tabIndex",-1),$(toFocus).attr("tabIndex",0),$(toFocus).trigger("focus"),event.preventDefault())}},_panelKeyDown:function(event){event.keyCode===$.ui.keyCode.UP&&event.ctrlKey&&$(event.currentTarget).prev().trigger("focus")},refresh:function(){var options=this.options;this._processPanels(),!1===options.active&&!0===options.collapsible||!this.headers.length?(options.active=!1,
this.active=$()):!1===options.active?this._activate(0):this.active.length&&!$.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(options.active=!1,this.active=$()):this._activate(Math.max(0,options.active-1)):options.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var prevHeaders=this.headers,prevPanels=this.panels;this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),prevPanels&&(this._off(prevHeaders.not(this.headers)),this._off(prevPanels.not(this.panels)))},_refresh:function(){var maxHeight,options=this.options,heightStyle=options.heightStyle,parent=this.element.parent();this.active=this._findActive(options.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var header=$(this),headerId=header.uniqueId().attr("id"),panel=header.next(),panelId=panel.uniqueId().attr("id");header.attr("aria-controls",panelId),panel.attr("aria-labelledby",headerId)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(options.event),"fill"===heightStyle?(maxHeight=parent.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.headers.each(function(){maxHeight-=$(this).outerHeight(!0)}),this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.headers.next().each(function(){var isVisible=$(this).is(":visible");isVisible||$(this).show(),maxHeight=Math.max(maxHeight,$(this).css("height","").height()),isVisible||$(this).hide()}).height(maxHeight))},_activate:function(index){var active=this._findActive(index)[0];active!==this.active[0]&&(active=active||this.active[0],this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop}))},_findActive:function(selector){return"number"==typeof selector?this.headers.eq(selector):$()},_setupEvents:function(event){var events={keydown:"_keydown"};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,events),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(event){var activeChildren,clickedChildren,options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),toHide=active.next(),eventData={oldHeader:active,oldPanel:toHide,newHeader:collapsing?$():clicked,newPanel:toShow};event.preventDefault(),clickedIsActive&&!options.collapsible||!1===this._trigger("beforeActivate",event,eventData)||(options.active=!collapsing&&this.headers.index(clicked),this.active=clickedIsActive?$():clicked,this._toggle(eventData),this._removeClass(active,"ui-accordion-header-active","ui-state-active"),options.icons&&(activeChildren=active.children(".ui-accordion-header-icon"),this._removeClass(activeChildren,null,options.icons.activeHeader)._addClass(activeChildren,null,options.icons.header)),clickedIsActive||(this._removeClass(clicked,"ui-accordion-header-collapsed")._addClass(clicked,"ui-accordion-header-active","ui-state-active"),options.icons&&(clickedChildren=clicked.children(".ui-accordion-header-icon"),this._removeClass(clickedChildren,null,options.icons.header)._addClass(clickedChildren,null,options.icons.activeHeader)),this._addClass(clicked.next(),"ui-accordion-content-active")))},_toggle:function(data){var toShow=data.newPanel,toHide=this.prevShow.length?this.prevShow:data.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=toShow,this.prevHide=toHide,this.options.animate?this._animate(toShow,toHide,data):(toHide.hide(),toShow.show(),this._toggleComplete(data)),toHide.attr({"aria-hidden":"true"}),toHide.prev().attr({"aria-selected":"false","aria-expanded":"false"}),toShow.length&&toHide.length?toHide.prev().attr({tabIndex:-1,"aria-expanded":"false"}):toShow.length&&this.headers.filter(function(){return 0===parseInt($(this).attr("tabIndex"),10)}).attr("tabIndex",-1),toShow.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(toShow,toHide,data){var total,easing,duration,that=this,adjust=0,boxSizing=toShow.css("box-sizing"),down=toShow.length&&(!toHide.length||toShow.index()<toHide.index()),animate=this.options.animate||{},options=down&&animate.down||animate,complete=function(){that._toggleComplete(data)};return"number"==typeof options&&(duration=options),"string"==typeof options&&(easing=options),easing=easing||options.easing||animate.easing,duration=duration||options.duration||animate.duration,toHide.length?toShow.length?(total=toShow.show().outerHeight(),toHide.animate(this.hideProps,{duration:duration,easing:easing,step:function(now,fx){fx.now=Math.round(now)}}),void toShow.hide().animate(this.showProps,{duration:duration,easing:easing,complete:complete,step:function(now,fx){fx.now=Math.round(now),"height"!==fx.prop?"content-box"===boxSizing&&(adjust+=fx.now):"content"!==that.options.heightStyle&&(fx.now=Math.round(total-toHide.outerHeight()-adjust),adjust=0)}})):toHide.animate(this.hideProps,duration,easing,complete):toShow.animate(this.showProps,duration,easing,complete)},_toggleComplete:function(data){var toHide=data.oldPanel,prev=toHide.prev();this._removeClass(toHide,"ui-accordion-content-active"),this._removeClass(prev,"ui-accordion-header-active")._addClass(prev,"ui-accordion-header-collapsed"),toHide.length&&(toHide.parent()[0].className=toHide.parent()[0].className),this._trigger("activate",null,data)}}),$.ui.safeActiveElement=function(document){var activeElement;try{activeElement=document.activeElement}catch(error){activeElement=document.body}return activeElement||(activeElement=document.body),activeElement.nodeName||(activeElement=document.body),activeElement},$.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(event){event.preventDefault()},"click .ui-menu-item":function(event){var target=$(event.target),active=$($.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&target.not(".ui-state-disabled").length&&(this.select(event),event.isPropagationStopped()||(this.mouseHandled=!0),target.has(".ui-menu").length?this.expand(event):!this.element.is(":focus")&&active.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(event){if(!this.previousFilter){var actualTarget=$(event.target).closest(".ui-menu-item"),target=$(event.currentTarget);actualTarget[0]===target[0]&&(this._removeClass(target.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(event,target))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.find(this.options.items).eq(0);keepActiveItem||this.focus(event,item)},blur:function(event){this._delay(function(){!$.contains(this.element[0],$.ui.safeActiveElement(this.document[0]))&&this.collapseAll(event)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(event){this._closeOnDocumentClick(event)&&this.collapseAll(event),this.mouseHandled=!1}})},_destroy:function(){var items=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),submenus=items.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),submenus.children().each(function(){var elem=$(this);elem.data("ui-menu-submenu-caret")&&elem.remove()})},_keydown:function(event){var match,prev,character,skip,preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(event);break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=!1,prev=this.previousFilter||"",skip=!1,character=event.keyCode>=96&&event.keyCode<=105?(event.keyCode-96).toString():String.fromCharCode(event.keyCode),clearTimeout(this.filterTimer),character===prev?skip=!0:character=prev+character,match=this._filterMenuItems(character),match=skip&&-1!==match.index(this.active.next())?this.active.nextAll(".ui-menu-item"):match,match.length||(character=String.fromCharCode(event.keyCode),match=this._filterMenuItems(character)),match.length?(this.focus(event,match),this.previousFilter=character,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}preventDefault&&event.preventDefault()},_activate:function(event){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(event):this.select(event))},refresh:function(){var menus,items,newSubmenus,newItems,newWrappers,that=this,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),newSubmenus=submenus.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.prev(),submenuCaret=$("<span>").data("ui-menu-submenu-caret",!0);that._addClass(submenuCaret,"ui-menu-icon","ui-icon "+icon),item.attr("aria-haspopup","true").prepend(submenuCaret),menu.attr("aria-labelledby",item.attr("id"))}),this._addClass(newSubmenus,"ui-menu","ui-widget ui-widget-content ui-front"),menus=submenus.add(this.element),items=menus.find(this.options.items),items.not(".ui-menu-item").each(function(){var item=$(this);that._isDivider(item)&&that._addClass(item,"ui-menu-divider","ui-widget-content")}),newItems=items.not(".ui-menu-item, .ui-menu-divider"),newWrappers=newItems.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(newItems,"ui-menu-item")._addClass(newWrappers,"ui-menu-item-wrapper"),items.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!$.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(key,value){if("icons"===key){var icons=this.element.find(".ui-menu-icon");this._removeClass(icons,null,this.options.icons.submenu)._addClass(icons,null,value.submenu)}this._super(key,value)},_setOptionDisabled:function(value){this._super(value),this.element.attr("aria-disabled",String(value)),this._toggleClass(null,"ui-state-disabled",!!value)},focus:function(event,item){var nested,focused,activeParent;this.blur(event,event&&"focus"===event.type),this._scrollIntoView(item),this.active=item.first(),focused=this.active.children(".ui-menu-item-wrapper"),this._addClass(focused,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",focused.attr("id")),activeParent=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(activeParent,null,"ui-state-active"),event&&"keydown"===event.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),nested=item.children(".ui-menu"),nested.length&&event&&/^mouse/.test(event.type)&&this._startOpening(nested),this.activeMenu=item.parent(),this._trigger("focus",event,{item:item})},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;this._hasScroll()&&(borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0,paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0,offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop,scroll=this.activeMenu.scrollTop(),elementHeight=this.activeMenu.height(),itemHeight=item.outerHeight(),offset<0?this.activeMenu.scrollTop(scroll+offset):offset+itemHeight>elementHeight&&this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight))},blur:function(event,fromFocus){fromFocus||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",event,{item:this.active}),this.active=null)},_startOpening:function(submenu){clearTimeout(this.timer),"true"===submenu.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(submenu)},this.delay))},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true"),submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position)},collapseAll:function(event,all){clearTimeout(this.timer),this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));currentMenu.length||(currentMenu=this.element),this._close(currentMenu),this.blur(event),this._removeClass(currentMenu.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=currentMenu},this.delay)},_close:function(startMenu){startMenu||(startMenu=this.active?this.active.parent():this.element),startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(event){return!$(event.target).closest(".ui-menu").length},_isDivider:function(item){return!/[^\-\u2014\u2013\s]/.test(item.text())},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);newItem&&newItem.length&&(this._close(),this.focus(event,newItem))},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();newItem&&newItem.length&&(this._open(newItem.parent()),this._delay(function(){this.focus(event,newItem)}))},next:function(event){this._move("next","first",event)},previous:function(event){this._move("prev","last",event)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(direction,filter,event){var next;this.active&&(next="first"===direction||"last"===direction?this.active["first"===direction?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[direction+"All"](".ui-menu-item").eq(0)),next&&next.length&&this.active||(next=this.activeMenu.find(this.options.items)[filter]()),this.focus(event,next)},nextPage:function(event){var item,base,height;if(!this.active)return void this.next(event);this.isLastItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base-height<0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))},previousPage:function(event){var item,base,height;if(!this.active)return void this.next(event);this.isFirstItem()||(this._hasScroll()?(base=this.active.offset().top,height=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return item=$(this),item.offset().top-base+height>0}),this.focus(event,item)):this.focus(event,this.activeMenu.find(this.options.items).first()))},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(event,!0),this._trigger("select",event,ui)},_filterMenuItems:function(character){var escapedCharacter=character.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),regex=new RegExp("^"+escapedCharacter,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return regex.test($.trim($(this).children(".ui-menu-item-wrapper").text()))})}});$.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea="textarea"===nodeName,isInput="input"===nodeName;this.isMultiLine=isTextarea||!isInput&&this._isContentEditable(this.element),this.valueMethod=this.element[isTextarea||isInput?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly"))return suppressKeyPress=!0,suppressInput=!0,void(suppressKeyPressRepeat=!0);suppressKeyPress=!1,suppressInput=!1,suppressKeyPressRepeat=!1;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=!0,this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=!0,this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=!0,this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=!0,this._keyEvent("next",event);break;case keyCode.ENTER:this.menu.active&&(suppressKeyPress=!0,event.preventDefault(),this.menu.select(event));break;case keyCode.TAB:this.menu.active&&this.menu.select(event);break;case keyCode.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(event),event.preventDefault());break;default:suppressKeyPressRepeat=!0,this._searchTimeout(event)}},keypress:function(event){if(suppressKeyPress)return suppressKeyPress=!1,void(this.isMultiLine&&!this.menu.element.is(":visible")||event.preventDefault());if(!suppressKeyPressRepeat){var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event)}}},input:function(event){if(suppressInput)return suppressInput=!1,void event.preventDefault();this._searchTimeout(event)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(event){if(this.cancelBlur)return void delete this.cancelBlur;clearTimeout(this.searching),this.close(event),this._change(event)}}),this._initSource(),this.menu=$("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(event){event.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==$.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(event,ui){var label,item;if(this.isNewMenu&&(this.isNewMenu=!1,event.originalEvent&&/^mouse/.test(event.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent)});item=ui.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",event,{item:item})&&event.originalEvent&&/^key/.test(event.originalEvent.type)&&this._value(item.value),(label=ui.item.attr("aria-label")||item.value)&&$.trim(label).length&&(this.liveRegion.children().hide(),$("<div>").text(label).appendTo(this.liveRegion))},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;this.element[0]!==$.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=previous,this._delay(function(){this.previous=previous,this.selectedItem=item})),!1!==this._trigger("select",event,{item:item})&&this._value(item.value),this.term=this._value(),this.close(event),this.selectedItem=item}}),this.liveRegion=$("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(key,value){this._super(key,value),"source"===key&&this._initSource(),"appendTo"===key&&this.menu.element.appendTo(this._appendTo()),"disabled"===key&&value&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(event){var menuElement=this.menu.element[0];return event.target===this.element[0]||event.target===menuElement||$.contains(menuElement,event.target)},_closeOnClickOutside:function(event){this._isEventTargetInWidget(event)||this.close()},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element&&element[0]||(element=this.element.closest(".ui-front, dialog")),element.length||(element=this.document[0].body),element},_initSource:function(){var array,url,that=this;$.isArray(this.options.source)?(array=this.options.source,this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}):"string"==typeof this.options.source?(url=this.options.source,this.source=function(request,response){that.xhr&&that.xhr.abort(),that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data)},error:function(){response([])}})}):this.source=this.options.source},_searchTimeout:function(event){clearTimeout(this.searching),this.searching=this._delay(function(){var equalValues=this.term===this._value(),menuVisible=this.menu.element.is(":visible"),modifierKey=event.altKey||event.ctrlKey||event.metaKey||event.shiftKey;equalValues&&(!equalValues||menuVisible||modifierKey)||(this.selectedItem=null,this.search(null,event))},this.options.delay)},search:function(value,event){return value=null!=value?value:this._value(),this.term=this._value(),value.length<this.options.minLength?this.close(event):!1!==this._trigger("search",event)?this._search(value):void 0},_search:function(value){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:value},this._response())},_response:function(){var index=++this.requestIndex;return $.proxy(function(content){index===this.requestIndex&&this.__response(content),--this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(content){content&&(content=this._normalize(content)),this._trigger("response",null,{content:content}),!this.options.disabled&&content&&content.length&&!this.cancelSearch?(this._suggest(content),this._trigger("open")):this._close()},close:function(event){this.cancelSearch=!0,this._close(event)},_close:function(event){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",event))},_change:function(event){this.previous!==this._value()&&this._trigger("change",event,{item:this.selectedItem})},_normalize:function(items){return items.length&&items[0].label&&items[0].value?items:$.map(items,function(item){return"string"==typeof item?{label:item,value:item}:$.extend({},item,{label:item.label||item.value,value:item.value||item.label})})},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items),this.isNewMenu=!0,this.menu.refresh(),ul.show(),this._resizeMenu(),ul.position($.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item)},_renderItem:function(ul,item){return $("<li>").append($("<div>").text(item.label)).appendTo(ul)},_move:function(direction,event){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[direction](event):void this.search(null,event)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(keyEvent,event){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(keyEvent,event),event.preventDefault())},_isContentEditable:function(element){if(!element.length)return!1;var editable=element.prop("contentEditable");return"inherit"===editable?this._isContentEditable(element.parent()):"true"===editable}}),$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}}),$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(content){var message;this._superApply(arguments),this.options.disabled||this.cancelSearch||(message=content&&content.length?this.options.messages.results(content.length):this.options.messages.noResults,this.liveRegion.children().hide(),$("<div>").text(message).appendTo(this.liveRegion))}});var controlgroupCornerRegex=($.ui.autocomplete,/ui-corner-([a-z]){2,6}/g);$.widget("ui.controlgroup",{version:"1.12.1",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var that=this,childWidgets=[];$.each(this.options.items,function(widget,selector){var labels,options={};if(selector)return"controlgroupLabel"===widget?(labels=that.element.find(selector),labels.each(function(){var element=$(this);element.children(".ui-controlgroup-label-contents").length||element.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),that._addClass(labels,null,"ui-widget ui-widget-content ui-state-default"),void(childWidgets=childWidgets.concat(labels.get()))):void($.fn[widget]&&(options=that["_"+widget+"Options"]?that["_"+widget+"Options"]("middle"):{classes:{}},that.element.find(selector).each(function(){var element=$(this),instance=element[widget]("instance"),instanceOptions=$.widget.extend({},options);if("button"!==widget||!element.parent(".ui-spinner").length){instance||(instance=element[widget]()[widget]("instance")),instance&&(instanceOptions.classes=that._resolveClassesValues(instanceOptions.classes,instance)),element[widget](instanceOptions);var widgetElement=element[widget]("widget");$.data(widgetElement[0],"ui-controlgroup-data",instance||element[widget]("instance")),childWidgets.push(widgetElement[0])}})))}),this.childWidgets=$($.unique(childWidgets)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(method){this.childWidgets.each(function(){var element=$(this),data=element.data("ui-controlgroup-data");data&&data[method]&&data[method]()})},_updateCornerClass:function(element,position){var add=this._buildSimpleOptions(position,"label").classes.label;this._removeClass(element,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(element,null,add)},_buildSimpleOptions:function(position,key){var direction="vertical"===this.options.direction,result={classes:{}};return result.classes[key]={middle:"",first:"ui-corner-"+(direction?"top":"left"),last:"ui-corner-"+(direction?"bottom":"right"),only:"ui-corner-all"}[position],result},_spinnerOptions:function(position){var options=this._buildSimpleOptions(position,"ui-spinner");return options.classes["ui-spinner-up"]="",options.classes["ui-spinner-down"]="",options},_buttonOptions:function(position){return this._buildSimpleOptions(position,"ui-button")},_checkboxradioOptions:function(position){return this._buildSimpleOptions(position,"ui-checkboxradio-label")},_selectmenuOptions:function(position){var direction="vertical"===this.options.direction;return{width:!!direction&&"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(direction?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(direction?"top":"left")},last:{"ui-selectmenu-button-open":direction?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(direction?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[position]}},_resolveClassesValues:function(classes,instance){var result={};return $.each(classes,function(key){var current=instance.options.classes[key]||"";current=$.trim(current.replace(controlgroupCornerRegex,"")),result[key]=(current+" "+classes[key]).replace(/\s+/g," ")}),result},_setOption:function(key,value){if("direction"===key&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(key,value),"disabled"===key)return void this._callChildMethod(value?"disable":"enable");this.refresh()},refresh:function(){var children,that=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),
"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),children=this.childWidgets,this.options.onlyVisible&&(children=children.filter(":visible")),children.length&&($.each(["first","last"],function(index,value){var instance=children[value]().data("ui-controlgroup-data");if(instance&&that["_"+instance.widgetName+"Options"]){var options=that["_"+instance.widgetName+"Options"](1===children.length?"only":value);options.classes=that._resolveClassesValues(options.classes,instance),instance.element[instance.widgetName](options)}else that._updateCornerClass(children[value](),value)}),this._callChildMethod("refresh"))}});$.widget("ui.checkboxradio",[$.ui.formResetMixin,{version:"1.12.1",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var disabled,labels,that=this,options=this._super()||{};return this._readType(),labels=this.element.labels(),this.label=$(labels[labels.length-1]),this.label.length||$.error("No label found for checkboxradio widget"),this.originalLabel="",this.label.contents().not(this.element[0]).each(function(){that.originalLabel+=3===this.nodeType?$(this).text():this.outerHTML}),this.originalLabel&&(options.label=this.originalLabel),disabled=this.element[0].disabled,null!=disabled&&(options.disabled=disabled),options},_create:function(){var checked=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),checked&&(this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this.icon&&this._addClass(this.icon,null,"ui-state-hover")),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var nodeName=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===nodeName&&/radio|checkbox/.test(this.type)||$.error("Can't create checkboxradio on element.nodeName="+nodeName+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var group,name=this.element[0].name,nameSelector="input[name='"+$.ui.escapeSelector(name)+"']";return name?(group=this.form.length?$(this.form[0].elements).filter(nameSelector):$(nameSelector).filter(function(){return 0===$(this).form().length}),group.not(this.element)):$([])},_toggleClasses:function(){var checked=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",checked),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",checked)._toggleClass(this.icon,null,"ui-icon-blank",!checked),"radio"===this.type&&this._getRadioGroup().each(function(){var instance=$(this).checkboxradio("instance");instance&&instance._removeClass(instance.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(key,value){if("label"!==key||value){if(this._super(key,value),"disabled"===key)return this._toggleClass(this.label,null,"ui-state-disabled",value),void(this.element[0].disabled=value);this.refresh()}},_updateIcon:function(checked){var toAdd="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=$("<span>"),this.iconSpace=$("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(toAdd+=checked?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,checked?"ui-icon-blank":"ui-icon-check")):toAdd+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",toAdd),checked||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var contents=this.label.contents().not(this.element[0]);this.icon&&(contents=contents.not(this.icon[0])),this.iconSpace&&(contents=contents.not(this.iconSpace[0])),contents.remove(),this.label.append(this.options.label)},refresh:function(){var checked=this.element[0].checked,isDisabled=this.element[0].disabled;this._updateIcon(checked),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",checked),null!==this.options.label&&this._updateLabel(),isDisabled!==this.options.disabled&&this._setOptions({disabled:isDisabled})}}]);$.ui.checkboxradio;$.widget("ui.button",{version:"1.12.1",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var disabled,options=this._super()||{};return this.isInput=this.element.is("input"),disabled=this.element[0].disabled,null!=disabled&&(options.disabled=disabled),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(options.label=this.originalLabel),options},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(event){event.keyCode===$.ui.keyCode.SPACE&&(event.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(option,value){var icon="iconPosition"!==option,position=icon?this.options.iconPosition:value,displayBlock="top"===position||"bottom"===position;this.icon?icon&&this._removeClass(this.icon,null,this.options.icon):(this.icon=$("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),icon&&this._addClass(this.icon,null,value),this._attachIcon(position),displayBlock?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=$("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(position))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(iconPosition){this.icon[/^(?:end|bottom)/.test(iconPosition)?"before":"after"](this.iconSpace)},_attachIcon:function(iconPosition){this.element[/^(?:end|bottom)/.test(iconPosition)?"append":"prepend"](this.icon)},_setOptions:function(options){var newShowLabel=void 0===options.showLabel?this.options.showLabel:options.showLabel,newIcon=void 0===options.icon?this.options.icon:options.icon;newShowLabel||newIcon||(options.showLabel=!0),this._super(options)},_setOption:function(key,value){"icon"===key&&(value?this._updateIcon(key,value):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),"iconPosition"===key&&this._updateIcon(key,value),"showLabel"===key&&(this._toggleClass("ui-button-icon-only",null,!value),this._updateTooltip()),"label"===key&&(this.isInput?this.element.val(value):(this.element.html(value),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(key,value),"disabled"===key&&(this._toggleClass(null,"ui-state-disabled",value),this.element[0].disabled=value,value&&this.element.blur())},refresh:function(){var isDisabled=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");isDisabled!==this.options.disabled&&this._setOptions({disabled:isDisabled}),this._updateTooltip()}}),!1!==$.uiBackCompat&&($.widget("ui.button",$.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(key,value){if("text"===key)return void this._super("showLabel",value);"showLabel"===key&&(this.options.text=value),"icon"===key&&(this.options.icons.primary=value),"icons"===key&&(value.primary?(this._super("icon",value.primary),this._super("iconPosition","beginning")):value.secondary&&(this._super("icon",value.secondary),this._super("iconPosition","end"))),this._superApply(arguments)}}),$.fn.button=function(orig){return function(){return!this.length||this.length&&"INPUT"!==this[0].tagName||this.length&&"INPUT"===this[0].tagName&&"checkbox"!==this.attr("type")&&"radio"!==this.attr("type")?orig.apply(this,arguments):($.ui.checkboxradio||$.error("Checkboxradio widget missing"),0===arguments.length?this.checkboxradio({icon:!1}):this.checkboxradio.apply(this,arguments))}}($.fn.button),$.fn.buttonset=function(){return $.ui.controlgroup||$.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))});$.ui.button;$.extend($.ui,{datepicker:{version:"1.12.1"}});var datepicker_instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){return datepicker_extendRemove(this._defaults,settings||{}),this},_attachDatepicker:function(target,settings){var nodeName,inline,inst;nodeName=target.nodeName.toLowerCase(),inline="div"===nodeName||"span"===nodeName,target.id||(this.uuid+=1,target.id="dp"+this.uuid),inst=this._newInst($(target),inline),inst.settings=$.extend({},settings||{}),"input"===nodeName?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(target,inline){return{id:target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:inline?datepicker_bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]),inst.trigger=$([]),input.hasClass(this.markerClassName)||(this._attachments(input,inst),input.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(inst),$.data(target,"datepicker",inst),inst.settings.disabled&&this._disableDatepicker(target))},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");inst.append&&inst.append.remove(),appendText&&(inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>"),input[isRTL?"before":"after"](inst.append)),input.off("focus",this._showDatepicker),inst.trigger&&inst.trigger.remove(),showOn=this._get(inst,"showOn"),"focus"!==showOn&&"both"!==showOn||input.on("focus",this._showDatepicker),"button"!==showOn&&"both"!==showOn||(buttonText=this._get(inst,"buttonText"),buttonImage=this._get(inst,"buttonImage"),inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(buttonImage?$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText}):buttonText)),input[isRTL?"before":"after"](inst.trigger),inst.trigger.on("click",function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(input[0])):$.datepicker._showDatepicker(input[0]),!1}))},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,11,20),dateFormat=this._get(inst,"dateFormat");dateFormat.match(/[DM]/)&&(findMax=function(names){for(max=0,maxI=0,i=0;i<names.length;i++)names[i].length>max&&(max=names[i].length,maxI=i);return maxI},date.setMonth(findMax(this._get(inst,dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))),date.setDate(findMax(this._get(inst,dateFormat.match(/DD/)?"dayNames":"dayNamesShort"))+20-date.getDay())),inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);divSpan.hasClass(this.markerClassName)||(divSpan.addClass(this.markerClassName).append(inst.dpDiv),$.data(target,"datepicker",inst),this._setDate(inst,this._getDefaultDate(inst),!0),this._updateDatepicker(inst),this._updateAlternate(inst),inst.settings.disabled&&this._disableDatepicker(target),inst.dpDiv.css("display","block"))},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;return inst||(this.uuid+=1,id="dp"+this.uuid,this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),$("body").append(this._dialogInput),inst=this._dialogInst=this._newInst(this._dialogInput,!1),inst.settings={},$.data(this._dialogInput[0],"datepicker",inst)),datepicker_extendRemove(inst.settings,settings||{}),date=date&&date.constructor===Date?this._formatDate(inst,date):date,this._dialogInput.val(date),this._pos=pos?pos.length?pos:[pos.pageX,pos.pageY]:null,this._pos||(browserWidth=document.documentElement.clientWidth,browserHeight=document.documentElement.clientHeight,scrollX=document.documentElement.scrollLeft||document.body.scrollLeft,scrollY=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[browserWidth/2-100+scrollX,browserHeight/2-150+scrollY]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),inst.settings.onSelect=onSelect,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],"datepicker",inst),this},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),$.removeData(target,"datepicker"),"input"===nodeName?(inst.append.remove(),inst.trigger.remove(),$target.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==nodeName&&"span"!==nodeName||$target.removeClass(this.markerClassName).empty(),datepicker_instActive===inst&&(datepicker_instActive=null))},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),"input"===nodeName?(target.disabled=!1,inst.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==nodeName&&"span"!==nodeName||(inline=$target.children("."+this._inlineClass),inline.children().removeClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}))},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,"datepicker");$target.hasClass(this.markerClassName)&&(nodeName=target.nodeName.toLowerCase(),"input"===nodeName?(target.disabled=!0,inst.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==nodeName&&"span"!==nodeName||(inline=$target.children("."+this._inlineClass),inline.children().addClass("ui-state-disabled"),inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=$.map(this._disabledInputs,function(value){return value===target?null:value}),this._disabledInputs[this._disabledInputs.length]=target)},_isDisabledDatepicker:function(target){if(!target)return!1;for(var i=0;i<this._disabledInputs.length;i++)if(this._disabledInputs[i]===target)return!0;return!1},_getInst:function(target){try{return $.data(target,"datepicker")}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);if(2===arguments.length&&"string"==typeof name)return"defaults"===name?$.extend({},$.datepicker._defaults):inst?"all"===name?$.extend({},inst.settings):this._get(inst,name):null;settings=name||{},"string"==typeof name&&(settings={},settings[name]=value),inst&&(this._curInst===inst&&this._hideDatepicker(),date=this._getDateDatepicker(target,!0),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),datepicker_extendRemove(inst.settings,settings),null!==minDate&&void 0!==settings.dateFormat&&void 0===settings.minDate&&(inst.settings.minDate=this._formatDate(inst,minDate)),null!==maxDate&&void 0!==settings.dateFormat&&void 0===settings.maxDate&&(inst.settings.maxDate=this._formatDate(inst,maxDate)),"disabled"in settings&&(settings.disabled?this._disableDatepicker(target):this._enableDatepicker(target)),this._attachments($(target),inst),this._autoSize(inst),this._setDate(inst,date),this._updateAlternate(inst),this._updateDatepicker(inst))},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);inst&&this._updateDatepicker(inst)},_setDateDatepicker:function(target,date){var inst=this._getInst(target);inst&&(this._setDate(inst,date),this._updateDatepicker(inst),this._updateAlternate(inst))},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);return inst&&!inst.inline&&this._setDateFromField(inst,noDefault),inst?this._getDate(inst):null},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=!0,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");if(inst._keyEvent=!0,$.datepicker._datepickerShowing)switch(event.keyCode){case 9:$.datepicker._hideDatepicker(),handled=!1;break;case 13:return sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv),sel[0]&&$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0]),onSelect=$.datepicker._get(inst,"onSelect"),onSelect?(dateStr=$.datepicker._formatDate(inst),onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst])):$.datepicker._hideDatepicker(),!1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 35:(event.ctrlKey||event.metaKey)&&$.datepicker._clearDate(event.target),handled=event.ctrlKey||event.metaKey;break;case 36:(event.ctrlKey||event.metaKey)&&$.datepicker._gotoToday(event.target),handled=event.ctrlKey||event.metaKey;break;case 37:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?1:-1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths"),"M");break;case 38:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,-7,"D"),handled=event.ctrlKey||event.metaKey;break;case 39:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,isRTL?-1:1,"D"),handled=event.ctrlKey||event.metaKey,event.originalEvent.altKey&&$.datepicker._adjustDate(event.target,event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths"),"M");break;case 40:(event.ctrlKey||event.metaKey)&&$.datepicker._adjustDate(event.target,7,"D"),handled=event.ctrlKey||event.metaKey;break;default:handled=!1}else 36===event.keyCode&&event.ctrlKey?$.datepicker._showDatepicker(this):handled=!1;handled&&(event.preventDefault(),event.stopPropagation())},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput"))return chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat")),chr=String.fromCharCode(null==event.charCode?event.keyCode:event.charCode),event.ctrlKey||event.metaKey||chr<" "||!chars||chars.indexOf(chr)>-1},_doKeyUp:function(event){var date,inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal)try{date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),inst.input?inst.input.val():null,$.datepicker._getFormatConfig(inst)),date&&($.datepicker._setDateFromField(inst),$.datepicker._updateAlternate(inst),$.datepicker._updateDatepicker(inst))}catch(err){}return!0},_showDatepicker:function(input){if(input=input.target||input,"input"!==input.nodeName.toLowerCase()&&(input=$("input",input.parentNode)[0]),!$.datepicker._isDisabledDatepicker(input)&&$.datepicker._lastInput!==input){var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input),$.datepicker._curInst&&$.datepicker._curInst!==inst&&($.datepicker._curInst.dpDiv.stop(!0,!0),inst&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0])),beforeShow=$.datepicker._get(inst,"beforeShow"),beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{},!1!==beforeShowSettings&&(datepicker_extendRemove(inst.settings,beforeShowSettings),inst.lastVal=null,$.datepicker._lastInput=input,$.datepicker._setDateFromField(inst),$.datepicker._inDialog&&(input.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(input),$.datepicker._pos[1]+=input.offsetHeight),isFixed=!1,$(input).parents().each(function(){return!(isFixed|="fixed"===$(this).css("position"))}),offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]},$.datepicker._pos=null,inst.dpDiv.empty(),inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(inst),offset=$.datepicker._checkOffset(inst,offset,isFixed),inst.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":isFixed?"fixed":"absolute",display:"none",left:offset.left+"px",top:offset.top+"px"}),inst.inline||(showAnim=$.datepicker._get(inst,"showAnim"),duration=$.datepicker._get(inst,"duration"),inst.dpDiv.css("z-index",datepicker_getZindex($(input))+1),$.datepicker._datepickerShowing=!0,$.effects&&$.effects.effect[showAnim]?inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration):inst.dpDiv[showAnim||"show"](showAnim?duration:null),$.datepicker._shouldFocusInput(inst)&&inst.input.trigger("focus"),$.datepicker._curInst=inst))}},_updateDatepicker:function(inst){this.maxRows=4,datepicker_instActive=inst,inst.dpDiv.empty().append(this._generateHTML(inst)),this._attachHandlers(inst);var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1],activeCell=inst.dpDiv.find("."+this._dayOverClass+" a");activeCell.length>0&&datepicker_handleMouseover.apply(activeCell.get(0)),inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),cols>1&&inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",17*cols+"em"),inst.dpDiv[(1!==numMonths[0]||1!==numMonths[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)&&inst.input.trigger("focus"),inst.yearshtml&&(origyearshtml=inst.yearshtml,setTimeout(function(){origyearshtml===inst.yearshtml&&inst.yearshtml&&inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml),origyearshtml=inst.yearshtml=null},0))},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus")},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());return offset.left-=this._get(inst,"isRTL")?dpWidth-inputWidth:0,offset.left-=isFixed&&offset.left===inst.input.offset().left?$(document).scrollLeft():0,offset.top-=isFixed&&offset.top===inst.input.offset().top+inputHeight?$(document).scrollTop():0,offset.left-=Math.min(offset.left,offset.left+dpWidth>viewWidth&&viewWidth>dpWidth?Math.abs(offset.left+dpWidth-viewWidth):0),offset.top-=Math.min(offset.top,offset.top+dpHeight>viewHeight&&viewHeight>dpHeight?Math.abs(dpHeight+inputHeight):0),offset},_findPos:function(obj){for(var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");obj&&("hidden"===obj.type||1!==obj.nodeType||$.expr.filters.hidden(obj));)obj=obj[isRTL?"previousSibling":"nextSibling"];return position=$(obj).offset(),[position.left,position.top]},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;!inst||input&&inst!==$.data(input,"datepicker")||this._datepickerShowing&&(showAnim=this._get(inst,"showAnim"),duration=this._get(inst,"duration"),postProcess=function(){$.datepicker._tidyDialog(inst)},$.effects&&($.effects.effect[showAnim]||$.effects[showAnim])?inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess):inst.dpDiv["slideDown"===showAnim?"slideUp":"fadeIn"===showAnim?"fadeOut":"hide"](showAnim?duration:null,postProcess),showAnim||postProcess(),this._datepickerShowing=!1,onClose=this._get(inst,"onClose"),onClose&&onClose.apply(inst.input?inst.input[0]:null,[inst.input?inst.input.val():"",inst]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(event){if($.datepicker._curInst){var $target=$(event.target),inst=$.datepicker._getInst($target[0]);($target[0].id===$.datepicker._mainDivId||0!==$target.parents("#"+$.datepicker._mainDivId).length||$target.hasClass($.datepicker.markerClassName)||$target.closest("."+$.datepicker._triggerClass).length||!$.datepicker._datepickerShowing||$.datepicker._inDialog&&$.blockUI)&&(!$target.hasClass($.datepicker.markerClassName)||$.datepicker._curInst===inst)||$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);this._isDisabledDatepicker(target[0])||(this._adjustInstDate(inst,offset+("M"===period?this._get(inst,"showCurrentAtPos"):0),period),this._updateDatepicker(inst))},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);this._get(inst,"gotoCurrent")&&inst.currentDay?(inst.selectedDay=inst.currentDay,inst.drawMonth=inst.selectedMonth=inst.currentMonth,inst.drawYear=inst.selectedYear=inst.currentYear):(date=new Date,inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear()),this._notifyChange(inst),this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+("M"===period?"Month":"Year")]=inst["draw"+("M"===period?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10),this._notifyChange(inst),this._adjustDate(target)},_selectDay:function(id,month,year,td){var inst,target=$(id);$(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])||(inst=this._getInst(target[0]),inst.selectedDay=inst.currentDay=$("a",td).html(),inst.selectedMonth=inst.currentMonth=month,inst.selectedYear=inst.currentYear=year,this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear)))},_clearDate:function(id){var target=$(id);this._selectDate(target,"")},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=null!=dateStr?dateStr:this._formatDate(inst),inst.input&&inst.input.val(dateStr),this._updateAlternate(inst),onSelect=this._get(inst,"onSelect"),onSelect?onSelect.apply(inst.input?inst.input[0]:null,[dateStr,inst]):inst.input&&inst.input.trigger("change"),inst.inline?this._updateDatepicker(inst):(this._hideDatepicker(),this._lastInput=inst.input[0],"object"!=typeof inst.input[0]&&inst.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");altField&&(altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat"),date=this._getDate(inst),dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst)),$(altField).val(dateStr))},noWeekends:function(date){var day=date.getDay();return[day>0&&day<6,""]},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());return checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7)),time=checkDate.getTime(),checkDate.setMonth(0),checkDate.setDate(1),Math.floor(Math.round((time-checkDate)/864e5)/7)+1},parseDate:function(format,value,settings){if(null==format||null==value)throw"Invalid arguments";if(""===(value="object"==typeof value?value.toString():value+""))return null;var iFormat,dim,extra,date,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff="string"!=typeof shortYearCutoffTemp?shortYearCutoffTemp:(new Date).getFullYear()%100+parseInt(shortYearCutoffTemp,10),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=!1,lookAhead=function(match){
var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},getNumber=function(match){var isDoubled=lookAhead(match),size="@"===match?14:"!"===match?20:"y"===match&&isDoubled?4:"o"===match?3:2,minSize="y"===match?size:1,digits=new RegExp("^\\d{"+minSize+","+size+"}"),num=value.substring(iValue).match(digits);if(!num)throw"Missing number at position "+iValue;return iValue+=num[0].length,parseInt(num[0],10)},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if($.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase())return index=pair[0],iValue+=name.length,!1}),-1!==index)return index+1;throw"Unknown name at position "+iValue},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat))throw"Unexpected literal at position "+iValue;iValue++};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?checkLiteral():literal=!1;else switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":date=new Date(getNumber("@")),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"!":date=new Date((getNumber("!")-this._ticksTo1970)/1e4),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate();break;case"'":lookAhead("'")?checkLiteral():literal=!0;break;default:checkLiteral()}if(iValue<value.length&&(extra=value.substr(iValue),!/^\s+/.test(extra)))throw"Extra/unparsed characters found in date: "+extra;if(-1===year?year=(new Date).getFullYear():year<100&&(year+=(new Date).getFullYear()-(new Date).getFullYear()%100+(year<=shortYearCutoff?0:-100)),doy>-1)for(month=1,day=doy;;){if(dim=this._getDaysInMonth(year,month-1),day<=dim)break;month++,day-=dim}if(date=this._daylightSavingAdjust(new Date(year,month-1,day)),date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day)throw"Invalid date";return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(format,date,settings){if(!date)return"";var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match))for(;num.length<len;)num="0"+num;return num},formatName=function(match,value,shortNames,longNames){return lookAhead(match)?longNames[value]:shortNames[value]},output="",literal=!1;if(date)for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?output+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/864e5),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=lookAhead("y")?date.getFullYear():(date.getFullYear()%100<10?"0":"")+date.getFullYear()%100;break;case"@":output+=date.getTime();break;case"!":output+=1e4*date.getTime()+this._ticksTo1970;break;case"'":lookAhead("'")?output+="'":literal=!0;break;default:output+=format.charAt(iFormat)}return output},_possibleChars:function(format){var iFormat,chars="",literal=!1,lookAhead=function(match){var matches=iFormat+1<format.length&&format.charAt(iFormat+1)===match;return matches&&iFormat++,matches};for(iFormat=0;iFormat<format.length;iFormat++)if(literal)"'"!==format.charAt(iFormat)||lookAhead("'")?chars+=format.charAt(iFormat):literal=!1;else switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":lookAhead("'")?chars+="'":literal=!0;break;default:chars+=format.charAt(iFormat)}return chars},_get:function(inst,name){return void 0!==inst.settings[name]?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()!==inst.lastVal){var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){dates=noDefault?"":dates}inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),inst.currentDay=dates?date.getDate():0,inst.currentMonth=dates?date.getMonth():0,inst.currentYear=dates?date.getFullYear():0,this._adjustInstDate(inst)}},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date))},_determineDate:function(inst,date,defaultDate){var newDate=null==date||""===date?defaultDate:"string"==typeof date?function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}for(var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date,year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);matches;){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=7*parseInt(matches[1],10);break;case"m":case"M":month+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10),day=Math.min(day,$.datepicker._getDaysInMonth(year,month))}matches=pattern.exec(offset)}return new Date(year,month,day)}(date):"number"==typeof date?isNaN(date)?defaultDate:function(offset){var date=new Date;return date.setDate(date.getDate()+offset),date}(date):new Date(date.getTime());return newDate=newDate&&"Invalid Date"===newDate.toString()?defaultDate:newDate,newDate&&(newDate.setHours(0),newDate.setMinutes(0),newDate.setSeconds(0),newDate.setMilliseconds(0)),this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){return date?(date.setHours(date.getHours()>12?date.getHours()+2:0),date):null},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date));inst.selectedDay=inst.currentDay=newDate.getDate(),inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth(),inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear(),origMonth===inst.selectedMonth&&origYear===inst.selectedYear||noChange||this._notifyChange(inst),this._adjustInstDate(inst),inst.input&&inst.input.val(clear?"":this._formatDate(inst))},_getDate:function(inst){return!inst.currentYear||inst.input&&""===inst.input.val()?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay))},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M")},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(id)},selectDay:function(){return $.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return $.datepicker._selectMonthYear(id,this,"M"),!1},selectYear:function(){return $.datepicker._selectMonthYear(id,this,"Y"),!1}};$(this).on(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date,today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=1!==numMonths[0]||1!==numMonths[1],currentDate=this._daylightSavingAdjust(inst.currentDay?new Date(inst.currentYear,inst.currentMonth,inst.currentDay):new Date(9999,9,9)),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(drawMonth<0&&(drawMonth+=12,drawYear--),maxDate)for(maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-numMonths[0]*numMonths[1]+1,maxDate.getDate())),maxDraw=minDate&&maxDraw<minDate?minDate:maxDraw;this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw;)--drawMonth<0&&(drawMonth=11,drawYear--);for(inst.drawMonth=drawMonth,inst.drawYear=drawYear,prevText=this._get(inst,"prevText"),prevText=navigationAsDateFormat?this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)):prevText,prev=this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>",nextText=this._get(inst,"nextText"),nextText=navigationAsDateFormat?this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)):nextText,next=this._canAdjustMonth(inst,1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>",currentText=this._get(inst,"currentText"),gotoDate=this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today,currentText=navigationAsDateFormat?this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)):currentText,controls=inst.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(inst,"closeText")+"</button>",buttonPanel=showButtonPanel?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"",firstDay=parseInt(this._get(inst,"firstDay"),10),firstDay=isNaN(firstDay)?0:firstDay,showWeek=this._get(inst,"showWeek"),dayNames=this._get(inst,"dayNames"),dayNamesMin=this._get(inst,"dayNamesMin"),monthNames=this._get(inst,"monthNames"),monthNamesShort=this._get(inst,"monthNamesShort"),beforeShowDay=this._get(inst,"beforeShowDay"),showOtherMonths=this._get(inst,"showOtherMonths"),selectOtherMonths=this._get(inst,"selectOtherMonths"),defaultDate=this._getDefaultDate(inst),html="",row=0;row<numMonths[0];row++){for(group="",this.maxRows=4,col=0;col<numMonths[1];col++){if(selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay)),cornerClass=" ui-corner-all",calender="",isMultiMonth){if(calender+="<div class='ui-datepicker-group",numMonths[1]>1)switch(col){case 0:calender+=" ui-datepicker-group-first",cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last",cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle",cornerClass=""}calender+="'>"}for(calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+(/all|left/.test(cornerClass)&&0===row?isRTL?next:prev:"")+(/all|right/.test(cornerClass)&&0===row?isRTL?prev:next:"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead><tr>",thead=showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"",dow=0;dow<7;dow++)day=(dow+firstDay)%7,thead+="<th scope='col'"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>";for(calender+=thead+"</tr></thead><tbody>",daysInMonth=this._getDaysInMonth(drawYear,drawMonth),drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth&&(inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)),leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7,curRows=Math.ceil((leadDays+daysInMonth)/7),numRows=isMultiMonth&&this.maxRows>curRows?this.maxRows:curRows,this.maxRows=numRows,printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays)),dRow=0;dRow<numRows;dRow++){for(calender+="<tr>",tbody=showWeek?"<td class='ui-datepicker-week-col'>"+this._get(inst,"calculateWeek")(printDate)+"</td>":"",dow=0;dow<7;dow++)daySettings=beforeShowDay?beforeShowDay.apply(inst.input?inst.input[0]:null,[printDate]):[!0,""],otherMonth=printDate.getMonth()!==drawMonth,unselectable=otherMonth&&!selectOtherMonths||!daySettings[0]||minDate&&printDate<minDate||maxDate&&printDate>maxDate,tbody+="<td class='"+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+(printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent||defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime()?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+(otherMonth&&!showOtherMonths||!daySettings[2]?"":" title='"+daySettings[2].replace(/'/g,"&#39;")+"'")+(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+(otherMonth&&!showOtherMonths?"&#xa0;":unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>")+"</td>",printDate.setDate(printDate.getDate()+1),printDate=this._daylightSavingAdjust(printDate);calender+=tbody+"</tr>"}drawMonth++,drawMonth>11&&(drawMonth=0,drawYear++),calender+="</tbody></table>"+(isMultiMonth?"</div>"+(numMonths[0]>0&&col===numMonths[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),group+=calender}html+=group}return html+=buttonPanel,inst._keyEvent=!1,html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth)monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>";else{for(inMinYear=minDate&&minDate.getFullYear()===drawYear,inMaxYear=maxDate&&maxDate.getFullYear()===drawYear,monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",month=0;month<12;month++)(!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())&&(monthHtml+="<option value='"+month+"'"+(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>");monthHtml+="</select>"}if(showMonthAfterYear||(html+=monthHtml+(!secondary&&changeMonth&&changeYear?"":"&#xa0;")),!inst.yearshtml)if(inst.yearshtml="",secondary||!changeYear)html+="<span class='ui-datepicker-year'>"+drawYear+"</span>";else{for(years=this._get(inst,"yearRange").split(":"),thisYear=(new Date).getFullYear(),determineYear=function(value){var year=value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10);return isNaN(year)?thisYear:year},year=determineYear(years[0]),endYear=Math.max(year,determineYear(years[1]||"")),year=minDate?Math.max(year,minDate.getFullYear()):year,endYear=maxDate?Math.min(endYear,maxDate.getFullYear()):endYear,inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";year<=endYear;year++)inst.yearshtml+="<option value='"+year+"'"+(year===drawYear?" selected='selected'":"")+">"+year+"</option>";inst.yearshtml+="</select>",html+=inst.yearshtml,inst.yearshtml=null}return html+=this._get(inst,"yearSuffix"),showMonthAfterYear&&(html+=(!secondary&&changeMonth&&changeYear?"":"&#xa0;")+monthHtml),html+="</div>"},_adjustInstDate:function(inst,offset,period){var year=inst.selectedYear+("Y"===period?offset:0),month=inst.selectedMonth+("M"===period?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+("D"===period?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate(),inst.drawMonth=inst.selectedMonth=date.getMonth(),inst.drawYear=inst.selectedYear=date.getFullYear(),"M"!==period&&"Y"!==period||this._notifyChange(inst)},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=minDate&&date<minDate?minDate:date;return maxDate&&newDate>maxDate?maxDate:newDate},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");onChange&&onChange.apply(inst.input?inst.input[0]:null,[inst.selectedYear,inst.selectedMonth+1,inst])},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return null==numMonths?[1,1]:"number"==typeof numMonths?[1,numMonths]:numMonths},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));return offset<0&&date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth())),this._isInRange(inst,date)},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");return years&&(yearSplit=years.split(":"),currentYear=(new Date).getFullYear(),minYear=parseInt(yearSplit[0],10),maxYear=parseInt(yearSplit[1],10),yearSplit[0].match(/[+\-].*/)&&(minYear+=currentYear),yearSplit[1].match(/[+\-].*/)&&(maxYear+=currentYear)),(!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear)},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");return shortYearCutoff="string"!=typeof shortYearCutoff?shortYearCutoff:(new Date).getFullYear()%100+parseInt(shortYearCutoff,10),{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){day||(inst.currentDay=inst.selectedDay,inst.currentMonth=inst.selectedMonth,inst.currentYear=inst.selectedYear);var date=day?"object"==typeof day?day:this._daylightSavingAdjust(new Date(year,month,day)):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}}),$.fn.datepicker=function(options){if(!this.length)return this;$.datepicker.initialized||($(document).on("mousedown",$.datepicker._checkExternalClick),$.datepicker.initialized=!0),0===$("#"+$.datepicker._mainDivId).length&&$("body").append($.datepicker.dpDiv);var otherArgs=Array.prototype.slice.call(arguments,1);return"string"!=typeof options||"isDisabled"!==options&&"getDate"!==options&&"widget"!==options?"option"===options&&2===arguments.length&&"string"==typeof arguments[1]?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs)):this.each(function(){"string"==typeof options?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)}):$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.12.1";var mouseHandled=($.datepicker,$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),!1);$(document).on("mouseup",function(){mouseHandled=!1});$.widget("ui.mouse",{version:"1.12.1",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.on("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).on("click."+this.widgetName,function(event){if(!0===$.data(event.target,that.widgetName+".preventClickEvent"))return $.removeData(event.target,that.widgetName+".preventClickEvent"),event.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(event){if(!mouseHandled){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(event),this._mouseDownEvent=event;var that=this,btnIsLeft=1===event.which,elIsCancel=!("string"!=typeof this.options.cancel||!event.target.nodeName)&&$(event.target).closest(this.options.cancel).length;return!(btnIsLeft&&!elIsCancel&&this._mouseCapture(event))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=!1!==this._mouseStart(event),!this._mouseStarted)?(event.preventDefault(),!0):(!0===$.data(event.target,this.widgetName+".preventClickEvent")&&$.removeData(event.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(event){return that._mouseMove(event)},this._mouseUpDelegate=function(event){return that._mouseUp(event)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),event.preventDefault(),mouseHandled=!0,!0))}},_mouseMove:function(event){if(this._mouseMoved){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button)return this._mouseUp(event);if(!event.which)if(event.originalEvent.altKey||event.originalEvent.ctrlKey||event.originalEvent.metaKey||event.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(event)}return(event.which||event.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(event),event.preventDefault()):(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,event),this._mouseStarted?this._mouseDrag(event):this._mouseUp(event)),!this._mouseStarted)},_mouseUp:function(event){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,event.target===this._mouseDownEvent.target&&$.data(event.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(event)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,mouseHandled=!1,event.preventDefault()},_mouseDistanceMet:function(event){return Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),$.ui.plugin={add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set)proto.plugins[i]=proto.plugins[i]||[],proto.plugins[i].push([option,set[i]])},call:function(instance,name,args,allowDisconnected){var i,set=instance.plugins[name];if(set&&(allowDisconnected||instance.element[0].parentNode&&11!==instance.element[0].parentNode.nodeType))for(i=0;i<set.length;i++)instance.options[set[i][0]]&&set[i][1].apply(instance.element,args)}},$.ui.safeBlur=function(element){element&&"body"!==element.nodeName.toLowerCase()&&$(element).trigger("blur")};$.widget("ui.draggable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(key,value){this._super(key,value),"handle"===key&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging"))return void(this.destroyOnClear=!0);this._removeHandleClassName(),this._mouseDestroy()},_mouseCapture:function(event){var o=this.options;return!(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(event),!!this.handle&&(this._blurActiveElement(event),this._blockFrames(!0===o.iframeFix?"iframe":o.iframeFix),!0))},_blockFrames:function(selector){this.iframeBlocks=this.document.find(selector).map(function(){var iframe=$(this);return $("<div>").css("position","absolute").appendTo(iframe.parent()).outerWidth(iframe.outerWidth()).outerHeight(iframe.outerHeight()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(event){var activeElement=$.ui.safeActiveElement(this.document[0]);$(event.target).closest(activeElement).length||$.ui.safeBlur(activeElement)},_mouseStart:function(event){var o=this.options;return this.helper=this._createHelper(event),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),$.ui.ddmanager&&($.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===$(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(event),this.originalPosition=this.position=this._generatePosition(event,!1),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this._setContainment(),!1===this._trigger("start",event)?(this._clear(),!1):(this._cacheHelperProportions(),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this._mouseDrag(event,!0),$.ui.ddmanager&&$.ui.ddmanager.dragStart(this,event),!0)},_refreshOffsets:function(event){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:event.pageX-this.offset.left,top:event.pageY-this.offset.top}},_mouseDrag:function(event,noPropagation){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(event,!0),this.positionAbs=this._convertPositionTo("absolute"),!noPropagation){var ui=this._uiHash();if(!1===this._trigger("drag",event,ui))return this._mouseUp(new $.Event("mouseup",event)),!1;this.position=ui.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),!1},_mouseStop:function(event){var that=this,dropped=!1;return $.ui.ddmanager&&!this.options.dropBehaviour&&(dropped=$.ui.ddmanager.drop(this,event)),this.dropped&&(dropped=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!dropped||"valid"===this.options.revert&&dropped||!0===this.options.revert||$.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped)?$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==that._trigger("stop",event)&&that._clear()}):!1!==this._trigger("stop",event)&&this._clear(),!1},_mouseUp:function(event){return this._unblockFrames(),$.ui.ddmanager&&$.ui.ddmanager.dragStop(this,event),this.handleElement.is(event.target)&&this.element.trigger("focus"),$.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new $.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(event){return!this.options.handle||!!$(event.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(event){
var o=this.options,helperIsFunction=$.isFunction(o.helper),helper=helperIsFunction?$(o.helper.apply(this.element[0],[event])):"clone"===o.helper?this.element.clone().removeAttr("id"):this.element;return helper.parents("body").length||helper.appendTo("parent"===o.appendTo?this.element[0].parentNode:o.appendTo),helperIsFunction&&helper[0]===this.element[0]&&this._setPositionRelative(),helper[0]===this.element[0]||/(fixed|absolute)/.test(helper.css("position"))||helper.css("position","absolute"),helper},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_isRootNode:function(element){return/(html|body)/i.test(element.tagName)||element===this.document[0]},_getParentOffset:function(){var po=this.offsetParent.offset(),document=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var p=this.element.position(),scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollTop()),left:p.left-(parseInt(this.helper.css("left"),10)||0)+(scrollIsRootNode?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var isUserScrollable,c,ce,o=this.options,document=this.document[0];return this.relativeContainer=null,o.containment?"window"===o.containment?void(this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),c=$(o.containment),void((ce=c[0])&&(isUserScrollable=/(scroll|auto)/.test(c.css("overflow")),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(isUserScrollable?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(isUserScrollable?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=c))):void(this.containment=null)},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scrollIsRootNode=this._isRootNode(this.scrollParent[0]);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top)*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)*mod}},_generatePosition:function(event,constrainPosition){var containment,co,top,left,o=this.options,scrollIsRootNode=this._isRootNode(this.scrollParent[0]),pageX=event.pageX,pageY=event.pageY;return scrollIsRootNode&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),constrainPosition&&(this.containment&&(this.relativeContainer?(co=this.relativeContainer.offset(),containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]):containment=this.containment,event.pageX-this.offset.click.left<containment[0]&&(pageX=containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<containment[1]&&(pageY=containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>containment[2]&&(pageX=containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>containment[3]&&(pageY=containment[3]+this.offset.click.top)),o.grid&&(top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY,pageY=containment?top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3]?top:top-this.offset.click.top>=containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX,pageX=containment?left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2]?left:left-this.offset.click.left>=containment[0]?left-o.grid[0]:left+o.grid[0]:left),"y"===o.axis&&(pageX=this.originalPageX),"x"===o.axis&&(pageY=this.originalPageY)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:scrollIsRootNode?0:this.offset.scroll.top),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:scrollIsRootNode?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(type,event,ui){return ui=ui||this._uiHash(),$.ui.plugin.call(this,type,[event,ui,this],!0),/^(drag|start|stop)/.test(type)&&(this.positionAbs=this._convertPositionTo("absolute"),ui.offset=this.positionAbs),$.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.sortables=[],$(draggable.options.connectToSortable).each(function(){var sortable=$(this).sortable("instance");sortable&&!sortable.options.disabled&&(draggable.sortables.push(sortable),sortable.refreshPositions(),sortable._trigger("activate",event,uiSortable))})},stop:function(event,ui,draggable){var uiSortable=$.extend({},ui,{item:draggable.element});draggable.cancelHelperRemoval=!1,$.each(draggable.sortables,function(){var sortable=this;sortable.isOver?(sortable.isOver=0,draggable.cancelHelperRemoval=!0,sortable.cancelHelperRemoval=!1,sortable._storedCSS={position:sortable.placeholder.css("position"),top:sortable.placeholder.css("top"),left:sortable.placeholder.css("left")},sortable._mouseStop(event),sortable.options.helper=sortable.options._helper):(sortable.cancelHelperRemoval=!0,sortable._trigger("deactivate",event,uiSortable))})},drag:function(event,ui,draggable){$.each(draggable.sortables,function(){var innermostIntersecting=!1,sortable=this;sortable.positionAbs=draggable.positionAbs,sortable.helperProportions=draggable.helperProportions,sortable.offset.click=draggable.offset.click,sortable._intersectsWith(sortable.containerCache)&&(innermostIntersecting=!0,$.each(draggable.sortables,function(){return this.positionAbs=draggable.positionAbs,this.helperProportions=draggable.helperProportions,this.offset.click=draggable.offset.click,this!==sortable&&this._intersectsWith(this.containerCache)&&$.contains(sortable.element[0],this.element[0])&&(innermostIntersecting=!1),innermostIntersecting})),innermostIntersecting?(sortable.isOver||(sortable.isOver=1,draggable._parent=ui.helper.parent(),sortable.currentItem=ui.helper.appendTo(sortable.element).data("ui-sortable-item",!0),sortable.options._helper=sortable.options.helper,sortable.options.helper=function(){return ui.helper[0]},event.target=sortable.currentItem[0],sortable._mouseCapture(event,!0),sortable._mouseStart(event,!0,!0),sortable.offset.click.top=draggable.offset.click.top,sortable.offset.click.left=draggable.offset.click.left,sortable.offset.parent.left-=draggable.offset.parent.left-sortable.offset.parent.left,sortable.offset.parent.top-=draggable.offset.parent.top-sortable.offset.parent.top,draggable._trigger("toSortable",event),draggable.dropped=sortable.element,$.each(draggable.sortables,function(){this.refreshPositions()}),draggable.currentItem=draggable.element,sortable.fromOutside=draggable),sortable.currentItem&&(sortable._mouseDrag(event),ui.position=sortable.position)):sortable.isOver&&(sortable.isOver=0,sortable.cancelHelperRemoval=!0,sortable.options._revert=sortable.options.revert,sortable.options.revert=!1,sortable._trigger("out",event,sortable._uiHash(sortable)),sortable._mouseStop(event,!0),sortable.options.revert=sortable.options._revert,sortable.options.helper=sortable.options._helper,sortable.placeholder&&sortable.placeholder.remove(),ui.helper.appendTo(draggable._parent),draggable._refreshOffsets(event),ui.position=draggable._generatePosition(event,!0),draggable._trigger("fromSortable",event),draggable.dropped=!1,$.each(draggable.sortables,function(){this.refreshPositions()}))})}}),$.ui.plugin.add("draggable","cursor",{start:function(event,ui,instance){var t=$("body"),o=instance.options;t.css("cursor")&&(o._cursor=t.css("cursor")),t.css("cursor",o.cursor)},stop:function(event,ui,instance){var o=instance.options;o._cursor&&$("body").css("cursor",o._cursor)}}),$.ui.plugin.add("draggable","opacity",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("opacity")&&(o._opacity=t.css("opacity")),t.css("opacity",o.opacity)},stop:function(event,ui,instance){var o=instance.options;o._opacity&&$(ui.helper).css("opacity",o._opacity)}}),$.ui.plugin.add("draggable","scroll",{start:function(event,ui,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(event,ui,i){var o=i.options,scrolled=!1,scrollParent=i.scrollParentNotHidden[0],document=i.document[0];scrollParent!==document&&"HTML"!==scrollParent.tagName?(o.axis&&"x"===o.axis||(i.overflowOffset.top+scrollParent.offsetHeight-event.pageY<o.scrollSensitivity?scrollParent.scrollTop=scrolled=scrollParent.scrollTop+o.scrollSpeed:event.pageY-i.overflowOffset.top<o.scrollSensitivity&&(scrollParent.scrollTop=scrolled=scrollParent.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(i.overflowOffset.left+scrollParent.offsetWidth-event.pageX<o.scrollSensitivity?scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft+o.scrollSpeed:event.pageX-i.overflowOffset.left<o.scrollSensitivity&&(scrollParent.scrollLeft=scrolled=scrollParent.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)))),!1!==scrolled&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(i,event)}}),$.ui.plugin.add("draggable","snap",{start:function(event,ui,i){var o=i.options;i.snapElements=[],$(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var $t=$(this),$o=$t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})})},drag:function(event,ui,inst){var ts,bs,ls,rs,l,r,t,b,i,first,o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--)l=inst.snapElements[i].left-inst.margins.left,r=l+inst.snapElements[i].width,t=inst.snapElements[i].top-inst.margins.top,b=t+inst.snapElements[i].height,x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)?(inst.snapElements[i].snapping&&inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=!1):("inner"!==o.snapMode&&(ts=Math.abs(t-y2)<=d,bs=Math.abs(b-y1)<=d,ls=Math.abs(l-x2)<=d,rs=Math.abs(r-x1)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left)),first=ts||bs||ls||rs,"outer"!==o.snapMode&&(ts=Math.abs(t-y1)<=d,bs=Math.abs(b-y2)<=d,ls=Math.abs(l-x1)<=d,rs=Math.abs(r-x2)<=d,ts&&(ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top),bs&&(ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top),ls&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left),rs&&(ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left)),!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)&&inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})),inst.snapElements[i].snapping=ts||bs||ls||rs||first)}}),$.ui.plugin.add("draggable","stack",{start:function(event,ui,instance){var min,o=instance.options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});group.length&&(min=parseInt($(group[0]).css("zIndex"),10)||0,$(group).each(function(i){$(this).css("zIndex",min+i)}),this.css("zIndex",min+group.length))}}),$.ui.plugin.add("draggable","zIndex",{start:function(event,ui,instance){var t=$(ui.helper),o=instance.options;t.css("zIndex")&&(o._zIndex=t.css("zIndex")),t.css("zIndex",o.zIndex)},stop:function(event,ui,instance){var o=instance.options;o._zIndex&&$(ui.helper).css("zIndex",o._zIndex)}});$.ui.draggable;$.widget("ui.resizable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(value){return parseFloat(value)||0},_isNumber:function(value){return!isNaN(parseFloat(value))},_hasScroll:function(el,a){if("hidden"===$(el).css("overflow"))return!1;var scroll=a&&"left"===a?"scrollLeft":"scrollTop",has=!1;return el[scroll]>0||(el[scroll]=1,has=el[scroll]>0,el[scroll]=0,has)},_create:function(){var margins,o=this.options,that=this;this._addClass("ui-resizable"),$.extend(this,{_aspectRatio:!!o.aspectRatio,aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,margins={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(margins),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(margins),this._proportionallyResize()),this._setupHandles(),o.autoHide&&$(this.element).on("mouseenter",function(){o.disabled||(that._removeClass("ui-resizable-autohide"),that._handles.show())}).on("mouseleave",function(){o.disabled||that.resizing||(that._addClass("ui-resizable-autohide"),that._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeData("resizable").removeData("ui-resizable").off(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(_destroy(this.element),wrapper=this.element,this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper),wrapper.remove()),this.originalElement.css("resize",this.originalResizeStyle),_destroy(this.originalElement),this},_setOption:function(key,value){switch(this._super(key,value),key){case"handles":this._removeHandles(),this._setupHandles()}},_setupHandles:function(){var handle,i,n,hname,axis,o=this.options,that=this;if(this.handles=o.handles||($(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=$(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),n=this.handles.split(","),this.handles={},i=0;i<n.length;i++)handle=$.trim(n[i]),hname="ui-resizable-"+handle,axis=$("<div>"),this._addClass(axis,"ui-resizable-handle "+hname),axis.css({zIndex:o.zIndex}),this.handles[handle]=".ui-resizable-"+handle,this.element.append(axis);this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles)this.handles[i].constructor===String?this.handles[i]=this.element.children(this.handles[i]).first().show():(this.handles[i].jquery||this.handles[i].nodeType)&&(this.handles[i]=$(this.handles[i]),this._on(this.handles[i],{mousedown:that._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(axis=$(this.handles[i],this.element),padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth(),padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),target.css(padPos,padWrapper),this._proportionallyResize()),this._handles=this._handles.add(this.handles[i])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){that.resizing||(this.className&&(axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),that.axis=axis&&axis[1]?axis[1]:"se")}),o.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._handles.remove()},_mouseCapture:function(event){var i,handle,capture=!1;for(i in this.handles)((handle=$(this.handles[i])[0])===event.target||$.contains(handle,event.target))&&(capture=!0);return!this.options.disabled&&capture},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,el=this.element;return this.resizing=!0,this._renderProxy(),curleft=this._num(this.helper.css("left")),curtop=this._num(this.helper.css("top")),o.containment&&(curleft+=$(o.containment).scrollLeft()||0,curtop+=$(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:curleft,top:curtop},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:el.width(),height:el.height()},this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()},this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()},this.originalPosition={left:curleft,top:curtop},this.originalMousePosition={left:event.pageX,top:event.pageY},this.aspectRatio="number"==typeof o.aspectRatio?o.aspectRatio:this.originalSize.width/this.originalSize.height||1,cursor=$(".ui-resizable-"+this.axis).css("cursor"),$("body").css("cursor","auto"===cursor?this.axis+"-resize":cursor),this._addClass("ui-resizable-resizing"),this._propagate("start",event),!0},_mouseDrag:function(event){var data,props,smp=this.originalMousePosition,a=this.axis,dx=event.pageX-smp.left||0,dy=event.pageY-smp.top||0,trigger=this._change[a];return this._updatePrevProperties(),!!trigger&&(data=trigger.apply(this,[event,dx,dy]),this._updateVirtualBoundaries(event.shiftKey),(this._aspectRatio||event.shiftKey)&&(data=this._updateRatio(data,event)),data=this._respectSize(data,event),this._updateCache(data),this._propagate("resize",event),props=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),$.isEmptyObject(props)||(this._updatePrevProperties(),this._trigger("resize",event,this.ui()),this._applyChanges()),!1)},_mouseStop:function(event){this.resizing=!1;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;return this._helper&&(pr=this._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&this._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,s={width:that.helper.width()-soffsetw,height:that.helper.height()-soffseth},left=parseFloat(that.element.css("left"))+(that.position.left-that.originalPosition.left)||null,top=parseFloat(that.element.css("top"))+(that.position.top-that.originalPosition.top)||null,o.animate||this.element.css($.extend(s,{top:top,left:left})),that.helper.height(that.size.height),that.helper.width(that.size.width),this._helper&&!o.animate&&this._proportionallyResize()),$("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",event),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var props={};return this.position.top!==this.prevPosition.top&&(props.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(props.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(props.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(props.height=this.size.height+"px"),this.helper.css(props),props},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:this._isNumber(o.minWidth)?o.minWidth:0,maxWidth:this._isNumber(o.maxWidth)?o.maxWidth:1/0,minHeight:this._isNumber(o.minHeight)?o.minHeight:0,maxHeight:this._isNumber(o.maxHeight)?o.maxHeight:1/0},(this._aspectRatio||forceAspectRatio)&&(pMinWidth=b.minHeight*this.aspectRatio,pMinHeight=b.minWidth/this.aspectRatio,pMaxWidth=b.maxHeight*this.aspectRatio,pMaxHeight=b.maxWidth/this.aspectRatio,pMinWidth>b.minWidth&&(b.minWidth=pMinWidth),pMinHeight>b.minHeight&&(b.minHeight=pMinHeight),pMaxWidth<b.maxWidth&&(b.maxWidth=pMaxWidth),pMaxHeight<b.maxHeight&&(b.maxHeight=pMaxHeight)),this._vBoundaries=b},_updateCache:function(data){this.offset=this.helper.offset(),this._isNumber(data.left)&&(this.position.left=data.left),this._isNumber(data.top)&&(this.position.top=data.top),this._isNumber(data.height)&&(this.size.height=data.height),this._isNumber(data.width)&&(this.size.width=data.width)},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;return this._isNumber(data.height)?data.width=data.height*this.aspectRatio:this._isNumber(data.width)&&(data.height=data.width/this.aspectRatio),"sw"===a&&(data.left=cpos.left+(csize.width-data.width),data.top=null),"nw"===a&&(data.top=cpos.top+(csize.height-data.height),data.left=cpos.left+(csize.width-data.width)),data},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=this._isNumber(data.width)&&o.maxWidth&&o.maxWidth<data.width,ismaxh=this._isNumber(data.height)&&o.maxHeight&&o.maxHeight<data.height,isminw=this._isNumber(data.width)&&o.minWidth&&o.minWidth>data.width,isminh=this._isNumber(data.height)&&o.minHeight&&o.minHeight>data.height,dw=this.originalPosition.left+this.originalSize.width,dh=this.originalPosition.top+this.originalSize.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);return isminw&&(data.width=o.minWidth),isminh&&(data.height=o.minHeight),ismaxw&&(data.width=o.maxWidth),ismaxh&&(data.height=o.maxHeight),isminw&&cw&&(data.left=dw-o.minWidth),ismaxw&&cw&&(data.left=dw-o.maxWidth),isminh&&ch&&(data.top=dh-o.minHeight),ismaxh&&ch&&(data.top=dh-o.maxHeight),data.width||data.height||data.left||!data.top?data.width||data.height||data.top||!data.left||(data.left=null):data.top=null,data},_getPaddingPlusBorderDimensions:function(element){for(var i=0,widths=[],borders=[element.css("borderTopWidth"),element.css("borderRightWidth"),element.css("borderBottomWidth"),element.css("borderLeftWidth")],paddings=[element.css("paddingTop"),element.css("paddingRight"),element.css("paddingBottom"),element.css("paddingLeft")];i<4;i++)widths[i]=parseFloat(borders[i])||0,widths[i]+=parseFloat(paddings[i])||0;return{height:widths[0]+widths[2],width:widths[1]+widths[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var prel,i=0,element=this.helper||this.element;i<this._proportionallyResizeElements.length;i++)prel=this._proportionallyResizeElements[i],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(prel)),prel.css({height:element.height()-this.outerDimensions.height||0,width:element.width()-this.outerDimensions.width||0})},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset(),this._helper?(this.helper=this.helper||$("<div style='overflow:hidden;'></div>"),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(event,dx){return{width:this.originalSize.width+dx}},w:function(event,dx){var cs=this.originalSize;return{left:this.originalPosition.left+dx,width:cs.width-dx}},n:function(event,dx,dy){var cs=this.originalSize;return{top:this.originalPosition.top+dy,height:cs.height-dy}},s:function(event,dx,dy){return{height:this.originalSize.height+dy}},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]),"resize"!==n&&this._trigger(n,event,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).resizable("instance"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&/textarea/i.test(pr[0].nodeName),soffseth=ista&&that._hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:that.size.width-soffsetw,height:that.size.height-soffseth},left=parseFloat(that.element.css("left"))+(that.position.left-that.originalPosition.left)||null,top=parseFloat(that.element.css("top"))+(that.position.top-that.originalPosition.top)||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseFloat(that.element.css("width")),height:parseFloat(that.element.css("height")),top:parseFloat(that.element.css("top")),left:parseFloat(that.element.css("left"))};pr&&pr.length&&$(pr[0]).css({width:data.width,height:data.height}),that._updateCache(data),that._propagate("resize",event)}})}}),$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).resizable("instance"),o=that.options,el=that.element,oc=o.containment,ce=oc instanceof $?oc.get(0):/parent/.test(oc)?el.parent().get(0):oc;ce&&(that.containerElement=$(ce),/document/.test(oc)||oc===document?(that.containerOffset={left:0,top:0},that.containerPosition={left:0,top:0},that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}):(element=$(ce),p=[],$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=that._num(element.css("padding"+name))}),that.containerOffset=element.offset(),that.containerPosition=element.position(),that.containerSize={height:element.innerHeight()-p[3],width:element.innerWidth()-p[1]},co=that.containerOffset,ch=that.containerSize.height,cw=that.containerSize.width,width=that._hasScroll(ce,"left")?ce.scrollWidth:cw,height=that._hasScroll(ce)?ce.scrollHeight:ch,that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height}))},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement,continueResize=!0;ce[0]!==document&&/static/.test(ce.css("position"))&&(cop=co),cp.left<(that._helper?co.left:0)&&(that.size.width=that.size.width+(that._helper?that.position.left-co.left:that.position.left-cop.left),pRatio&&(that.size.height=that.size.width/that.aspectRatio,continueResize=!1),that.position.left=o.helper?co.left:0),
cp.top<(that._helper?co.top:0)&&(that.size.height=that.size.height+(that._helper?that.position.top-co.top:that.position.top),pRatio&&(that.size.width=that.size.height*that.aspectRatio,continueResize=!1),that.position.top=that._helper?co.top:0),isParent=that.containerElement.get(0)===that.element.parent().get(0),isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position")),isParent&&isOffsetRelative?(that.offset.left=that.parentData.left+that.position.left,that.offset.top=that.parentData.top+that.position.top):(that.offset.left=that.element.offset().left,that.offset.top=that.element.offset().top),woset=Math.abs(that.sizeDiff.width+(that._helper?that.offset.left-cop.left:that.offset.left-co.left)),hoset=Math.abs(that.sizeDiff.height+(that._helper?that.offset.top-cop.top:that.offset.top-co.top)),woset+that.size.width>=that.parentData.width&&(that.size.width=that.parentData.width-woset,pRatio&&(that.size.height=that.size.width/that.aspectRatio,continueResize=!1)),hoset+that.size.height>=that.parentData.height&&(that.size.height=that.parentData.height-hoset,pRatio&&(that.size.width=that.size.height*that.aspectRatio,continueResize=!1)),continueResize||(that.position.left=that.prevPosition.left,that.position.top=that.prevPosition.top,that.size.width=that.prevSize.width,that.size.height=that.prevSize.height)},stop:function(){var that=$(this).resizable("instance"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;that._helper&&!o.animate&&/relative/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h}),that._helper&&!o.animate&&/static/.test(ce.css("position"))&&$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}}),$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).resizable("instance"),o=that.options;$(o.alsoResize).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseFloat(el.width()),height:parseFloat(el.height()),left:parseFloat(el.css("left")),top:parseFloat(el.css("top"))})})},resize:function(event,ui){var that=$(this).resizable("instance"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:that.size.height-os.height||0,width:that.size.width-os.width||0,top:that.position.top-op.top||0,left:that.position.left-op.left||0};$(o.alsoResize).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);sum&&sum>=0&&(style[prop]=sum||null)}),el.css(style)})},stop:function(){$(this).removeData("ui-resizable-alsoresize")}}),$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).resizable("instance"),cs=that.size;that.ghost=that.originalElement.clone(),that.ghost.css({opacity:.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}),that._addClass(that.ghost,"ui-resizable-ghost"),!1!==$.uiBackCompat&&"string"==typeof that.options.ghost&&that.ghost.addClass(this.options.ghost),that.ghost.appendTo(that.helper)},resize:function(){var that=$(this).resizable("instance");that.ghost&&that.ghost.css({position:"relative",height:that.size.height,width:that.size.width})},stop:function(){var that=$(this).resizable("instance");that.ghost&&that.helper&&that.helper.get(0).removeChild(that.ghost.get(0))}}),$.ui.plugin.add("resizable","grid",{resize:function(){var outerDimensions,that=$(this).resizable("instance"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid="number"==typeof o.grid?[o.grid,o.grid]:o.grid,gridX=grid[0]||1,gridY=grid[1]||1,ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&o.maxWidth<newWidth,isMaxHeight=o.maxHeight&&o.maxHeight<newHeight,isMinWidth=o.minWidth&&o.minWidth>newWidth,isMinHeight=o.minHeight&&o.minHeight>newHeight;o.grid=grid,isMinWidth&&(newWidth+=gridX),isMinHeight&&(newHeight+=gridY),isMaxWidth&&(newWidth-=gridX),isMaxHeight&&(newHeight-=gridY),/^(se|s|e)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight):/^(ne)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.top=op.top-oy):/^(sw)$/.test(a)?(that.size.width=newWidth,that.size.height=newHeight,that.position.left=op.left-ox):((newHeight-gridY<=0||newWidth-gridX<=0)&&(outerDimensions=that._getPaddingPlusBorderDimensions(this)),newHeight-gridY>0?(that.size.height=newHeight,that.position.top=op.top-oy):(newHeight=gridY-outerDimensions.height,that.size.height=newHeight,that.position.top=op.top+os.height-newHeight),newWidth-gridX>0?(that.size.width=newWidth,that.position.left=op.left-ox):(newWidth=gridX-outerDimensions.width,that.size.width=newWidth,that.position.left=op.left+os.width-newWidth))}});$.ui.resizable;$.widget("ui.dialog",{version:"1.12.1",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;topOffset<0&&$(this).css("top",pos.top-topOffset)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&$.fn.draggable&&this._makeDraggable(),this.options.resizable&&$.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var element=this.options.appendTo;return element&&(element.jquery||element.nodeType)?$(element):this.document.find(element||"body").eq(0)},_destroy:function(){var next,originalPosition=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),next=originalPosition.parent.children().eq(originalPosition.index),next.length&&next[0]!==this.element[0]?next.before(this.element):originalPosition.parent.append(this.element)},widget:function(){return this.uiDialog},disable:$.noop,enable:$.noop,close:function(event){var that=this;this._isOpen&&!1!==this._trigger("beforeClose",event)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||$.ui.safeBlur($.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){that._trigger("close",event)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(event,silent){var moved=!1,zIndices=this.uiDialog.siblings(".ui-front:visible").map(function(){return+$(this).css("z-index")}).get(),zIndexMax=Math.max.apply(null,zIndices);return zIndexMax>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",zIndexMax+1),moved=!0),moved&&!silent&&this._trigger("focus",event),moved},open:function(){var that=this;if(this._isOpen)return void(this._moveToTop()&&this._focusTabbable());this._isOpen=!0,this.opener=$($.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){that._focusTabbable(),that._trigger("focus")}),this._makeFocusTarget(),this._trigger("open")},_focusTabbable:function(){var hasFocus=this._focusedElement;hasFocus||(hasFocus=this.element.find("[autofocus]")),hasFocus.length||(hasFocus=this.element.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogButtonPane.find(":tabbable")),hasFocus.length||(hasFocus=this.uiDialogTitlebarClose.filter(":tabbable")),hasFocus.length||(hasFocus=this.uiDialog),hasFocus.eq(0).trigger("focus")},_keepFocus:function(event){function checkFocus(){var activeElement=$.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===activeElement||$.contains(this.uiDialog[0],activeElement)||this._focusTabbable()}event.preventDefault(),checkFocus.call(this),this._delay(checkFocus)},_createWrapper:function(){this.uiDialog=$("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(event){if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE)return event.preventDefault(),void this.close(event);if(event.keyCode===$.ui.keyCode.TAB&&!event.isDefaultPrevented()){var tabbables=this.uiDialog.find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");event.target!==last[0]&&event.target!==this.uiDialog[0]||event.shiftKey?event.target!==first[0]&&event.target!==this.uiDialog[0]||!event.shiftKey||(this._delay(function(){last.trigger("focus")}),event.preventDefault()):(this._delay(function(){first.trigger("focus")}),event.preventDefault())}},mousedown:function(event){this._moveToTop(event)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var uiDialogTitle;this.uiDialogTitlebar=$("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(event){$(event.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=$("<button type='button'></button>").button({label:$("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(event){event.preventDefault(),this.close(event)}}),uiDialogTitle=$("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(uiDialogTitle,"ui-dialog-title"),this._title(uiDialogTitle),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":uiDialogTitle.attr("id")})},_title:function(title){this.options.title?title.text(this.options.title):title.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=$("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var that=this,buttons=this.options.buttons;if(this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),$.isEmptyObject(buttons)||$.isArray(buttons)&&!buttons.length)return void this._removeClass(this.uiDialog,"ui-dialog-buttons");$.each(buttons,function(name,props){var click,buttonOptions;props=$.isFunction(props)?{click:props,text:name}:props,props=$.extend({type:"button"},props),click=props.click,buttonOptions={icon:props.icon,iconPosition:props.iconPosition,showLabel:props.showLabel,icons:props.icons,text:props.text},delete props.click,delete props.icon,delete props.iconPosition,delete props.showLabel,delete props.icons,"boolean"==typeof props.text&&delete props.text,$("<button></button>",props).button(buttonOptions).appendTo(that.uiButtonSet).on("click",function(){click.apply(that.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){function filteredUi(ui){return{position:ui.position,offset:ui.offset}}var that=this,options=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){that._addClass($(this),"ui-dialog-dragging"),that._blockFrames(),that._trigger("dragStart",event,filteredUi(ui))},drag:function(event,ui){that._trigger("drag",event,filteredUi(ui))},stop:function(event,ui){var left=ui.offset.left-that.document.scrollLeft(),top=ui.offset.top-that.document.scrollTop();options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" top"+(top>=0?"+":"")+top,of:that.window},that._removeClass($(this),"ui-dialog-dragging"),that._unblockFrames(),that._trigger("dragStop",event,filteredUi(ui))}})},_makeResizable:function(){function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size}}var that=this,options=this.options,handles=options.resizable,position=this.uiDialog.css("position"),resizeHandles="string"==typeof handles?handles:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:this._minHeight(),handles:resizeHandles,start:function(event,ui){that._addClass($(this),"ui-dialog-resizing"),that._blockFrames(),that._trigger("resizeStart",event,filteredUi(ui))},resize:function(event,ui){that._trigger("resize",event,filteredUi(ui))},stop:function(event,ui){var offset=that.uiDialog.offset(),left=offset.left-that.document.scrollLeft(),top=offset.top-that.document.scrollTop();options.height=that.uiDialog.height(),options.width=that.uiDialog.width(),options.position={my:"left top",at:"left"+(left>=0?"+":"")+left+" top"+(top>=0?"+":"")+top,of:that.window},that._removeClass($(this),"ui-dialog-resizing"),that._unblockFrames(),that._trigger("resizeStop",event,filteredUi(ui))}}).css("position",position)},_trackFocus:function(){this._on(this.widget(),{focusin:function(event){this._makeFocusTarget(),this._focusedElement=$(event.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var instances=this._trackingInstances(),exists=$.inArray(this,instances);-1!==exists&&instances.splice(exists,1)},_trackingInstances:function(){var instances=this.document.data("ui-dialog-instances");return instances||(instances=[],this.document.data("ui-dialog-instances",instances)),instances},_minHeight:function(){var options=this.options;return"auto"===options.height?options.minHeight:Math.min(options.minHeight,options.height)},_position:function(){var isVisible=this.uiDialog.is(":visible");isVisible||this.uiDialog.show(),this.uiDialog.position(this.options.position),isVisible||this.uiDialog.hide()},_setOptions:function(options){var that=this,resize=!1,resizableOptions={};$.each(options,function(key,value){that._setOption(key,value),key in that.sizeRelatedOptions&&(resize=!0),key in that.resizableRelatedOptions&&(resizableOptions[key]=value)}),resize&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",resizableOptions)},_setOption:function(key,value){var isDraggable,isResizable,uiDialog=this.uiDialog;"disabled"!==key&&(this._super(key,value),"appendTo"===key&&this.uiDialog.appendTo(this._appendTo()),"buttons"===key&&this._createButtons(),"closeText"===key&&this.uiDialogTitlebarClose.button({label:$("<a>").text(""+this.options.closeText).html()}),"draggable"===key&&(isDraggable=uiDialog.is(":data(ui-draggable)"),isDraggable&&!value&&uiDialog.draggable("destroy"),!isDraggable&&value&&this._makeDraggable()),"position"===key&&this._position(),"resizable"===key&&(isResizable=uiDialog.is(":data(ui-resizable)"),isResizable&&!value&&uiDialog.resizable("destroy"),isResizable&&"string"==typeof value&&uiDialog.resizable("option","handles",value),isResizable||!1===value||this._makeResizable()),"title"===key&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var nonContentHeight,minContentHeight,maxContentHeight,options=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),options.minWidth>options.width&&(options.width=options.minWidth),nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).outerHeight(),minContentHeight=Math.max(0,options.minHeight-nonContentHeight),maxContentHeight="number"==typeof options.maxHeight?Math.max(0,options.maxHeight-nonContentHeight):"none","auto"===options.height?this.element.css({minHeight:minContentHeight,maxHeight:maxContentHeight,height:"auto"}):this.element.height(Math.max(0,options.height-nonContentHeight)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var iframe=$(this);return $("<div>").css({position:"absolute",width:iframe.outerWidth(),height:iframe.outerHeight()}).appendTo(iframe.parent()).offset(iframe.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(event){return!!$(event.target).closest(".ui-dialog").length||!!$(event.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var isOpening=!0;this._delay(function(){isOpening=!1}),this.document.data("ui-dialog-overlays")||this._on(this.document,{focusin:function(event){isOpening||this._allowInteraction(event)||(event.preventDefault(),this._trackingInstances()[0]._focusTabbable())}}),this.overlay=$("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var overlays=this.document.data("ui-dialog-overlays")-1;overlays?this.document.data("ui-dialog-overlays",overlays):(this._off(this.document,"focusin"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),!1!==$.uiBackCompat&&$.widget("ui.dialog",$.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(key,value){"dialogClass"===key&&this.uiDialog.removeClass(this.options.dialogClass).addClass(value),this._superApply(arguments)}});$.ui.dialog;$.widget("ui.droppable",{version:"1.12.1",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var proportions,o=this.options,accept=o.accept;this.isover=!1,this.isout=!0,this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept)},this.proportions=function(){if(!arguments.length)return proportions||(proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});proportions=arguments[0]},this._addToManager(o.scope),o.addClasses&&this._addClass("ui-droppable")},_addToManager:function(scope){$.ui.ddmanager.droppables[scope]=$.ui.ddmanager.droppables[scope]||[],$.ui.ddmanager.droppables[scope].push(this)},_splice:function(drop){for(var i=0;i<drop.length;i++)drop[i]===this&&drop.splice(i,1)},_destroy:function(){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop)},_setOption:function(key,value){if("accept"===key)this.accept=$.isFunction(value)?value:function(d){return d.is(value)};else if("scope"===key){var drop=$.ui.ddmanager.droppables[this.options.scope];this._splice(drop),this._addToManager(value)}this._super(key,value)},_activate:function(event){var draggable=$.ui.ddmanager.current;this._addActiveClass(),draggable&&this._trigger("activate",event,this.ui(draggable))},_deactivate:function(event){var draggable=$.ui.ddmanager.current;this._removeActiveClass(),draggable&&this._trigger("deactivate",event,this.ui(draggable))},_over:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this._addHoverClass(),this._trigger("over",event,this.ui(draggable)))},_out:function(event){var draggable=$.ui.ddmanager.current;draggable&&(draggable.currentItem||draggable.element)[0]!==this.element[0]&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this._removeHoverClass(),this._trigger("out",event,this.ui(draggable)))},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=!1;return!(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$(this).droppable("instance");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],draggable.currentItem||draggable.element)&&intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance,event))return childrenIntersection=!0,!1}),!childrenIntersection&&(!!this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",event,this.ui(draggable)),this.element)))},ui:function(c){return{draggable:c.currentItem||c.element,helper:c.helper,position:c.position,offset:c.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}});var intersect=$.ui.intersect=function(){function isOverAxis(x,reference,size){return x>=reference&&x<reference+size}return function(draggable,droppable,toleranceMode,event){if(!droppable.offset)return!1;var x1=(draggable.positionAbs||draggable.position.absolute).left+draggable.margins.left,y1=(draggable.positionAbs||draggable.position.absolute).top+draggable.margins.top,x2=x1+draggable.helperProportions.width,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,t=droppable.offset.top,r=l+droppable.proportions().width,b=t+droppable.proportions().height;switch(toleranceMode){case"fit":return l<=x1&&x2<=r&&t<=y1&&y2<=b;case"intersect":return l<x1+draggable.helperProportions.width/2&&x2-draggable.helperProportions.width/2<r&&t<y1+draggable.helperProportions.height/2&&y2-draggable.helperProportions.height/2<b;case"pointer":return isOverAxis(event.pageY,t,droppable.proportions().height)&&isOverAxis(event.pageX,l,droppable.proportions().width);case"touch":return(y1>=t&&y1<=b||y2>=t&&y2<=b||y1<t&&y2>b)&&(x1>=l&&x1<=r||x2>=l&&x2<=r||x1<l&&x2>r);default:return!1}}}();$.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++)if(!(m[i].options.disabled||t&&!m[i].accept.call(m[i].element[0],t.currentItem||t.element))){for(j=0;j<list.length;j++)if(list[j]===m[i].element[0]){m[i].proportions().height=0;continue droppablesLoop}m[i].visible="none"!==m[i].element.css("display"),m[i].visible&&("mousedown"===type&&m[i]._activate.call(m[i],event),m[i].offset=m[i].element.offset(),m[i].proportions({width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight}))}},drop:function(draggable,event){var dropped=!1;return $.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&intersect(draggable,this,this.options.tolerance,event)&&(dropped=this._drop.call(this,event)||dropped),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],draggable.currentItem||draggable.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,event)))}),dropped},dragStart:function(draggable,event){draggable.element.parentsUntil("body").on("scroll.droppable",function(){draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)})},drag:function(draggable,event){draggable.options.refreshPositions&&$.ui.ddmanager.prepareOffsets(draggable,event),$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var parentInstance,scope,parent,intersects=intersect(draggable,this,this.options.tolerance,event),c=!intersects&&this.isover?"isout":intersects&&!this.isover?"isover":null;c&&(this.options.greedy&&(scope=this.options.scope,parent=this.element.parents(":data(ui-droppable)").filter(function(){return $(this).droppable("instance").options.scope===scope}),parent.length&&(parentInstance=$(parent[0]).droppable("instance"),parentInstance.greedyChild="isover"===c)),parentInstance&&"isover"===c&&(parentInstance.isover=!1,parentInstance.isout=!0,parentInstance._out.call(parentInstance,event)),this[c]=!0,this["isout"===c?"isover":"isout"]=!1,this["isover"===c?"_over":"_out"].call(this,event),parentInstance&&"isout"===c&&(parentInstance.isout=!1,parentInstance.isover=!0,parentInstance._over.call(parentInstance,event)))}})},dragStop:function(draggable,event){draggable.element.parentsUntil("body").off("scroll.droppable"),draggable.options.refreshPositions||$.ui.ddmanager.prepareOffsets(draggable,event)}},!1!==$.uiBackCompat&&$.widget("ui.droppable",$.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}});$.ui.droppable,$.widget("ui.progressbar",{version:"1.12.1",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=$("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(newValue){if(void 0===newValue)return this.options.value;this.options.value=this._constrainedValue(newValue),this._refreshValue()},_constrainedValue:function(newValue){return void 0===newValue&&(newValue=this.options.value),this.indeterminate=!1===newValue,"number"!=typeof newValue&&(newValue=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,newValue))},_setOptions:function(options){var value=options.value;delete options.value,this._super(options),this.options.value=this._constrainedValue(value),this._refreshValue()},_setOption:function(key,value){"max"===key&&(value=Math.max(this.min,value)),this._super(key,value)},_setOptionDisabled:function(value){this._super(value),this.element.attr("aria-disabled",value),this._toggleClass(null,"ui-state-disabled",!!value)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var value=this.options.value,percentage=this._percentage();this.valueDiv.toggle(this.indeterminate||value>this.min).width(percentage.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,value===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=$("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":value}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==value&&(this.oldValue=value,this._trigger("change")),value===this.options.max&&this._trigger("complete")}}),$.widget("ui.selectable",$.ui.mouse,{version:"1.12.1",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var that=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){that.elementPos=$(that.element[0]).offset(),that.selectees=$(that.options.filter,that.element[0]),that._addClass(that.selectees,"ui-selectee"),that.selectees.each(function(){var $this=$(this),selecteeOffset=$this.offset(),pos={left:selecteeOffset.left-that.elementPos.left,top:selecteeOffset.top-that.elementPos.top};$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:!1,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=$("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(event){var that=this,options=this.options;this.opos=[event.pageX,event.pageY],this.elementPos=$(this.element[0]).offset(),this.options.disabled||(this.selectees=$(options.filter,this.element[0]),this._trigger("start",event),$(options.appendTo).append(this.helper),this.helper.css({left:event.pageX,top:event.pageY,width:0,height:0}),options.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=!0,event.metaKey||event.ctrlKey||(that._removeClass(selectee.$element,"ui-selected"),selectee.selected=!1,that._addClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element}))}),$(event.target).parents().addBack().each(function(){var doSelect,selectee=$.data(this,"selectable-item");if(selectee)return doSelect=!event.metaKey&&!event.ctrlKey||!selectee.$element.hasClass("ui-selected"),that._removeClass(selectee.$element,doSelect?"ui-unselecting":"ui-selected")._addClass(selectee.$element,doSelect?"ui-selecting":"ui-unselecting"),selectee.unselecting=!doSelect,selectee.selecting=doSelect,selectee.selected=doSelect,doSelect?that._trigger("selecting",event,{selecting:selectee.element}):that._trigger("unselecting",event,{
unselecting:selectee.element}),!1}))},_mouseDrag:function(event){if(this.dragged=!0,!this.options.disabled){var tmp,that=this,options=this.options,x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;return x1>x2&&(tmp=x2,x2=x1,x1=tmp),y1>y2&&(tmp=y2,y2=y1,y1=tmp),this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1}),this.selectees.each(function(){var selectee=$.data(this,"selectable-item"),hit=!1,offset={};selectee&&selectee.element!==that.element[0]&&(offset.left=selectee.left+that.elementPos.left,offset.right=selectee.right+that.elementPos.left,offset.top=selectee.top+that.elementPos.top,offset.bottom=selectee.bottom+that.elementPos.top,"touch"===options.tolerance?hit=!(offset.left>x2||offset.right<x1||offset.top>y2||offset.bottom<y1):"fit"===options.tolerance&&(hit=offset.left>x1&&offset.right<x2&&offset.top>y1&&offset.bottom<y2),hit?(selectee.selected&&(that._removeClass(selectee.$element,"ui-selected"),selectee.selected=!1),selectee.unselecting&&(that._removeClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!1),selectee.selecting||(that._addClass(selectee.$element,"ui-selecting"),selectee.selecting=!0,that._trigger("selecting",event,{selecting:selectee.element}))):(selectee.selecting&&((event.metaKey||event.ctrlKey)&&selectee.startselected?(that._removeClass(selectee.$element,"ui-selecting"),selectee.selecting=!1,that._addClass(selectee.$element,"ui-selected"),selectee.selected=!0):(that._removeClass(selectee.$element,"ui-selecting"),selectee.selecting=!1,selectee.startselected&&(that._addClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!0),that._trigger("unselecting",event,{unselecting:selectee.element}))),selectee.selected&&(event.metaKey||event.ctrlKey||selectee.startselected||(that._removeClass(selectee.$element,"ui-selected"),selectee.selected=!1,that._addClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!0,that._trigger("unselecting",event,{unselecting:selectee.element})))))}),!1}},_mouseStop:function(event){var that=this;return this.dragged=!1,$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");that._removeClass(selectee.$element,"ui-unselecting"),selectee.unselecting=!1,selectee.startselected=!1,that._trigger("unselected",event,{unselected:selectee.element})}),$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");that._removeClass(selectee.$element,"ui-selecting")._addClass(selectee.$element,"ui-selected"),selectee.selecting=!1,selectee.selected=!0,selectee.startselected=!0,that._trigger("selected",event,{selected:selectee.element})}),this._trigger("stop",event),this.helper.remove(),!1}}),$.widget("ui.selectmenu",[$.ui.formResetMixin,{version:"1.12.1",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var selectmenuId=this.element.uniqueId().attr("id");this.ids={element:selectmenuId,button:selectmenuId+"-button",menu:selectmenuId+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=$()},_drawButton:function(){var icon,that=this,item=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(event){this.button.focus(),event.preventDefault()}}),this.element.hide(),this.button=$("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),icon=$("<span>").appendTo(this.button),this._addClass(icon,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(item).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){that._rendered||that._refreshMenu()})},_drawMenu:function(){var that=this;this.menu=$("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=$("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(event,ui){event.preventDefault(),that._setSelection(),that._select(ui.item.data("ui-selectmenu-item"),event)},focus:function(event,ui){var item=ui.item.data("ui-selectmenu-item");null!=that.focusIndex&&item.index!==that.focusIndex&&(that._trigger("focus",event,{item:item}),that.isOpen||that._select(item,event)),that.focusIndex=item.index,that.button.attr("aria-activedescendant",that.menuItems.eq(item.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var item,options=this.element.find("option");this.menu.empty(),this._parseOptions(options),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,options.length&&(item=this._getSelectedItem(),this.menuInstance.focus(null,item),this._setAria(item.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(event){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",event)))},_position:function(){this.menuWrap.position($.extend({of:this.button},this.options.position))},close:function(event){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",event))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(item){var buttonItem=$("<span>");return this._setText(buttonItem,item.label),this._addClass(buttonItem,"ui-selectmenu-text"),buttonItem},_renderMenu:function(ul,items){var that=this,currentOptgroup="";$.each(items,function(index,item){var li;item.optgroup!==currentOptgroup&&(li=$("<li>",{text:item.optgroup}),that._addClass(li,"ui-selectmenu-optgroup","ui-menu-divider"+(item.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),li.appendTo(ul),currentOptgroup=item.optgroup),that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-selectmenu-item",item)},_renderItem:function(ul,item){var li=$("<li>"),wrapper=$("<div>",{title:item.element.attr("title")});return item.disabled&&this._addClass(li,null,"ui-state-disabled"),this._setText(wrapper,item.label),li.append(wrapper).appendTo(ul)},_setText:function(element,value){value?element.text(value):element.html("&#160;")},_move:function(direction,event){var item,next,filter=".ui-menu-item";this.isOpen?item=this.menuItems.eq(this.focusIndex).parent("li"):(item=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),filter+=":not(.ui-state-disabled)"),next="first"===direction||"last"===direction?item["first"===direction?"prevAll":"nextAll"](filter).eq(-1):item[direction+"All"](filter).eq(0),next.length&&this.menuInstance.focus(event,next)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(event){this[this.isOpen?"close":"open"](event)},_setSelection:function(){var selection;this.range&&(window.getSelection?(selection=window.getSelection(),selection.removeAllRanges(),selection.addRange(this.range)):this.range.select(),this.button.focus())},_documentClick:{mousedown:function(event){this.isOpen&&($(event.target).closest(".ui-selectmenu-menu, #"+$.ui.escapeSelector(this.ids.button)).length||this.close(event))}},_buttonEvents:{mousedown:function(){var selection;window.getSelection?(selection=window.getSelection(),selection.rangeCount&&(this.range=selection.getRangeAt(0))):this.range=document.selection.createRange()},click:function(event){this._setSelection(),this._toggle(event)},keydown:function(event){var preventDefault=!0;switch(event.keyCode){case $.ui.keyCode.TAB:case $.ui.keyCode.ESCAPE:this.close(event),preventDefault=!1;break;case $.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(event);break;case $.ui.keyCode.UP:event.altKey?this._toggle(event):this._move("prev",event);break;case $.ui.keyCode.DOWN:event.altKey?this._toggle(event):this._move("next",event);break;case $.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(event):this._toggle(event);break;case $.ui.keyCode.LEFT:this._move("prev",event);break;case $.ui.keyCode.RIGHT:this._move("next",event);break;case $.ui.keyCode.HOME:case $.ui.keyCode.PAGE_UP:this._move("first",event);break;case $.ui.keyCode.END:case $.ui.keyCode.PAGE_DOWN:this._move("last",event);break;default:this.menu.trigger(event),preventDefault=!1}preventDefault&&event.preventDefault()}},_selectFocusedItem:function(event){var item=this.menuItems.eq(this.focusIndex).parent("li");item.hasClass("ui-state-disabled")||this._select(item.data("ui-selectmenu-item"),event)},_select:function(item,event){var oldIndex=this.element[0].selectedIndex;this.element[0].selectedIndex=item.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(item)),this._setAria(item),this._trigger("select",event,{item:item}),item.index!==oldIndex&&this._trigger("change",event,{item:item}),this.close(event)},_setAria:function(item){var id=this.menuItems.eq(item.index).attr("id");this.button.attr({"aria-labelledby":id,"aria-activedescendant":id}),this.menu.attr("aria-activedescendant",id)},_setOption:function(key,value){if("icons"===key){var icon=this.button.find("span.ui-icon");this._removeClass(icon,null,this.options.icons.button)._addClass(icon,null,value.button)}this._super(key,value),"appendTo"===key&&this.menuWrap.appendTo(this._appendTo()),"width"===key&&this._resizeButton()},_setOptionDisabled:function(value){this._super(value),this.menuInstance.option("disabled",value),this.button.attr("aria-disabled",value),this._toggleClass(this.button,null,"ui-state-disabled",value),this.element.prop("disabled",value),value?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var element=this.options.appendTo;return element&&(element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)),element&&element[0]||(element=this.element.closest(".ui-front, dialog")),element.length||(element=this.document[0].body),element},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var width=this.options.width;if(!1===width)return void this.button.css("width","");null===width&&(width=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(width)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var options=this._super();return options.disabled=this.element.prop("disabled"),options},_parseOptions:function(options){var that=this,data=[];options.each(function(index,item){data.push(that._parseOption($(item),index))}),this.items=data},_parseOption:function(option,index){var optgroup=option.parent("optgroup");return{element:option,index:index,value:option.val(),label:option.text(),optgroup:optgroup.attr("label")||"",disabled:optgroup.prop("disabled")||option.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),$.widget("ui.slider",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle"),handles=[];for(handleCount=options.values&&options.values.length||1,existingHandles.length>handleCount&&(existingHandles.slice(handleCount).remove(),existingHandles=existingHandles.slice(0,handleCount)),i=existingHandles.length;i<handleCount;i++)handles.push("<span tabindex='0'></span>");this.handles=existingHandles.add($(handles.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(i){$(this).data("ui-slider-handle-index",i).attr("tabIndex",0)})},_createRange:function(){var options=this.options;options.range?(!0===options.range&&(options.values?options.values.length&&2!==options.values.length?options.values=[options.values[0],options.values[0]]:$.isArray(options.values)&&(options.values=options.values.slice(0)):options.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=$("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==options.range&&"max"!==options.range||this._addClass(this.range,"ui-slider-range-"+options.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,offset,mouseOverHandle,that=this,o=this.options;return!o.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position),distance=this._valueMax()-this._valueMin()+1,this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));(distance>thisDistance||distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min))&&(distance=thisDistance,closestHandle=$(this),index=i)}),!1!==this._start(event,index)&&(this._mouseSliding=!0,this._handleIndex=index,this._addClass(closestHandle,null,"ui-state-active"),closestHandle.trigger("focus"),offset=closestHandle.offset(),mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-closestHandle.width()/2,top:event.pageY-offset.top-closestHandle.height()/2-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(event,index,normValue),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);return this._slide(event,this._handleIndex,normValue),!1},_mouseStop:function(event){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(event,this._handleIndex),this._change(event,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;return"horizontal"===this.orientation?(pixelTotal=this.elementSize.width,pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(pixelTotal=this.elementSize.height,pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),percentMouse=pixelMouse/pixelTotal,percentMouse>1&&(percentMouse=1),percentMouse<0&&(percentMouse=0),"vertical"===this.orientation&&(percentMouse=1-percentMouse),valueTotal=this._valueMax()-this._valueMin(),valueMouse=this._valueMin()+percentMouse*valueTotal,this._trimAlignValue(valueMouse)},_uiHash:function(index,value,values){var uiHash={handle:this.handles[index],handleIndex:index,value:void 0!==value?value:this.value()};return this._hasMultipleValues()&&(uiHash.value=void 0!==value?value:this.values(index),uiHash.values=values||this.values()),uiHash},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(event,index){return this._trigger("start",event,this._uiHash(index))},_slide:function(event,index,newVal){var otherVal,currentValue=this.value(),newValues=this.values();this._hasMultipleValues()&&(otherVal=this.values(index?0:1),currentValue=this.values(index),2===this.options.values.length&&!0===this.options.range&&(newVal=0===index?Math.min(otherVal,newVal):Math.max(otherVal,newVal)),newValues[index]=newVal),newVal!==currentValue&&!1!==this._trigger("slide",event,this._uiHash(index,newVal,newValues))&&(this._hasMultipleValues()?this.values(index,newVal):this.value(newVal))},_stop:function(event,index){this._trigger("stop",event,this._uiHash(index))},_change:function(event,index){this._keySliding||this._mouseSliding||(this._lastChangedValue=index,this._trigger("change",event,this._uiHash(index)))},value:function(newValue){return arguments.length?(this.options.value=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,0)):this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1)return this.options.values[index]=this._trimAlignValue(newValue),this._refreshValue(),void this._change(null,index);if(!arguments.length)return this._values();if(!$.isArray(arguments[0]))return this._hasMultipleValues()?this._values(index):this.value();for(vals=this.options.values,newValues=arguments[0],i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(newValues[i]),this._change(null,i);this._refreshValue()},_setOption:function(key,value){var i,valsLength=0;switch("range"===key&&!0===this.options.range&&("min"===value?(this.options.value=this._values(0),this.options.values=null):"max"===value&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),$.isArray(this.options.values)&&(valsLength=this.options.values.length),this._super(key,value),key){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(value),this.handles.css("horizontal"===value?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),i=valsLength-1;i>=0;i--)this._change(null,i);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(value){this._super(value),this._toggleClass(null,"ui-state-disabled",!!value)},_value:function(){var val=this.options.value;return val=this._trimAlignValue(val)},_values:function(index){var val,vals,i;if(arguments.length)return val=this.options.values[index],val=this._trimAlignValue(val);if(this._hasMultipleValues()){for(vals=this.options.values.slice(),i=0;i<vals.length;i+=1)vals[i]=this._trimAlignValue(vals[i]);return vals}return[]},_trimAlignValue:function(val){if(val<=this._valueMin())return this._valueMin();if(val>=this._valueMax())return this._valueMax();var step=this.options.step>0?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;return 2*Math.abs(valModStep)>=step&&(alignValue+=valModStep>0?step:-step),parseFloat(alignValue.toFixed(5))},_calculateNewMax:function(){var max=this.options.max,min=this._valueMin(),step=this.options.step;max=Math.round((max-min)/step)*step+min,max>this.options.max&&(max-=step),this.max=parseFloat(max.toFixed(this._precision()))},_precision:function(){var precision=this._precisionOf(this.options.step);return null!==this.options.min&&(precision=Math.max(precision,this._precisionOf(this.options.min))),precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return-1===decimal?0:str.length-decimal-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(orientation){"vertical"===orientation&&this.range.css({width:"",left:""}),"horizontal"===orientation&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=!this._animateOff&&o.animate,_set={};this._hasMultipleValues()?this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100,_set["horizontal"===that.orientation?"left":"bottom"]=valPercent+"%",$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate),!0===that.options.range&&("horizontal"===that.orientation?(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({width:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate})):(0===i&&that.range.stop(1,1)[animate?"animate":"css"]({bottom:valPercent+"%"},o.animate),1===i&&that.range[animate?"animate":"css"]({height:valPercent-lastValPercent+"%"},{queue:!1,duration:o.animate}))),lastValPercent=valPercent}):(value=this.value(),valueMin=this._valueMin(),valueMax=this._valueMax(),valPercent=valueMax!==valueMin?(value-valueMin)/(valueMax-valueMin)*100:0,_set["horizontal"===this.orientation?"left":"bottom"]=valPercent+"%",this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate),"min"===oRange&&"horizontal"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate),"max"===oRange&&"horizontal"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({width:100-valPercent+"%"},o.animate),"min"===oRange&&"vertical"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate),"max"===oRange&&"vertical"===this.orientation&&this.range.stop(1,1)[animate?"animate":"css"]({height:100-valPercent+"%"},o.animate))},_handleEvents:{keydown:function(event){var curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(event.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass($(event.target),null,"ui-state-active"),!1===this._start(event,index)))return}switch(step=this.options.step,curVal=newVal=this._hasMultipleValues()?this.values(index):this.value(),event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-(this._valueMax()-this._valueMin())/this.numPages);break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax())return;newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin())return;newVal=this._trimAlignValue(curVal-step)}this._slide(event,index,newVal)},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(event,index),this._change(event,index),this._removeClass($(event.target),null,"ui-state-active"))}}}),$.widget("ui.sortable",$.ui.mouse,{version:"1.12.1",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(x,reference,size){return x>=reference&&x<reference+size},_isFloating:function(item){return/left|right/.test(item.css("float"))||/inline|table-cell/.test(item.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(key,value){this._super(key,value),"handle"===key&&this._setHandleClassName()},_setHandleClassName:function(){var that=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),$.each(this.items,function(){that._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--)this.items[i].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=!1,that=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(event),$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that)return currentItem=$(this),!1}),$.data(event.target,that.widgetName+"-item")===that&&(currentItem=$(event.target)),!!currentItem&&(!(this.options.handle&&!overrideHandle&&($(this.options.handle,currentItem).find("*").addBack().each(function(){this===event.target&&(validHandle=!0)}),!validHandle))&&(this.currentItem=currentItem,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(event),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(event),this.originalPageX=event.pageX,this.originalPageY=event.pageY,o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(body=this.document.find("body"),this.storedCursor=body.css("cursor"),body.css("cursor",o.cursor),this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",event,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!noActivation)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",event,this._uiHash(this));return $.ui.ddmanager&&($.ui.ddmanager.current=this),$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this._mouseDrag(event),!0},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=!1;for(this.position=this._generatePosition(event),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed:event.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed:event.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(event.pageY-this.document.scrollTop()<o.scrollSensitivity?scrolled=this.document.scrollTop(this.document.scrollTop()-o.scrollSpeed):this.window.height()-(event.pageY-this.document.scrollTop())<o.scrollSensitivity&&(scrolled=this.document.scrollTop(this.document.scrollTop()+o.scrollSpeed)),event.pageX-this.document.scrollLeft()<o.scrollSensitivity?scrolled=this.document.scrollLeft(this.document.scrollLeft()-o.scrollSpeed):this.window.width()-(event.pageX-this.document.scrollLeft())<o.scrollSensitivity&&(scrolled=this.document.scrollLeft(this.document.scrollLeft()+o.scrollSpeed))),!1!==scrolled&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(item=this.items[i],itemElement=item.item[0],(intersection=this._intersectsWithPointer(item))&&item.instance===this.currentContainer&&!(itemElement===this.currentItem[0]||this.placeholder[1===intersection?"next":"prev"]()[0]===itemElement||$.contains(this.placeholder[0],itemElement)||"semi-dynamic"===this.options.type&&$.contains(this.element[0],itemElement))){
if(this.direction=1===intersection?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(item))break;this._rearrange(event,item),this._trigger("change",event,this._uiHash());break}return this._contactContainers(event),$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),this._trigger("sort",event,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(event,noPropagation){if(event){if($.ui.ddmanager&&!this.options.dropBehaviour&&$.ui.ddmanager.drop(this,event),this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};axis&&"x"!==axis||(animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),axis&&"y"!==axis||(animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event)})}else this._clear(event,noPropagation);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new $.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("deactivate",null,this._uiHash(this)),this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",null,this._uiHash(this)),this.containers[i].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),$.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?$(this.domPosition.prev).after(this.currentItem):$(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];return o=o||{},$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||/(.+)[\-=_](.+)/);res&&str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]))}),!str.length&&o.key&&str.push(o.key+"="),str.join("&")},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];return o=o||{},items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"")}),ret},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight="x"===this.options.axis||y1+dyClick>t&&y1+dyClick<b,isOverElementWidth="y"===this.options.axis||x1+dxClick>l&&x1+dxClick<r,isOverElement=isOverElementHeight&&isOverElementWidth;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"]?isOverElement:l<x1+this.helperProportions.width/2&&x2-this.helperProportions.width/2<r&&t<y1+this.helperProportions.height/2&&y2-this.helperProportions.height/2<b},_intersectsWithPointer:function(item){var verticalDirection,horizontalDirection,isOverElementHeight="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width);return!(!isOverElementHeight||!isOverElementWidth)&&(verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection(),this.floating?"right"===horizontalDirection||"down"===verticalDirection?2:1:verticalDirection&&("down"===verticalDirection?2:1))},_intersectsWithSides:function(item){var isOverBottomHalf=this._isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+item.height/2,item.height),isOverRightHalf=this._isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+item.width/2,item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();return this.floating&&horizontalDirection?"right"===horizontalDirection&&isOverRightHalf||"left"===horizontalDirection&&!isOverRightHalf:verticalDirection&&("down"===verticalDirection&&isOverBottomHalf||"up"===verticalDirection&&!isOverBottomHalf)},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return 0!==delta&&(delta>0?"down":"up")},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return 0!==delta&&(delta>0?"right":"left")},refresh:function(event){return this._refreshItems(event),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith},_getItemsAsjQuery:function(connected){function addItems(){items.push(this)}var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i],this.document[0]),j=cur.length-1;j>=0;j--)(inst=$.data(cur[j],this.widgetFullName))&&inst!==this&&!inst.options.disabled&&queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst]);for(queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=queries.length-1;i>=0;i--)queries[i][0].each(addItems);return $(items)},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++)if(list[j]===item.item[0])return!1;return!0})},_refreshItems:function(event){this.items=[],this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready)for(i=connectWith.length-1;i>=0;i--)for(cur=$(connectWith[i],this.document[0]),j=cur.length-1;j>=0;j--)(inst=$.data(cur[j],this.widgetFullName))&&inst!==this&&!inst.options.disabled&&(queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]),this.containers.push(inst));for(i=queries.length-1;i>=0;i--)for(targetData=queries[i][1],_queries=queries[i][0],j=0,queriesLength=_queries.length;j<queriesLength;j++)item=$(_queries[j]),item.data(this.widgetName+"-item",targetData),items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0})},refreshPositions:function(fast){this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,item,t,p;for(i=this.items.length-1;i>=0;i--)item=this.items[i],item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]||(t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item,fast||(item.width=t.outerWidth(),item.height=t.outerHeight()),p=t.offset(),item.left=p.left,item.top=p.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)p=this.containers[i].element.offset(),this.containers[i].containerCache.left=p.left,this.containers[i].containerCache.top=p.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(that){that=that||this;var className,o=that.options;o.placeholder&&o.placeholder.constructor!==String||(className=o.placeholder,o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]);return that._addClass(element,"ui-sortable-placeholder",className||that.currentItem[0].className)._removeClass(element,"ui-sortable-helper"),"tbody"===nodeName?that._createTrPlaceholder(that.currentItem.find("tr").eq(0),$("<tr>",that.document[0]).appendTo(element)):"tr"===nodeName?that._createTrPlaceholder(that.currentItem,element):"img"===nodeName&&element.attr("src",that.currentItem.attr("src")),className||element.css("visibility","hidden"),element},update:function(container,p){className&&!o.forcePlaceholderSize||(p.height()||p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10)),p.width()||p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10)))}}),that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem)),that.currentItem.after(that.placeholder),o.placeholder.update(that,that.placeholder)},_createTrPlaceholder:function(sourceTr,targetTr){var that=this;sourceTr.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(targetTr)})},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,cur,nearBottom,floating,axis,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--)if(!$.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0]))continue;innermostContainer=this.containers[i],innermostIndex=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",event,this._uiHash(this)),this.containers[i].containerCache.over=0);if(innermostContainer)if(1===this.containers.length)this.containers[innermostIndex].containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1);else{for(dist=1e4,itemWithLeastDistance=null,floating=innermostContainer.floating||this._isFloating(this.currentItem),posProperty=floating?"left":"top",sizeProperty=floating?"width":"height",axis=floating?"pageX":"pageY",j=this.items.length-1;j>=0;j--)$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])&&this.items[j].item[0]!==this.currentItem[0]&&(cur=this.items[j].item.offset()[posProperty],nearBottom=!1,event[axis]-cur>this.items[j][sizeProperty]/2&&(nearBottom=!0),Math.abs(event[axis]-cur)<dist&&(dist=Math.abs(event[axis]-cur),itemWithLeastDistance=this.items[j],this.direction=nearBottom?"up":"down"));if(!itemWithLeastDistance&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[innermostIndex])return void(this.currentContainer.containerCache.over||(this.containers[innermostIndex]._trigger("over",event,this._uiHash()),this.currentContainer.containerCache.over=1));itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,!0):this._rearrange(event,null,this.containers[innermostIndex].element,!0),this._trigger("change",event,this._uiHash()),this.containers[innermostIndex]._trigger("change",event,this._uiHash(this)),this.currentContainer=this.containers[innermostIndex],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[innermostIndex]._trigger("over",event,this._uiHash(this)),this.containers[innermostIndex].containerCache.over=1}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):"clone"===o.helper?this.currentItem.clone():this.currentItem;return helper.parents("body").length||$("parent"!==o.appendTo?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0]),helper[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),helper[0].style.width&&!o.forceHelperSize||helper.width(this.currentItem.width()),helper[0].style.height&&!o.forceHelperSize||helper.height(this.currentItem.height()),helper},_adjustOffsetFromHelper:function(obj){"string"==typeof obj&&(obj=obj.split(" ")),$.isArray(obj)&&(obj={left:+obj[0],top:+obj[1]||0}),"left"in obj&&(this.offset.click.left=obj.left+this.margins.left),"right"in obj&&(this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left),"top"in obj&&(this.offset.click.top=obj.top+this.margins.top),"bottom"in obj&&(this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])&&(po.left+=this.scrollParent.scrollLeft(),po.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&$.ui.ie)&&(po={top:0,left:0}),{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var ce,co,over,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),"document"!==o.containment&&"window"!==o.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===o.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===o.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(ce=$(o.containment)[0],co=$(o.containment).offset(),over="hidden"!==$(ce).css("overflow"),this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(d,pos){pos||(pos=this.position);var mod="absolute"===d?1:-1,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return{top:pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop())*mod,left:pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod}},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&$.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,scrollIsRootNode=/(html|body)/i.test(scroll[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(event.pageX-this.offset.click.left<this.containment[0]&&(pageX=this.containment[0]+this.offset.click.left),event.pageY-this.offset.click.top<this.containment[1]&&(pageY=this.containment[1]+this.offset.click.top),event.pageX-this.offset.click.left>this.containment[2]&&(pageX=this.containment[2]+this.offset.click.left),event.pageY-this.offset.click.top>this.containment[3]&&(pageY=this.containment[3]+this.offset.click.top)),o.grid&&(top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1],pageY=this.containment?top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3]?top:top-this.offset.click.top>=this.containment[1]?top-o.grid[1]:top+o.grid[1]:top,left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0],pageX=this.containment?left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2]?left:left-this.offset.click.left>=this.containment[0]?left-o.grid[0]:left+o.grid[0]:left)),{top:pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():scrollIsRootNode?0:scroll.scrollTop()),left:pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())}},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?i.item[0]:i.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){counter===this.counter&&this.refreshPositions(!hardRefresh)})},_clear:function(event,noPropagation){function delayEvent(type,instance,container){return function(event){container._trigger(type,event,instance._uiHash(instance))}}this.reverting=!1;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!noPropagation&&delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||noPropagation||delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())}),this!==this.currentContainer&&(noPropagation||(delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())}),delayedTriggers.push(function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}.call(this,this.currentContainer)),delayedTriggers.push(function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)noPropagation||delayedTriggers.push(delayEvent("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(delayedTriggers.push(delayEvent("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,noPropagation||this._trigger("beforeStop",event,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!noPropagation){for(i=0;i<delayedTriggers.length;i++)delayedTriggers[i].call(this,event);this._trigger("stop",event,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===$.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null}}});$.widget("ui.spinner",{version:"1.12.1",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var options=this._super(),element=this.element;return $.each(["min","max","step"],function(i,option){var value=element.attr(option);null!=value&&value.length&&(options[option]=value)}),options},_events:{keydown:function(event){this._start(event)&&this._keydown(event)&&event.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(event){if(this.cancelBlur)return void delete this.cancelBlur;this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",event)},mousewheel:function(event,delta){if(delta){if(!this.spinning&&!this._start(event))return!1;this._spin((delta>0?1:-1)*this.options.step,event),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(event)},100),event.preventDefault()}},"mousedown .ui-spinner-button":function(event){function checkFocus(){this.element[0]===$.ui.safeActiveElement(this.document[0])||(this.element.trigger("focus"),this.previous=previous,this._delay(function(){this.previous=previous}))}var previous;previous=this.element[0]===$.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),event.preventDefault(),checkFocus.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,checkFocus.call(this)}),!1!==this._start(event)&&this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(event){if($(event.currentTarget).hasClass("ui-state-active"))return!1!==this._start(event)&&void this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(event){var options=this.options,keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.UP:return this._repeat(null,1,event),!0;case keyCode.DOWN:return this._repeat(null,-1,event),!0;case keyCode.PAGE_UP:return this._repeat(null,options.page,event),!0;case keyCode.PAGE_DOWN:return this._repeat(null,-options.page,event),!0}return!1},_start:function(event){return!(!this.spinning&&!1===this._trigger("start",event))&&(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(i,steps,event){i=i||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,steps,event)},i),this._spin(steps*this.options.step,event)},_spin:function(step,event){var value=this.value()||0;this.counter||(this.counter=1),value=this._adjustValue(value+step*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",event,{value:value})||(this._value(value),this.counter++)},_increment:function(i){var incremental=this.options.incremental;return incremental?$.isFunction(incremental)?incremental(i):Math.floor(i*i*i/5e4-i*i/500+17*i/200+1):1},_precision:function(){var precision=this._precisionOf(this.options.step);return null!==this.options.min&&(precision=Math.max(precision,this._precisionOf(this.options.min))),precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return-1===decimal?0:str.length-decimal-1},_adjustValue:function(value){var base,aboveMin,options=this.options;return base=null!==options.min?options.min:0,aboveMin=value-base,aboveMin=Math.round(aboveMin/options.step)*options.step,value=base+aboveMin,value=parseFloat(value.toFixed(this._precision())),null!==options.max&&value>options.max?options.max:null!==options.min&&value<options.min?options.min:value},_stop:function(event){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",event))},_setOption:function(key,value){var prevValue,first,last;if("culture"===key||"numberFormat"===key)return prevValue=this._parse(this.element.val()),this.options[key]=value,void this.element.val(this._format(prevValue));"max"!==key&&"min"!==key&&"step"!==key||"string"==typeof value&&(value=this._parse(value)),"icons"===key&&(first=this.buttons.first().find(".ui-icon"),this._removeClass(first,null,this.options.icons.up),this._addClass(first,null,value.up),last=this.buttons.last().find(".ui-icon"),this._removeClass(last,null,this.options.icons.down),this._addClass(last,null,value.down)),this._super(key,value)},_setOptionDisabled:function(value){this._super(value),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!value),this.element.prop("disabled",!!value),this.buttons.button(value?"disable":"enable")},_setOptions:spinnerModifer(function(options){this._super(options)}),_parse:function(val){return"string"==typeof val&&""!==val&&(val=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(val,10,this.options.culture):+val),""===val||isNaN(val)?null:val},_format:function(value){return""===value?"":window.Globalize&&this.options.numberFormat?Globalize.format(value,this.options.numberFormat,this.options.culture):value},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var value=this.value();return null!==value&&value===this._adjustValue(value)},_value:function(value,allowAny){var parsed;""!==value&&null!==(parsed=this._parse(value))&&(allowAny||(parsed=this._adjustValue(parsed)),value=this._format(parsed)),this.element.val(value),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:spinnerModifer(function(steps){this._stepUp(steps)}),_stepUp:function(steps){this._start()&&(this._spin((steps||1)*this.options.step),this._stop())},stepDown:spinnerModifer(function(steps){this._stepDown(steps)}),_stepDown:function(steps){this._start()&&(this._spin((steps||1)*-this.options.step),this._stop())},pageUp:spinnerModifer(function(pages){this._stepUp((pages||1)*this.options.page)}),pageDown:spinnerModifer(function(pages){this._stepDown((pages||1)*this.options.page)}),value:function(newVal){if(!arguments.length)return this._parse(this.element.val());spinnerModifer(this._value).call(this,newVal)},widget:function(){return this.uiSpinner}}),!1!==$.uiBackCompat&&$.widget("ui.spinner",$.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}});$.ui.spinner;$.widget("ui.tabs",{version:"1.12.1",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var rhash=/#.*$/;return function(anchor){var anchorUrl,locationUrl;anchorUrl=anchor.href.replace(rhash,""),locationUrl=location.href.replace(rhash,"");try{anchorUrl=decodeURIComponent(anchorUrl)}catch(error){}try{locationUrl=decodeURIComponent(locationUrl)}catch(error){}return anchor.hash.length>1&&anchorUrl===locationUrl}}(),_create:function(){var that=this,options=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,options.collapsible),this._processTabs(),options.active=this._initialActive(),$.isArray(options.disabled)&&(options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li)}))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(options.active):this.active=$(),this._refresh(),this.active.length&&this.load(options.active)},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);return null===active&&(locationHash&&this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash)return active=i,!1}),null===active&&(active=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),null!==active&&-1!==active||(active=!!this.tabs.length&&0)),!1!==active&&-1===(active=this.tabs.index(this.tabs.eq(active)))&&(active=!collapsible&&0),!collapsible&&!1===active&&this.anchors.length&&(active=0),active},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):$()}},_tabKeydown:function(event){var focusedTab=$($.ui.safeActiveElement(this.document[0])).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=!0;if(!this._handlePageNav(event)){switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=!1,selectedIndex--;break
;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex);case $.ui.keyCode.ENTER:return event.preventDefault(),clearTimeout(this.activating),void this._activate(selectedIndex!==this.options.active&&selectedIndex);default:return}event.preventDefault(),clearTimeout(this.activating),selectedIndex=this._focusNextTab(selectedIndex,goingForward),event.ctrlKey||event.metaKey||(focusedTab.attr("aria-selected","false"),this.tabs.eq(selectedIndex).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",selectedIndex)},this.delay))}},_panelKeydown:function(event){this._handlePageNav(event)||event.ctrlKey&&event.keyCode===$.ui.keyCode.UP&&(event.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(event){return event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(index,goingForward){for(var lastTabIndex=this.tabs.length-1;-1!==$.inArray(function(){return index>lastTabIndex&&(index=0),index<0&&(index=lastTabIndex),index}(),this.options.disabled);)index=goingForward?index+1:index-1;return index},_focusNextTab:function(index,goingForward){return index=this._findNextTab(index,goingForward),this.tabs.eq(index).trigger("focus"),index},_setOption:function(key,value){if("active"===key)return void this._activate(value);this._super(key,value),"collapsible"===key&&(this._toggleClass("ui-tabs-collapsible",null,value),value||!1!==this.options.active||this._activate(0)),"event"===key&&this._setupEvents(value),"heightStyle"===key&&this._setupHeightStyle(value)},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab)}),this._processTabs(),!1!==options.active&&this.anchors.length?this.active.length&&!$.contains(this.tablist[0],this.active[0])?this.tabs.length===options.disabled.length?(options.active=!1,this.active=$()):this._activate(this._findNextTab(Math.max(0,options.active-1),!1)):options.active=this.tabs.index(this.active):(options.active=!1,this.active=$()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var that=this,prevTabs=this.tabs,prevAnchors=this.anchors,prevPanels=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(event){$(this).is(".ui-state-disabled")&&event.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){$(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return $("a",this)[0]}).attr({role:"presentation",tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=$(),this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");that._isLocal(anchor)?(selector=anchor.hash,panelId=selector.substring(1),panel=that.element.find(that._sanitizeSelector(selector))):(panelId=tab.attr("aria-controls")||$({}).uniqueId()[0].id,selector="#"+panelId,panel=that.element.find(selector),panel.length||(panel=that._createPanel(panelId),panel.insertAfter(that.panels[i-1]||that.tablist)),panel.attr("aria-live","polite")),panel.length&&(that.panels=that.panels.add(panel)),originalAriaControls&&tab.data("ui-tabs-aria-controls",originalAriaControls),tab.attr({"aria-controls":panelId,"aria-labelledby":anchorId}),panel.attr("aria-labelledby",anchorId)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),prevTabs&&(this._off(prevTabs.not(this.tabs)),this._off(prevAnchors.not(this.anchors)),this._off(prevPanels.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(id){return $("<div>").attr("id",id).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(disabled){var currentItem,li,i;for($.isArray(disabled)&&(disabled.length?disabled.length===this.anchors.length&&(disabled=!0):disabled=!1),i=0;li=this.tabs[i];i++)currentItem=$(li),!0===disabled||-1!==$.inArray(i,disabled)?(currentItem.attr("aria-disabled","true"),this._addClass(currentItem,null,"ui-state-disabled")):(currentItem.removeAttr("aria-disabled"),this._removeClass(currentItem,null,"ui-state-disabled"));this.options.disabled=disabled,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===disabled)},_setupEvents:function(event){var events={};event&&$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(event){event.preventDefault()}}),this._on(this.anchors,events),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();"fill"===heightStyle?(maxHeight=parent.height(),maxHeight-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");"absolute"!==position&&"fixed"!==position&&(maxHeight-=elem.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(!0)}),this.panels.each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")):"auto"===heightStyle&&(maxHeight=0,this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height())}).height(maxHeight))},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=active.length?this._getPanelForTab(active):$(),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault(),tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||clickedIsActive&&!options.collapsible||!1===this._trigger("beforeActivate",event,eventData)||(options.active=!collapsing&&this.tabs.index(tab),this.active=clickedIsActive?$():tab,this.xhr&&this.xhr.abort(),toHide.length||toShow.length||$.error("jQuery UI Tabs: Mismatching fragment identifier."),toShow.length&&this.load(this.tabs.index(tab),event),this._toggle(event,eventData))},_toggle:function(event,eventData){function complete(){that.running=!1,that._trigger("activate",event,eventData)}function show(){that._addClass(eventData.newTab.closest("li"),"ui-tabs-active","ui-state-active"),toShow.length&&that.options.show?that._show(toShow,that.options.show,complete):(toShow.show(),complete())}var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=!0,toHide.length&&this.options.hide?this._hide(toHide,this.options.hide,function(){that._removeClass(eventData.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),show()}):(this._removeClass(eventData.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),toHide.hide(),show()),toHide.attr("aria-hidden","true"),eventData.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),toShow.length&&toHide.length?eventData.oldTab.attr("tabIndex",-1):toShow.length&&this.tabs.filter(function(){return 0===$(this).attr("tabIndex")}).attr("tabIndex",-1),toShow.attr("aria-hidden","false"),eventData.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(index){var anchor,active=this._findActive(index);active[0]!==this.active[0]&&(active.length||(active=this.active),anchor=active.find(".ui-tabs-anchor")[0],this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop}))},_findActive:function(index){return!1===index?$():this.tabs.eq(index)},_getIndex:function(index){return"string"==typeof index&&(index=this.anchors.index(this.anchors.filter("[href$='"+$.ui.escapeSelector(index)+"']"))),index},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){$.data(this,"ui-tabs-destroy")?$(this).remove():$(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");prev?li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls"):li.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(index){var disabled=this.options.disabled;!1!==disabled&&(void 0===index?disabled=!1:(index=this._getIndex(index),disabled=$.isArray(disabled)?$.map(disabled,function(num){return num!==index?num:null}):$.map(this.tabs,function(li,num){return num!==index?num:null})),this._setOptionDisabled(disabled))},disable:function(index){var disabled=this.options.disabled;if(!0!==disabled){if(void 0===index)disabled=!0;else{if(index=this._getIndex(index),-1!==$.inArray(index,disabled))return;disabled=$.isArray(disabled)?$.merge([index],disabled).sort():[index]}this._setOptionDisabled(disabled)}},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel},complete=function(jqXHR,status){"abort"===status&&that.panels.stop(!1,!0),that._removeClass(tab,"ui-tabs-loading"),panel.removeAttr("aria-busy"),jqXHR===that.xhr&&delete that.xhr};this._isLocal(anchor[0])||(this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(tab,"ui-tabs-loading"),panel.attr("aria-busy","true"),this.xhr.done(function(response,status,jqXHR){setTimeout(function(){panel.html(response),that._trigger("load",event,eventData),complete(jqXHR,status)},1)}).fail(function(jqXHR,status){setTimeout(function(){complete(jqXHR,status)},1)})))},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href").replace(/#.*$/,""),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData))}}},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id))}}),!1!==$.uiBackCompat&&$.widget("ui.tabs",$.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}});$.ui.tabs;$.widget("ui.tooltip",{version:"1.12.1",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var title=$(this).attr("title")||"";return $("<a>").text(title).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(elem,id){var describedby=(elem.attr("aria-describedby")||"").split(/\s+/);describedby.push(id),elem.data("ui-tooltip-id",id).attr("aria-describedby",$.trim(describedby.join(" ")))},_removeDescribedBy:function(elem){var id=elem.data("ui-tooltip-id"),describedby=(elem.attr("aria-describedby")||"").split(/\s+/),index=$.inArray(id,describedby);-1!==index&&describedby.splice(index,1),elem.removeData("ui-tooltip-id"),describedby=$.trim(describedby.join(" ")),describedby?elem.attr("aria-describedby",describedby):elem.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=$("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=$([])},_setOption:function(key,value){var that=this;this._super(key,value),"content"===key&&$.each(this.tooltips,function(id,tooltipData){that._updateContent(tooltipData.element)})},_setOptionDisabled:function(value){this[value?"_disable":"_enable"]()},_disable:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur");event.target=event.currentTarget=tooltipData.element[0],that.close(event,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var element=$(this);if(element.is("[title]"))return element.data("ui-tooltip-title",element.attr("title")).removeAttr("title")}))},_enable:function(){this.disabledTitles.each(function(){var element=$(this);element.data("ui-tooltip-title")&&element.attr("title",element.data("ui-tooltip-title"))}),this.disabledTitles=$([])},open:function(event){var that=this,target=$(event?event.target:this.element).closest(this.options.items);target.length&&!target.data("ui-tooltip-id")&&(target.attr("title")&&target.data("ui-tooltip-title",target.attr("title")),target.data("ui-tooltip-open",!0),event&&"mouseover"===event.type&&target.parents().each(function(){var blurEvent,parent=$(this);parent.data("ui-tooltip-open")&&(blurEvent=$.Event("blur"),blurEvent.target=blurEvent.currentTarget=this,that.close(blurEvent,!0)),parent.attr("title")&&(parent.uniqueId(),that.parents[this.id]={element:this,title:parent.attr("title")},parent.attr("title",""))}),this._registerCloseHandlers(event,target),this._updateContent(target,event))},_updateContent:function(target,event){var content,contentOption=this.options.content,that=this,eventType=event?event.type:null;if("string"==typeof contentOption||contentOption.nodeType||contentOption.jquery)return this._open(event,target,contentOption);(content=contentOption.call(target[0],function(response){that._delay(function(){target.data("ui-tooltip-open")&&(event&&(event.type=eventType),this._open(event,target,response))})}))&&this._open(event,target,content)},_open:function(event,target,content){function position(event){positionOption.of=event,tooltip.is(":hidden")||tooltip.position(positionOption)}var tooltipData,tooltip,delayedShow,a11yContent,positionOption=$.extend({},this.options.position);if(content){if(tooltipData=this._find(target))return void tooltipData.tooltip.find(".ui-tooltip-content").html(content);target.is("[title]")&&(event&&"mouseover"===event.type?target.attr("title",""):target.removeAttr("title")),tooltipData=this._tooltip(target),tooltip=tooltipData.tooltip,this._addDescribedBy(target,tooltip.attr("id")),tooltip.find(".ui-tooltip-content").html(content),this.liveRegion.children().hide(),a11yContent=$("<div>").html(tooltip.find(".ui-tooltip-content").html()),a11yContent.removeAttr("name").find("[name]").removeAttr("name"),a11yContent.removeAttr("id").find("[id]").removeAttr("id"),a11yContent.appendTo(this.liveRegion),this.options.track&&event&&/^mouse/.test(event.type)?(this._on(this.document,{mousemove:position}),position(event)):tooltip.position($.extend({of:target},this.options.position)),tooltip.hide(),this._show(tooltip,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(delayedShow=this.delayedShow=setInterval(function(){tooltip.is(":visible")&&(position(positionOption.of),clearInterval(delayedShow))},$.fx.interval)),this._trigger("open",event,{tooltip:tooltip})}},_registerCloseHandlers:function(event,target){var events={keyup:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){var fakeEvent=$.Event(event);fakeEvent.currentTarget=target[0],this.close(fakeEvent,!0)}}};target[0]!==this.element[0]&&(events.remove=function(){this._removeTooltip(this._find(target).tooltip)}),event&&"mouseover"!==event.type||(events.mouseleave="close"),event&&"focusin"!==event.type||(events.focusout="close"),this._on(!0,target,events)},close:function(event){var tooltip,that=this,target=$(event?event.currentTarget:this.element),tooltipData=this._find(target);if(!tooltipData)return void target.removeData("ui-tooltip-open");tooltip=tooltipData.tooltip,tooltipData.closing||(clearInterval(this.delayedShow),target.data("ui-tooltip-title")&&!target.attr("title")&&target.attr("title",target.data("ui-tooltip-title")),this._removeDescribedBy(target),tooltipData.hiding=!0,tooltip.stop(!0),this._hide(tooltip,this.options.hide,function(){that._removeTooltip($(this))}),target.removeData("ui-tooltip-open"),this._off(target,"mouseleave focusout keyup"),target[0]!==this.element[0]&&this._off(target,"remove"),this._off(this.document,"mousemove"),event&&"mouseleave"===event.type&&$.each(this.parents,function(id,parent){$(parent.element).attr("title",parent.title),delete that.parents[id]}),tooltipData.closing=!0,this._trigger("close",event,{tooltip:tooltip}),tooltipData.hiding||(tooltipData.closing=!1))},_tooltip:function(element){var tooltip=$("<div>").attr("role","tooltip"),content=$("<div>").appendTo(tooltip),id=tooltip.uniqueId().attr("id");return this._addClass(content,"ui-tooltip-content"),this._addClass(tooltip,"ui-tooltip","ui-widget ui-widget-content"),tooltip.appendTo(this._appendTo(element)),this.tooltips[id]={element:element,tooltip:tooltip}},_find:function(target){var id=target.data("ui-tooltip-id");return id?this.tooltips[id]:null},_removeTooltip:function(tooltip){tooltip.remove(),delete this.tooltips[tooltip.attr("id")]},_appendTo:function(target){var element=target.closest(".ui-front, dialog");return element.length||(element=this.document[0].body),element},_destroy:function(){var that=this;$.each(this.tooltips,function(id,tooltipData){var event=$.Event("blur"),element=tooltipData.element;event.target=event.currentTarget=element[0],that.close(event,!0),$("#"+id).remove(),element.data("ui-tooltip-title")&&(element.attr("title")||element.attr("title",element.data("ui-tooltip-title")),element.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),!1!==$.uiBackCompat&&$.widget("ui.tooltip",$.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var tooltipData=this._superApply(arguments);return this.options.tooltipClass&&tooltipData.tooltip.addClass(this.options.tooltipClass),tooltipData}});$.ui.tooltip}),define("css!../../bower_components/jquery-ui/themes/base/jquery-ui",[],function(){}),function(){function sightglass(obj,keypath,callback,options){return new Observer(obj,keypath,callback,options)}function Observer(obj,keypath,callback,options){this.options=options||{},this.options.adapters=this.options.adapters||{},this.obj=obj,this.keypath=keypath,this.callback=callback,this.objectPath=[],this.update=this.update.bind(this),this.parse(),isObject(this.target=this.realize())&&this.set(!0,this.key,this.target,this.callback)}function isObject(obj){return"object"==typeof obj&&null!==obj}function error(message){throw new Error("[sightglass] "+message)}sightglass.adapters={},Observer.tokenize=function(keypath,interfaces,root){var index,chr,tokens=[],current={i:root,path:""};for(index=0;index<keypath.length;index++)chr=keypath.charAt(index),~interfaces.indexOf(chr)?(tokens.push(current),current={i:chr,path:""}):current.path+=chr;return tokens.push(current),tokens},Observer.prototype.parse=function(){var root,path,interfaces=this.interfaces();interfaces.length||error("Must define at least one adapter interface."),~interfaces.indexOf(this.keypath[0])?(root=this.keypath[0],path=this.keypath.substr(1)):(void 0===(root=this.options.root||sightglass.root)&&error("Must define a default root adapter."),path=this.keypath),this.tokens=Observer.tokenize(path,interfaces,root),this.key=this.tokens.pop()},Observer.prototype.realize=function(){var prev,current=this.obj,unreached=!1;return this.tokens.forEach(function(token,index){isObject(current)?(void 0!==this.objectPath[index]?current!==(prev=this.objectPath[index])&&(this.set(!1,token,prev,this.update),this.set(!0,token,current,this.update),this.objectPath[index]=current):(this.set(!0,token,current,this.update),this.objectPath[index]=current),current=this.get(token,current)):(!1===unreached&&(unreached=index),(prev=this.objectPath[index])&&this.set(!1,token,prev,this.update))},this),!1!==unreached&&this.objectPath.splice(unreached),current},Observer.prototype.update=function(){var next,oldValue;(next=this.realize())!==this.target&&(isObject(this.target)&&this.set(!1,this.key,this.target,this.callback),isObject(next)&&this.set(!0,this.key,next,this.callback),oldValue=this.value(),this.target=next,(this.value()instanceof Function||this.value()!==oldValue)&&this.callback())},Observer.prototype.value=function(){if(isObject(this.target))return this.get(this.key,this.target)},Observer.prototype.setValue=function(value){isObject(this.target)&&this.adapter(this.key).set(this.target,this.key.path,value)},Observer.prototype.get=function(key,obj){return this.adapter(key).get(obj,key.path)},Observer.prototype.set=function(active,key,obj,callback){var action=active?"observe":"unobserve";this.adapter(key)[action](obj,key.path,callback)},Observer.prototype.interfaces=function(){var interfaces=Object.keys(this.options.adapters);return Object.keys(sightglass.adapters).forEach(function(i){~interfaces.indexOf(i)||interfaces.push(i)}),interfaces},Observer.prototype.adapter=function(key){return this.options.adapters[key.i]||sightglass.adapters[key.i]},Observer.prototype.unobserve=function(){var obj;this.tokens.forEach(function(token,index){(obj=this.objectPath[index])&&this.set(!1,token,obj,this.update)},this),isObject(this.target)&&this.set(!1,this.key,this.target,this.callback)},"undefined"!=typeof module&&module.exports?module.exports=sightglass:"function"==typeof define&&define.amd?define("sightglass",[],function(){return this.sightglass=sightglass}):this.sightglass=sightglass}.call(this),function(){var Rivets,bindMethod,jQuery,unbindMethod,_ref,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__slice=[].slice,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};Rivets={options:["prefix","templateDelimiters","rootInterface","preloadData","handler","executeFunctions"],extensions:["binders","formatters","components","adapters"],public:{binders:{},components:{},formatters:{},adapters:{},prefix:"rv",templateDelimiters:["{","}"],rootInterface:".",preloadData:!0,executeFunctions:!1,iterationAlias:function(modelName){return"%"+modelName+"%"},handler:function(context,ev,binding){return this.call(context,ev,binding.view.models)},configure:function(options){var descriptor,key,option,value;null==options&&(options={});for(option in options)if(value=options[option],"binders"===option||"components"===option||"formatters"===option||"adapters"===option)for(key in value)descriptor=value[key],Rivets[option][key]=descriptor;else Rivets.public[option]=value},bind:function(el,models,options){var view;return null==models&&(models={}),null==options&&(options={}),view=new Rivets.View(el,models,options),view.bind(),view},init:function(component,el,data){var scope,template,view;if(null==data&&(data={}),null==el&&(el=document.createElement("div")),component=Rivets.public.components[component],(template=component.template.call(this,el))instanceof HTMLElement){for(;el.firstChild;)el.removeChild(el.firstChild);el.appendChild(template)}else el.innerHTML=template;return scope=component.initialize.call(this,el,data),view=new Rivets.View(el,scope),view.bind(),view}}},window.jQuery||window.$?(jQuery=window.jQuery||window.$,_ref="on"in jQuery.prototype?["on","off"]:["bind","unbind"],bindMethod=_ref[0],unbindMethod=_ref[1],Rivets.Util={bindEvent:function(el,event,handler){return jQuery(el)[bindMethod](event,handler)},unbindEvent:function(el,event,handler){return jQuery(el)[unbindMethod](event,handler)},getInputValue:function(el){var $el;return $el=jQuery(el),"checkbox"===$el.attr("type")?$el.is(":checked"):$el.val()}}):Rivets.Util={bindEvent:function(){return"addEventListener"in window?function(el,event,handler){return el.addEventListener(event,handler,!1)}:function(el,event,handler){return el.attachEvent("on"+event,handler)}}(),unbindEvent:function(){return"removeEventListener"in window?function(el,event,handler){return el.removeEventListener(event,handler,!1)}:function(el,event,handler){return el.detachEvent("on"+event,handler)}}(),getInputValue:function(el){var o,_i,_len,_results;if("checkbox"===el.type)return el.checked;if("select-multiple"===el.type){for(_results=[],_i=0,_len=el.length;_i<_len;_i++)o=el[_i],o.selected&&_results.push(o.value);return _results}return el.value}},Rivets.TypeParser=function(){function TypeParser(){}return TypeParser.types={primitive:0,keypath:1},TypeParser.parse=function(string){return/^'.*'$|^".*"$/.test(string)?{type:this.types.primitive,value:string.slice(1,-1)}:"true"===string?{type:this.types.primitive,value:!0}:"false"===string?{type:this.types.primitive,value:!1}:"null"===string?{type:this.types.primitive,value:null}:"undefined"===string?{type:this.types.primitive,value:void 0}:""===string?{type:this.types.primitive,value:void 0}:!1===isNaN(Number(string))?{type:this.types.primitive,value:Number(string)}:{type:this.types.keypath,value:string}},TypeParser}(),Rivets.TextTemplateParser=function(){function TextTemplateParser(){}return TextTemplateParser.types={text:0,binding:1},TextTemplateParser.parse=function(template,delimiters){var index,lastIndex,lastToken,length,substring,tokens,value;for(tokens=[],length=template.length,index=0,lastIndex=0;lastIndex<length;){if((index=template.indexOf(delimiters[0],lastIndex))<0){tokens.push({type:this.types.text,value:template.slice(lastIndex)});break}if(index>0&&lastIndex<index&&tokens.push({type:this.types.text,value:template.slice(lastIndex,index)}),lastIndex=index+delimiters[0].length,(index=template.indexOf(delimiters[1],lastIndex))<0){substring=template.slice(lastIndex-delimiters[1].length),lastToken=tokens[tokens.length-1],(null!=lastToken?lastToken.type:void 0)===this.types.text?lastToken.value+=substring:tokens.push({type:this.types.text,value:substring});break}value=template.slice(lastIndex,index).trim(),tokens.push({type:this.types.binding,value:value}),lastIndex=index+delimiters[1].length}return tokens},TextTemplateParser}(),Rivets.View=function(){function View(els,models,options){var k,option,v,_base,_i,_j,_len,_len1,_ref1,_ref2,_ref3,_ref4,_ref5;for(this.els=els,this.models=models,null==options&&(options={}),this.update=__bind(this.update,this),this.publish=__bind(this.publish,this),this.sync=__bind(this.sync,this),this.unbind=__bind(this.unbind,this),this.bind=__bind(this.bind,this),this.select=__bind(this.select,this),this.traverse=__bind(this.traverse,this),this.build=__bind(this.build,this),this.buildBinding=__bind(this.buildBinding,this),this.bindingRegExp=__bind(this.bindingRegExp,this),this.options=__bind(this.options,this),this.els.jquery||this.els instanceof Array||(this.els=[this.els]),_ref1=Rivets.extensions,_i=0,_len=_ref1.length;_i<_len;_i++){if(option=_ref1[_i],this[option]={},options[option]){_ref2=options[option];for(k in _ref2)v=_ref2[k],this[option][k]=v}_ref3=Rivets.public[option];for(k in _ref3)v=_ref3[k],null==(_base=this[option])[k]&&(_base[k]=v)}for(_ref4=Rivets.options,_j=0,_len1=_ref4.length;_j<_len1;_j++)option=_ref4[_j],this[option]=null!=(_ref5=options[option])?_ref5:Rivets.public[option];this.build()}return View.prototype.options=function(){var option,options,_i,_len,_ref1;for(options={},_ref1=Rivets.extensions.concat(Rivets.options),_i=0,_len=_ref1.length;_i<_len;_i++)option=_ref1[_i],options[option]=this[option];return options},View.prototype.bindingRegExp=function(){return new RegExp("^"+this.prefix+"-")},View.prototype.buildBinding=function(binding,node,type,declaration){var context,ctx,dependencies,keypath,options,pipe,pipes;return options={},pipes=function(){var _i,_len,_ref1,_results;for(_ref1=declaration.match(/((?:'[^']*')*(?:(?:[^\|']*(?:'[^']*')+[^\|']*)+|[^\|]+))|^$/g),_results=[],_i=0,_len=_ref1.length;_i<_len;_i++)pipe=_ref1[_i],_results.push(pipe.trim());return _results}(),context=function(){var _i,_len,_ref1,_results;for(_ref1=pipes.shift().split("<"),_results=[],_i=0,_len=_ref1.length;_i<_len;_i++)ctx=_ref1[_i],_results.push(ctx.trim());return _results}(),keypath=context.shift(),options.formatters=pipes,(dependencies=context.shift())&&(options.dependencies=dependencies.split(/\s+/)),this.bindings.push(new Rivets[binding](this,node,type,keypath,options))},View.prototype.build=function(){var el,parse,_i,_len,_ref1;for(this.bindings=[],parse=function(_this){return function(node){var block,childNode,delimiters,n,parser,text,token,tokens,_i,_j,_len,_len1,_ref1;if(3===node.nodeType){if(parser=Rivets.TextTemplateParser,(delimiters=_this.templateDelimiters)&&(tokens=parser.parse(node.data,delimiters)).length&&(1!==tokens.length||tokens[0].type!==parser.types.text)){for(_i=0,_len=tokens.length;_i<_len;_i++)token=tokens[_i],text=document.createTextNode(token.value),node.parentNode.insertBefore(text,node),1===token.type&&_this.buildBinding("TextBinding",text,null,token.value);node.parentNode.removeChild(node)}}else 1===node.nodeType&&(block=_this.traverse(node));if(!block)for(_ref1=function(){var _k,_len1,_ref1,_results;for(_ref1=node.childNodes,_results=[],_k=0,_len1=_ref1.length;_k<_len1;_k++)n=_ref1[_k],_results.push(n);return _results}(),_j=0,_len1=_ref1.length;_j<_len1;_j++)childNode=_ref1[_j],parse(childNode)}}(this),_ref1=this.els,_i=0,_len=_ref1.length;_i<_len;_i++)el=_ref1[_i],parse(el);this.bindings.sort(function(a,b){var _ref2,_ref3;return((null!=(_ref2=b.binder)?_ref2.priority:void 0)||0)-((null!=(_ref3=a.binder)?_ref3.priority:void 0)||0)})},View.prototype.traverse=function(node){var attribute,attributes,binder,bindingRegExp,block,identifier,regexp,type,value,_i,_j,_len,_len1,_ref1,_ref2,_ref3;for(bindingRegExp=this.bindingRegExp(),block="SCRIPT"===node.nodeName||"STYLE"===node.nodeName,_ref1=node.attributes,_i=0,_len=_ref1.length;_i<_len;_i++)if(attribute=_ref1[_i],bindingRegExp.test(attribute.name)){if(type=attribute.name.replace(bindingRegExp,""),!(binder=this.binders[type])){_ref2=this.binders;for(identifier in _ref2)value=_ref2[identifier],"*"!==identifier&&-1!==identifier.indexOf("*")&&(regexp=new RegExp("^"+identifier.replace(/\*/g,".+")+"$"),regexp.test(type)&&(binder=value))}binder||(binder=this.binders["*"]),binder.block&&(block=!0,attributes=[attribute])}for(_ref3=attributes||node.attributes,_j=0,_len1=_ref3.length;_j<_len1;_j++)attribute=_ref3[_j],
bindingRegExp.test(attribute.name)&&(type=attribute.name.replace(bindingRegExp,""),this.buildBinding("Binding",node,type,attribute.value));return block||(type=node.nodeName.toLowerCase(),this.components[type]&&!node._bound&&(this.bindings.push(new Rivets.ComponentBinding(this,node,type)),block=!0)),block},View.prototype.select=function(fn){var binding,_i,_len,_ref1,_results;for(_ref1=this.bindings,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++)binding=_ref1[_i],fn(binding)&&_results.push(binding);return _results},View.prototype.bind=function(){var binding,_i,_len,_ref1;for(_ref1=this.bindings,_i=0,_len=_ref1.length;_i<_len;_i++)binding=_ref1[_i],binding.bind()},View.prototype.unbind=function(){var binding,_i,_len,_ref1;for(_ref1=this.bindings,_i=0,_len=_ref1.length;_i<_len;_i++)binding=_ref1[_i],binding.unbind()},View.prototype.sync=function(){var binding,_i,_len,_ref1;for(_ref1=this.bindings,_i=0,_len=_ref1.length;_i<_len;_i++)binding=_ref1[_i],"function"==typeof binding.sync&&binding.sync()},View.prototype.publish=function(){var binding,_i,_len,_ref1;for(_ref1=this.select(function(b){var _ref1;return null!=(_ref1=b.binder)?_ref1.publishes:void 0}),_i=0,_len=_ref1.length;_i<_len;_i++)binding=_ref1[_i],binding.publish()},View.prototype.update=function(models){var binding,key,model,_i,_len,_ref1;null==models&&(models={});for(key in models)model=models[key],this.models[key]=model;for(_ref1=this.bindings,_i=0,_len=_ref1.length;_i<_len;_i++)binding=_ref1[_i],"function"==typeof binding.update&&binding.update(models)},View}(),Rivets.Binding=function(){function Binding(view,el,type,keypath,options){this.view=view,this.el=el,this.type=type,this.keypath=keypath,this.options=null!=options?options:{},this.getValue=__bind(this.getValue,this),this.update=__bind(this.update,this),this.unbind=__bind(this.unbind,this),this.bind=__bind(this.bind,this),this.publish=__bind(this.publish,this),this.sync=__bind(this.sync,this),this.set=__bind(this.set,this),this.eventHandler=__bind(this.eventHandler,this),this.formattedValue=__bind(this.formattedValue,this),this.parseFormatterArguments=__bind(this.parseFormatterArguments,this),this.parseTarget=__bind(this.parseTarget,this),this.observe=__bind(this.observe,this),this.setBinder=__bind(this.setBinder,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={},this.model=void 0,this.setBinder()}return Binding.prototype.setBinder=function(){var identifier,regexp,value,_ref1;if(!(this.binder=this.view.binders[this.type])){_ref1=this.view.binders;for(identifier in _ref1)value=_ref1[identifier],"*"!==identifier&&-1!==identifier.indexOf("*")&&(regexp=new RegExp("^"+identifier.replace(/\*/g,".+")+"$"),regexp.test(this.type)&&(this.binder=value,this.args=new RegExp("^"+identifier.replace(/\*/g,"(.+)")+"$").exec(this.type),this.args.shift()))}if(this.binder||(this.binder=this.view.binders["*"]),this.binder instanceof Function)return this.binder={routine:this.binder}},Binding.prototype.observe=function(obj,keypath,callback){return Rivets.sightglass(obj,keypath,callback,{root:this.view.rootInterface,adapters:this.view.adapters})},Binding.prototype.parseTarget=function(){var token;return token=Rivets.TypeParser.parse(this.keypath),token.type===Rivets.TypeParser.types.primitive?this.value=token.value:(this.observer=this.observe(this.view.models,this.keypath,this.sync),this.model=this.observer.target)},Binding.prototype.parseFormatterArguments=function(args,formatterIndex){var ai,arg,observer,processedArgs,_base,_i,_len;for(args=function(){var _i,_len,_results;for(_results=[],_i=0,_len=args.length;_i<_len;_i++)arg=args[_i],_results.push(Rivets.TypeParser.parse(arg));return _results}(),processedArgs=[],ai=_i=0,_len=args.length;_i<_len;ai=++_i)arg=args[ai],processedArgs.push(arg.type===Rivets.TypeParser.types.primitive?arg.value:((_base=this.formatterObservers)[formatterIndex]||(_base[formatterIndex]={}),(observer=this.formatterObservers[formatterIndex][ai])||(observer=this.observe(this.view.models,arg.value,this.sync),this.formatterObservers[formatterIndex][ai]=observer),observer.value()));return processedArgs},Binding.prototype.formattedValue=function(value){var args,fi,formatter,id,processedArgs,_i,_len,_ref1,_ref2;for(_ref1=this.formatters,fi=_i=0,_len=_ref1.length;_i<_len;fi=++_i)formatter=_ref1[fi],args=formatter.match(/[^\s']+|'([^']|'[^\s])*'|"([^"]|"[^\s])*"/g),id=args.shift(),formatter=this.view.formatters[id],processedArgs=this.parseFormatterArguments(args,fi),(null!=formatter?formatter.read:void 0)instanceof Function?value=(_ref2=formatter.read).call.apply(_ref2,[this.model,value].concat(__slice.call(processedArgs))):formatter instanceof Function&&(value=formatter.call.apply(formatter,[this.model,value].concat(__slice.call(processedArgs))));return value},Binding.prototype.eventHandler=function(fn){var binding,handler;return handler=(binding=this).view.handler,function(ev){return handler.call(fn,this,ev,binding)}},Binding.prototype.set=function(value){var _ref1;return value=value instanceof Function&&!this.binder.function&&Rivets.public.executeFunctions?this.formattedValue(value.call(this.model)):this.formattedValue(value),null!=(_ref1=this.binder.routine)?_ref1.call(this,this.el,value):void 0},Binding.prototype.sync=function(){var dependency,observer;return this.set(function(){var _i,_j,_len,_len1,_ref1,_ref2,_ref3;if(this.observer){if(this.model!==this.observer.target){for(_ref1=this.dependencies,_i=0,_len=_ref1.length;_i<_len;_i++)observer=_ref1[_i],observer.unobserve();if(this.dependencies=[],null!=(this.model=this.observer.target)&&(null!=(_ref2=this.options.dependencies)?_ref2.length:void 0))for(_ref3=this.options.dependencies,_j=0,_len1=_ref3.length;_j<_len1;_j++)dependency=_ref3[_j],observer=this.observe(this.model,dependency,this.sync),this.dependencies.push(observer)}return this.observer.value()}return this.value}.call(this))},Binding.prototype.publish=function(){var args,fi,fiReversed,formatter,id,lastformatterIndex,processedArgs,value,_i,_len,_ref1,_ref2,_ref3;if(this.observer){for(value=this.getValue(this.el),lastformatterIndex=this.formatters.length-1,_ref1=this.formatters.slice(0).reverse(),fiReversed=_i=0,_len=_ref1.length;_i<_len;fiReversed=++_i)formatter=_ref1[fiReversed],fi=lastformatterIndex-fiReversed,args=formatter.split(/\s+/),id=args.shift(),processedArgs=this.parseFormatterArguments(args,fi),(null!=(_ref2=this.view.formatters[id])?_ref2.publish:void 0)&&(value=(_ref3=this.view.formatters[id]).publish.apply(_ref3,[value].concat(__slice.call(processedArgs))));return this.observer.setValue(value)}},Binding.prototype.bind=function(){var dependency,observer,_i,_len,_ref1,_ref2,_ref3;if(this.parseTarget(),null!=(_ref1=this.binder.bind)&&_ref1.call(this,this.el),null!=this.model&&(null!=(_ref2=this.options.dependencies)?_ref2.length:void 0))for(_ref3=this.options.dependencies,_i=0,_len=_ref3.length;_i<_len;_i++)dependency=_ref3[_i],observer=this.observe(this.model,dependency,this.sync),this.dependencies.push(observer);if(this.view.preloadData)return this.sync()},Binding.prototype.unbind=function(){var ai,args,fi,observer,_i,_len,_ref1,_ref2,_ref3,_ref4;for(null!=(_ref1=this.binder.unbind)&&_ref1.call(this,this.el),null!=(_ref2=this.observer)&&_ref2.unobserve(),_ref3=this.dependencies,_i=0,_len=_ref3.length;_i<_len;_i++)observer=_ref3[_i],observer.unobserve();this.dependencies=[],_ref4=this.formatterObservers;for(fi in _ref4){args=_ref4[fi];for(ai in args)observer=args[ai],observer.unobserve()}return this.formatterObservers={}},Binding.prototype.update=function(models){var _ref1,_ref2;return null==models&&(models={}),this.model=null!=(_ref1=this.observer)?_ref1.target:void 0,null!=(_ref2=this.binder.update)?_ref2.call(this,models):void 0},Binding.prototype.getValue=function(el){return this.binder&&null!=this.binder.getValue?this.binder.getValue.call(this,el):Rivets.Util.getInputValue(el)},Binding}(),Rivets.ComponentBinding=function(_super){function ComponentBinding(view,el,type){var attribute,bindingRegExp,propertyName,token,_i,_len,_ref1,_ref2;for(this.view=view,this.el=el,this.type=type,this.unbind=__bind(this.unbind,this),this.bind=__bind(this.bind,this),this.locals=__bind(this.locals,this),this.component=this.view.components[this.type],this.static={},this.observers={},this.upstreamObservers={},bindingRegExp=view.bindingRegExp(),_ref1=this.el.attributes||[],_i=0,_len=_ref1.length;_i<_len;_i++)attribute=_ref1[_i],bindingRegExp.test(attribute.name)||(propertyName=this.camelCase(attribute.name),token=Rivets.TypeParser.parse(attribute.value),__indexOf.call(null!=(_ref2=this.component.static)?_ref2:[],propertyName)>=0?this.static[propertyName]=attribute.value:token.type===Rivets.TypeParser.types.primitive?this.static[propertyName]=token.value:this.observers[propertyName]=attribute.value)}return __extends(ComponentBinding,_super),ComponentBinding.prototype.sync=function(){},ComponentBinding.prototype.update=function(){},ComponentBinding.prototype.publish=function(){},ComponentBinding.prototype.locals=function(){var key,observer,result,value,_ref1,_ref2;result={},_ref1=this.static;for(key in _ref1)value=_ref1[key],result[key]=value;_ref2=this.observers;for(key in _ref2)observer=_ref2[key],result[key]=observer.value();return result},ComponentBinding.prototype.camelCase=function(string){return string.replace(/-([a-z])/g,function(grouped){return grouped[1].toUpperCase()})},ComponentBinding.prototype.bind=function(){var k,key,keypath,observer,option,options,scope,v,_base,_i,_j,_len,_len1,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;if(!this.bound){_ref1=this.observers;for(key in _ref1)keypath=_ref1[key],this.observers[key]=this.observe(this.view.models,keypath,function(_this){return function(key){return function(){return _this.componentView.models[key]=_this.observers[key].value()}}}(this).call(this,key));this.bound=!0}if(null!=this.componentView)this.componentView.bind();else{for(this.el.innerHTML=this.component.template.call(this),scope=this.component.initialize.call(this,this.el,this.locals()),this.el._bound=!0,options={},_ref2=Rivets.extensions,_i=0,_len=_ref2.length;_i<_len;_i++){if(option=_ref2[_i],options[option]={},this.component[option]){_ref3=this.component[option];for(k in _ref3)v=_ref3[k],options[option][k]=v}_ref4=this.view[option];for(k in _ref4)v=_ref4[k],null==(_base=options[option])[k]&&(_base[k]=v)}for(_ref5=Rivets.options,_j=0,_len1=_ref5.length;_j<_len1;_j++)option=_ref5[_j],options[option]=null!=(_ref6=this.component[option])?_ref6:this.view[option];this.componentView=new Rivets.View(Array.prototype.slice.call(this.el.childNodes),scope,options),this.componentView.bind(),_ref7=this.observers;for(key in _ref7)observer=_ref7[key],this.upstreamObservers[key]=this.observe(this.componentView.models,key,function(_this){return function(key,observer){return function(){return observer.setValue(_this.componentView.models[key])}}}(this).call(this,key,observer))}},ComponentBinding.prototype.unbind=function(){var key,observer,_ref1,_ref2,_ref3;_ref1=this.upstreamObservers;for(key in _ref1)observer=_ref1[key],observer.unobserve();_ref2=this.observers;for(key in _ref2)observer=_ref2[key],observer.unobserve();return null!=(_ref3=this.componentView)?_ref3.unbind.call(this):void 0},ComponentBinding}(Rivets.Binding),Rivets.TextBinding=function(_super){function TextBinding(view,el,type,keypath,options){this.view=view,this.el=el,this.type=type,this.keypath=keypath,this.options=null!=options?options:{},this.sync=__bind(this.sync,this),this.formatters=this.options.formatters||[],this.dependencies=[],this.formatterObservers={}}return __extends(TextBinding,_super),TextBinding.prototype.binder={routine:function(node,value){return node.data=null!=value?value:""}},TextBinding.prototype.sync=function(){return TextBinding.__super__.sync.apply(this,arguments)},TextBinding}(Rivets.Binding),Rivets.public.binders.text=function(el,value){return null!=el.textContent?el.textContent=null!=value?value:"":el.innerText=null!=value?value:""},Rivets.public.binders.html=function(el,value){return el.innerHTML=null!=value?value:""},Rivets.public.binders.show=function(el,value){return el.style.display=value?"":"none"},Rivets.public.binders.hide=function(el,value){return el.style.display=value?"none":""},Rivets.public.binders.enabled=function(el,value){return el.disabled=!value},Rivets.public.binders.disabled=function(el,value){return el.disabled=!!value},Rivets.public.binders.checked={publishes:!0,priority:2e3,bind:function(el){return Rivets.Util.bindEvent(el,"change",this.publish)},unbind:function(el){return Rivets.Util.unbindEvent(el,"change",this.publish)},routine:function(el,value){var _ref1;return"radio"===el.type?el.checked=(null!=(_ref1=el.value)?_ref1.toString():void 0)===(null!=value?value.toString():void 0):el.checked=!!value}},Rivets.public.binders.unchecked={publishes:!0,priority:2e3,bind:function(el){return Rivets.Util.bindEvent(el,"change",this.publish)},unbind:function(el){return Rivets.Util.unbindEvent(el,"change",this.publish)},routine:function(el,value){var _ref1;return"radio"===el.type?el.checked=(null!=(_ref1=el.value)?_ref1.toString():void 0)!==(null!=value?value.toString():void 0):el.checked=!value}},Rivets.public.binders.value={publishes:!0,priority:3e3,bind:function(el){if("INPUT"!==el.tagName||"radio"!==el.type)return this.event="SELECT"===el.tagName?"change":"input",Rivets.Util.bindEvent(el,this.event,this.publish)},unbind:function(el){if("INPUT"!==el.tagName||"radio"!==el.type)return Rivets.Util.unbindEvent(el,this.event,this.publish)},routine:function(el,value){var o,_i,_len,_ref1,_ref2,_ref3,_results;if("INPUT"===el.tagName&&"radio"===el.type)return el.setAttribute("value",value);if(null!=window.jQuery){if(el=jQuery(el),(null!=value?value.toString():void 0)!==(null!=(_ref1=el.val())?_ref1.toString():void 0))return el.val(null!=value?value:"")}else if("select-multiple"===el.type){if(null!=value){for(_results=[],_i=0,_len=el.length;_i<_len;_i++)o=el[_i],_results.push(o.selected=(_ref2=o.value,__indexOf.call(value,_ref2)>=0));return _results}}else if((null!=value?value.toString():void 0)!==(null!=(_ref3=el.value)?_ref3.toString():void 0))return el.value=null!=value?value:""}},Rivets.public.binders.if={block:!0,priority:4e3,bind:function(el){var attr,declaration;if(null==this.marker)return attr=[this.view.prefix,this.type].join("-").replace("--","-"),declaration=el.getAttribute(attr),this.marker=document.createComment(" rivets: "+this.type+" "+declaration+" "),this.bound=!1,el.removeAttribute(attr),el.parentNode.insertBefore(this.marker,el),el.parentNode.removeChild(el)},unbind:function(){if(this.nested)return this.nested.unbind(),this.bound=!1},routine:function(el,value){var key,model,models,_ref1;if(!!value==!this.bound){if(value){models={},_ref1=this.view.models;for(key in _ref1)model=_ref1[key],models[key]=model;return(this.nested||(this.nested=new Rivets.View(el,models,this.view.options()))).bind(),this.marker.parentNode.insertBefore(el,this.marker.nextSibling),this.bound=!0}return el.parentNode.removeChild(el),this.nested.unbind(),this.bound=!1}},update:function(models){var _ref1;return null!=(_ref1=this.nested)?_ref1.update(models):void 0}},Rivets.public.binders.unless={block:!0,priority:4e3,bind:function(el){return Rivets.public.binders.if.bind.call(this,el)},unbind:function(){return Rivets.public.binders.if.unbind.call(this)},routine:function(el,value){return Rivets.public.binders.if.routine.call(this,el,!value)},update:function(models){return Rivets.public.binders.if.update.call(this,models)}},Rivets.public.binders["on-*"]={function:!0,priority:1e3,unbind:function(el){if(this.handler)return Rivets.Util.unbindEvent(el,this.args[0],this.handler)},routine:function(el,value){return this.handler&&Rivets.Util.unbindEvent(el,this.args[0],this.handler),Rivets.Util.bindEvent(el,this.args[0],this.handler=this.eventHandler(value))}},Rivets.public.binders["each-*"]={block:!0,priority:4e3,bind:function(el){var attr,view,_i,_len,_ref1;if(null==this.marker)attr=[this.view.prefix,this.type].join("-").replace("--","-"),this.marker=document.createComment(" rivets: "+this.type+" "),this.iterated=[],el.removeAttribute(attr),el.parentNode.insertBefore(this.marker,el),el.parentNode.removeChild(el);else for(_ref1=this.iterated,_i=0,_len=_ref1.length;_i<_len;_i++)view=_ref1[_i],view.bind()},unbind:function(el){var view,_i,_len,_ref1;if(null!=this.iterated)for(_ref1=this.iterated,_i=0,_len=_ref1.length;_i<_len;_i++)view=_ref1[_i],view.unbind()},routine:function(el,collection){var binding,data,index,key,model,modelName,options,previous,template,view,_i,_j,_k,_len,_len1,_len2,_ref1,_ref2,_ref3;if(modelName=this.args[0],collection=collection||[],this.iterated.length>collection.length)for(_ref1=Array(this.iterated.length-collection.length),_i=0,_len=_ref1.length;_i<_len;_i++)_ref1[_i],view=this.iterated.pop(),view.unbind(),this.marker.parentNode.removeChild(view.els[0]);for(index=_j=0,_len1=collection.length;_j<_len1;index=++_j)if(model=collection[index],data={index:index},data[Rivets.public.iterationAlias(modelName)]=index,data[modelName]=model,null==this.iterated[index]){_ref2=this.view.models;for(key in _ref2)model=_ref2[key],null==data[key]&&(data[key]=model);previous=this.iterated.length?this.iterated[this.iterated.length-1].els[0]:this.marker,options=this.view.options(),options.preloadData=!0,template=el.cloneNode(!0),view=new Rivets.View(template,data,options),view.bind(),this.iterated.push(view),this.marker.parentNode.insertBefore(template,previous.nextSibling)}else this.iterated[index].models[modelName]!==model&&this.iterated[index].update(data);if("OPTION"===el.nodeName)for(_ref3=this.view.bindings,_k=0,_len2=_ref3.length;_k<_len2;_k++)binding=_ref3[_k],binding.el===this.marker.parentNode&&"value"===binding.type&&binding.sync()},update:function(models){var data,key,model,view,_i,_len,_ref1;data={};for(key in models)model=models[key],key!==this.args[0]&&(data[key]=model);for(_ref1=this.iterated,_i=0,_len=_ref1.length;_i<_len;_i++)view=_ref1[_i],view.update(data)}},Rivets.public.binders["class-*"]=function(el,value){var elClass;if(elClass=" "+el.className+" ",!value==(-1!==elClass.indexOf(" "+this.args[0]+" ")))return el.className=value?el.className+" "+this.args[0]:elClass.replace(" "+this.args[0]+" "," ").trim()},Rivets.public.binders["*"]=function(el,value){return null!=value?el.setAttribute(this.type,value):el.removeAttribute(this.type)},Rivets.public.formatters.call=function(){var args,value;return value=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[],value.call.apply(value,[this].concat(__slice.call(args)))},Rivets.public.adapters["."]={id:"_rv",counter:0,weakmap:{},weakReference:function(obj){var id,_base,_name;return obj.hasOwnProperty(this.id)||(id=this.counter++,Object.defineProperty(obj,this.id,{value:id})),(_base=this.weakmap)[_name=obj[this.id]]||(_base[_name]={callbacks:{}})},cleanupWeakReference:function(ref,id){if(!(Object.keys(ref.callbacks).length||ref.pointers&&Object.keys(ref.pointers).length))return delete this.weakmap[id]},stubFunction:function(obj,fn){var map,original,weakmap;return original=obj[fn],map=this.weakReference(obj),weakmap=this.weakmap,obj[fn]=function(){var k,r,response,_i,_len,_ref1,_ref2,_ref3,_ref4;response=original.apply(obj,arguments),_ref1=map.pointers;for(r in _ref1)for(k=_ref1[r],_ref4=null!=(_ref2=null!=(_ref3=weakmap[r])?_ref3.callbacks[k]:void 0)?_ref2:[],_i=0,_len=_ref4.length;_i<_len;_i++)(0,_ref4[_i])();return response}},observeMutations:function(obj,ref,keypath){var fn,functions,map,_base,_i,_len;if(Array.isArray(obj)){if(map=this.weakReference(obj),null==map.pointers)for(map.pointers={},functions=["push","pop","shift","unshift","sort","reverse","splice"],_i=0,_len=functions.length;_i<_len;_i++)fn=functions[_i],this.stubFunction(obj,fn);if(null==(_base=map.pointers)[ref]&&(_base[ref]=[]),__indexOf.call(map.pointers[ref],keypath)<0)return map.pointers[ref].push(keypath)}},unobserveMutations:function(obj,ref,keypath){var idx,map,pointers;if(Array.isArray(obj)&&null!=obj[this.id]&&(map=this.weakmap[obj[this.id]])&&(pointers=map.pointers[ref]))return(idx=pointers.indexOf(keypath))>=0&&pointers.splice(idx,1),pointers.length||delete map.pointers[ref],this.cleanupWeakReference(map,obj[this.id])},observe:function(obj,keypath,callback){var callbacks,desc,value;return callbacks=this.weakReference(obj).callbacks,null==callbacks[keypath]&&(callbacks[keypath]=[],desc=Object.getOwnPropertyDescriptor(obj,keypath),(null!=desc?desc.get:void 0)||(null!=desc?desc.set:void 0)||(value=obj[keypath],Object.defineProperty(obj,keypath,{enumerable:!0,get:function(){return value},set:function(_this){return function(newValue){var cb,map,_i,_len,_ref1;if(newValue!==value&&(_this.unobserveMutations(value,obj[_this.id],keypath),value=newValue,map=_this.weakmap[obj[_this.id]])){if(callbacks=map.callbacks,callbacks[keypath])for(_ref1=callbacks[keypath].slice(),_i=0,_len=_ref1.length;_i<_len;_i++)cb=_ref1[_i],__indexOf.call(callbacks[keypath],cb)>=0&&cb();return _this.observeMutations(newValue,obj[_this.id],keypath)}}}(this)}))),__indexOf.call(callbacks[keypath],callback)<0&&callbacks[keypath].push(callback),this.observeMutations(obj[keypath],obj[this.id],keypath)},unobserve:function(obj,keypath,callback){var callbacks,idx,map;if((map=this.weakmap[obj[this.id]])&&(callbacks=map.callbacks[keypath]))return(idx=callbacks.indexOf(callback))>=0&&(callbacks.splice(idx,1),callbacks.length||(delete map.callbacks[keypath],this.unobserveMutations(obj[keypath],obj[this.id],keypath))),this.cleanupWeakReference(map,obj[this.id])},get:function(obj,keypath){return obj[keypath]},set:function(obj,keypath,value){return obj[keypath]=value}},Rivets.factory=function(sightglass){return Rivets.sightglass=sightglass,Rivets.public._=Rivets,Rivets.public},"object"==typeof("undefined"!=typeof module&&null!==module?module.exports:void 0)?module.exports=Rivets.factory(require("sightglass")):"function"==typeof define&&define.amd?define("rivets",["sightglass"],function(sightglass){return this.rivets=Rivets.factory(sightglass)}):this.rivets=Rivets.factory(sightglass)}.call(this),function(global){var qq=function(element){"use strict";return{hide:function(){return element.style.display="none",this},attach:function(type,fn){return element.addEventListener?element.addEventListener(type,fn,!1):element.attachEvent&&element.attachEvent("on"+type,fn),function(){qq(element).detach(type,fn)}},detach:function(type,fn){return element.removeEventListener?element.removeEventListener(type,fn,!1):element.attachEvent&&element.detachEvent("on"+type,fn),this},contains:function(descendant){return!!descendant&&(element===descendant||(element.contains?element.contains(descendant):!!(8&descendant.compareDocumentPosition(element))))},insertBefore:function(elementB){return elementB.parentNode.insertBefore(element,elementB),this},remove:function(){return element.parentNode.removeChild(element),this},css:function(styles){if(null==element.style)throw new qq.Error("Can't apply style to node as it is not on the HTMLElement prototype chain!");return null!=styles.opacity&&"string"!=typeof element.style.opacity&&void 0!==element.filters&&(styles.filter="alpha(opacity="+Math.round(100*styles.opacity)+")"),qq.extend(element.style,styles),this},hasClass:function(name,considerParent){var re=new RegExp("(^| )"+name+"( |$)");return re.test(element.className)||!(!considerParent||!re.test(element.parentNode.className))},addClass:function(name){return qq(element).hasClass(name)||(element.className+=" "+name),this},removeClass:function(name){var re=new RegExp("(^| )"+name+"( |$)");return element.className=element.className.replace(re," ").replace(/^\s+|\s+$/g,""),this},getByClass:function(className,first){var candidates,result=[];return first&&element.querySelector?element.querySelector("."+className):element.querySelectorAll?element.querySelectorAll("."+className):(candidates=element.getElementsByTagName("*"),qq.each(candidates,function(idx,val){qq(val).hasClass(className)&&result.push(val)}),first?result[0]:result)},getFirstByClass:function(className){return qq(element).getByClass(className,!0)},children:function(){for(var children=[],child=element.firstChild;child;)1===child.nodeType&&children.push(child),child=child.nextSibling;return children},setText:function(text){return element.innerText=text,element.textContent=text,this},clearText:function(){return qq(element).setText("")},hasAttribute:function(attrName){var attrVal;return element.hasAttribute?!!element.hasAttribute(attrName)&&null==/^false$/i.exec(element.getAttribute(attrName)):void 0!==(attrVal=element[attrName])&&null==/^false$/i.exec(attrVal)}}};!function(){"use strict";qq.canvasToBlob=function(canvas,mime,quality){return qq.dataUriToBlob(canvas.toDataURL(mime,quality))},qq.dataUriToBlob=function(dataUri){var arrayBuffer,byteString,intArray,mimeString;return byteString=dataUri.split(",")[0].indexOf("base64")>=0?atob(dataUri.split(",")[1]):decodeURI(dataUri.split(",")[1]),mimeString=dataUri.split(",")[0].split(":")[1].split(";")[0],arrayBuffer=new ArrayBuffer(byteString.length),intArray=new Uint8Array(arrayBuffer),qq.each(byteString,function(idx,character){intArray[idx]=character.charCodeAt(0)}),function(data,mime){var BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,blobBuilder=BlobBuilder&&new BlobBuilder;return blobBuilder?(blobBuilder.append(data),blobBuilder.getBlob(mime)):new Blob([data],{type:mime})}(arrayBuffer,mimeString)},qq.log=function(message,level){window.console&&(level&&"info"!==level?window.console[level]?window.console[level](message):window.console.log("<"+level+"> "+message):window.console.log(message))},qq.isObject=function(variable){return variable&&!variable.nodeType&&"[object Object]"===Object.prototype.toString.call(variable)},qq.isFunction=function(variable){return"function"==typeof variable},qq.isArray=function(value){return"[object Array]"===Object.prototype.toString.call(value)||value&&window.ArrayBuffer&&value.buffer&&value.buffer.constructor===ArrayBuffer},qq.isItemList=function(maybeItemList){return"[object DataTransferItemList]"===Object.prototype.toString.call(maybeItemList)},qq.isNodeList=function(maybeNodeList){return"[object NodeList]"===Object.prototype.toString.call(maybeNodeList)||maybeNodeList.item&&maybeNodeList.namedItem},qq.isString=function(maybeString){return"[object String]"===Object.prototype.toString.call(maybeString)},qq.trimStr=function(string){return String.prototype.trim?string.trim():string.replace(/^\s+|\s+$/g,"")},qq.format=function(str){var args=Array.prototype.slice.call(arguments,1),newStr=str,nextIdxToReplace=newStr.indexOf("{}");return qq.each(args,function(idx,val){var strBefore=newStr.substring(0,nextIdxToReplace),strAfter=newStr.substring(nextIdxToReplace+2);if(newStr=strBefore+val+strAfter,(nextIdxToReplace=newStr.indexOf("{}",nextIdxToReplace+val.length))<0)return!1}),newStr},qq.isFile=function(maybeFile){return window.File&&"[object File]"===Object.prototype.toString.call(maybeFile)},qq.isFileList=function(maybeFileList){return window.FileList&&"[object FileList]"===Object.prototype.toString.call(maybeFileList)},qq.isFileOrInput=function(maybeFileOrInput){return qq.isFile(maybeFileOrInput)||qq.isInput(maybeFileOrInput)},qq.isInput=function(maybeInput,notFile){var evaluateType=function(type){var normalizedType=type.toLowerCase();return notFile?"file"!==normalizedType:"file"===normalizedType};return!!(window.HTMLInputElement&&"[object HTMLInputElement]"===Object.prototype.toString.call(maybeInput)&&maybeInput.type&&evaluateType(maybeInput.type))||!!(maybeInput.tagName&&"input"===maybeInput.tagName.toLowerCase()&&maybeInput.type&&evaluateType(maybeInput.type))},qq.isBlob=function(maybeBlob){if(window.Blob&&"[object Blob]"===Object.prototype.toString.call(maybeBlob))return!0},qq.isXhrUploadSupported=function(){var input=document.createElement("input");return input.type="file",void 0!==input.multiple&&"undefined"!=typeof File&&"undefined"!=typeof FormData&&void 0!==qq.createXhrInstance().upload},qq.createXhrInstance=function(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(error){return qq.log("Neither XHR or ActiveX are supported!","error"),null}},qq.isFolderDropSupported=function(dataTransfer){return dataTransfer.items&&dataTransfer.items.length>0&&dataTransfer.items[0].webkitGetAsEntry},qq.isFileChunkingSupported=function(){return!qq.androidStock()&&qq.isXhrUploadSupported()&&(void 0!==File.prototype.slice||void 0!==File.prototype.webkitSlice||void 0!==File.prototype.mozSlice)},qq.sliceBlob=function(fileOrBlob,start,end){return(fileOrBlob.slice||fileOrBlob.mozSlice||fileOrBlob.webkitSlice).call(fileOrBlob,start,end)},qq.arrayBufferToHex=function(buffer){var bytesAsHex="",bytes=new Uint8Array(buffer);return qq.each(bytes,function(idx,byt){var byteAsHexStr=byt.toString(16);byteAsHexStr.length<2&&(byteAsHexStr="0"+byteAsHexStr),bytesAsHex+=byteAsHexStr}),bytesAsHex},qq.readBlobToHex=function(blob,startOffset,length){var initialBlob=qq.sliceBlob(blob,startOffset,startOffset+length),fileReader=new FileReader,promise=new qq.Promise;return fileReader.onload=function(){promise.success(qq.arrayBufferToHex(fileReader.result))},fileReader.onerror=promise.failure,fileReader.readAsArrayBuffer(initialBlob),promise},qq.extend=function(first,second,extendNested){return qq.each(second,function(prop,val){extendNested&&qq.isObject(val)?(void 0===first[prop]&&(first[prop]={}),qq.extend(first[prop],val,!0)):first[prop]=val}),first},qq.override=function(target,sourceFn){var super_={},source=sourceFn(super_);return qq.each(source,function(srcPropName,srcPropVal){void 0!==target[srcPropName]&&(super_[srcPropName]=target[srcPropName]),target[srcPropName]=srcPropVal}),target},qq.indexOf=function(arr,elt,from){if(arr.indexOf)return arr.indexOf(elt,from);from=from||0;var len=arr.length;for(from<0&&(from+=len);from<len;from+=1)if(arr.hasOwnProperty(from)&&arr[from]===elt)return from;return-1},qq.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=16*Math.random()|0;return("x"==c?r:3&r|8).toString(16)})},qq.ie=function(){return-1!==navigator.userAgent.indexOf("MSIE")||-1!==navigator.userAgent.indexOf("Trident")},qq.ie7=function(){return-1!==navigator.userAgent.indexOf("MSIE 7")},qq.ie8=function(){return-1!==navigator.userAgent.indexOf("MSIE 8")},qq.ie10=function(){return-1!==navigator.userAgent.indexOf("MSIE 10")},qq.ie11=function(){return qq.ie()&&-1!==navigator.userAgent.indexOf("rv:11")},qq.edge=function(){return navigator.userAgent.indexOf("Edge")>=0},qq.safari=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Apple")},qq.chrome=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Google")},qq.opera=function(){return void 0!==navigator.vendor&&-1!==navigator.vendor.indexOf("Opera")},qq.firefox=function(){return!qq.edge()&&!qq.ie11()&&-1!==navigator.userAgent.indexOf("Mozilla")&&void 0!==navigator.vendor&&""===navigator.vendor},qq.windows=function(){return"Win32"===navigator.platform},qq.android=function(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")},qq.androidStock=function(){return qq.android()&&navigator.userAgent.toLowerCase().indexOf("chrome")<0},qq.ios6=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 6_")},qq.ios7=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 7_")},qq.ios8=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 8_")},qq.ios800=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf(" OS 8_0 ")},qq.ios=function(){return-1!==navigator.userAgent.indexOf("iPad")||-1!==navigator.userAgent.indexOf("iPod")||-1!==navigator.userAgent.indexOf("iPhone")},qq.iosChrome=function(){return qq.ios()&&-1!==navigator.userAgent.indexOf("CriOS")},qq.iosSafari=function(){
return qq.ios()&&!qq.iosChrome()&&-1!==navigator.userAgent.indexOf("Safari")},qq.iosSafariWebView=function(){return qq.ios()&&!qq.iosChrome()&&!qq.iosSafari()},qq.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},qq.toElement=function(){var div=document.createElement("div");return function(html){div.innerHTML=html;var element=div.firstChild;return div.removeChild(element),element}}(),qq.each=function(iterableItem,callback){var keyOrIndex;if(iterableItem)if(window.Storage&&iterableItem.constructor===window.Storage)for(keyOrIndex=0;keyOrIndex<iterableItem.length&&!1!==callback(iterableItem.key(keyOrIndex),iterableItem.getItem(iterableItem.key(keyOrIndex)));keyOrIndex++);else if(qq.isArray(iterableItem)||qq.isItemList(iterableItem)||qq.isNodeList(iterableItem))for(keyOrIndex=0;keyOrIndex<iterableItem.length&&!1!==callback(keyOrIndex,iterableItem[keyOrIndex]);keyOrIndex++);else if(qq.isString(iterableItem))for(keyOrIndex=0;keyOrIndex<iterableItem.length&&!1!==callback(keyOrIndex,iterableItem.charAt(keyOrIndex));keyOrIndex++);else for(keyOrIndex in iterableItem)if(Object.prototype.hasOwnProperty.call(iterableItem,keyOrIndex)&&!1===callback(keyOrIndex,iterableItem[keyOrIndex]))break},qq.bind=function(oldFunc,context){if(qq.isFunction(oldFunc)){var args=Array.prototype.slice.call(arguments,2);return function(){var newArgs=qq.extend([],args);return arguments.length&&(newArgs=newArgs.concat(Array.prototype.slice.call(arguments))),oldFunc.apply(context,newArgs)}}throw new Error("first parameter must be a function!")},qq.obj2url=function(obj,temp,prefixDone){var uristrings=[],prefix="&",add=function(nextObj,i){var nextTemp=temp?/\[\]$/.test(temp)?temp:temp+"["+i+"]":i;"undefined"!==nextTemp&&"undefined"!==i&&uristrings.push("object"==typeof nextObj?qq.obj2url(nextObj,nextTemp,!0):"[object Function]"===Object.prototype.toString.call(nextObj)?encodeURIComponent(nextTemp)+"="+encodeURIComponent(nextObj()):encodeURIComponent(nextTemp)+"="+encodeURIComponent(nextObj))};return!prefixDone&&temp?(prefix=/\?/.test(temp)?/\?$/.test(temp)?"":"&":"?",uristrings.push(temp),uristrings.push(qq.obj2url(obj))):"[object Array]"===Object.prototype.toString.call(obj)&&void 0!==obj?qq.each(obj,function(idx,val){add(val,idx)}):void 0!==obj&&null!==obj&&"object"==typeof obj?qq.each(obj,function(prop,val){add(val,prop)}):uristrings.push(encodeURIComponent(temp)+"="+encodeURIComponent(obj)),temp?uristrings.join(prefix):uristrings.join(prefix).replace(/^&/,"").replace(/%20/g,"+")},qq.obj2FormData=function(obj,formData,arrayKeyName){return formData||(formData=new FormData),qq.each(obj,function(key,val){key=arrayKeyName?arrayKeyName+"["+key+"]":key,qq.isObject(val)?qq.obj2FormData(val,formData,key):qq.isFunction(val)?formData.append(key,val()):formData.append(key,val)}),formData},qq.obj2Inputs=function(obj,form){var input;return form||(form=document.createElement("form")),qq.obj2FormData(obj,{append:function(key,val){input=document.createElement("input"),input.setAttribute("name",key),input.setAttribute("value",val),form.appendChild(input)}}),form},qq.parseJson=function(json){return window.JSON&&qq.isFunction(JSON.parse)?JSON.parse(json):eval("("+json+")")},qq.getExtension=function(filename){var extIdx=filename.lastIndexOf(".")+1;if(extIdx>0)return filename.substr(extIdx,filename.length-extIdx)},qq.getFilename=function(blobOrFileInput){return qq.isInput(blobOrFileInput)?blobOrFileInput.value.replace(/.*(\/|\\)/,""):qq.isFile(blobOrFileInput)&&null!==blobOrFileInput.fileName&&void 0!==blobOrFileInput.fileName?blobOrFileInput.fileName:blobOrFileInput.name},qq.DisposeSupport=function(){var disposers=[];return{dispose:function(){var disposer;do{(disposer=disposers.shift())&&disposer()}while(disposer)},attach:function(){var args=arguments;this.addDisposer(qq(args[0]).attach.apply(this,Array.prototype.slice.call(arguments,1)))},addDisposer:function(disposeFunction){disposers.push(disposeFunction)}}}}(),function(){"use strict";"function"==typeof define&&define.amd?define("fine-uploader",[],function(){return qq}):"undefined"!=typeof module&&module.exports?module.exports=qq:global.qq=qq}(),function(){"use strict";qq.Error=function(message){this.message="[Fine Uploader "+qq.version+"] "+message},qq.Error.prototype=new Error}(),qq.version="5.13.0",qq.supportedFeatures=function(){"use strict";function isCrossOriginXhrSupported(){if(window.XMLHttpRequest){return void 0!==qq.createXhrInstance().withCredentials}return!1}function isXdrSupported(){return void 0!==window.XDomainRequest}var supportsUploading,supportsUploadingBlobs,supportsFileDrop,supportsAjaxFileUploading,supportsFolderDrop,supportsChunking,supportsResume,supportsUploadViaPaste,supportsUploadCors,supportsDeleteFileXdr,supportsDeleteFileCorsXhr,supportsDeleteFileCors,supportsFolderSelection,supportsImagePreviews,supportsUploadProgress;return supportsUploading=function(){var tempInput,supported=!0;try{tempInput=document.createElement("input"),tempInput.type="file",qq(tempInput).hide(),tempInput.disabled&&(supported=!1)}catch(ex){supported=!1}return supported}(),supportsAjaxFileUploading=supportsUploading&&qq.isXhrUploadSupported(),supportsUploadingBlobs=supportsAjaxFileUploading&&!qq.androidStock(),supportsFileDrop=supportsAjaxFileUploading&&function(){var span=document.createElement("span");return("draggable"in span||"ondragstart"in span&&"ondrop"in span)&&!qq.android()&&!qq.ios()}(),supportsFolderDrop=supportsFileDrop&&function(){return(qq.chrome()||qq.opera())&&void 0!==navigator.userAgent.match(/Chrome\/[2][1-9]|Chrome\/[3-9][0-9]/)}(),supportsChunking=supportsAjaxFileUploading&&qq.isFileChunkingSupported(),supportsResume=supportsAjaxFileUploading&&supportsChunking&&function(){try{return!!window.localStorage&&qq.isFunction(window.localStorage.setItem)}catch(error){return!1}}(),supportsUploadViaPaste=supportsAjaxFileUploading&&function(){return(qq.chrome()||qq.opera())&&void 0!==navigator.userAgent.match(/Chrome\/[1][4-9]|Chrome\/[2-9][0-9]/)}(),supportsUploadCors=supportsUploading&&(void 0!==window.postMessage||supportsAjaxFileUploading),supportsDeleteFileCorsXhr=isCrossOriginXhrSupported(),supportsDeleteFileXdr=isXdrSupported(),supportsDeleteFileCors=function(){return!!isCrossOriginXhrSupported()||isXdrSupported()}(),supportsFolderSelection=function(){return void 0!==document.createElement("input").webkitdirectory}(),supportsImagePreviews=supportsAjaxFileUploading&&void 0!==window.FileReader,supportsUploadProgress=function(){return!!supportsAjaxFileUploading&&(!qq.androidStock()&&!qq.iosChrome())}(),{ajaxUploading:supportsAjaxFileUploading,blobUploading:supportsUploadingBlobs,canDetermineSize:supportsAjaxFileUploading,chunking:supportsChunking,deleteFileCors:supportsDeleteFileCors,deleteFileCorsXdr:supportsDeleteFileXdr,deleteFileCorsXhr:supportsDeleteFileCorsXhr,dialogElement:!!window.HTMLDialogElement,fileDrop:supportsFileDrop,folderDrop:supportsFolderDrop,folderSelection:supportsFolderSelection,imagePreviews:supportsImagePreviews,imageValidation:supportsImagePreviews,itemSizeValidation:supportsAjaxFileUploading,pause:supportsChunking,progressBar:supportsUploadProgress,resume:supportsResume,scaling:supportsImagePreviews&&supportsUploadingBlobs,tiffPreviews:qq.safari(),unlimitedScaledImageSize:!qq.ios(),uploading:supportsUploading,uploadCors:supportsUploadCors,uploadCustomHeaders:supportsAjaxFileUploading,uploadNonMultipart:supportsAjaxFileUploading,uploadViaPaste:supportsUploadViaPaste}}(),qq.isGenericPromise=function(maybePromise){"use strict";return!!(maybePromise&&maybePromise.then&&qq.isFunction(maybePromise.then))},qq.Promise=function(){"use strict";var successArgs,failureArgs,successCallbacks=[],failureCallbacks=[],doneCallbacks=[],state=0;qq.extend(this,{then:function(onSuccess,onFailure){return 0===state?(onSuccess&&successCallbacks.push(onSuccess),onFailure&&failureCallbacks.push(onFailure)):-1===state?onFailure&&onFailure.apply(null,failureArgs):onSuccess&&onSuccess.apply(null,successArgs),this},done:function(callback){return 0===state?doneCallbacks.push(callback):callback.apply(null,void 0===failureArgs?successArgs:failureArgs),this},success:function(){return state=1,successArgs=arguments,successCallbacks.length&&qq.each(successCallbacks,function(idx,callback){callback.apply(null,successArgs)}),doneCallbacks.length&&qq.each(doneCallbacks,function(idx,callback){callback.apply(null,successArgs)}),this},failure:function(){return state=-1,failureArgs=arguments,failureCallbacks.length&&qq.each(failureCallbacks,function(idx,callback){callback.apply(null,failureArgs)}),doneCallbacks.length&&qq.each(doneCallbacks,function(idx,callback){callback.apply(null,failureArgs)}),this}})},qq.BlobProxy=function(referenceBlob,onCreate){"use strict";qq.extend(this,{referenceBlob:referenceBlob,create:function(){return onCreate(referenceBlob)}})},qq.UploadButton=function(o){"use strict";function createInput(){var input=document.createElement("input");return input.setAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME,buttonId),input.setAttribute("title",options.title),self.setMultiple(options.multiple,input),options.folders&&qq.supportedFeatures.folderSelection&&input.setAttribute("webkitdirectory",""),options.acceptFiles&&input.setAttribute("accept",options.acceptFiles),input.setAttribute("type","file"),input.setAttribute("name",options.name),qq(input).css({position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:qq.ie()&&!qq.ie8()?"3500px":"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),!qq.ie7()&&qq(input).css({height:"100%"}),options.element.appendChild(input),disposeSupport.attach(input,"change",function(){options.onChange(input)}),disposeSupport.attach(input,"mouseover",function(){qq(options.element).addClass(options.hoverClass)}),disposeSupport.attach(input,"mouseout",function(){qq(options.element).removeClass(options.hoverClass)}),disposeSupport.attach(input,"focus",function(){qq(options.element).addClass(options.focusClass)}),disposeSupport.attach(input,"blur",function(){qq(options.element).removeClass(options.focusClass)}),input}var input,buttonId,self=this,disposeSupport=new qq.DisposeSupport,options={acceptFiles:null,element:null,focusClass:"qq-upload-button-focus",folders:!1,hoverClass:"qq-upload-button-hover",ios8BrowserCrashWorkaround:!1,multiple:!1,name:"qqfile",onChange:function(input){},title:null};qq.extend(options,o),buttonId=qq.getUniqueId(),qq(options.element).css({position:"relative",overflow:"hidden",direction:"ltr"}),qq.extend(this,{getInput:function(){return input},getButtonId:function(){return buttonId},setMultiple:function(isMultiple,optInput){var input=optInput||this.getInput();options.ios8BrowserCrashWorkaround&&qq.ios8()&&(qq.iosChrome()||qq.iosSafariWebView())?input.setAttribute("multiple",""):isMultiple?input.setAttribute("multiple",""):input.removeAttribute("multiple")},setAcceptFiles:function(acceptFiles){acceptFiles!==options.acceptFiles&&input.setAttribute("accept",acceptFiles)},reset:function(){input.parentNode&&qq(input).remove(),qq(options.element).removeClass(options.focusClass),input=null,input=createInput()}}),input=createInput()},qq.UploadButton.BUTTON_ID_ATTR_NAME="qq-button-id",qq.UploadData=function(uploaderProxy){"use strict";function getDataByIds(idOrIds){if(qq.isArray(idOrIds)){var entries=[];return qq.each(idOrIds,function(idx,id){entries.push(data[id])}),entries}return data[idOrIds]}function getDataByUuids(uuids){if(qq.isArray(uuids)){var entries=[];return qq.each(uuids,function(idx,uuid){entries.push(data[byUuid[uuid]])}),entries}return data[byUuid[uuids]]}function getDataByStatus(status){var statusResults=[],statuses=[].concat(status);return qq.each(statuses,function(index,statusEnum){var statusResultIndexes=byStatus[statusEnum];void 0!==statusResultIndexes&&qq.each(statusResultIndexes,function(i,dataIndex){statusResults.push(data[dataIndex])})}),statusResults}var data=[],byUuid={},byStatus={},byProxyGroupId={},byBatchId={};qq.extend(this,{addFile:function(spec){var status=spec.status||qq.status.SUBMITTING,id=data.push({name:spec.name,originalName:spec.name,uuid:spec.uuid,size:null==spec.size?-1:spec.size,status:status})-1;return spec.batchId&&(data[id].batchId=spec.batchId,void 0===byBatchId[spec.batchId]&&(byBatchId[spec.batchId]=[]),byBatchId[spec.batchId].push(id)),spec.proxyGroupId&&(data[id].proxyGroupId=spec.proxyGroupId,void 0===byProxyGroupId[spec.proxyGroupId]&&(byProxyGroupId[spec.proxyGroupId]=[]),byProxyGroupId[spec.proxyGroupId].push(id)),data[id].id=id,byUuid[spec.uuid]=id,void 0===byStatus[status]&&(byStatus[status]=[]),byStatus[status].push(id),uploaderProxy.onStatusChange(id,null,status),id},retrieve:function(optionalFilter){return qq.isObject(optionalFilter)&&data.length?void 0!==optionalFilter.id?getDataByIds(optionalFilter.id):void 0!==optionalFilter.uuid?getDataByUuids(optionalFilter.uuid):optionalFilter.status?getDataByStatus(optionalFilter.status):void 0:qq.extend([],data,!0)},reset:function(){data=[],byUuid={},byStatus={},byBatchId={}},setStatus:function(id,newStatus){var oldStatus=data[id].status,byStatusOldStatusIndex=qq.indexOf(byStatus[oldStatus],id);byStatus[oldStatus].splice(byStatusOldStatusIndex,1),data[id].status=newStatus,void 0===byStatus[newStatus]&&(byStatus[newStatus]=[]),byStatus[newStatus].push(id),uploaderProxy.onStatusChange(id,oldStatus,newStatus)},uuidChanged:function(id,newUuid){var oldUuid=data[id].uuid;data[id].uuid=newUuid,byUuid[newUuid]=id,delete byUuid[oldUuid]},updateName:function(id,newName){data[id].name=newName},updateSize:function(id,newSize){data[id].size=newSize},setParentId:function(targetId,parentId){data[targetId].parentId=parentId},getIdsInProxyGroup:function(id){var proxyGroupId=data[id].proxyGroupId;return proxyGroupId?byProxyGroupId[proxyGroupId]:[]},getIdsInBatch:function(id){var batchId=data[id].batchId;return byBatchId[batchId]}})},qq.status={SUBMITTING:"submitting",SUBMITTED:"submitted",REJECTED:"rejected",QUEUED:"queued",CANCELED:"canceled",PAUSED:"paused",UPLOADING:"uploading",UPLOAD_RETRYING:"retrying upload",UPLOAD_SUCCESSFUL:"upload successful",UPLOAD_FAILED:"upload failed",DELETE_FAILED:"delete failed",DELETING:"deleting",DELETED:"deleted"},function(){"use strict";qq.basePublicApi={addBlobs:function(blobDataOrArray,params,endpoint){this.addFiles(blobDataOrArray,params,endpoint)},addInitialFiles:function(cannedFileList){var self=this;qq.each(cannedFileList,function(index,cannedFile){self._addCannedFile(cannedFile)})},addFiles:function(data,params,endpoint){this._maybeHandleIos8SafariWorkaround();var batchId=0===this._storedIds.length?qq.getUniqueId():this._currentBatchId,processBlob=qq.bind(function(blob){this._handleNewFile({blob:blob,name:this._options.blobs.defaultName},batchId,verifiedFiles)},this),processBlobData=qq.bind(function(blobData){this._handleNewFile(blobData,batchId,verifiedFiles)},this),processCanvas=qq.bind(function(canvas){var blob=qq.canvasToBlob(canvas);this._handleNewFile({blob:blob,name:this._options.blobs.defaultName+".png"},batchId,verifiedFiles)},this),processCanvasData=qq.bind(function(canvasData){var normalizedQuality=canvasData.quality&&canvasData.quality/100,blob=qq.canvasToBlob(canvasData.canvas,canvasData.type,normalizedQuality);this._handleNewFile({blob:blob,name:canvasData.name},batchId,verifiedFiles)},this),processFileOrInput=qq.bind(function(fileOrInput){if(qq.isInput(fileOrInput)&&qq.supportedFeatures.ajaxUploading){var files=Array.prototype.slice.call(fileOrInput.files),self=this;qq.each(files,function(idx,file){self._handleNewFile(file,batchId,verifiedFiles)})}else this._handleNewFile(fileOrInput,batchId,verifiedFiles)},this),self=this,verifiedFiles=[];this._currentBatchId=batchId,data&&(!function(){qq.isFileList(data)&&(data=Array.prototype.slice.call(data)),data=[].concat(data)}(),qq.each(data,function(idx,fileContainer){qq.isFileOrInput(fileContainer)?processFileOrInput(fileContainer):qq.isBlob(fileContainer)?processBlob(fileContainer):qq.isObject(fileContainer)?fileContainer.blob&&fileContainer.name?processBlobData(fileContainer):fileContainer.canvas&&fileContainer.name&&processCanvasData(fileContainer):fileContainer.tagName&&"canvas"===fileContainer.tagName.toLowerCase()?processCanvas(fileContainer):self.log(fileContainer+" is not a valid file container!  Ignoring!","warn")}),this.log("Received "+verifiedFiles.length+" files."),this._prepareItemsForUpload(verifiedFiles,params,endpoint))},cancel:function(id){this._handler.cancel(id)},cancelAll:function(){var storedIdsCopy=[],self=this;qq.extend(storedIdsCopy,this._storedIds),qq.each(storedIdsCopy,function(idx,storedFileId){self.cancel(storedFileId)}),this._handler.cancelAll()},clearStoredFiles:function(){this._storedIds=[]},continueUpload:function(id){var uploadData=this._uploadData.retrieve({id:id});return!(!qq.supportedFeatures.pause||!this._options.chunking.enabled)&&(uploadData.status===qq.status.PAUSED?(this.log(qq.format("Paused file ID {} ({}) will be continued.  Not paused.",id,this.getName(id))),this._uploadFile(id),!0):(this.log(qq.format("Ignoring continue for file ID {} ({}).  Not paused.",id,this.getName(id)),"error"),!1))},deleteFile:function(id){return this._onSubmitDelete(id)},doesExist:function(fileOrBlobId){return this._handler.isValid(fileOrBlobId)},drawThumbnail:function(fileId,imgOrCanvas,maxSize,fromServer,customResizeFunction){var fileOrUrl,options,promiseToReturn=new qq.Promise;return this._imageGenerator?(fileOrUrl=this._thumbnailUrls[fileId],options={customResizeFunction:customResizeFunction,maxSize:maxSize>0?maxSize:null,scale:maxSize>0},!fromServer&&qq.supportedFeatures.imagePreviews&&(fileOrUrl=this.getFile(fileId)),null==fileOrUrl?promiseToReturn.failure({container:imgOrCanvas,error:"File or URL not found."}):this._imageGenerator.generate(fileOrUrl,imgOrCanvas,options).then(function(modifiedContainer){promiseToReturn.success(modifiedContainer)},function(container,reason){promiseToReturn.failure({container:container,error:reason||"Problem generating thumbnail"})})):promiseToReturn.failure({container:imgOrCanvas,error:"Missing image generator module"}),promiseToReturn},getButton:function(fileId){return this._getButton(this._buttonIdsForFileIds[fileId])},getEndpoint:function(fileId){return this._endpointStore.get(fileId)},getFile:function(fileOrBlobId){return this._handler.getFile(fileOrBlobId)||null},getInProgress:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED]}).length},getName:function(id){return this._uploadData.retrieve({id:id}).name},getParentId:function(id){var uploadDataEntry=this.getUploads({id:id}),parentId=null;return uploadDataEntry&&void 0!==uploadDataEntry.parentId&&(parentId=uploadDataEntry.parentId),parentId},getResumableFilesData:function(){return this._handler.getResumableFilesData()},getSize:function(id){return this._uploadData.retrieve({id:id}).size},getNetUploads:function(){return this._netUploaded},getRemainingAllowedItems:function(){var allowedItems=this._currentItemLimit;return allowedItems>0?allowedItems-this._netUploadedOrQueued:null},getUploads:function(optionalFilter){return this._uploadData.retrieve(optionalFilter)},getUuid:function(id){return this._uploadData.retrieve({id:id}).uuid},log:function(str,level){!this._options.debug||level&&"info"!==level?level&&"info"!==level&&qq.log("[Fine Uploader "+qq.version+"] "+str,level):qq.log("[Fine Uploader "+qq.version+"] "+str)},pauseUpload:function(id){var uploadData=this._uploadData.retrieve({id:id});if(!qq.supportedFeatures.pause||!this._options.chunking.enabled)return!1;if(qq.indexOf([qq.status.UPLOADING,qq.status.UPLOAD_RETRYING],uploadData.status)>=0){if(this._handler.pause(id))return this._uploadData.setStatus(id,qq.status.PAUSED),!0;this.log(qq.format("Unable to pause file ID {} ({}).",id,this.getName(id)),"error")}else this.log(qq.format("Ignoring pause for file ID {} ({}).  Not in progress.",id,this.getName(id)),"error");return!1},reset:function(){this.log("Resetting uploader..."),this._handler.reset(),this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._thumbnailUrls=[],qq.each(this._buttons,function(idx,button){button.reset()}),this._paramsStore.reset(),this._endpointStore.reset(),this._netUploadedOrQueued=0,this._netUploaded=0,this._uploadData.reset(),this._buttonIdsForFileIds=[],this._pasteHandler&&this._pasteHandler.reset(),this._options.session.refreshOnReset&&this._refreshSessionData(),this._succeededSinceLastAllComplete=[],this._failedSinceLastAllComplete=[],this._totalProgress&&this._totalProgress.reset()},retry:function(id){return this._manualRetry(id)},scaleImage:function(id,specs){var self=this;return qq.Scaler.prototype.scaleImage(id,specs,{log:qq.bind(self.log,self),getFile:qq.bind(self.getFile,self),uploadData:self._uploadData})},setCustomHeaders:function(headers,id){this._customHeadersStore.set(headers,id)},setDeleteFileCustomHeaders:function(headers,id){this._deleteFileCustomHeadersStore.set(headers,id)},setDeleteFileEndpoint:function(endpoint,id){this._deleteFileEndpointStore.set(endpoint,id)},setDeleteFileParams:function(params,id){this._deleteFileParamsStore.set(params,id)},setEndpoint:function(endpoint,id){this._endpointStore.set(endpoint,id)},setForm:function(elementOrId){this._updateFormSupportAndParams(elementOrId)},setItemLimit:function(newItemLimit){this._currentItemLimit=newItemLimit},setName:function(id,newName){this._uploadData.updateName(id,newName)},setParams:function(params,id){this._paramsStore.set(params,id)},setUuid:function(id,newUuid){return this._uploadData.uuidChanged(id,newUuid)},uploadStoredFiles:function(){0===this._storedIds.length?this._itemError("noFilesError"):this._uploadStoredFiles()}},qq.basePrivateApi={_addCannedFile:function(sessionData){var id=this._uploadData.addFile({uuid:sessionData.uuid,name:sessionData.name,size:sessionData.size,status:qq.status.UPLOAD_SUCCESSFUL});return sessionData.deleteFileEndpoint&&this.setDeleteFileEndpoint(sessionData.deleteFileEndpoint,id),sessionData.deleteFileParams&&this.setDeleteFileParams(sessionData.deleteFileParams,id),sessionData.thumbnailUrl&&(this._thumbnailUrls[id]=sessionData.thumbnailUrl),this._netUploaded++,this._netUploadedOrQueued++,id},_annotateWithButtonId:function(file,associatedInput){qq.isFile(file)&&(file.qqButtonId=this._getButtonId(associatedInput))},_batchError:function(message){this._options.callbacks.onError(null,null,message,void 0)},_createDeleteHandler:function(){var self=this;return new qq.DeleteFileAjaxRequester({method:this._options.deleteFile.method.toUpperCase(),maxConnections:this._options.maxConnections,uuidParamName:this._options.request.uuidName,customHeaders:this._deleteFileCustomHeadersStore,paramsStore:this._deleteFileParamsStore,endpointStore:this._deleteFileEndpointStore,cors:this._options.cors,log:qq.bind(self.log,self),onDelete:function(id){self._onDelete(id),self._options.callbacks.onDelete(id)},onDeleteComplete:function(id,xhrOrXdr,isError){self._onDeleteComplete(id,xhrOrXdr,isError),self._options.callbacks.onDeleteComplete(id,xhrOrXdr,isError)}})},_createPasteHandler:function(){var self=this;return new qq.PasteSupport({targetElement:this._options.paste.targetElement,callbacks:{log:qq.bind(self.log,self),pasteReceived:function(blob){self._handleCheckedCallback({name:"onPasteReceived",callback:qq.bind(self._options.callbacks.onPasteReceived,self,blob),onSuccess:qq.bind(self._handlePasteSuccess,self,blob),identifier:"pasted image"})}}})},_createStore:function(initialValue,_readOnlyValues_){var store={},catchall=initialValue,perIdReadOnlyValues={},readOnlyValues=_readOnlyValues_,copy=function(orig){return qq.isObject(orig)?qq.extend({},orig):orig},getReadOnlyValues=function(){return qq.isFunction(readOnlyValues)?readOnlyValues():readOnlyValues},includeReadOnlyValues=function(id,existing){readOnlyValues&&qq.isObject(existing)&&qq.extend(existing,getReadOnlyValues()),perIdReadOnlyValues[id]&&qq.extend(existing,perIdReadOnlyValues[id])};return{set:function(val,id){null==id?(store={},catchall=copy(val)):store[id]=copy(val)},get:function(id){var values;return values=null!=id&&store[id]?store[id]:copy(catchall),includeReadOnlyValues(id,values),copy(values)},addReadOnly:function(id,values){qq.isObject(store)&&(null===id?qq.isFunction(values)?readOnlyValues=values:(readOnlyValues=readOnlyValues||{},qq.extend(readOnlyValues,values)):(perIdReadOnlyValues[id]=perIdReadOnlyValues[id]||{},qq.extend(perIdReadOnlyValues[id],values)))},remove:function(fileId){return delete store[fileId]},reset:function(){store={},perIdReadOnlyValues={},catchall=initialValue}}},_createUploadDataTracker:function(){var self=this;return new qq.UploadData({getName:function(id){return self.getName(id)},getUuid:function(id){return self.getUuid(id)},getSize:function(id){return self.getSize(id)},onStatusChange:function(id,oldStatus,newStatus){self._onUploadStatusChange(id,oldStatus,newStatus),self._options.callbacks.onStatusChange(id,oldStatus,newStatus),self._maybeAllComplete(id,newStatus),self._totalProgress&&setTimeout(function(){self._totalProgress.onStatusChange(id,oldStatus,newStatus)},0)}})},_createUploadButton:function(spec){var button,self=this,acceptFiles=spec.accept||this._options.validation.acceptFiles,allowedExtensions=spec.allowedExtensions||this._options.validation.allowedExtensions;return button=new qq.UploadButton({acceptFiles:acceptFiles,element:spec.element,focusClass:this._options.classes.buttonFocus,folders:spec.folders,hoverClass:this._options.classes.buttonHover,ios8BrowserCrashWorkaround:this._options.workarounds.ios8BrowserCrash,multiple:function(){return!!qq.supportedFeatures.ajaxUploading&&(!(self._options.workarounds.iosEmptyVideos&&qq.ios()&&!qq.ios6()&&self._isAllowedExtension(allowedExtensions,".mov"))&&(void 0===spec.multiple?self._options.multiple:spec.multiple))}(),name:this._options.request.inputName,onChange:function(input){self._onInputChange(input)},title:null==spec.title?this._options.text.fileInputTitle:spec.title}),this._disposeSupport.addDisposer(function(){button.dispose()}),self._buttons.push(button),button},_createUploadHandler:function(additionalOptions,namespace){var self=this,lastOnProgress={},options={debug:this._options.debug,maxConnections:this._options.maxConnections,cors:this._options.cors,paramsStore:this._paramsStore,endpointStore:this._endpointStore,chunking:this._options.chunking,resume:this._options.resume,blobs:this._options.blobs,log:qq.bind(self.log,self),preventRetryParam:this._options.retry.preventRetryResponseProperty,onProgress:function(id,name,loaded,total){loaded<0||total<0||(lastOnProgress[id]?lastOnProgress[id].loaded===loaded&&lastOnProgress[id].total===total||(self._onProgress(id,name,loaded,total),self._options.callbacks.onProgress(id,name,loaded,total)):(self._onProgress(id,name,loaded,total),self._options.callbacks.onProgress(id,name,loaded,total)),lastOnProgress[id]={loaded:loaded,total:total})},onComplete:function(id,name,result,xhr){delete lastOnProgress[id];var retVal,status=self.getUploads({id:id}).status;status!==qq.status.UPLOAD_SUCCESSFUL&&status!==qq.status.UPLOAD_FAILED&&(retVal=self._onComplete(id,name,result,xhr),retVal instanceof qq.Promise?retVal.done(function(){self._options.callbacks.onComplete(id,name,result,xhr)}):self._options.callbacks.onComplete(id,name,result,xhr))},onCancel:function(id,name,cancelFinalizationEffort){var promise=new qq.Promise;return self._handleCheckedCallback({name:"onCancel",callback:qq.bind(self._options.callbacks.onCancel,self,id,name),onFailure:promise.failure,onSuccess:function(){cancelFinalizationEffort.then(function(){self._onCancel(id,name)}),promise.success()},identifier:id}),promise},onUploadPrep:qq.bind(this._onUploadPrep,this),onUpload:function(id,name){self._onUpload(id,name),self._options.callbacks.onUpload(id,name)},onUploadChunk:function(id,name,chunkData){self._onUploadChunk(id,chunkData),self._options.callbacks.onUploadChunk(id,name,chunkData)},onUploadChunkSuccess:function(id,chunkData,result,xhr){self._options.callbacks.onUploadChunkSuccess.apply(self,arguments)},onResume:function(id,name,chunkData){return self._options.callbacks.onResume(id,name,chunkData)},onAutoRetry:function(id,name,responseJSON,xhr){return self._onAutoRetry.apply(self,arguments)},onUuidChanged:function(id,newUuid){self.log("Server requested UUID change from '"+self.getUuid(id)+"' to '"+newUuid+"'"),self.setUuid(id,newUuid)},getName:qq.bind(self.getName,self),getUuid:qq.bind(self.getUuid,self),getSize:qq.bind(self.getSize,self),setSize:qq.bind(self._setSize,self),getDataByUuid:function(uuid){return self.getUploads({uuid:uuid})},isQueued:function(id){var status=self.getUploads({id:id}).status;return status===qq.status.QUEUED||status===qq.status.SUBMITTED||status===qq.status.UPLOAD_RETRYING||status===qq.status.PAUSED},getIdsInProxyGroup:self._uploadData.getIdsInProxyGroup,getIdsInBatch:self._uploadData.getIdsInBatch};return qq.each(this._options.request,function(prop,val){options[prop]=val}),options.customHeaders=this._customHeadersStore,additionalOptions&&qq.each(additionalOptions,function(key,val){options[key]=val}),new qq.UploadHandlerController(options,namespace)},_fileOrBlobRejected:function(id){this._netUploadedOrQueued--,this._uploadData.setStatus(id,qq.status.REJECTED)},_formatSize:function(bytes){if(0===bytes)return bytes+this._options.text.sizeSymbols[0];var i=-1;do{bytes/=1e3,i++}while(bytes>999);return Math.max(bytes,.1).toFixed(1)+this._options.text.sizeSymbols[i]},_generateExtraButtonSpecs:function(){var self=this;this._extraButtonSpecs={},qq.each(this._options.extraButtons,function(idx,extraButtonOptionEntry){var multiple=extraButtonOptionEntry.multiple,validation=qq.extend({},self._options.validation,!0),extraButtonSpec=qq.extend({},extraButtonOptionEntry);void 0===multiple&&(multiple=self._options.multiple),extraButtonSpec.validation&&qq.extend(validation,extraButtonOptionEntry.validation,!0),qq.extend(extraButtonSpec,{multiple:multiple,validation:validation},!0),self._initExtraButton(extraButtonSpec)})},_getButton:function(buttonId){var extraButtonsSpec=this._extraButtonSpecs[buttonId];return extraButtonsSpec?extraButtonsSpec.element:buttonId===this._defaultButtonId?this._options.button:void 0},_getButtonId:function(buttonOrFileInputOrFile){var inputs,fileInput,fileBlobOrInput=buttonOrFileInputOrFile;if(fileBlobOrInput instanceof qq.BlobProxy&&(fileBlobOrInput=fileBlobOrInput.referenceBlob),fileBlobOrInput&&!qq.isBlob(fileBlobOrInput)){if(qq.isFile(fileBlobOrInput))return fileBlobOrInput.qqButtonId;if("input"===fileBlobOrInput.tagName.toLowerCase()&&"file"===fileBlobOrInput.type.toLowerCase())return fileBlobOrInput.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME);if(inputs=fileBlobOrInput.getElementsByTagName("input"),qq.each(inputs,function(idx,input){if("file"===input.getAttribute("type"))return fileInput=input,!1}),fileInput)return fileInput.getAttribute(qq.UploadButton.BUTTON_ID_ATTR_NAME)}},_getNotFinished:function(){return this._uploadData.retrieve({status:[qq.status.UPLOADING,qq.status.UPLOAD_RETRYING,qq.status.QUEUED,qq.status.SUBMITTING,qq.status.SUBMITTED,qq.status.PAUSED]}).length},_getValidationBase:function(buttonId){var extraButtonSpec=this._extraButtonSpecs[buttonId];return extraButtonSpec?extraButtonSpec.validation:this._options.validation},_getValidationDescriptor:function(fileWrapper){return fileWrapper.file instanceof qq.BlobProxy?{name:qq.getFilename(fileWrapper.file.referenceBlob),size:fileWrapper.file.referenceBlob.size}:{name:this.getUploads({id:fileWrapper.id}).name,size:this.getUploads({id:fileWrapper.id}).size}},_getValidationDescriptors:function(fileWrappers){var self=this,fileDescriptors=[];return qq.each(fileWrappers,function(idx,fileWrapper){fileDescriptors.push(self._getValidationDescriptor(fileWrapper))}),fileDescriptors},_handleCameraAccess:function(){if(this._options.camera.ios&&qq.ios()){
var button=this._options.camera.button,buttonId=button?this._getButtonId(button):this._defaultButtonId,optionRoot=this._options;buttonId&&buttonId!==this._defaultButtonId&&(optionRoot=this._extraButtonSpecs[buttonId]),optionRoot.multiple=!1,null===optionRoot.validation.acceptFiles?optionRoot.validation.acceptFiles="image/*;capture=camera":optionRoot.validation.acceptFiles+=",image/*;capture=camera",qq.each(this._buttons,function(idx,button){if(button.getButtonId()===buttonId)return button.setMultiple(optionRoot.multiple),button.setAcceptFiles(optionRoot.acceptFiles),!1})}},_handleCheckedCallback:function(details){var self=this,callbackRetVal=details.callback();return qq.isGenericPromise(callbackRetVal)?(this.log(details.name+" - waiting for "+details.name+" promise to be fulfilled for "+details.identifier),callbackRetVal.then(function(successParam){self.log(details.name+" promise success for "+details.identifier),details.onSuccess(successParam)},function(){details.onFailure?(self.log(details.name+" promise failure for "+details.identifier),details.onFailure()):self.log(details.name+" promise failure for "+details.identifier)})):(!1!==callbackRetVal?details.onSuccess(callbackRetVal):details.onFailure?(this.log(details.name+" - return value was 'false' for "+details.identifier+".  Invoking failure callback."),details.onFailure()):this.log(details.name+" - return value was 'false' for "+details.identifier+".  Will not proceed."),callbackRetVal)},_handleNewFile:function(file,batchId,newFileWrapperList){var self=this,uuid=qq.getUniqueId(),size=-1,name=qq.getFilename(file),actualFile=file.blob||file,handler=this._customNewFileHandler?this._customNewFileHandler:qq.bind(self._handleNewFileGeneric,self);!qq.isInput(actualFile)&&actualFile.size>=0&&(size=actualFile.size),handler(actualFile,name,uuid,size,newFileWrapperList,batchId,this._options.request.uuidName,{uploadData:self._uploadData,paramsStore:self._paramsStore,addFileToHandler:function(id,file){self._handler.add(id,file),self._netUploadedOrQueued++,self._trackButton(id)}})},_handleNewFileGeneric:function(file,name,uuid,size,fileList,batchId){var id=this._uploadData.addFile({uuid:uuid,name:name,size:size,batchId:batchId});this._handler.add(id,file),this._trackButton(id),this._netUploadedOrQueued++,fileList.push({id:id,file:file})},_handlePasteSuccess:function(blob,extSuppliedName){var extension=blob.type.split("/")[1],name=extSuppliedName;null==name&&(name=this._options.paste.defaultName),name+="."+extension,this.addFiles({name:name,blob:blob})},_initExtraButton:function(spec){var button=this._createUploadButton({accept:spec.validation.acceptFiles,allowedExtensions:spec.validation.allowedExtensions,element:spec.element,folders:spec.folders,multiple:spec.multiple,title:spec.fileInputTitle});this._extraButtonSpecs[button.getButtonId()]=spec},_initFormSupportAndParams:function(){this._formSupport=qq.FormSupport&&new qq.FormSupport(this._options.form,qq.bind(this.uploadStoredFiles,this),qq.bind(this.log,this)),this._formSupport&&this._formSupport.attachedToForm?(this._paramsStore=this._createStore(this._options.request.params,this._formSupport.getFormInputsAsObject),this._options.autoUpload=this._formSupport.newAutoUpload,this._formSupport.newEndpoint&&(this._options.request.endpoint=this._formSupport.newEndpoint)):this._paramsStore=this._createStore(this._options.request.params)},_isDeletePossible:function(){return!(!qq.DeleteFileAjaxRequester||!this._options.deleteFile.enabled)&&(!this._options.cors.expected||(!!qq.supportedFeatures.deleteFileCorsXhr||!(!qq.supportedFeatures.deleteFileCorsXdr||!this._options.cors.allowXdr)))},_isAllowedExtension:function(allowed,fileName){var valid=!1;return!allowed.length||(qq.each(allowed,function(idx,allowedExt){if(qq.isString(allowedExt)){var extRegex=new RegExp("\\."+allowedExt+"$","i");if(null!=fileName.match(extRegex))return valid=!0,!1}}),valid)},_itemError:function(code,maybeNameOrNames,item){function r(name,replacement){message=message.replace(name,replacement)}var extensionsForMessage,placeholderMatch,message=this._options.messages[code],allowedExtensions=[],names=[].concat(maybeNameOrNames),name=names[0],buttonId=this._getButtonId(item),validationBase=this._getValidationBase(buttonId);return qq.each(validationBase.allowedExtensions,function(idx,allowedExtension){qq.isString(allowedExtension)&&allowedExtensions.push(allowedExtension)}),extensionsForMessage=allowedExtensions.join(", ").toLowerCase(),r("{file}",this._options.formatFileName(name)),r("{extensions}",extensionsForMessage),r("{sizeLimit}",this._formatSize(validationBase.sizeLimit)),r("{minSizeLimit}",this._formatSize(validationBase.minSizeLimit)),placeholderMatch=message.match(/(\{\w+\})/g),null!==placeholderMatch&&qq.each(placeholderMatch,function(idx,placeholder){r(placeholder,names[idx])}),this._options.callbacks.onError(null,name,message,void 0),message},_manualRetry:function(id,callback){if(this._onBeforeManualRetry(id))return this._netUploadedOrQueued++,this._uploadData.setStatus(id,qq.status.UPLOAD_RETRYING),callback?callback(id):this._handler.retry(id),!0},_maybeAllComplete:function(id,status){var self=this,notFinished=this._getNotFinished();status===qq.status.UPLOAD_SUCCESSFUL?this._succeededSinceLastAllComplete.push(id):status===qq.status.UPLOAD_FAILED&&this._failedSinceLastAllComplete.push(id),0===notFinished&&(this._succeededSinceLastAllComplete.length||this._failedSinceLastAllComplete.length)&&setTimeout(function(){self._onAllComplete(self._succeededSinceLastAllComplete,self._failedSinceLastAllComplete)},0)},_maybeHandleIos8SafariWorkaround:function(){var self=this;if(this._options.workarounds.ios8SafariUploads&&qq.ios800()&&qq.iosSafari())throw setTimeout(function(){window.alert(self._options.messages.unsupportedBrowserIos8Safari)},0),new qq.Error(this._options.messages.unsupportedBrowserIos8Safari)},_maybeParseAndSendUploadError:function(id,name,response,xhr){if(!response.success)if(xhr&&200!==xhr.status&&!response.error)this._options.callbacks.onError(id,name,"XHR returned response code "+xhr.status,xhr);else{var errorReason=response.error?response.error:this._options.text.defaultResponseError;this._options.callbacks.onError(id,name,errorReason,xhr)}},_maybeProcessNextItemAfterOnValidateCallback:function(validItem,items,index,params,endpoint){var self=this;if(items.length>index)if(validItem||!this._options.validation.stopOnFirstInvalidFile)setTimeout(function(){var validationDescriptor=self._getValidationDescriptor(items[index]),buttonId=self._getButtonId(items[index].file),button=self._getButton(buttonId);self._handleCheckedCallback({name:"onValidate",callback:qq.bind(self._options.callbacks.onValidate,self,validationDescriptor,button),onSuccess:qq.bind(self._onValidateCallbackSuccess,self,items,index,params,endpoint),onFailure:qq.bind(self._onValidateCallbackFailure,self,items,index,params,endpoint),identifier:"Item '"+validationDescriptor.name+"', size: "+validationDescriptor.size})},0);else if(!validItem)for(;index<items.length;index++)self._fileOrBlobRejected(items[index].id)},_onAllComplete:function(successful,failed){this._totalProgress&&this._totalProgress.onAllComplete(successful,failed,this._preventRetries),this._options.callbacks.onAllComplete(qq.extend([],successful),qq.extend([],failed)),this._succeededSinceLastAllComplete=[],this._failedSinceLastAllComplete=[]},_onAutoRetry:function(id,name,responseJSON,xhr,callback){var self=this;if(self._preventRetries[id]=responseJSON[self._options.retry.preventRetryResponseProperty],self._shouldAutoRetry(id,name,responseJSON)){var retryWaitPeriod=1e3*self._options.retry.autoAttemptDelay;return self._maybeParseAndSendUploadError.apply(self,arguments),self._options.callbacks.onAutoRetry(id,name,self._autoRetries[id]),self._onBeforeAutoRetry(id,name),self._uploadData.setStatus(id,qq.status.UPLOAD_RETRYING),self._retryTimeouts[id]=setTimeout(function(){self.log("Starting retry for "+name+"..."),callback?callback(id):self._handler.retry(id)},retryWaitPeriod),!0}},_onBeforeAutoRetry:function(id,name){this.log("Waiting "+this._options.retry.autoAttemptDelay+" seconds before retrying "+name+"...")},_onBeforeManualRetry:function(id){var fileName,itemLimit=this._currentItemLimit;return this._preventRetries[id]?(this.log("Retries are forbidden for id "+id,"warn"),!1):this._handler.isValid(id)?(fileName=this.getName(id),!1!==this._options.callbacks.onManualRetry(id,fileName)&&(itemLimit>0&&this._netUploadedOrQueued+1>itemLimit?(this._itemError("retryFailTooManyItems"),!1):(this.log("Retrying upload for '"+fileName+"' (id: "+id+")..."),!0))):(this.log("'"+id+"' is not a valid file ID","error"),!1)},_onCancel:function(id,name){this._netUploadedOrQueued--,clearTimeout(this._retryTimeouts[id]);var storedItemIndex=qq.indexOf(this._storedIds,id);!this._options.autoUpload&&storedItemIndex>=0&&this._storedIds.splice(storedItemIndex,1),this._uploadData.setStatus(id,qq.status.CANCELED)},_onComplete:function(id,name,result,xhr){return result.success?(result.thumbnailUrl&&(this._thumbnailUrls[id]=result.thumbnailUrl),this._netUploaded++,this._uploadData.setStatus(id,qq.status.UPLOAD_SUCCESSFUL)):(this._netUploadedOrQueued--,this._uploadData.setStatus(id,qq.status.UPLOAD_FAILED),!0===result[this._options.retry.preventRetryResponseProperty]&&(this._preventRetries[id]=!0)),this._maybeParseAndSendUploadError(id,name,result,xhr),!!result.success},_onDelete:function(id){this._uploadData.setStatus(id,qq.status.DELETING)},_onDeleteComplete:function(id,xhrOrXdr,isError){var name=this.getName(id);isError?(this._uploadData.setStatus(id,qq.status.DELETE_FAILED),this.log("Delete request for '"+name+"' has failed.","error"),void 0===xhrOrXdr.withCredentials?this._options.callbacks.onError(id,name,"Delete request failed",xhrOrXdr):this._options.callbacks.onError(id,name,"Delete request failed with response code "+xhrOrXdr.status,xhrOrXdr)):(this._netUploadedOrQueued--,this._netUploaded--,this._handler.expunge(id),this._uploadData.setStatus(id,qq.status.DELETED),this.log("Delete request for '"+name+"' has succeeded."))},_onInputChange:function(input){var fileIndex;if(qq.supportedFeatures.ajaxUploading){for(fileIndex=0;fileIndex<input.files.length;fileIndex++)this._annotateWithButtonId(input.files[fileIndex],input);this.addFiles(input.files)}else input.value.length>0&&this.addFiles(input);qq.each(this._buttons,function(idx,button){button.reset()})},_onProgress:function(id,name,loaded,total){this._totalProgress&&this._totalProgress.onIndividualProgress(id,loaded,total)},_onSubmit:function(id,name){},_onSubmitCallbackSuccess:function(id,name){this._onSubmit.apply(this,arguments),this._uploadData.setStatus(id,qq.status.SUBMITTED),this._onSubmitted.apply(this,arguments),this._options.autoUpload?(this._options.callbacks.onSubmitted.apply(this,arguments),this._uploadFile(id)):(this._storeForLater(id),this._options.callbacks.onSubmitted.apply(this,arguments))},_onSubmitDelete:function(id,onSuccessCallback,additionalMandatedParams){var adjustedOnSuccessCallback,uuid=this.getUuid(id);return onSuccessCallback&&(adjustedOnSuccessCallback=qq.bind(onSuccessCallback,this,id,uuid,additionalMandatedParams)),this._isDeletePossible()?(this._handleCheckedCallback({name:"onSubmitDelete",callback:qq.bind(this._options.callbacks.onSubmitDelete,this,id),onSuccess:adjustedOnSuccessCallback||qq.bind(this._deleteHandler.sendDelete,this,id,uuid,additionalMandatedParams),identifier:id}),!0):(this.log("Delete request ignored for ID "+id+", delete feature is disabled or request not possible due to CORS on a user agent that does not support pre-flighting.","warn"),!1)},_onSubmitted:function(id){},_onTotalProgress:function(loaded,total){this._options.callbacks.onTotalProgress(loaded,total)},_onUploadPrep:function(id){},_onUpload:function(id,name){this._uploadData.setStatus(id,qq.status.UPLOADING)},_onUploadChunk:function(id,chunkData){},_onUploadStatusChange:function(id,oldStatus,newStatus){newStatus===qq.status.PAUSED&&clearTimeout(this._retryTimeouts[id])},_onValidateBatchCallbackFailure:function(fileWrappers){var self=this;qq.each(fileWrappers,function(idx,fileWrapper){self._fileOrBlobRejected(fileWrapper.id)})},_onValidateBatchCallbackSuccess:function(validationDescriptors,items,params,endpoint,button){var errorMessage,itemLimit=this._currentItemLimit,proposedNetFilesUploadedOrQueued=this._netUploadedOrQueued;0===itemLimit||proposedNetFilesUploadedOrQueued<=itemLimit?items.length>0?this._handleCheckedCallback({name:"onValidate",callback:qq.bind(this._options.callbacks.onValidate,this,validationDescriptors[0],button),onSuccess:qq.bind(this._onValidateCallbackSuccess,this,items,0,params,endpoint),onFailure:qq.bind(this._onValidateCallbackFailure,this,items,0,params,endpoint),identifier:"Item '"+items[0].file.name+"', size: "+items[0].file.size}):this._itemError("noFilesError"):(this._onValidateBatchCallbackFailure(items),errorMessage=this._options.messages.tooManyItemsError.replace(/\{netItems\}/g,proposedNetFilesUploadedOrQueued).replace(/\{itemLimit\}/g,itemLimit),this._batchError(errorMessage))},_onValidateCallbackFailure:function(items,index,params,endpoint){var nextIndex=index+1;this._fileOrBlobRejected(items[index].id,items[index].file.name),this._maybeProcessNextItemAfterOnValidateCallback(!1,items,nextIndex,params,endpoint)},_onValidateCallbackSuccess:function(items,index,params,endpoint){var self=this,nextIndex=index+1,validationDescriptor=this._getValidationDescriptor(items[index]);this._validateFileOrBlobData(items[index],validationDescriptor).then(function(){self._upload(items[index].id,params,endpoint),self._maybeProcessNextItemAfterOnValidateCallback(!0,items,nextIndex,params,endpoint)},function(){self._maybeProcessNextItemAfterOnValidateCallback(!1,items,nextIndex,params,endpoint)})},_prepareItemsForUpload:function(items,params,endpoint){if(0===items.length)return void this._itemError("noFilesError");var validationDescriptors=this._getValidationDescriptors(items),buttonId=this._getButtonId(items[0].file),button=this._getButton(buttonId);this._handleCheckedCallback({name:"onValidateBatch",callback:qq.bind(this._options.callbacks.onValidateBatch,this,validationDescriptors,button),onSuccess:qq.bind(this._onValidateBatchCallbackSuccess,this,validationDescriptors,items,params,endpoint,button),onFailure:qq.bind(this._onValidateBatchCallbackFailure,this,items),identifier:"batch validation"})},_preventLeaveInProgress:function(){var self=this;this._disposeSupport.attach(window,"beforeunload",function(e){if(self.getInProgress())return e=e||window.event,e.returnValue=self._options.messages.onLeave,self._options.messages.onLeave})},_refreshSessionData:function(){var self=this,options=this._options.session;qq.Session&&null!=this._options.session.endpoint&&(this._session||(qq.extend(options,{cors:this._options.cors}),options.log=qq.bind(this.log,this),options.addFileRecord=qq.bind(this._addCannedFile,this),this._session=new qq.Session(options)),setTimeout(function(){self._session.refresh().then(function(response,xhrOrXdr){self._sessionRequestComplete(),self._options.callbacks.onSessionRequestComplete(response,!0,xhrOrXdr)},function(response,xhrOrXdr){self._options.callbacks.onSessionRequestComplete(response,!1,xhrOrXdr)})},0))},_sessionRequestComplete:function(){},_setSize:function(id,newSize){this._uploadData.updateSize(id,newSize),this._totalProgress&&this._totalProgress.onNewSize(id)},_shouldAutoRetry:function(id,name,responseJSON){var uploadData=this._uploadData.retrieve({id:id});return!!(!this._preventRetries[id]&&this._options.retry.enableAuto&&uploadData.status!==qq.status.PAUSED&&(void 0===this._autoRetries[id]&&(this._autoRetries[id]=0),this._autoRetries[id]<this._options.retry.maxAutoAttempts))&&(this._autoRetries[id]+=1,!0)},_storeForLater:function(id){this._storedIds.push(id)},_trackButton:function(id){var buttonId;(buttonId=qq.supportedFeatures.ajaxUploading?this._handler.getFile(id).qqButtonId:this._getButtonId(this._handler.getInput(id)))&&(this._buttonIdsForFileIds[id]=buttonId)},_updateFormSupportAndParams:function(formElementOrId){this._options.form.element=formElementOrId,this._formSupport=qq.FormSupport&&new qq.FormSupport(this._options.form,qq.bind(this.uploadStoredFiles,this),qq.bind(this.log,this)),this._formSupport&&this._formSupport.attachedToForm&&(this._paramsStore.addReadOnly(null,this._formSupport.getFormInputsAsObject),this._options.autoUpload=this._formSupport.newAutoUpload,this._formSupport.newEndpoint&&this.setEndpoint(this._formSupport.newEndpoint))},_upload:function(id,params,endpoint){var name=this.getName(id);params&&this.setParams(params,id),endpoint&&this.setEndpoint(endpoint,id),this._handleCheckedCallback({name:"onSubmit",callback:qq.bind(this._options.callbacks.onSubmit,this,id,name),onSuccess:qq.bind(this._onSubmitCallbackSuccess,this,id,name),onFailure:qq.bind(this._fileOrBlobRejected,this,id,name),identifier:id})},_uploadFile:function(id){this._handler.upload(id)||this._uploadData.setStatus(id,qq.status.QUEUED)},_uploadStoredFiles:function(){for(var idToUpload,stillSubmitting,self=this;this._storedIds.length;)idToUpload=this._storedIds.shift(),this._uploadFile(idToUpload);(stillSubmitting=this.getUploads({status:qq.status.SUBMITTING}).length)&&(qq.log("Still waiting for "+stillSubmitting+" files to clear submit queue. Will re-parse stored IDs array shortly."),setTimeout(function(){self._uploadStoredFiles()},1e3))},_validateFileOrBlobData:function(fileWrapper,validationDescriptor){var self=this,file=function(){return fileWrapper.file instanceof qq.BlobProxy?fileWrapper.file.referenceBlob:fileWrapper.file}(),name=validationDescriptor.name,size=validationDescriptor.size,buttonId=this._getButtonId(fileWrapper.file),validationBase=this._getValidationBase(buttonId),validityChecker=new qq.Promise;return validityChecker.then(function(){},function(){self._fileOrBlobRejected(fileWrapper.id,name)}),qq.isFileOrInput(file)&&!this._isAllowedExtension(validationBase.allowedExtensions,name)?(this._itemError("typeError",name,file),validityChecker.failure()):this._options.validation.allowEmpty||0!==size?size>0&&validationBase.sizeLimit&&size>validationBase.sizeLimit?(this._itemError("sizeError",name,file),validityChecker.failure()):size>0&&size<validationBase.minSizeLimit?(this._itemError("minSizeError",name,file),validityChecker.failure()):(qq.ImageValidation&&qq.supportedFeatures.imagePreviews&&qq.isFile(file)?new qq.ImageValidation(file,qq.bind(self.log,self)).validate(validationBase.image).then(validityChecker.success,function(errorCode){self._itemError(errorCode+"ImageError",name,file),validityChecker.failure()}):validityChecker.success(),validityChecker):(this._itemError("emptyError",name,file),validityChecker.failure())},_wrapCallbacks:function(){var self,safeCallback,prop;self=this,safeCallback=function(name,callback,args){var errorMsg;try{return callback.apply(self,args)}catch(exception){errorMsg=exception.message||exception.toString(),self.log("Caught exception in '"+name+"' callback - "+errorMsg,"error")}};for(prop in this._options.callbacks)!function(){var callbackName,callbackFunc;callbackName=prop,callbackFunc=self._options.callbacks[callbackName],self._options.callbacks[callbackName]=function(){return safeCallback(callbackName,callbackFunc,arguments)}}()}}}(),function(){"use strict";qq.FineUploaderBasic=function(o){var self=this;this._options={debug:!1,button:null,multiple:!0,maxConnections:3,disableCancelForFormUploads:!1,autoUpload:!0,request:{customHeaders:{},endpoint:"/server/upload",filenameParam:"qqfilename",forceMultipart:!0,inputName:"qqfile",method:"POST",params:{},paramsInBody:!0,totalFileSizeName:"qqtotalfilesize",uuidName:"qquuid"},validation:{allowedExtensions:[],sizeLimit:0,minSizeLimit:0,itemLimit:0,stopOnFirstInvalidFile:!0,acceptFiles:null,image:{maxHeight:0,maxWidth:0,minHeight:0,minWidth:0},allowEmpty:!1},callbacks:{onSubmit:function(id,name){},onSubmitted:function(id,name){},onComplete:function(id,name,responseJSON,maybeXhr){},onAllComplete:function(successful,failed){},onCancel:function(id,name){},onUpload:function(id,name){},onUploadChunk:function(id,name,chunkData){},onUploadChunkSuccess:function(id,chunkData,responseJSON,xhr){},onResume:function(id,fileName,chunkData){},onProgress:function(id,name,loaded,total){},onTotalProgress:function(loaded,total){},onError:function(id,name,reason,maybeXhrOrXdr){},onAutoRetry:function(id,name,attemptNumber){},onManualRetry:function(id,name){},onValidateBatch:function(fileOrBlobData){},onValidate:function(fileOrBlobData){},onSubmitDelete:function(id){},onDelete:function(id){},onDeleteComplete:function(id,xhrOrXdr,isError){},onPasteReceived:function(blob){},onStatusChange:function(id,oldStatus,newStatus){},onSessionRequestComplete:function(response,success,xhrOrXdr){}},messages:{typeError:"{file} has an invalid extension. Valid extension(s): {extensions}.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",noFilesError:"No files to upload.",tooManyItemsError:"Too many items ({netItems}) would be uploaded.  Item limit is {itemLimit}.",maxHeightImageError:"Image is too tall.",maxWidthImageError:"Image is too wide.",minHeightImageError:"Image is not tall enough.",minWidthImageError:"Image is not wide enough.",retryFailTooManyItems:"Retry failed - you have reached your file limit.",onLeave:"The files are being uploaded, if you leave now the upload will be canceled.",unsupportedBrowserIos8Safari:"Unrecoverable error - this browser does not permit file uploading of any kind due to serious bugs in iOS8 Safari.  Please use iOS8 Chrome until Apple fixes these issues."},retry:{enableAuto:!1,maxAutoAttempts:3,autoAttemptDelay:5,preventRetryResponseProperty:"preventRetry"},classes:{buttonHover:"qq-upload-button-hover",buttonFocus:"qq-upload-button-focus"},chunking:{enabled:!1,concurrent:{enabled:!1},mandatory:!1,paramNames:{partIndex:"qqpartindex",partByteOffset:"qqpartbyteoffset",chunkSize:"qqchunksize",totalFileSize:"qqtotalfilesize",totalParts:"qqtotalparts"},partSize:2e6,success:{endpoint:null}},resume:{enabled:!1,recordsExpireIn:7,paramNames:{resuming:"qqresume"}},formatFileName:function(fileOrBlobName){return fileOrBlobName},text:{defaultResponseError:"Upload failure reason unknown",fileInputTitle:"file input",sizeSymbols:["kB","MB","GB","TB","PB","EB"]},deleteFile:{enabled:!1,method:"DELETE",endpoint:"/server/upload",customHeaders:{},params:{}},cors:{expected:!1,sendCredentials:!1,allowXdr:!1},blobs:{defaultName:"misc_data"},paste:{targetElement:null,defaultName:"pasted_image"},camera:{ios:!1,button:null},extraButtons:[],session:{endpoint:null,params:{},customHeaders:{},refreshOnReset:!0},form:{element:"qq-form",autoUpload:!1,interceptSubmit:!0},scaling:{customResizer:null,sendOriginal:!0,orient:!0,defaultType:null,defaultQuality:80,failureText:"Failed to scale",includeExif:!1,sizes:[]},workarounds:{iosEmptyVideos:!0,ios8SafariUploads:!0,ios8BrowserCrash:!1}},qq.extend(this._options,o,!0),this._buttons=[],this._extraButtonSpecs={},this._buttonIdsForFileIds=[],this._wrapCallbacks(),this._disposeSupport=new qq.DisposeSupport,this._storedIds=[],this._autoRetries=[],this._retryTimeouts=[],this._preventRetries=[],this._thumbnailUrls=[],this._netUploadedOrQueued=0,this._netUploaded=0,this._uploadData=this._createUploadDataTracker(),this._initFormSupportAndParams(),this._customHeadersStore=this._createStore(this._options.request.customHeaders),this._deleteFileCustomHeadersStore=this._createStore(this._options.deleteFile.customHeaders),this._deleteFileParamsStore=this._createStore(this._options.deleteFile.params),this._endpointStore=this._createStore(this._options.request.endpoint),this._deleteFileEndpointStore=this._createStore(this._options.deleteFile.endpoint),this._handler=this._createUploadHandler(),this._deleteHandler=qq.DeleteFileAjaxRequester&&this._createDeleteHandler(),this._options.button&&(this._defaultButtonId=this._createUploadButton({element:this._options.button,title:this._options.text.fileInputTitle}).getButtonId()),this._generateExtraButtonSpecs(),this._handleCameraAccess(),this._options.paste.targetElement&&(qq.PasteSupport?this._pasteHandler=this._createPasteHandler():this.log("Paste support module not found","error")),this._preventLeaveInProgress(),this._imageGenerator=qq.ImageGenerator&&new qq.ImageGenerator(qq.bind(this.log,this)),this._refreshSessionData(),this._succeededSinceLastAllComplete=[],this._failedSinceLastAllComplete=[],this._scaler=qq.Scaler&&new qq.Scaler(this._options.scaling,qq.bind(this.log,this))||{},this._scaler.enabled&&(this._customNewFileHandler=qq.bind(this._scaler.handleNewFile,this._scaler)),qq.TotalProgress&&qq.supportedFeatures.progressBar&&(this._totalProgress=new qq.TotalProgress(qq.bind(this._onTotalProgress,this),function(id){var entry=self._uploadData.retrieve({id:id});return entry&&entry.size||0})),this._currentItemLimit=this._options.validation.itemLimit},qq.FineUploaderBasic.prototype=qq.basePublicApi,qq.extend(qq.FineUploaderBasic.prototype,qq.basePrivateApi)}(),qq.AjaxRequester=function(o){"use strict";function isSimpleMethod(){return qq.indexOf(["GET","POST","HEAD"],options.method)>=0}function containsNonSimpleHeaders(headers){var containsNonSimple=!1;return qq.each(containsNonSimple,function(idx,header){if(qq.indexOf(["Accept","Accept-Language","Content-Language","Content-Type"],header)<0)return containsNonSimple=!0,!1}),containsNonSimple}function isXdr(xhr){return options.cors.expected&&void 0===xhr.withCredentials}function getCorsAjaxTransport(){var xhrOrXdr;return(window.XMLHttpRequest||window.ActiveXObject)&&(xhrOrXdr=qq.createXhrInstance(),void 0===xhrOrXdr.withCredentials&&(xhrOrXdr=new XDomainRequest,xhrOrXdr.onload=function(){},xhrOrXdr.onerror=function(){},xhrOrXdr.ontimeout=function(){},xhrOrXdr.onprogress=function(){})),xhrOrXdr}function getXhrOrXdr(id,suppliedXhr){var xhrOrXdr=requestData[id].xhr;return xhrOrXdr||(xhrOrXdr=suppliedXhr||(options.cors.expected?getCorsAjaxTransport():qq.createXhrInstance()),requestData[id].xhr=xhrOrXdr),xhrOrXdr}function dequeue(id){var nextId,i=qq.indexOf(queue,id),max=options.maxConnections;delete requestData[id],queue.splice(i,1),queue.length>=max&&i<max&&(nextId=queue[max-1],sendRequest(nextId))}function onComplete(id,xdrError){var xhr=getXhrOrXdr(id),method=options.method,isError=!0===xdrError;dequeue(id),isError?log(method+" request for "+id+" has failed","error"):isXdr(xhr)||isResponseSuccessful(xhr.status)||(isError=!0,log(method+" request for "+id+" has failed - response code "+xhr.status,"error")),options.onComplete(id,xhr,isError)}function getParams(id){var params,onDemandParams=requestData[id].additionalParams,mandatedParams=options.mandatedParams;return options.paramsStore.get&&(params=options.paramsStore.get(id)),onDemandParams&&qq.each(onDemandParams,function(name,val){params=params||{},params[name]=val}),mandatedParams&&qq.each(mandatedParams,function(name,val){params=params||{},params[name]=val}),params}function sendRequest(id,optXhr){var url,xhr=getXhrOrXdr(id,optXhr),method=options.method,params=getParams(id),payload=requestData[id].payload;return options.onSend(id),url=createUrl(id,params,requestData[id].additionalQueryParams),isXdr(xhr)?(xhr.onload=getXdrLoadHandler(id),xhr.onerror=getXdrErrorHandler(id)):xhr.onreadystatechange=getXhrReadyStateChangeHandler(id),registerForUploadProgress(id),xhr.open(method,url,!0),options.cors.expected&&options.cors.sendCredentials&&!isXdr(xhr)&&(xhr.withCredentials=!0),setHeaders(id),log("Sending "+method+" request for "+id),payload?xhr.send(payload):shouldParamsBeInQueryString||!params?xhr.send():params&&options.contentType&&options.contentType.toLowerCase().indexOf("application/x-www-form-urlencoded")>=0?xhr.send(qq.obj2url(params,"")):params&&options.contentType&&options.contentType.toLowerCase().indexOf("application/json")>=0?xhr.send(JSON.stringify(params)):xhr.send(params),xhr}function createUrl(id,params,additionalQueryParams){var endpoint=options.endpointStore.get(id),addToPath=requestData[id].addToPath;return void 0!=addToPath&&(endpoint+="/"+addToPath),shouldParamsBeInQueryString&&params&&(endpoint=qq.obj2url(params,endpoint)),additionalQueryParams&&(endpoint=qq.obj2url(additionalQueryParams,endpoint)),endpoint}function getXhrReadyStateChangeHandler(id){return function(){4===getXhrOrXdr(id).readyState&&onComplete(id)}}function registerForUploadProgress(id){var onProgress=options.onProgress;onProgress&&(getXhrOrXdr(id).upload.onprogress=function(e){e.lengthComputable&&onProgress(id,e.loaded,e.total)})}function getXdrLoadHandler(id){return function(){onComplete(id)}}function getXdrErrorHandler(id){return function(){onComplete(id,!0)}}function setHeaders(id){var xhr=getXhrOrXdr(id),customHeaders=options.customHeaders,onDemandHeaders=requestData[id].additionalHeaders||{},method=options.method,allHeaders={};isXdr(xhr)||(options.acceptHeader&&xhr.setRequestHeader("Accept",options.acceptHeader),options.allowXRequestedWithAndCacheControl&&(options.cors.expected&&isSimpleMethod()&&!containsNonSimpleHeaders(customHeaders)||(xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.setRequestHeader("Cache-Control","no-cache"))),!options.contentType||"POST"!==method&&"PUT"!==method||xhr.setRequestHeader("Content-Type",options.contentType),qq.extend(allHeaders,qq.isFunction(customHeaders)?customHeaders(id):customHeaders),qq.extend(allHeaders,onDemandHeaders),qq.each(allHeaders,function(name,val){xhr.setRequestHeader(name,val)}))}function isResponseSuccessful(responseCode){return qq.indexOf(options.successfulResponseCodes[options.method],responseCode)>=0}function prepareToSend(id,optXhr,addToPath,additionalParams,additionalQueryParams,additionalHeaders,payload){if(requestData[id]={addToPath:addToPath,additionalParams:additionalParams,additionalQueryParams:additionalQueryParams,additionalHeaders:additionalHeaders,payload:payload},queue.push(id)<=options.maxConnections)return sendRequest(id,optXhr)}var log,shouldParamsBeInQueryString,queue=[],requestData={},options={acceptHeader:null,validMethods:["PATCH","POST","PUT"],method:"POST",contentType:"application/x-www-form-urlencoded",maxConnections:3,customHeaders:{},endpointStore:{},paramsStore:{},mandatedParams:{},allowXRequestedWithAndCacheControl:!0,successfulResponseCodes:{DELETE:[200,202,204],PATCH:[200,201,202,203,204],POST:[200,201,202,203,204],PUT:[200,201,202,203,204],GET:[200]},cors:{expected:!1,sendCredentials:!1},log:function(str,level){},onSend:function(id){},onComplete:function(id,xhrOrXdr,isError){},onProgress:null};if(qq.extend(options,o),log=options.log,qq.indexOf(options.validMethods,options.method)<0)throw new Error("'"+options.method+"' is not a supported method for this type of request!");shouldParamsBeInQueryString="GET"===options.method||"DELETE"===options.method,qq.extend(this,{initTransport:function(id){var path,params,headers,payload,cacheBuster,additionalQueryParams;return{withPath:function(appendToPath){return path=appendToPath,this},withParams:function(additionalParams){return params=additionalParams,this},withQueryParams:function(_additionalQueryParams_){return additionalQueryParams=_additionalQueryParams_,this},withHeaders:function(additionalHeaders){return headers=additionalHeaders,this},withPayload:function(thePayload){return payload=thePayload,this},withCacheBuster:function(){return cacheBuster=!0,this},send:function(optXhr){return cacheBuster&&qq.indexOf(["GET","DELETE"],options.method)>=0&&(params.qqtimestamp=(new Date).getTime()),prepareToSend(id,optXhr,path,params,additionalQueryParams,headers,payload)}}},canceled:function(id){dequeue(id)}})},qq.UploadHandler=function(spec){"use strict";var proxy=spec.proxy,fileState={},onCancel=proxy.onCancel,getName=proxy.getName;qq.extend(this,{add:function(id,fileItem){fileState[id]=fileItem,
fileState[id].temp={}},cancel:function(id){var self=this,cancelFinalizationEffort=new qq.Promise;onCancel(id,getName(id),cancelFinalizationEffort).then(function(){self.isValid(id)&&(fileState[id].canceled=!0,self.expunge(id)),cancelFinalizationEffort.success()})},expunge:function(id){delete fileState[id]},getThirdPartyFileId:function(id){return fileState[id].key},isValid:function(id){return void 0!==fileState[id]},reset:function(){fileState={}},_getFileState:function(id){return fileState[id]},_setThirdPartyFileId:function(id,thirdPartyFileId){fileState[id].key=thirdPartyFileId},_wasCanceled:function(id){return!!fileState[id].canceled}})},qq.UploadHandlerController=function(o,namespace){"use strict";var preventRetryResponse,log,handler,controller=this,chunkingPossible=!1,concurrentChunkingPossible=!1,options={paramsStore:{},maxConnections:3,chunking:{enabled:!1,multiple:{enabled:!1}},log:function(str,level){},onProgress:function(id,fileName,loaded,total){},onComplete:function(id,fileName,response,xhr){},onCancel:function(id,fileName){},onUploadPrep:function(id){},onUpload:function(id,fileName){},onUploadChunk:function(id,fileName,chunkData){},onUploadChunkSuccess:function(id,chunkData,response,xhr){},onAutoRetry:function(id,fileName,response,xhr){},onResume:function(id,fileName,chunkData){},onUuidChanged:function(id,newUuid){},getName:function(id){},setSize:function(id,newSize){},isQueued:function(id){},getIdsInProxyGroup:function(id){},getIdsInBatch:function(id){}},chunked={done:function(id,chunkIdx,response,xhr){var chunkData=handler._getChunkData(id,chunkIdx);handler._getFileState(id).attemptingResume=!1,delete handler._getFileState(id).temp.chunkProgress[chunkIdx],handler._getFileState(id).loaded+=chunkData.size,options.onUploadChunkSuccess(id,handler._getChunkDataForCallback(chunkData),response,xhr)},finalize:function(id){var size=options.getSize(id),name=options.getName(id);log("All chunks have been uploaded for "+id+" - finalizing...."),handler.finalizeChunks(id).then(function(response,xhr){log("Finalize successful for "+id);var normaizedResponse=upload.normalizeResponse(response,!0);options.onProgress(id,name,size,size),handler._maybeDeletePersistedChunkData(id),upload.cleanup(id,normaizedResponse,xhr)},function(response,xhr){var normaizedResponse=upload.normalizeResponse(response,!1);log("Problem finalizing chunks for file ID "+id+" - "+normaizedResponse.error,"error"),normaizedResponse.reset&&chunked.reset(id),options.onAutoRetry(id,name,normaizedResponse,xhr)||upload.cleanup(id,normaizedResponse,xhr)})},handleFailure:function(chunkIdx,id,response,xhr){var name=options.getName(id);log("Chunked upload request failed for "+id+", chunk "+chunkIdx),handler.clearCachedChunk(id,chunkIdx);var inProgressIdx,responseToReport=upload.normalizeResponse(response,!1);responseToReport.reset?chunked.reset(id):(inProgressIdx=qq.indexOf(handler._getFileState(id).chunking.inProgress,chunkIdx))>=0&&(handler._getFileState(id).chunking.inProgress.splice(inProgressIdx,1),handler._getFileState(id).chunking.remaining.unshift(chunkIdx)),handler._getFileState(id).temp.ignoreFailure||(concurrentChunkingPossible&&(handler._getFileState(id).temp.ignoreFailure=!0,log(qq.format("Going to attempt to abort these chunks: {}. These are currently in-progress: {}.",JSON.stringify(Object.keys(handler._getXhrs(id))),JSON.stringify(handler._getFileState(id).chunking.inProgress))),qq.each(handler._getXhrs(id),function(ckid,ckXhr){log(qq.format("Attempting to abort file {}.{}. XHR readyState {}. ",id,ckid,ckXhr.readyState)),ckXhr.abort(),ckXhr._cancelled=!0}),handler.moveInProgressToRemaining(id),connectionManager.free(id,!0)),options.onAutoRetry(id,name,responseToReport,xhr)||upload.cleanup(id,responseToReport,xhr))},hasMoreParts:function(id){return!!handler._getFileState(id).chunking.remaining.length},nextPart:function(id){var nextIdx=handler._getFileState(id).chunking.remaining.shift();return nextIdx>=handler._getTotalChunks(id)&&(nextIdx=null),nextIdx},reset:function(id){log("Server or callback has ordered chunking effort to be restarted on next attempt for item ID "+id,"error"),handler._maybeDeletePersistedChunkData(id),handler.reevaluateChunking(id),handler._getFileState(id).loaded=0},sendNext:function(id){var size=options.getSize(id),name=options.getName(id),chunkIdx=chunked.nextPart(id),chunkData=handler._getChunkData(id,chunkIdx),resuming=handler._getFileState(id).attemptingResume,inProgressChunks=handler._getFileState(id).chunking.inProgress||[];null==handler._getFileState(id).loaded&&(handler._getFileState(id).loaded=0),resuming&&!1===options.onResume(id,name,chunkData)&&(chunked.reset(id),chunkIdx=chunked.nextPart(id),chunkData=handler._getChunkData(id,chunkIdx),resuming=!1),null==chunkIdx&&0===inProgressChunks.length?chunked.finalize(id):(log(qq.format("Sending chunked upload request for item {}.{}, bytes {}-{} of {}.",id,chunkIdx,chunkData.start+1,chunkData.end,size)),options.onUploadChunk(id,name,handler._getChunkDataForCallback(chunkData)),inProgressChunks.push(chunkIdx),handler._getFileState(id).chunking.inProgress=inProgressChunks,concurrentChunkingPossible&&connectionManager.open(id,chunkIdx),concurrentChunkingPossible&&connectionManager.available()&&handler._getFileState(id).chunking.remaining.length&&chunked.sendNext(id),0===chunkData.blob.size?(log(qq.format("Chunk {} for file {} will not be uploaded, zero sized chunk.",chunkIdx,id),"error"),chunked.handleFailure(chunkIdx,id,"File is no longer available",null)):handler.uploadChunk(id,chunkIdx,resuming).then(function(response,xhr){log("Chunked upload request succeeded for "+id+", chunk "+chunkIdx),handler.clearCachedChunk(id,chunkIdx);var inProgressChunks=handler._getFileState(id).chunking.inProgress||[],responseToReport=upload.normalizeResponse(response,!0),inProgressChunkIdx=qq.indexOf(inProgressChunks,chunkIdx);log(qq.format("Chunk {} for file {} uploaded successfully.",chunkIdx,id)),chunked.done(id,chunkIdx,responseToReport,xhr),inProgressChunkIdx>=0&&inProgressChunks.splice(inProgressChunkIdx,1),handler._maybePersistChunkedState(id),chunked.hasMoreParts(id)||0!==inProgressChunks.length?chunked.hasMoreParts(id)?chunked.sendNext(id):log(qq.format("File ID {} has no more chunks to send and these chunk indexes are still marked as in-progress: {}",id,JSON.stringify(inProgressChunks))):chunked.finalize(id)},function(response,xhr){chunked.handleFailure(chunkIdx,id,response,xhr)}).done(function(){handler.clearXhr(id,chunkIdx)}))}},connectionManager={_open:[],_openChunks:{},_waiting:[],available:function(){var max=options.maxConnections,openChunkEntriesCount=0,openChunksCount=0;return qq.each(connectionManager._openChunks,function(fileId,openChunkIndexes){openChunkEntriesCount++,openChunksCount+=openChunkIndexes.length}),max-(connectionManager._open.length-openChunkEntriesCount+openChunksCount)},free:function(id,dontAllowNext){var nextId,allowNext=!dontAllowNext,waitingIndex=qq.indexOf(connectionManager._waiting,id),connectionsIndex=qq.indexOf(connectionManager._open,id);delete connectionManager._openChunks[id],upload.getProxyOrBlob(id)instanceof qq.BlobProxy&&(log("Generated blob upload has ended for "+id+", disposing generated blob."),delete handler._getFileState(id).file),waitingIndex>=0?connectionManager._waiting.splice(waitingIndex,1):allowNext&&connectionsIndex>=0&&(connectionManager._open.splice(connectionsIndex,1),(nextId=connectionManager._waiting.shift())>=0&&(connectionManager._open.push(nextId),upload.start(nextId)))},getWaitingOrConnected:function(){var waitingOrConnected=[];return qq.each(connectionManager._openChunks,function(fileId,chunks){chunks&&chunks.length&&waitingOrConnected.push(parseInt(fileId))}),qq.each(connectionManager._open,function(idx,fileId){connectionManager._openChunks[fileId]||waitingOrConnected.push(parseInt(fileId))}),waitingOrConnected=waitingOrConnected.concat(connectionManager._waiting)},isUsingConnection:function(id){return qq.indexOf(connectionManager._open,id)>=0},open:function(id,chunkIdx){return null==chunkIdx&&connectionManager._waiting.push(id),!!connectionManager.available()&&(null==chunkIdx?(connectionManager._waiting.pop(),connectionManager._open.push(id)):function(){var openChunksEntry=connectionManager._openChunks[id]||[];openChunksEntry.push(chunkIdx),connectionManager._openChunks[id]=openChunksEntry}(),!0)},reset:function(){connectionManager._waiting=[],connectionManager._open=[]}},simple={send:function(id,name){handler._getFileState(id).loaded=0,log("Sending simple upload request for "+id),handler.uploadFile(id).then(function(response,optXhr){log("Simple upload request succeeded for "+id);var responseToReport=upload.normalizeResponse(response,!0),size=options.getSize(id);options.onProgress(id,name,size,size),upload.maybeNewUuid(id,responseToReport),upload.cleanup(id,responseToReport,optXhr)},function(response,optXhr){log("Simple upload request failed for "+id);var responseToReport=upload.normalizeResponse(response,!1);options.onAutoRetry(id,name,responseToReport,optXhr)||upload.cleanup(id,responseToReport,optXhr)})}},upload={cancel:function(id){log("Cancelling "+id),options.paramsStore.remove(id),connectionManager.free(id)},cleanup:function(id,response,optXhr){var name=options.getName(id);options.onComplete(id,name,response,optXhr),handler._getFileState(id)&&handler._clearXhrs&&handler._clearXhrs(id),connectionManager.free(id)},getProxyOrBlob:function(id){return handler.getProxy&&handler.getProxy(id)||handler.getFile&&handler.getFile(id)},initHandler:function(){var handlerType=namespace?qq[namespace]:qq.traditional,handlerModuleSubtype=qq.supportedFeatures.ajaxUploading?"Xhr":"Form";handler=new handlerType[handlerModuleSubtype+"UploadHandler"](options,{getDataByUuid:options.getDataByUuid,getName:options.getName,getSize:options.getSize,getUuid:options.getUuid,log:log,onCancel:options.onCancel,onProgress:options.onProgress,onUuidChanged:options.onUuidChanged}),handler._removeExpiredChunkingRecords&&handler._removeExpiredChunkingRecords()},isDeferredEligibleForUpload:function(id){return options.isQueued(id)},maybeDefer:function(id,blob){return blob&&!handler.getFile(id)&&blob instanceof qq.BlobProxy?(options.onUploadPrep(id),log("Attempting to generate a blob on-demand for "+id),blob.create().then(function(generatedBlob){log("Generated an on-demand blob for "+id),handler.updateBlob(id,generatedBlob),options.setSize(id,generatedBlob.size),handler.reevaluateChunking(id),upload.maybeSendDeferredFiles(id)},function(errorMessage){var errorResponse={};errorMessage&&(errorResponse.error=errorMessage),log(qq.format("Failed to generate blob for ID {}.  Error message: {}.",id,errorMessage),"error"),options.onComplete(id,options.getName(id),qq.extend(errorResponse,preventRetryResponse),null),upload.maybeSendDeferredFiles(id),connectionManager.free(id)}),!1):upload.maybeSendDeferredFiles(id)},maybeSendDeferredFiles:function(id){var idsInGroup=options.getIdsInProxyGroup(id),uploadedThisId=!1;return idsInGroup&&idsInGroup.length?(log("Maybe ready to upload proxy group file "+id),qq.each(idsInGroup,function(idx,idInGroup){if(upload.isDeferredEligibleForUpload(idInGroup)&&handler.getFile(idInGroup))uploadedThisId=idInGroup===id,upload.now(idInGroup);else if(upload.isDeferredEligibleForUpload(idInGroup))return!1})):(uploadedThisId=!0,upload.now(id)),uploadedThisId},maybeNewUuid:function(id,response){void 0!==response.newUuid&&options.onUuidChanged(id,response.newUuid)},normalizeResponse:function(originalResponse,successful){var response=originalResponse;return qq.isObject(originalResponse)||(response={},qq.isString(originalResponse)&&!successful&&(response.error=originalResponse)),response.success=successful,response},now:function(id){var name=options.getName(id);if(!controller.isValid(id))throw new qq.Error(id+" is not a valid file ID to upload!");options.onUpload(id,name),chunkingPossible&&handler._shouldChunkThisFile(id)?chunked.sendNext(id):simple.send(id,name)},start:function(id){var blobToUpload=upload.getProxyOrBlob(id);return blobToUpload?upload.maybeDefer(id,blobToUpload):(upload.now(id),!0)}};qq.extend(this,{add:function(id,file){handler.add.apply(this,arguments)},upload:function(id){return!!connectionManager.open(id)&&upload.start(id)},retry:function(id){return concurrentChunkingPossible&&(handler._getFileState(id).temp.ignoreFailure=!1),connectionManager.isUsingConnection(id)?upload.start(id):controller.upload(id)},cancel:function(id){var cancelRetVal=handler.cancel(id);qq.isGenericPromise(cancelRetVal)?cancelRetVal.then(function(){upload.cancel(id)}):!1!==cancelRetVal&&upload.cancel(id)},cancelAll:function(){var i,waitingOrConnected=connectionManager.getWaitingOrConnected();if(waitingOrConnected.length)for(i=waitingOrConnected.length-1;i>=0;i--)controller.cancel(waitingOrConnected[i]);connectionManager.reset()},getFile:function(id){return handler.getProxy&&handler.getProxy(id)?handler.getProxy(id).referenceBlob:handler.getFile&&handler.getFile(id)},isProxied:function(id){return!(!handler.getProxy||!handler.getProxy(id))},getInput:function(id){if(handler.getInput)return handler.getInput(id)},reset:function(){log("Resetting upload handler"),controller.cancelAll(),connectionManager.reset(),handler.reset()},expunge:function(id){if(controller.isValid(id))return handler.expunge(id)},isValid:function(id){return handler.isValid(id)},getResumableFilesData:function(){return handler.getResumableFilesData?handler.getResumableFilesData():[]},getThirdPartyFileId:function(id){if(controller.isValid(id))return handler.getThirdPartyFileId(id)},pause:function(id){return!!(controller.isResumable(id)&&handler.pause&&controller.isValid(id)&&handler.pause(id))&&(connectionManager.free(id),handler.moveInProgressToRemaining(id),!0)},isResumable:function(id){return!!handler.isResumable&&handler.isResumable(id)}}),qq.extend(options,o),log=options.log,chunkingPossible=options.chunking.enabled&&qq.supportedFeatures.chunking,concurrentChunkingPossible=chunkingPossible&&options.chunking.concurrent.enabled,preventRetryResponse=function(){var response={};return response[options.preventRetryParam]=!0,response}(),upload.initHandler()},qq.WindowReceiveMessage=function(o){"use strict";var options={log:function(message,level){}},callbackWrapperDetachers={};qq.extend(options,o),qq.extend(this,{receiveMessage:function(id,callback){var onMessageCallbackWrapper=function(event){callback(event.data)};window.postMessage?callbackWrapperDetachers[id]=qq(window).attach("message",onMessageCallbackWrapper):log("iframe message passing not supported in this browser!","error")},stopReceivingMessages:function(id){if(window.postMessage){var detacher=callbackWrapperDetachers[id];detacher&&detacher()}}})},qq.FormUploadHandler=function(spec){"use strict";function expungeFile(id){delete detachLoadEvents[id],isCors&&(clearTimeout(postMessageCallbackTimers[id]),delete postMessageCallbackTimers[id],corsMessageReceiver.stopReceivingMessages(id));var iframe=document.getElementById(handler._getIframeName(id));iframe&&(iframe.setAttribute("src","javascript:false;"),qq(iframe).remove())}function getFileIdForIframeName(iframeName){return iframeName.split("_")[0]}function initIframeForUpload(name){var iframe=qq.toElement("<iframe src='javascript:false;' name='"+name+"' />");return iframe.setAttribute("id",name),iframe.style.display="none",document.body.appendChild(iframe),iframe}function registerPostMessageCallback(iframe,callback){var iframeName=iframe.id,fileId=getFileIdForIframeName(iframeName),uuid=getUuid(fileId);onloadCallbacks[uuid]=callback,detachLoadEvents[fileId]=qq(iframe).attach("load",function(){handler.getInput(fileId)&&(log("Received iframe load event for CORS upload request (iframe name "+iframeName+")"),postMessageCallbackTimers[iframeName]=setTimeout(function(){var errorMessage="No valid message received from loaded iframe for iframe name "+iframeName;log(errorMessage,"error"),callback({error:errorMessage})},1e3))}),corsMessageReceiver.receiveMessage(iframeName,function(message){log("Received the following window message: '"+message+"'");var onloadCallback,response=(getFileIdForIframeName(iframeName),handler._parseJsonResponse(message)),uuid=response.uuid;uuid&&onloadCallbacks[uuid]?(log("Handling response for iframe name "+iframeName),clearTimeout(postMessageCallbackTimers[iframeName]),delete postMessageCallbackTimers[iframeName],handler._detachLoadEvent(iframeName),onloadCallback=onloadCallbacks[uuid],delete onloadCallbacks[uuid],corsMessageReceiver.stopReceivingMessages(iframeName),onloadCallback(response)):uuid||log("'"+message+"' does not contain a UUID - ignoring.")})}var options=spec.options,handler=this,proxy=spec.proxy,formHandlerInstanceId=qq.getUniqueId(),onloadCallbacks={},detachLoadEvents={},postMessageCallbackTimers={},isCors=options.isCors,inputName=options.inputName,getUuid=proxy.getUuid,log=proxy.log,corsMessageReceiver=new qq.WindowReceiveMessage({log:log});qq.extend(this,new qq.UploadHandler(spec)),qq.override(this,function(super_){return{add:function(id,fileInput){super_.add(id,{input:fileInput}),fileInput.setAttribute("name",inputName),fileInput.parentNode&&qq(fileInput).remove()},expunge:function(id){expungeFile(id),super_.expunge(id)},isValid:function(id){return super_.isValid(id)&&void 0!==handler._getFileState(id).input}}}),qq.extend(this,{getInput:function(id){return handler._getFileState(id).input},_attachLoadEvent:function(iframe,callback){var responseDescriptor;isCors?registerPostMessageCallback(iframe,callback):detachLoadEvents[iframe.id]=qq(iframe).attach("load",function(){if(log("Received response for "+iframe.id),iframe.parentNode){try{if(iframe.contentDocument&&iframe.contentDocument.body&&"false"==iframe.contentDocument.body.innerHTML)return}catch(error){log("Error when attempting to access iframe during handling of upload response ("+error.message+")","error"),responseDescriptor={success:!1}}callback(responseDescriptor)}})},_createIframe:function(id){return initIframeForUpload(handler._getIframeName(id))},_detachLoadEvent:function(id){void 0!==detachLoadEvents[id]&&(detachLoadEvents[id](),delete detachLoadEvents[id])},_getIframeName:function(fileId){return fileId+"_"+formHandlerInstanceId},_initFormForUpload:function(spec){var method=spec.method,endpoint=spec.endpoint,params=spec.params,paramsInBody=spec.paramsInBody,targetName=spec.targetName,form=qq.toElement("<form method='"+method+"' enctype='multipart/form-data'></form>"),url=endpoint;return paramsInBody?qq.obj2Inputs(params,form):url=qq.obj2url(params,endpoint),form.setAttribute("action",url),form.setAttribute("target",targetName),form.style.display="none",document.body.appendChild(form),form},_parseJsonResponse:function(innerHtmlOrMessage){var response={};try{response=qq.parseJson(innerHtmlOrMessage)}catch(error){log("Error when attempting to parse iframe upload response ("+error.message+")","error")}return response}})},qq.XhrUploadHandler=function(spec){"use strict";function abort(id){qq.each(handler._getXhrs(id),function(xhrId,xhr){var ajaxRequester=handler._getAjaxRequester(id,xhrId);xhr.onreadystatechange=null,xhr.upload.onprogress=null,xhr.abort(),ajaxRequester&&ajaxRequester.canceled&&ajaxRequester.canceled(id)})}var handler=this,namespace=spec.options.namespace,proxy=spec.proxy,chunking=spec.options.chunking,resume=spec.options.resume,chunkFiles=chunking&&spec.options.chunking.enabled&&qq.supportedFeatures.chunking,resumeEnabled=resume&&spec.options.resume.enabled&&chunkFiles&&qq.supportedFeatures.resume,getName=proxy.getName,getSize=proxy.getSize,getUuid=proxy.getUuid,getEndpoint=proxy.getEndpoint,getDataByUuid=proxy.getDataByUuid,onUuidChanged=proxy.onUuidChanged,onProgress=proxy.onProgress,log=proxy.log;qq.extend(this,new qq.UploadHandler(spec)),qq.override(this,function(super_){return{add:function(id,blobOrProxy){if(qq.isFile(blobOrProxy)||qq.isBlob(blobOrProxy))super_.add(id,{file:blobOrProxy});else{if(!(blobOrProxy instanceof qq.BlobProxy))throw new Error("Passed obj is not a File, Blob, or proxy");super_.add(id,{proxy:blobOrProxy})}handler._initTempState(id),resumeEnabled&&handler._maybePrepareForResume(id)},expunge:function(id){abort(id),handler._maybeDeletePersistedChunkData(id),handler._clearXhrs(id),super_.expunge(id)}}}),qq.extend(this,{clearCachedChunk:function(id,chunkIdx){delete handler._getFileState(id).temp.cachedChunks[chunkIdx]},clearXhr:function(id,chunkIdx){var tempState=handler._getFileState(id).temp;tempState.xhrs&&delete tempState.xhrs[chunkIdx],tempState.ajaxRequesters&&delete tempState.ajaxRequesters[chunkIdx]},finalizeChunks:function(id,responseParser){var lastChunkIdx=handler._getTotalChunks(id)-1,xhr=handler._getXhr(id,lastChunkIdx);return responseParser?(new qq.Promise).success(responseParser(xhr),xhr):(new qq.Promise).success({},xhr)},getFile:function(id){return handler.isValid(id)&&handler._getFileState(id).file},getProxy:function(id){return handler.isValid(id)&&handler._getFileState(id).proxy},getResumableFilesData:function(){var resumableFilesData=[];return handler._iterateResumeRecords(function(key,uploadData){handler.moveInProgressToRemaining(null,uploadData.chunking.inProgress,uploadData.chunking.remaining);var data={name:uploadData.name,remaining:uploadData.chunking.remaining,size:uploadData.size,uuid:uploadData.uuid};uploadData.key&&(data.key=uploadData.key),resumableFilesData.push(data)}),resumableFilesData},isResumable:function(id){return!!chunking&&handler.isValid(id)&&!handler._getFileState(id).notResumable},moveInProgressToRemaining:function(id,optInProgress,optRemaining){var inProgress=optInProgress||handler._getFileState(id).chunking.inProgress,remaining=optRemaining||handler._getFileState(id).chunking.remaining;inProgress&&(log(qq.format("Moving these chunks from in-progress {}, to remaining.",JSON.stringify(inProgress))),inProgress.reverse(),qq.each(inProgress,function(idx,chunkIdx){remaining.unshift(chunkIdx)}),inProgress.length=0)},pause:function(id){if(handler.isValid(id))return log(qq.format("Aborting XHR upload for {} '{}' due to pause instruction.",id,getName(id))),handler._getFileState(id).paused=!0,abort(id),!0},reevaluateChunking:function(id){if(chunking&&handler.isValid(id)){var totalChunks,i,state=handler._getFileState(id);if(delete state.chunking,state.chunking={},(totalChunks=handler._getTotalChunks(id))>1||chunking.mandatory){for(state.chunking.enabled=!0,state.chunking.parts=totalChunks,state.chunking.remaining=[],i=0;i<totalChunks;i++)state.chunking.remaining.push(i);handler._initTempState(id)}else state.chunking.enabled=!1}},updateBlob:function(id,newBlob){handler.isValid(id)&&(handler._getFileState(id).file=newBlob)},_clearXhrs:function(id){var tempState=handler._getFileState(id).temp;qq.each(tempState.ajaxRequesters,function(chunkId){delete tempState.ajaxRequesters[chunkId]}),qq.each(tempState.xhrs,function(chunkId){delete tempState.xhrs[chunkId]})},_createXhr:function(id,optChunkIdx){return handler._registerXhr(id,optChunkIdx,qq.createXhrInstance())},_getAjaxRequester:function(id,optChunkIdx){var chunkIdx=null==optChunkIdx?-1:optChunkIdx;return handler._getFileState(id).temp.ajaxRequesters[chunkIdx]},_getChunkData:function(id,chunkIndex){var chunkSize=chunking.partSize,fileSize=getSize(id),fileOrBlob=handler.getFile(id),startBytes=chunkSize*chunkIndex,endBytes=startBytes+chunkSize>=fileSize?fileSize:startBytes+chunkSize,totalChunks=handler._getTotalChunks(id),cachedChunks=this._getFileState(id).temp.cachedChunks,blob=cachedChunks[chunkIndex]||qq.sliceBlob(fileOrBlob,startBytes,endBytes);return cachedChunks[chunkIndex]=blob,{part:chunkIndex,start:startBytes,end:endBytes,count:totalChunks,blob:blob,size:endBytes-startBytes}},_getChunkDataForCallback:function(chunkData){return{partIndex:chunkData.part,startByte:chunkData.start+1,endByte:chunkData.end,totalParts:chunkData.count}},_getLocalStorageId:function(id){var name=getName(id),size=getSize(id),chunkSize=chunking.partSize,endpoint=getEndpoint(id);return qq.format("qq{}resume{}-{}-{}-{}-{}",namespace,"5.0",name,size,chunkSize,endpoint)},_getMimeType:function(id){return handler.getFile(id).type},_getPersistableData:function(id){return handler._getFileState(id).chunking},_getTotalChunks:function(id){if(chunking){var fileSize=getSize(id),chunkSize=chunking.partSize;return Math.ceil(fileSize/chunkSize)}},_getXhr:function(id,optChunkIdx){var chunkIdx=null==optChunkIdx?-1:optChunkIdx;return handler._getFileState(id).temp.xhrs[chunkIdx]},_getXhrs:function(id){return handler._getFileState(id).temp.xhrs},_iterateResumeRecords:function(callback){resumeEnabled&&qq.each(localStorage,function(key,item){if(0===key.indexOf(qq.format("qq{}resume",namespace))){var uploadData=JSON.parse(item);callback(key,uploadData)}})},_initTempState:function(id){handler._getFileState(id).temp={ajaxRequesters:{},chunkProgress:{},xhrs:{},cachedChunks:{}}},_markNotResumable:function(id){handler._getFileState(id).notResumable=!0},_maybeDeletePersistedChunkData:function(id){var localStorageId;return!!(resumeEnabled&&handler.isResumable(id)&&(localStorageId=handler._getLocalStorageId(id))&&localStorage.getItem(localStorageId))&&(localStorage.removeItem(localStorageId),!0)},_maybePrepareForResume:function(id){var localStorageId,persistedData,state=handler._getFileState(id);resumeEnabled&&void 0===state.key&&(localStorageId=handler._getLocalStorageId(id),(persistedData=localStorage.getItem(localStorageId))&&(persistedData=JSON.parse(persistedData),getDataByUuid(persistedData.uuid)?handler._markNotResumable(id):(log(qq.format("Identified file with ID {} and name of {} as resumable.",id,getName(id))),onUuidChanged(id,persistedData.uuid),state.key=persistedData.key,state.chunking=persistedData.chunking,state.loaded=persistedData.loaded,state.attemptingResume=!0,handler.moveInProgressToRemaining(id))))},_maybePersistChunkedState:function(id){var localStorageId,persistedData,state=handler._getFileState(id);if(resumeEnabled&&handler.isResumable(id)){localStorageId=handler._getLocalStorageId(id),persistedData={name:getName(id),size:getSize(id),uuid:getUuid(id),key:state.key,chunking:state.chunking,loaded:state.loaded,lastUpdated:Date.now()};try{localStorage.setItem(localStorageId,JSON.stringify(persistedData))}catch(error){log(qq.format("Unable to save resume data for '{}' due to error: '{}'.",id,error.toString()),"warn")}}},_registerProgressHandler:function(id,chunkIdx,chunkSize){var xhr=handler._getXhr(id,chunkIdx),name=getName(id),progressCalculator={simple:function(loaded,total){var fileSize=getSize(id);loaded===total?onProgress(id,name,fileSize,fileSize):onProgress(id,name,loaded>=fileSize?fileSize-1:loaded,fileSize)},chunked:function(loaded,total){var chunkProgress=handler._getFileState(id).temp.chunkProgress,totalSuccessfullyLoadedForFile=handler._getFileState(id).loaded,loadedForRequest=loaded,totalForRequest=total,totalFileSize=getSize(id),estActualChunkLoaded=loadedForRequest-(totalForRequest-chunkSize),totalLoadedForFile=totalSuccessfullyLoadedForFile;chunkProgress[chunkIdx]=estActualChunkLoaded,qq.each(chunkProgress,function(chunkIdx,chunkLoaded){totalLoadedForFile+=chunkLoaded}),onProgress(id,name,totalLoadedForFile,totalFileSize)}};xhr.upload.onprogress=function(e){if(e.lengthComputable){progressCalculator[null==chunkSize?"simple":"chunked"](e.loaded,e.total)}}},_registerXhr:function(id,optChunkIdx,xhr,optAjaxRequester){var xhrsId=null==optChunkIdx?-1:optChunkIdx,tempState=handler._getFileState(id).temp;return tempState.xhrs=tempState.xhrs||{},tempState.ajaxRequesters=tempState.ajaxRequesters||{},tempState.xhrs[xhrsId]=xhr,optAjaxRequester&&(tempState.ajaxRequesters[xhrsId]=optAjaxRequester),xhr},_removeExpiredChunkingRecords:function(){var expirationDays=resume.recordsExpireIn;handler._iterateResumeRecords(function(key,uploadData){var expirationDate=new Date(uploadData.lastUpdated);expirationDate.setDate(expirationDate.getDate()+expirationDays),expirationDate.getTime()<=Date.now()&&(log("Removing expired resume record with key "+key),localStorage.removeItem(key))})},_shouldChunkThisFile:function(id){var state=handler._getFileState(id);return state.chunking||handler.reevaluateChunking(id),state.chunking.enabled}})},qq.DeleteFileAjaxRequester=function(o){"use strict";var requester,options={method:"DELETE",uuidParamName:"qquuid",endpointStore:{},maxConnections:3,customHeaders:function(id){return{}},paramsStore:{},cors:{expected:!1,sendCredentials:!1},log:function(str,level){},onDelete:function(id){},onDeleteComplete:function(id,xhrOrXdr,isError){}};qq.extend(options,o),requester=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:["POST","DELETE"],method:options.method,endpointStore:options.endpointStore,paramsStore:options.paramsStore,mandatedParams:function(){return"POST"===options.method.toUpperCase()?{_method:"DELETE"}:{}}(),maxConnections:options.maxConnections,customHeaders:function(id){return options.customHeaders.get(id)},log:options.log,onSend:options.onDelete,onComplete:options.onDeleteComplete,cors:options.cors})),qq.extend(this,{sendDelete:function(id,uuid,additionalMandatedParams){var additionalOptions=additionalMandatedParams||{};options.log("Submitting delete file request for "+id),"DELETE"===options.method?requester.initTransport(id).withPath(uuid).withParams(additionalOptions).send():(additionalOptions[options.uuidParamName]=uuid,requester.initTransport(id).withParams(additionalOptions).send())}})},function(){function detectSubsampling(img){var ctx,iw=img.naturalWidth,ih=img.naturalHeight,canvas=document.createElement("canvas");return iw*ih>1048576&&(canvas.width=canvas.height=1,ctx=canvas.getContext("2d"),ctx.drawImage(img,1-iw,0),0===ctx.getImageData(0,0,1,1).data[3])}function detectVerticalSquash(img,iw,ih){var ctx,data,alpha,ratio,canvas=document.createElement("canvas"),sy=0,ey=ih,py=ih;for(canvas.width=1,canvas.height=ih,ctx=canvas.getContext("2d"),ctx.drawImage(img,0,0),data=ctx.getImageData(0,0,1,ih).data;py>sy;)alpha=data[4*(py-1)+3],0===alpha?ey=py:sy=py,py=ey+sy>>1;return ratio=py/ih,0===ratio?1:ratio}function renderImageToDataURL(img,blob,options,doSquash){var canvas=document.createElement("canvas"),mime=options.mime||"image/jpeg",promise=new qq.Promise;return renderImageToCanvas(img,blob,canvas,options,doSquash).then(function(){promise.success(canvas.toDataURL(mime,options.quality||.8))}),promise}function maybeCalculateDownsampledDimensions(spec){if(!qq.ios())throw new qq.Error("Downsampled dimensions can only be reliably calculated for iOS!");if(spec.origHeight*spec.origWidth>5241e3)return{newHeight:Math.round(Math.sqrt(spec.origHeight/spec.origWidth*5241e3)),newWidth:Math.round(Math.sqrt(spec.origWidth/spec.origHeight*5241e3))}}function renderImageToCanvas(img,blob,canvas,options,doSquash){var modifiedDimensions,iw=img.naturalWidth,ih=img.naturalHeight,width=options.width,height=options.height,ctx=canvas.getContext("2d"),promise=new qq.Promise;return ctx.save(),options.resize?renderImageToCanvasWithCustomResizer({blob:blob,canvas:canvas,image:img,imageHeight:ih,imageWidth:iw,orientation:options.orientation,resize:options.resize,targetHeight:height,targetWidth:width}):(qq.supportedFeatures.unlimitedScaledImageSize||(modifiedDimensions=maybeCalculateDownsampledDimensions({origWidth:width,origHeight:height}))&&(qq.log(qq.format("Had to reduce dimensions due to device limitations from {}w / {}h to {}w / {}h",width,height,modifiedDimensions.newWidth,modifiedDimensions.newHeight),"warn"),width=modifiedDimensions.newWidth,height=modifiedDimensions.newHeight),transformCoordinate(canvas,width,height,options.orientation),qq.ios()?function(){detectSubsampling(img)&&(iw/=2,ih/=2);var tmpCtx,sx,dx,d=1024,tmpCanvas=document.createElement("canvas"),vertSquashRatio=doSquash?detectVerticalSquash(img,iw,ih):1,dw=Math.ceil(d*width/iw),dh=Math.ceil(d*height/ih/vertSquashRatio),sy=0,dy=0;for(tmpCanvas.width=tmpCanvas.height=d,tmpCtx=tmpCanvas.getContext("2d");sy<ih;){for(sx=0,dx=0;sx<iw;)tmpCtx.clearRect(0,0,d,d),
tmpCtx.drawImage(img,-sx,-sy),ctx.drawImage(tmpCanvas,0,0,d,d,dx,dy,dw,dh),sx+=d,dx+=dw;sy+=d,dy+=dh}ctx.restore(),tmpCanvas=tmpCtx=null}():ctx.drawImage(img,0,0,width,height),canvas.qqImageRendered&&canvas.qqImageRendered(),promise.success(),promise)}function renderImageToCanvasWithCustomResizer(resizeInfo){var blob=resizeInfo.blob,image=resizeInfo.image,imageHeight=resizeInfo.imageHeight,imageWidth=resizeInfo.imageWidth,orientation=resizeInfo.orientation,promise=new qq.Promise,resize=resizeInfo.resize,sourceCanvas=document.createElement("canvas"),sourceCanvasContext=sourceCanvas.getContext("2d"),targetCanvas=resizeInfo.canvas,targetHeight=resizeInfo.targetHeight,targetWidth=resizeInfo.targetWidth;return transformCoordinate(sourceCanvas,imageWidth,imageHeight,orientation),targetCanvas.height=targetHeight,targetCanvas.width=targetWidth,sourceCanvasContext.drawImage(image,0,0),resize({blob:blob,height:targetHeight,image:image,sourceCanvas:sourceCanvas,targetCanvas:targetCanvas,width:targetWidth}).then(function(){targetCanvas.qqImageRendered&&targetCanvas.qqImageRendered(),promise.success()},promise.failure),promise}function transformCoordinate(canvas,width,height,orientation){switch(orientation){case 5:case 6:case 7:case 8:canvas.width=height,canvas.height=width;break;default:canvas.width=width,canvas.height=height}var ctx=canvas.getContext("2d");switch(orientation){case 2:ctx.translate(width,0),ctx.scale(-1,1);break;case 3:ctx.translate(width,height),ctx.rotate(Math.PI);break;case 4:ctx.translate(0,height),ctx.scale(1,-1);break;case 5:ctx.rotate(.5*Math.PI),ctx.scale(1,-1);break;case 6:ctx.rotate(.5*Math.PI),ctx.translate(0,-height);break;case 7:ctx.rotate(.5*Math.PI),ctx.translate(width,-height),ctx.scale(-1,1);break;case 8:ctx.rotate(-.5*Math.PI),ctx.translate(-width,0)}}function MegaPixImage(srcImage,errorCallback){var self=this;window.Blob&&srcImage instanceof Blob&&function(){var img=new Image,URL=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;if(!URL)throw Error("No createObjectURL function found to create blob url");img.src=URL.createObjectURL(srcImage),self.blob=srcImage,srcImage=img}(),srcImage.naturalWidth||srcImage.naturalHeight||(srcImage.onload=function(){var listeners=self.imageLoadListeners;listeners&&(self.imageLoadListeners=null,setTimeout(function(){for(var i=0,len=listeners.length;i<len;i++)listeners[i]()},0))},srcImage.onerror=errorCallback,this.imageLoadListeners=[]),this.srcImage=srcImage}MegaPixImage.prototype.render=function(target,options){options=options||{};var opt,self=this,imgWidth=this.srcImage.naturalWidth,imgHeight=this.srcImage.naturalHeight,width=options.width,height=options.height,maxWidth=options.maxWidth,maxHeight=options.maxHeight,doSquash=!this.blob||"image/jpeg"===this.blob.type,tagName=target.tagName.toLowerCase();if(this.imageLoadListeners)return void this.imageLoadListeners.push(function(){self.render(target,options)});width&&!height?height=imgHeight*width/imgWidth<<0:height&&!width?width=imgWidth*height/imgHeight<<0:(width=imgWidth,height=imgHeight),maxWidth&&width>maxWidth&&(width=maxWidth,height=imgHeight*width/imgWidth<<0),maxHeight&&height>maxHeight&&(height=maxHeight,width=imgWidth*height/imgHeight<<0),opt={width:width,height:height},qq.each(options,function(optionsKey,optionsValue){opt[optionsKey]=optionsValue}),"img"===tagName?function(){var oldTargetSrc=target.src;renderImageToDataURL(self.srcImage,self.blob,opt,doSquash).then(function(dataUri){target.src=dataUri,oldTargetSrc===target.src&&target.onload()})}():"canvas"===tagName&&renderImageToCanvas(this.srcImage,this.blob,target,opt,doSquash),"function"==typeof this.onrender&&this.onrender(target)},qq.MegaPixImage=MegaPixImage}(),qq.ImageGenerator=function(log){"use strict";function isImg(el){return"img"===el.tagName.toLowerCase()}function isCanvas(el){return"canvas"===el.tagName.toLowerCase()}function isImgCorsSupported(){return void 0!==(new Image).crossOrigin}function isCanvasSupported(){var canvas=document.createElement("canvas");return canvas.getContext&&canvas.getContext("2d")}function determineMimeOfFileName(nameWithPath){var pathSegments=nameWithPath.split("/"),name=pathSegments[pathSegments.length-1].split("?")[0],extension=qq.getExtension(name);switch(extension=extension&&extension.toLowerCase()){case"jpeg":case"jpg":return"image/jpeg";case"png":return"image/png";case"bmp":return"image/bmp";case"gif":return"image/gif";case"tiff":case"tif":return"image/tiff"}}function isCrossOrigin(url){var targetProtocol,targetHostname,targetPort,targetAnchor=document.createElement("a");return targetAnchor.href=url,targetProtocol=targetAnchor.protocol,targetPort=targetAnchor.port,targetHostname=targetAnchor.hostname,targetProtocol.toLowerCase()!==window.location.protocol.toLowerCase()||(targetHostname.toLowerCase()!==window.location.hostname.toLowerCase()||targetPort!==window.location.port&&!qq.ie())}function registerImgLoadListeners(img,promise){img.onload=function(){img.onload=null,img.onerror=null,promise.success(img)},img.onerror=function(){img.onload=null,img.onerror=null,log("Problem drawing thumbnail!","error"),promise.failure(img,"Problem drawing thumbnail!")}}function registerCanvasDrawImageListener(canvas,promise){canvas.qqImageRendered=function(){promise.success(canvas)}}function registerThumbnailRenderedListener(imgOrCanvas,promise){var registered=isImg(imgOrCanvas)||isCanvas(imgOrCanvas);return isImg(imgOrCanvas)?registerImgLoadListeners(imgOrCanvas,promise):isCanvas(imgOrCanvas)?registerCanvasDrawImageListener(imgOrCanvas,promise):(promise.failure(imgOrCanvas),log(qq.format("Element container of type {} is not supported!",imgOrCanvas.tagName),"error")),registered}function draw(fileOrBlob,container,options){var drawPreview=new qq.Promise,identifier=new qq.Identify(fileOrBlob,log),maxSize=options.maxSize,orient=null==options.orient||options.orient,megapixErrorHandler=function(){container.onerror=null,container.onload=null,log("Could not render preview, file may be too large!","error"),drawPreview.failure(container,"Browser cannot render image!")};return identifier.isPreviewable().then(function(mime){var dummyExif={parse:function(){return(new qq.Promise).success()}},exif=orient?new qq.Exif(fileOrBlob,log):dummyExif,mpImg=new qq.MegaPixImage(fileOrBlob,megapixErrorHandler);registerThumbnailRenderedListener(container,drawPreview)&&exif.parse().then(function(exif){var orientation=exif&&exif.Orientation;mpImg.render(container,{maxWidth:maxSize,maxHeight:maxSize,orientation:orientation,mime:mime,resize:options.customResizeFunction})},function(failureMsg){log(qq.format("EXIF data could not be parsed ({}).  Assuming orientation = 1.",failureMsg)),mpImg.render(container,{maxWidth:maxSize,maxHeight:maxSize,mime:mime,resize:options.customResizeFunction})})},function(){log("Not previewable"),drawPreview.failure(container,"Not previewable")}),drawPreview}function drawOnCanvasOrImgFromUrl(url,canvasOrImg,draw,maxSize,customResizeFunction){var tempImg=new Image,tempImgRender=new qq.Promise;registerThumbnailRenderedListener(tempImg,tempImgRender),isCrossOrigin(url)&&(tempImg.crossOrigin="anonymous"),tempImg.src=url,tempImgRender.then(function(){registerThumbnailRenderedListener(canvasOrImg,draw),new qq.MegaPixImage(tempImg).render(canvasOrImg,{maxWidth:maxSize,maxHeight:maxSize,mime:determineMimeOfFileName(url),resize:customResizeFunction})},draw.failure)}function drawOnImgFromUrlWithCssScaling(url,img,draw,maxSize){registerThumbnailRenderedListener(img,draw),qq(img).css({maxWidth:maxSize+"px",maxHeight:maxSize+"px"}),img.src=url}function drawFromUrl(url,container,options){var draw=new qq.Promise,scale=options.scale,maxSize=scale?options.maxSize:null;return scale&&isImg(container)?isCanvasSupported()?isCrossOrigin(url)&&!isImgCorsSupported()?drawOnImgFromUrlWithCssScaling(url,container,draw,maxSize):drawOnCanvasOrImgFromUrl(url,container,draw,maxSize):drawOnImgFromUrlWithCssScaling(url,container,draw,maxSize):isCanvas(container)?drawOnCanvasOrImgFromUrl(url,container,draw,maxSize):registerThumbnailRenderedListener(container,draw)&&(container.src=url),draw}qq.extend(this,{generate:function(fileBlobOrUrl,container,options){return qq.isString(fileBlobOrUrl)?(log("Attempting to update thumbnail based on server response."),drawFromUrl(fileBlobOrUrl,container,options||{})):(log("Attempting to draw client-side image preview."),draw(fileBlobOrUrl,container,options||{}))}}),this._testing={},this._testing.isImg=isImg,this._testing.isCanvas=isCanvas,this._testing.isCrossOrigin=isCrossOrigin,this._testing.determineMimeOfFileName=determineMimeOfFileName},qq.Exif=function(fileOrBlob,log){"use strict";function parseLittleEndian(hex){for(var result=0,pow=0;hex.length>0;)result+=parseInt(hex.substring(0,2),16)*Math.pow(2,pow),hex=hex.substring(2,hex.length),pow+=8;return result}function seekToApp1(offset,promise){var theOffset=offset,thePromise=promise;return void 0===theOffset&&(theOffset=2,thePromise=new qq.Promise),qq.readBlobToHex(fileOrBlob,theOffset,4).then(function(hex){var segmentLength,match=/^ffe([0-9])/.exec(hex);match?"1"!==match[1]?(segmentLength=parseInt(hex.slice(4,8),16),seekToApp1(theOffset+segmentLength+2,thePromise)):thePromise.success(theOffset):thePromise.failure("No EXIF header to be found!")}),thePromise}function getApp1Offset(){var promise=new qq.Promise;return qq.readBlobToHex(fileOrBlob,0,6).then(function(hex){0!==hex.indexOf("ffd8")?promise.failure("Not a valid JPEG!"):seekToApp1().then(function(offset){promise.success(offset)},function(error){promise.failure(error)})}),promise}function isLittleEndian(app1Start){var promise=new qq.Promise;return qq.readBlobToHex(fileOrBlob,app1Start+10,2).then(function(hex){promise.success("4949"===hex)}),promise}function getDirEntryCount(app1Start,littleEndian){var promise=new qq.Promise;return qq.readBlobToHex(fileOrBlob,app1Start+18,2).then(function(hex){if(littleEndian)return promise.success(parseLittleEndian(hex));promise.success(parseInt(hex,16))}),promise}function getIfd(app1Start,dirEntries){var offset=app1Start+20,bytes=12*dirEntries;return qq.readBlobToHex(fileOrBlob,offset,bytes)}function getDirEntries(ifdHex){for(var entries=[],offset=0;offset+24<=ifdHex.length;)entries.push(ifdHex.slice(offset,offset+24)),offset+=24;return entries}function getTagValues(littleEndian,dirEntries){var tagsToFind=qq.extend([],TAG_IDS),vals={};return qq.each(dirEntries,function(idx,entry){var tagValHex,tagName,tagValLength,idHex=entry.slice(0,4),id=littleEndian?parseLittleEndian(idHex):parseInt(idHex,16),tagsToFindIdx=tagsToFind.indexOf(id);if(tagsToFindIdx>=0&&(tagName=TAG_INFO[id].name,tagValLength=TAG_INFO[id].bytes,tagValHex=entry.slice(16,16+2*tagValLength),vals[tagName]=littleEndian?parseLittleEndian(tagValHex):parseInt(tagValHex,16),tagsToFind.splice(tagsToFindIdx,1)),0===tagsToFind.length)return!1}),vals}var TAG_IDS=[274],TAG_INFO={274:{name:"Orientation",bytes:2}};qq.extend(this,{parse:function(){var parser=new qq.Promise,onParseFailure=function(message){log(qq.format("EXIF header parse failed: '{}' ",message)),parser.failure(message)};return getApp1Offset().then(function(app1Offset){log(qq.format("Moving forward with EXIF header parsing for '{}'",void 0===fileOrBlob.name?"blob":fileOrBlob.name)),isLittleEndian(app1Offset).then(function(littleEndian){log(qq.format("EXIF Byte order is {} endian",littleEndian?"little":"big")),getDirEntryCount(app1Offset,littleEndian).then(function(dirEntryCount){log(qq.format("Found {} APP1 directory entries",dirEntryCount)),getIfd(app1Offset,dirEntryCount).then(function(ifdHex){var dirEntries=getDirEntries(ifdHex),tagValues=getTagValues(littleEndian,dirEntries);log("Successfully parsed some EXIF tags"),parser.success(tagValues)},onParseFailure)},onParseFailure)},onParseFailure)},onParseFailure),parser}}),this._testing={},this._testing.parseLittleEndian=parseLittleEndian},qq.Identify=function(fileOrBlob,log){"use strict";function isIdentifiable(magicBytes,questionableBytes){var identifiable=!1,magicBytesEntries=[].concat(magicBytes);return qq.each(magicBytesEntries,function(idx,magicBytesArrayEntry){if(0===questionableBytes.indexOf(magicBytesArrayEntry))return identifiable=!0,!1}),identifiable}qq.extend(this,{isPreviewable:function(){var self=this,identifier=new qq.Promise,previewable=!1,name=void 0===fileOrBlob.name?"blob":fileOrBlob.name;return log(qq.format("Attempting to determine if {} can be rendered in this browser",name)),log("First pass: check type attribute of blob object."),this.isPreviewableSync()?(log("Second pass: check for magic bytes in file header."),qq.readBlobToHex(fileOrBlob,0,4).then(function(hex){qq.each(self.PREVIEWABLE_MIME_TYPES,function(mime,bytes){if(isIdentifiable(bytes,hex))return("image/tiff"!==mime||qq.supportedFeatures.tiffPreviews)&&(previewable=!0,identifier.success(mime)),!1}),log(qq.format("'{}' is {} able to be rendered in this browser",name,previewable?"":"NOT")),previewable||identifier.failure()},function(){log("Error reading file w/ name '"+name+"'.  Not able to be rendered in this browser."),identifier.failure()})):identifier.failure(),identifier},isPreviewableSync:function(){var fileMime=fileOrBlob.type,isRecognizedImage=qq.indexOf(Object.keys(this.PREVIEWABLE_MIME_TYPES),fileMime)>=0,previewable=!1,name=void 0===fileOrBlob.name?"blob":fileOrBlob.name;return isRecognizedImage&&(previewable="image/tiff"!==fileMime||qq.supportedFeatures.tiffPreviews),!previewable&&log(name+" is not previewable in this browser per the blob's type attr"),previewable}})},qq.Identify.prototype.PREVIEWABLE_MIME_TYPES={"image/jpeg":"ffd8ff","image/gif":"474946","image/png":"89504e","image/bmp":"424d","image/tiff":["49492a00","4d4d002a"]},qq.ImageValidation=function(blob,log){"use strict";function hasNonZeroLimits(limits){var atLeastOne=!1;return qq.each(limits,function(limit,value){if(value>0)return atLeastOne=!0,!1}),atLeastOne}function getWidthHeight(){var sizeDetermination=new qq.Promise;return new qq.Identify(blob,log).isPreviewable().then(function(){var image=new Image,url=window.URL&&window.URL.createObjectURL?window.URL:window.webkitURL&&window.webkitURL.createObjectURL?window.webkitURL:null;url?(image.onerror=function(){log("Cannot determine dimensions for image.  May be too large.","error"),sizeDetermination.failure()},image.onload=function(){sizeDetermination.success({width:this.width,height:this.height})},image.src=url.createObjectURL(blob)):(log("No createObjectURL function available to generate image URL!","error"),sizeDetermination.failure())},sizeDetermination.failure),sizeDetermination}function getFailingLimit(limits,dimensions){var failingLimit;return qq.each(limits,function(limitName,limitValue){if(limitValue>0){var limitMatcher=/(max|min)(Width|Height)/.exec(limitName),dimensionPropName=limitMatcher[2].charAt(0).toLowerCase()+limitMatcher[2].slice(1),actualValue=dimensions[dimensionPropName];switch(limitMatcher[1]){case"min":if(actualValue<limitValue)return failingLimit=limitName,!1;break;case"max":if(actualValue>limitValue)return failingLimit=limitName,!1}}}),failingLimit}this.validate=function(limits){var validationEffort=new qq.Promise;return log("Attempting to validate image."),hasNonZeroLimits(limits)?getWidthHeight().then(function(dimensions){var failingLimit=getFailingLimit(limits,dimensions);failingLimit?validationEffort.failure(failingLimit):validationEffort.success()},validationEffort.success):validationEffort.success(),validationEffort}},qq.Session=function(spec){"use strict";function isJsonResponseValid(response){if(qq.isArray(response))return!0;options.log("Session response is not an array.","error")}function handleFileItems(fileItems,success,xhrOrXdr,promise){var someItemsIgnored=!1;success=success&&isJsonResponseValid(fileItems),success&&qq.each(fileItems,function(idx,fileItem){if(null==fileItem.uuid)someItemsIgnored=!0,options.log(qq.format("Session response item {} did not include a valid UUID - ignoring.",idx),"error");else if(null==fileItem.name)someItemsIgnored=!0,options.log(qq.format("Session response item {} did not include a valid name - ignoring.",idx),"error");else try{return options.addFileRecord(fileItem),!0}catch(err){someItemsIgnored=!0,options.log(err.message,"error")}return!1}),promise[success&&!someItemsIgnored?"success":"failure"](fileItems,xhrOrXdr)}var options={endpoint:null,params:{},customHeaders:{},cors:{},addFileRecord:function(sessionData){},log:function(message,level){}};qq.extend(options,spec,!0),this.refresh=function(){var refreshEffort=new qq.Promise,refreshCompleteCallback=function(response,success,xhrOrXdr){handleFileItems(response,success,xhrOrXdr,refreshEffort)},requesterOptions=qq.extend({},options);return new qq.SessionAjaxRequester(qq.extend(requesterOptions,{onComplete:refreshCompleteCallback})).queryServer(),refreshEffort}},qq.SessionAjaxRequester=function(spec){"use strict";function onComplete(id,xhrOrXdr,isError){var response=null;if(null!=xhrOrXdr.responseText)try{response=qq.parseJson(xhrOrXdr.responseText)}catch(err){options.log("Problem parsing session response: "+err.message,"error"),isError=!0}options.onComplete(response,!isError,xhrOrXdr)}var requester,options={endpoint:null,customHeaders:{},params:{},cors:{expected:!1,sendCredentials:!1},onComplete:function(response,success,xhrOrXdr){},log:function(str,level){}};qq.extend(options,spec),requester=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",validMethods:["GET"],method:"GET",endpointStore:{get:function(){return options.endpoint}},customHeaders:options.customHeaders,log:options.log,onComplete:onComplete,cors:options.cors})),qq.extend(this,{queryServer:function(){var params=qq.extend({},options.params);options.log("Session query request."),requester.initTransport("sessionRefresh").withParams(params).withCacheBuster().send()}})},qq.Scaler=function(spec,log){"use strict";var customResizeFunction=spec.customResizer,includeOriginal=spec.sendOriginal,orient=spec.orient,defaultType=spec.defaultType,defaultQuality=spec.defaultQuality/100,failedToScaleText=spec.failureText,includeExif=spec.includeExif,sizes=this._getSortedSizes(spec.sizes);qq.extend(this,{enabled:qq.supportedFeatures.scaling&&sizes.length>0,getFileRecords:function(originalFileUuid,originalFileName,originalBlobOrBlobData){var self=this,records=[],originalBlob=originalBlobOrBlobData.blob?originalBlobOrBlobData.blob:originalBlobOrBlobData;return new qq.Identify(originalBlob,log).isPreviewableSync()?(qq.each(sizes,function(idx,sizeRecord){var outputType=self._determineOutputType({defaultType:defaultType,requestedType:sizeRecord.type,refType:originalBlob.type});records.push({uuid:qq.getUniqueId(),name:self._getName(originalFileName,{name:sizeRecord.name,type:outputType,refType:originalBlob.type}),blob:new qq.BlobProxy(originalBlob,qq.bind(self._generateScaledImage,self,{customResizeFunction:customResizeFunction,maxSize:sizeRecord.maxSize,orient:orient,type:outputType,quality:defaultQuality,failedText:failedToScaleText,includeExif:includeExif,log:log}))})}),records.push({uuid:originalFileUuid,name:originalFileName,size:originalBlob.size,blob:includeOriginal?originalBlob:null})):records.push({uuid:originalFileUuid,name:originalFileName,size:originalBlob.size,blob:originalBlob}),records},handleNewFile:function(file,name,uuid,size,fileList,batchId,uuidParamName,api){var self=this,scaledIds=(file.qqButtonId||file.blob&&file.blob.qqButtonId,[]),originalId=null,addFileToHandler=api.addFileToHandler,uploadData=api.uploadData,paramsStore=api.paramsStore,proxyGroupId=qq.getUniqueId();qq.each(self.getFileRecords(uuid,name,file),function(idx,record){var id,blobSize=record.size;record.blob instanceof qq.BlobProxy&&(blobSize=-1),id=uploadData.addFile({uuid:record.uuid,name:record.name,size:blobSize,batchId:batchId,proxyGroupId:proxyGroupId}),record.blob instanceof qq.BlobProxy?scaledIds.push(id):originalId=id,record.blob?(addFileToHandler(id,record.blob),fileList.push({id:id,file:record.blob})):uploadData.setStatus(id,qq.status.REJECTED)}),null!==originalId&&(qq.each(scaledIds,function(idx,scaledId){var params={qqparentuuid:uploadData.retrieve({id:originalId}).uuid,qqparentsize:uploadData.retrieve({id:originalId}).size};params[uuidParamName]=uploadData.retrieve({id:scaledId}).uuid,uploadData.setParentId(scaledId,originalId),paramsStore.addReadOnly(scaledId,params)}),scaledIds.length&&function(){var param={};param[uuidParamName]=uploadData.retrieve({id:originalId}).uuid,paramsStore.addReadOnly(originalId,param)}())}})},qq.extend(qq.Scaler.prototype,{scaleImage:function(id,specs,api){"use strict";if(!qq.supportedFeatures.scaling)throw new qq.Error("Scaling is not supported in this browser!");var scalingEffort=new qq.Promise,log=api.log,file=api.getFile(id),uploadData=api.uploadData.retrieve({id:id}),name=uploadData&&uploadData.name,uuid=uploadData&&uploadData.uuid,scalingOptions={customResizer:specs.customResizer,sendOriginal:!1,orient:specs.orient,defaultType:specs.type||null,defaultQuality:specs.quality,failedToScaleText:"Unable to scale",sizes:[{name:"",maxSize:specs.maxSize}]},scaler=new qq.Scaler(scalingOptions,log);return qq.Scaler&&qq.supportedFeatures.imagePreviews&&file?qq.bind(function(){var record=scaler.getFileRecords(uuid,name,file)[0];record&&record.blob instanceof qq.BlobProxy?record.blob.create().then(scalingEffort.success,scalingEffort.failure):(log(id+" is not a scalable image!","error"),scalingEffort.failure())},this)():(scalingEffort.failure(),log("Could not generate requested scaled image for "+id+".  Scaling is either not possible in this browser, or the file could not be located.","error")),scalingEffort},_determineOutputType:function(spec){"use strict";var requestedType=spec.requestedType,defaultType=spec.defaultType,referenceType=spec.refType;return defaultType||requestedType?requestedType&&qq.indexOf(Object.keys(qq.Identify.prototype.PREVIEWABLE_MIME_TYPES),requestedType)>=0?"image/tiff"===requestedType?qq.supportedFeatures.tiffPreviews?requestedType:defaultType:requestedType:defaultType:"image/jpeg"!==referenceType?"image/png":referenceType},_getName:function(originalName,scaledVersionProperties){"use strict";var startOfExt=originalName.lastIndexOf("."),versionType=scaledVersionProperties.type||"image/png",referenceType=scaledVersionProperties.refType,scaledName="",scaledExt=qq.getExtension(originalName),nameAppendage="";return scaledVersionProperties.name&&scaledVersionProperties.name.trim().length&&(nameAppendage=" ("+scaledVersionProperties.name+")"),startOfExt>=0?(scaledName=originalName.substr(0,startOfExt),referenceType!==versionType&&(scaledExt=versionType.split("/")[1]),scaledName+=nameAppendage+"."+scaledExt):scaledName=originalName+nameAppendage,scaledName},_getSortedSizes:function(sizes){"use strict";return sizes=qq.extend([],sizes),sizes.sort(function(a,b){return a.maxSize>b.maxSize?1:a.maxSize<b.maxSize?-1:0})},_generateScaledImage:function(spec,sourceFile){"use strict";var self=this,customResizeFunction=spec.customResizeFunction,log=spec.log,maxSize=spec.maxSize,orient=spec.orient,type=spec.type,quality=spec.quality,failedText=spec.failedText,includeExif=spec.includeExif&&"image/jpeg"===sourceFile.type&&"image/jpeg"===type,scalingEffort=new qq.Promise,imageGenerator=new qq.ImageGenerator(log),canvas=document.createElement("canvas");return log("Attempting to generate scaled version for "+sourceFile.name),imageGenerator.generate(sourceFile,canvas,{maxSize:maxSize,orient:orient,customResizeFunction:customResizeFunction}).then(function(){var scaledImageDataUri=canvas.toDataURL(type,quality),signalSuccess=function(){log("Success generating scaled version for "+sourceFile.name);var blob=qq.dataUriToBlob(scaledImageDataUri);scalingEffort.success(blob)};includeExif?self._insertExifHeader(sourceFile,scaledImageDataUri,log).then(function(scaledImageDataUriWithExif){scaledImageDataUri=scaledImageDataUriWithExif,signalSuccess()},function(){log("Problem inserting EXIF header into scaled image.  Using scaled image w/out EXIF data.","error"),signalSuccess()}):signalSuccess()},function(){log("Failed attempt to generate scaled version for "+sourceFile.name,"error"),scalingEffort.failure(failedText)}),scalingEffort},_insertExifHeader:function(originalImage,scaledImageDataUri,log){"use strict";var reader=new FileReader,insertionEffort=new qq.Promise,originalImageDataUri="";return reader.onload=function(){originalImageDataUri=reader.result,insertionEffort.success(qq.ExifRestorer.restore(originalImageDataUri,scaledImageDataUri))},reader.onerror=function(){log("Problem reading "+originalImage.name+" during attempt to transfer EXIF data to scaled version.","error"),insertionEffort.failure()},reader.readAsDataURL(originalImage),insertionEffort},_dataUriToBlob:function(dataUri){"use strict";var byteString,mimeString,arrayBuffer,intArray;return byteString=dataUri.split(",")[0].indexOf("base64")>=0?atob(dataUri.split(",")[1]):decodeURI(dataUri.split(",")[1]),mimeString=dataUri.split(",")[0].split(":")[1].split(";")[0],arrayBuffer=new ArrayBuffer(byteString.length),intArray=new Uint8Array(arrayBuffer),qq.each(byteString,function(idx,character){intArray[idx]=character.charCodeAt(0)}),this._createBlob(arrayBuffer,mimeString)},_createBlob:function(data,mime){"use strict";var BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,blobBuilder=BlobBuilder&&new BlobBuilder;return blobBuilder?(blobBuilder.append(data),blobBuilder.getBlob(mime)):new Blob([data],{type:mime})}}),qq.ExifRestorer=function(){var ExifRestorer={};return ExifRestorer.KEY_STR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ExifRestorer.encode64=function(input){var chr1,chr2,enc1,enc2,enc3,output="",chr3="",enc4="",i=0;do{chr1=input[i++],chr2=input[i++],chr3=input[i++],enc1=chr1>>2,enc2=(3&chr1)<<4|chr2>>4,enc3=(15&chr2)<<2|chr3>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+this.KEY_STR.charAt(enc1)+this.KEY_STR.charAt(enc2)+this.KEY_STR.charAt(enc3)+this.KEY_STR.charAt(enc4),chr1=chr2=chr3="",enc1=enc2=enc3=enc4=""}while(i<input.length);return output},ExifRestorer.restore=function(origFileBase64,resizedFileBase64){if(!origFileBase64.match("data:image/jpeg;base64,"))return resizedFileBase64;var rawImage=this.decode64(origFileBase64.replace("data:image/jpeg;base64,","")),segments=this.slice2Segments(rawImage),image=this.exifManipulation(resizedFileBase64,segments);return"data:image/jpeg;base64,"+this.encode64(image)},ExifRestorer.exifManipulation=function(resizedFileBase64,segments){var exifArray=this.getExifArray(segments),newImageArray=this.insertExif(resizedFileBase64,exifArray);return new Uint8Array(newImageArray)},ExifRestorer.getExifArray=function(segments){for(var seg,x=0;x<segments.length;x++)if(seg=segments[x],255==seg[0]&225==seg[1])return seg;return[]},ExifRestorer.insertExif=function(resizedFileBase64,exifArray){var imageData=resizedFileBase64.replace("data:image/jpeg;base64,",""),buf=this.decode64(imageData),separatePoint=buf.indexOf(255,3),mae=buf.slice(0,separatePoint),ato=buf.slice(separatePoint),array=mae;return array=array.concat(exifArray),array=array.concat(ato)},ExifRestorer.slice2Segments=function(rawImageArray){for(var head=0,segments=[];;){if(255==rawImageArray[head]&218==rawImageArray[head+1])break;if(255==rawImageArray[head]&216==rawImageArray[head+1])head+=2;else{var length=256*rawImageArray[head+2]+rawImageArray[head+3],endPoint=head+length+2,seg=rawImageArray.slice(head,endPoint);segments.push(seg),head=endPoint}if(head>rawImageArray.length)break}return segments},ExifRestorer.decode64=function(input){var chr1,chr2,enc1,enc2,enc3,chr3="",enc4="",i=0,buf=[];if(/[^A-Za-z0-9\+\/\=]/g.exec(input))throw new Error("There were invalid base64 characters in the input text.  Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='");input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{enc1=this.KEY_STR.indexOf(input.charAt(i++)),enc2=this.KEY_STR.indexOf(input.charAt(i++)),enc3=this.KEY_STR.indexOf(input.charAt(i++)),enc4=this.KEY_STR.indexOf(input.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,buf.push(chr1),64!=enc3&&buf.push(chr2),64!=enc4&&buf.push(chr3),chr1=chr2=chr3="",enc1=enc2=enc3=enc4=""}while(i<input.length);return buf},ExifRestorer}(),qq.TotalProgress=function(callback,getSize){"use strict";var perFileProgress={},totalLoaded=0,totalSize=0,lastLoadedSent=-1,lastTotalSent=-1,callbackProxy=function(loaded,total){loaded===lastLoadedSent&&total===lastTotalSent||callback(loaded,total),lastLoadedSent=loaded,lastTotalSent=total},noRetryableFiles=function(failed,retryable){var none=!0;return qq.each(failed,function(idx,failedId){if(qq.indexOf(retryable,failedId)>=0)return none=!1,!1}),none},onCancel=function(id){updateTotalProgress(id,-1,-1),delete perFileProgress[id]},onAllComplete=function(successful,failed,retryable){(0===failed.length||noRetryableFiles(failed,retryable))&&(callbackProxy(totalSize,totalSize),this.reset())},onNew=function(id){var size=getSize(id);size>0&&(updateTotalProgress(id,0,size),perFileProgress[id]={loaded:0,total:size})},updateTotalProgress=function(id,newLoaded,newTotal){var oldLoaded=perFileProgress[id]?perFileProgress[id].loaded:0,oldTotal=perFileProgress[id]?perFileProgress[id].total:0;-1===newLoaded&&-1===newTotal?(totalLoaded-=oldLoaded,totalSize-=oldTotal):(newLoaded&&(totalLoaded+=newLoaded-oldLoaded),newTotal&&(totalSize+=newTotal-oldTotal)),callbackProxy(totalLoaded,totalSize)};qq.extend(this,{onAllComplete:onAllComplete,onStatusChange:function(id,oldStatus,newStatus){newStatus===qq.status.CANCELED||newStatus===qq.status.REJECTED?onCancel(id):newStatus===qq.status.SUBMITTING&&onNew(id)},onIndividualProgress:function(id,loaded,total){updateTotalProgress(id,loaded,total),perFileProgress[id]={loaded:loaded,total:total}},onNewSize:function(id){onNew(id)},reset:function(){perFileProgress={},totalLoaded=0,totalSize=0}})},qq.PasteSupport=function(o){"use strict";function isImage(item){return item.type&&0===item.type.indexOf("image/")}function unregisterPasteHandler(){detachPasteHandler&&detachPasteHandler()}var options,detachPasteHandler;options={targetElement:null,callbacks:{log:function(message,level){},pasteReceived:function(blob){}}},qq.extend(options,o),function(){detachPasteHandler=qq(options.targetElement).attach("paste",function(event){var clipboardData=event.clipboardData;clipboardData&&qq.each(clipboardData.items,function(idx,item){if(isImage(item)){var blob=item.getAsFile();options.callbacks.pasteReceived(blob)}})})}(),qq.extend(this,{reset:function(){unregisterPasteHandler()}})},qq.FormSupport=function(options,startUpload,log){"use strict";function determineNewEndpoint(formEl){formEl.getAttribute("action")&&(self.newEndpoint=formEl.getAttribute("action"))}function validateForm(formEl,nativeSubmit){if(!formEl.checkValidity||formEl.checkValidity())return!0;log("Form did not pass validation checks - will not upload.","error"),nativeSubmit()}function maybeUploadOnSubmit(formEl){var nativeSubmit=formEl.submit;qq(formEl).attach("submit",function(event){event=event||window.event,event.preventDefault?event.preventDefault():event.returnValue=!1,validateForm(formEl,nativeSubmit)&&startUpload()}),formEl.submit=function(){validateForm(formEl,nativeSubmit)&&startUpload()}}var self=this,interceptSubmit=options.interceptSubmit,formEl=options.element,autoUpload=options.autoUpload;qq.extend(this,{newEndpoint:null,newAutoUpload:autoUpload,attachedToForm:!1,getFormInputsAsObject:function(){return null==formEl?null:self._form2Obj(formEl)}}),formEl=function(formEl){return formEl&&(qq.isString(formEl)&&(formEl=document.getElementById(formEl)),formEl&&(log("Attaching to form element."),determineNewEndpoint(formEl),interceptSubmit&&maybeUploadOnSubmit(formEl))),formEl}(formEl),this.attachedToForm=!!formEl},qq.extend(qq.FormSupport.prototype,{_form2Obj:function(form){"use strict"
;var obj={},notIrrelevantType=function(type){var irrelevantTypes=["button","image","reset","submit"];return qq.indexOf(irrelevantTypes,type.toLowerCase())<0},radioOrCheckbox=function(type){return qq.indexOf(["checkbox","radio"],type.toLowerCase())>=0},ignoreValue=function(el){return!(!radioOrCheckbox(el.type)||el.checked)||el.disabled&&"hidden"!==el.type.toLowerCase()},selectValue=function(select){var value=null;return qq.each(qq(select).children(),function(idx,child){if("option"===child.tagName.toLowerCase()&&child.selected)return value=child.value,!1}),value};return qq.each(form.elements,function(idx,el){if(!qq.isInput(el,!0)&&"textarea"!==el.tagName.toLowerCase()||!notIrrelevantType(el.type)||ignoreValue(el)){if("select"===el.tagName.toLowerCase()&&!ignoreValue(el)){var value=selectValue(el);null!==value&&(obj[el.name]=value)}}else obj[el.name]=el.value}),obj}}),qq.CryptoJS=function(Math,undefined){var C={},C_lib=C.lib={},Base=C_lib.Base=function(){function F(){}return{extend:function(overrides){F.prototype=this;var subtype=new F;return overrides&&subtype.mixIn(overrides),subtype.hasOwnProperty("init")||(subtype.init=function(){subtype.$super.init.apply(this,arguments)}),subtype.init.prototype=subtype,subtype.$super=this,subtype},create:function(){var instance=this.extend();return instance.init.apply(instance,arguments),instance},init:function(){},mixIn:function(properties){for(var propertyName in properties)properties.hasOwnProperty(propertyName)&&(this[propertyName]=properties[propertyName]);properties.hasOwnProperty("toString")&&(this.toString=properties.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),WordArray=C_lib.WordArray=Base.extend({init:function(words,sigBytes){words=this.words=words||[],this.sigBytes=void 0!=sigBytes?sigBytes:4*words.length},toString:function(encoder){return(encoder||Hex).stringify(this)},concat:function(wordArray){var thisWords=this.words,thatWords=wordArray.words,thisSigBytes=this.sigBytes,thatSigBytes=wordArray.sigBytes;if(this.clamp(),thisSigBytes%4)for(var i=0;i<thatSigBytes;i++){var thatByte=thatWords[i>>>2]>>>24-i%4*8&255;thisWords[thisSigBytes+i>>>2]|=thatByte<<24-(thisSigBytes+i)%4*8}else if(thatWords.length>65535)for(var i=0;i<thatSigBytes;i+=4)thisWords[thisSigBytes+i>>>2]=thatWords[i>>>2];else thisWords.push.apply(thisWords,thatWords);return this.sigBytes+=thatSigBytes,this},clamp:function(){var words=this.words,sigBytes=this.sigBytes;words[sigBytes>>>2]&=4294967295<<32-sigBytes%4*8,words.length=Math.ceil(sigBytes/4)},clone:function(){var clone=Base.clone.call(this);return clone.words=this.words.slice(0),clone},random:function(nBytes){for(var words=[],i=0;i<nBytes;i+=4)words.push(4294967296*Math.random()|0);return new WordArray.init(words,nBytes)}}),C_enc=C.enc={},Hex=C_enc.Hex={stringify:function(wordArray){for(var words=wordArray.words,sigBytes=wordArray.sigBytes,hexChars=[],i=0;i<sigBytes;i++){var bite=words[i>>>2]>>>24-i%4*8&255;hexChars.push((bite>>>4).toString(16)),hexChars.push((15&bite).toString(16))}return hexChars.join("")},parse:function(hexStr){for(var hexStrLength=hexStr.length,words=[],i=0;i<hexStrLength;i+=2)words[i>>>3]|=parseInt(hexStr.substr(i,2),16)<<24-i%8*4;return new WordArray.init(words,hexStrLength/2)}},Latin1=C_enc.Latin1={stringify:function(wordArray){for(var words=wordArray.words,sigBytes=wordArray.sigBytes,latin1Chars=[],i=0;i<sigBytes;i++){var bite=words[i>>>2]>>>24-i%4*8&255;latin1Chars.push(String.fromCharCode(bite))}return latin1Chars.join("")},parse:function(latin1Str){for(var latin1StrLength=latin1Str.length,words=[],i=0;i<latin1StrLength;i++)words[i>>>2]|=(255&latin1Str.charCodeAt(i))<<24-i%4*8;return new WordArray.init(words,latin1StrLength)}},Utf8=C_enc.Utf8={stringify:function(wordArray){try{return decodeURIComponent(escape(Latin1.stringify(wordArray)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(utf8Str){return Latin1.parse(unescape(encodeURIComponent(utf8Str)))}},BufferedBlockAlgorithm=C_lib.BufferedBlockAlgorithm=Base.extend({reset:function(){this._data=new WordArray.init,this._nDataBytes=0},_append:function(data){"string"==typeof data&&(data=Utf8.parse(data)),this._data.concat(data),this._nDataBytes+=data.sigBytes},_process:function(doFlush){var data=this._data,dataWords=data.words,dataSigBytes=data.sigBytes,blockSize=this.blockSize,blockSizeBytes=4*blockSize,nBlocksReady=dataSigBytes/blockSizeBytes;nBlocksReady=doFlush?Math.ceil(nBlocksReady):Math.max((0|nBlocksReady)-this._minBufferSize,0);var nWordsReady=nBlocksReady*blockSize,nBytesReady=Math.min(4*nWordsReady,dataSigBytes);if(nWordsReady){for(var offset=0;offset<nWordsReady;offset+=blockSize)this._doProcessBlock(dataWords,offset);var processedWords=dataWords.splice(0,nWordsReady);data.sigBytes-=nBytesReady}return new WordArray.init(processedWords,nBytesReady)},clone:function(){var clone=Base.clone.call(this);return clone._data=this._data.clone(),clone},_minBufferSize:0}),C_algo=(C_lib.Hasher=BufferedBlockAlgorithm.extend({cfg:Base.extend(),init:function(cfg){this.cfg=this.cfg.extend(cfg),this.reset()},reset:function(){BufferedBlockAlgorithm.reset.call(this),this._doReset()},update:function(messageUpdate){return this._append(messageUpdate),this._process(),this},finalize:function(messageUpdate){return messageUpdate&&this._append(messageUpdate),this._doFinalize()},blockSize:16,_createHelper:function(hasher){return function(message,cfg){return new hasher.init(cfg).finalize(message)}},_createHmacHelper:function(hasher){return function(message,key){return new C_algo.HMAC.init(hasher,key).finalize(message)}}}),C.algo={});return C}(Math),function(){var C=qq.CryptoJS,C_lib=C.lib,WordArray=C_lib.WordArray,C_enc=C.enc;C_enc.Base64={stringify:function(wordArray){var words=wordArray.words,sigBytes=wordArray.sigBytes,map=this._map;wordArray.clamp();for(var base64Chars=[],i=0;i<sigBytes;i+=3)for(var byte1=words[i>>>2]>>>24-i%4*8&255,byte2=words[i+1>>>2]>>>24-(i+1)%4*8&255,byte3=words[i+2>>>2]>>>24-(i+2)%4*8&255,triplet=byte1<<16|byte2<<8|byte3,j=0;j<4&&i+.75*j<sigBytes;j++)base64Chars.push(map.charAt(triplet>>>6*(3-j)&63));var paddingChar=map.charAt(64);if(paddingChar)for(;base64Chars.length%4;)base64Chars.push(paddingChar);return base64Chars.join("")},parse:function(base64Str){var base64StrLength=base64Str.length,map=this._map,paddingChar=map.charAt(64);if(paddingChar){var paddingIndex=base64Str.indexOf(paddingChar);-1!=paddingIndex&&(base64StrLength=paddingIndex)}for(var words=[],nBytes=0,i=0;i<base64StrLength;i++)if(i%4){var bits1=map.indexOf(base64Str.charAt(i-1))<<i%4*2,bits2=map.indexOf(base64Str.charAt(i))>>>6-i%4*2;words[nBytes>>>2]|=(bits1|bits2)<<24-nBytes%4*8,nBytes++}return WordArray.create(words,nBytes)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(){var C=qq.CryptoJS,C_lib=C.lib,Base=C_lib.Base,C_enc=C.enc,Utf8=C_enc.Utf8,C_algo=C.algo;C_algo.HMAC=Base.extend({init:function(hasher,key){hasher=this._hasher=new hasher.init,"string"==typeof key&&(key=Utf8.parse(key));var hasherBlockSize=hasher.blockSize,hasherBlockSizeBytes=4*hasherBlockSize;key.sigBytes>hasherBlockSizeBytes&&(key=hasher.finalize(key)),key.clamp();for(var oKey=this._oKey=key.clone(),iKey=this._iKey=key.clone(),oKeyWords=oKey.words,iKeyWords=iKey.words,i=0;i<hasherBlockSize;i++)oKeyWords[i]^=1549556828,iKeyWords[i]^=909522486;oKey.sigBytes=iKey.sigBytes=hasherBlockSizeBytes,this.reset()},reset:function(){var hasher=this._hasher;hasher.reset(),hasher.update(this._iKey)},update:function(messageUpdate){return this._hasher.update(messageUpdate),this},finalize:function(messageUpdate){var hasher=this._hasher,innerHash=hasher.finalize(messageUpdate);return hasher.reset(),hasher.finalize(this._oKey.clone().concat(innerHash))}})}(),function(){var C=qq.CryptoJS,C_lib=C.lib,WordArray=C_lib.WordArray,Hasher=C_lib.Hasher,C_algo=C.algo,W=[],SHA1=C_algo.SHA1=Hasher.extend({_doReset:function(){this._hash=new WordArray.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(M,offset){for(var H=this._hash.words,a=H[0],b=H[1],c=H[2],d=H[3],e=H[4],i=0;i<80;i++){if(i<16)W[i]=0|M[offset+i];else{var n=W[i-3]^W[i-8]^W[i-14]^W[i-16];W[i]=n<<1|n>>>31}var t=(a<<5|a>>>27)+e+W[i];t+=i<20?1518500249+(b&c|~b&d):i<40?1859775393+(b^c^d):i<60?(b&c|b&d|c&d)-1894007588:(b^c^d)-899497514,e=d,d=c,c=b<<30|b>>>2,b=a,a=t}H[0]=H[0]+a|0,H[1]=H[1]+b|0,H[2]=H[2]+c|0,H[3]=H[3]+d|0,H[4]=H[4]+e|0},_doFinalize:function(){var data=this._data,dataWords=data.words,nBitsTotal=8*this._nDataBytes,nBitsLeft=8*data.sigBytes;return dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32,dataWords[14+(nBitsLeft+64>>>9<<4)]=Math.floor(nBitsTotal/4294967296),dataWords[15+(nBitsLeft+64>>>9<<4)]=nBitsTotal,data.sigBytes=4*dataWords.length,this._process(),this._hash},clone:function(){var clone=Hasher.clone.call(this);return clone._hash=this._hash.clone(),clone}});C.SHA1=Hasher._createHelper(SHA1),C.HmacSHA1=Hasher._createHmacHelper(SHA1)}(),function(Math){var C=qq.CryptoJS,C_lib=C.lib,WordArray=C_lib.WordArray,Hasher=C_lib.Hasher,C_algo=C.algo,H=[],K=[];!function(){function getFractionalBits(n){return 4294967296*(n-(0|n))|0}for(var n=2,nPrime=0;nPrime<64;)(function(n){for(var sqrtN=Math.sqrt(n),factor=2;factor<=sqrtN;factor++)if(!(n%factor))return!1;return!0})(n)&&(nPrime<8&&(H[nPrime]=getFractionalBits(Math.pow(n,.5))),K[nPrime]=getFractionalBits(Math.pow(n,1/3)),nPrime++),n++}();var W=[],SHA256=C_algo.SHA256=Hasher.extend({_doReset:function(){this._hash=new WordArray.init(H.slice(0))},_doProcessBlock:function(M,offset){for(var H=this._hash.words,a=H[0],b=H[1],c=H[2],d=H[3],e=H[4],f=H[5],g=H[6],h=H[7],i=0;i<64;i++){if(i<16)W[i]=0|M[offset+i];else{var gamma0x=W[i-15],gamma0=(gamma0x<<25|gamma0x>>>7)^(gamma0x<<14|gamma0x>>>18)^gamma0x>>>3,gamma1x=W[i-2],gamma1=(gamma1x<<15|gamma1x>>>17)^(gamma1x<<13|gamma1x>>>19)^gamma1x>>>10;W[i]=gamma0+W[i-7]+gamma1+W[i-16]}var ch=e&f^~e&g,maj=a&b^a&c^b&c,sigma0=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),sigma1=(e<<26|e>>>6)^(e<<21|e>>>11)^(e<<7|e>>>25),t1=h+sigma1+ch+K[i]+W[i],t2=sigma0+maj;h=g,g=f,f=e,e=d+t1|0,d=c,c=b,b=a,a=t1+t2|0}H[0]=H[0]+a|0,H[1]=H[1]+b|0,H[2]=H[2]+c|0,H[3]=H[3]+d|0,H[4]=H[4]+e|0,H[5]=H[5]+f|0,H[6]=H[6]+g|0,H[7]=H[7]+h|0},_doFinalize:function(){var data=this._data,dataWords=data.words,nBitsTotal=8*this._nDataBytes,nBitsLeft=8*data.sigBytes;return dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32,dataWords[14+(nBitsLeft+64>>>9<<4)]=Math.floor(nBitsTotal/4294967296),dataWords[15+(nBitsLeft+64>>>9<<4)]=nBitsTotal,data.sigBytes=4*dataWords.length,this._process(),this._hash},clone:function(){var clone=Hasher.clone.call(this);return clone._hash=this._hash.clone(),clone}});C.SHA256=Hasher._createHelper(SHA256),C.HmacSHA256=Hasher._createHmacHelper(SHA256)}(Math),function(){if("function"==typeof ArrayBuffer){var C=qq.CryptoJS,C_lib=C.lib,WordArray=C_lib.WordArray,superInit=WordArray.init;(WordArray.init=function(typedArray){if(typedArray instanceof ArrayBuffer&&(typedArray=new Uint8Array(typedArray)),(typedArray instanceof Int8Array||typedArray instanceof Uint8ClampedArray||typedArray instanceof Int16Array||typedArray instanceof Uint16Array||typedArray instanceof Int32Array||typedArray instanceof Uint32Array||typedArray instanceof Float32Array||typedArray instanceof Float64Array)&&(typedArray=new Uint8Array(typedArray.buffer,typedArray.byteOffset,typedArray.byteLength)),typedArray instanceof Uint8Array){for(var typedArrayByteLength=typedArray.byteLength,words=[],i=0;i<typedArrayByteLength;i++)words[i>>>2]|=typedArray[i]<<24-i%4*8;superInit.call(this,words,typedArrayByteLength)}else superInit.apply(this,arguments)}).prototype=WordArray}}(),qq.s3=qq.s3||{},qq.s3.util=qq.s3.util||function(){"use strict";return{ALGORITHM_PARAM_NAME:"x-amz-algorithm",AWS_PARAM_PREFIX:"x-amz-meta-",CREDENTIAL_PARAM_NAME:"x-amz-credential",DATE_PARAM_NAME:"x-amz-date",REDUCED_REDUNDANCY_PARAM_NAME:"x-amz-storage-class",REDUCED_REDUNDANCY_PARAM_VALUE:"REDUCED_REDUNDANCY",SERVER_SIDE_ENCRYPTION_PARAM_NAME:"x-amz-server-side-encryption",SERVER_SIDE_ENCRYPTION_PARAM_VALUE:"AES256",SESSION_TOKEN_PARAM_NAME:"x-amz-security-token",V4_ALGORITHM_PARAM_VALUE:"AWS4-HMAC-SHA256",V4_SIGNATURE_PARAM_NAME:"x-amz-signature",CASE_SENSITIVE_PARAM_NAMES:["Cache-Control","Content-Disposition","Content-Encoding","Content-MD5"],UNSIGNABLE_REST_HEADER_NAMES:["Cache-Control","Content-Disposition","Content-Encoding","Content-MD5"],UNPREFIXED_PARAM_NAMES:["Cache-Control","Content-Disposition","Content-Encoding","Content-MD5","x-amz-server-side-encryption-customer-algorithm","x-amz-server-side-encryption-customer-key","x-amz-server-side-encryption-customer-key-MD5"],getBucket:function(endpoint){var bucket,patterns=[/^(?:https?:\/\/)?([a-z0-9.\-_]+)\.s3(?:-[a-z0-9\-]+)?\.amazonaws\.com/i,/^(?:https?:\/\/)?s3(?:-[a-z0-9\-]+)?\.amazonaws\.com\/([a-z0-9.\-_]+)/i,/^(?:https?:\/\/)?([a-z0-9.\-_]+)/i];return qq.each(patterns,function(idx,pattern){var match=pattern.exec(endpoint);if(match)return bucket=match[1],!1}),bucket},_getPrefixedParamName:function(name){return qq.indexOf(qq.s3.util.UNPREFIXED_PARAM_NAMES,name)>=0?name:qq.s3.util.AWS_PARAM_PREFIX+name},getPolicy:function(spec){var policy={},conditions=[],bucket=spec.bucket,date=spec.date,drift=spec.clockDrift,key=spec.key,accessKey=spec.accessKey,acl=spec.acl,type=spec.type,expectedStatus=spec.expectedStatus,sessionToken=spec.sessionToken,params=spec.params,successRedirectUrl=qq.s3.util.getSuccessRedirectAbsoluteUrl(spec.successRedirectUrl),minFileSize=spec.minFileSize,maxFileSize=spec.maxFileSize,reducedRedundancy=spec.reducedRedundancy,region=spec.region,serverSideEncryption=spec.serverSideEncryption,signatureVersion=spec.signatureVersion;return policy.expiration=qq.s3.util.getPolicyExpirationDate(date,drift),conditions.push({acl:acl}),conditions.push({bucket:bucket}),type&&conditions.push({"Content-Type":type}),expectedStatus&&conditions.push({success_action_status:expectedStatus.toString()}),successRedirectUrl&&conditions.push({success_action_redirect:successRedirectUrl}),reducedRedundancy&&(conditions.push({}),conditions[conditions.length-1][qq.s3.util.REDUCED_REDUNDANCY_PARAM_NAME]=qq.s3.util.REDUCED_REDUNDANCY_PARAM_VALUE),sessionToken&&(conditions.push({}),conditions[conditions.length-1][qq.s3.util.SESSION_TOKEN_PARAM_NAME]=sessionToken),serverSideEncryption&&(conditions.push({}),conditions[conditions.length-1][qq.s3.util.SERVER_SIDE_ENCRYPTION_PARAM_NAME]=qq.s3.util.SERVER_SIDE_ENCRYPTION_PARAM_VALUE),2===signatureVersion?conditions.push({key:key}):4===signatureVersion&&(conditions.push({}),conditions[conditions.length-1][qq.s3.util.ALGORITHM_PARAM_NAME]=qq.s3.util.V4_ALGORITHM_PARAM_VALUE,conditions.push({}),conditions[conditions.length-1].key=key,conditions.push({}),conditions[conditions.length-1][qq.s3.util.CREDENTIAL_PARAM_NAME]=qq.s3.util.getV4CredentialsString({date:date,key:accessKey,region:region}),conditions.push({}),conditions[conditions.length-1][qq.s3.util.DATE_PARAM_NAME]=qq.s3.util.getV4PolicyDate(date,drift)),qq.each(params,function(name,val){var awsParamName=qq.s3.util._getPrefixedParamName(name),param={};qq.indexOf(qq.s3.util.UNPREFIXED_PARAM_NAMES,awsParamName)>=0?param[awsParamName]=val:param[awsParamName]=encodeURIComponent(val),conditions.push(param)}),policy.conditions=conditions,qq.s3.util.enforceSizeLimits(policy,minFileSize,maxFileSize),policy},refreshPolicyCredentials:function(policy,newSessionToken){var sessionTokenFound=!1;qq.each(policy.conditions,function(oldCondIdx,oldCondObj){qq.each(oldCondObj,function(oldCondName,oldCondVal){oldCondName===qq.s3.util.SESSION_TOKEN_PARAM_NAME&&(oldCondObj[oldCondName]=newSessionToken,sessionTokenFound=!0)})}),sessionTokenFound||(policy.conditions.push({}),policy.conditions[policy.conditions.length-1][qq.s3.util.SESSION_TOKEN_PARAM_NAME]=newSessionToken)},generateAwsParams:function(spec,signPolicyCallback){var policyJson,awsParams={},customParams=spec.params,promise=new qq.Promise,sessionToken=spec.sessionToken,drift=spec.clockDrift,type=spec.type,key=spec.key,accessKey=spec.accessKey,acl=spec.acl,expectedStatus=spec.expectedStatus,successRedirectUrl=qq.s3.util.getSuccessRedirectAbsoluteUrl(spec.successRedirectUrl),reducedRedundancy=spec.reducedRedundancy,region=spec.region,serverSideEncryption=spec.serverSideEncryption,signatureVersion=spec.signatureVersion,now=new Date,log=spec.log;return spec.date=now,policyJson=qq.s3.util.getPolicy(spec),awsParams.key=key,type&&(awsParams["Content-Type"]=type),expectedStatus&&(awsParams.success_action_status=expectedStatus),successRedirectUrl&&(awsParams.success_action_redirect=successRedirectUrl),reducedRedundancy&&(awsParams[qq.s3.util.REDUCED_REDUNDANCY_PARAM_NAME]=qq.s3.util.REDUCED_REDUNDANCY_PARAM_VALUE),serverSideEncryption&&(awsParams[qq.s3.util.SERVER_SIDE_ENCRYPTION_PARAM_NAME]=qq.s3.util.SERVER_SIDE_ENCRYPTION_PARAM_VALUE),sessionToken&&(awsParams[qq.s3.util.SESSION_TOKEN_PARAM_NAME]=sessionToken),awsParams.acl=acl,qq.each(customParams,function(name,val){var awsParamName=qq.s3.util._getPrefixedParamName(name);qq.indexOf(qq.s3.util.UNPREFIXED_PARAM_NAMES,awsParamName)>=0?awsParams[awsParamName]=val:awsParams[awsParamName]=encodeURIComponent(val)}),2===signatureVersion?awsParams.AWSAccessKeyId=accessKey:4===signatureVersion&&(awsParams[qq.s3.util.ALGORITHM_PARAM_NAME]=qq.s3.util.V4_ALGORITHM_PARAM_VALUE,awsParams[qq.s3.util.CREDENTIAL_PARAM_NAME]=qq.s3.util.getV4CredentialsString({date:now,key:accessKey,region:region}),awsParams[qq.s3.util.DATE_PARAM_NAME]=qq.s3.util.getV4PolicyDate(now,drift)),signPolicyCallback(policyJson).then(function(policyAndSignature,updatedAccessKey,updatedSessionToken){awsParams.policy=policyAndSignature.policy,2===spec.signatureVersion?(awsParams.signature=policyAndSignature.signature,updatedAccessKey&&(awsParams.AWSAccessKeyId=updatedAccessKey)):4===spec.signatureVersion&&(awsParams[qq.s3.util.V4_SIGNATURE_PARAM_NAME]=policyAndSignature.signature),updatedSessionToken&&(awsParams[qq.s3.util.SESSION_TOKEN_PARAM_NAME]=updatedSessionToken),promise.success(awsParams)},function(errorMessage){errorMessage=errorMessage||"Can't continue further with request to S3 as we did not receive a valid signature and policy from the server.",log("Policy signing failed.  "+errorMessage,"error"),promise.failure(errorMessage)}),promise},enforceSizeLimits:function(policy,minSize,maxSize){var adjustedMinSize=minSize<0?0:minSize,adjustedMaxSize=maxSize<=0?9007199254740992:maxSize;(minSize>0||maxSize>0)&&policy.conditions.push(["content-length-range",adjustedMinSize.toString(),adjustedMaxSize.toString()])},getPolicyExpirationDate:function(date,drift){var adjustedDate=new Date(date.getTime()+drift);return qq.s3.util.getPolicyDate(adjustedDate,5)},getCredentialsDate:function(date){return date.getUTCFullYear()+""+("0"+(date.getUTCMonth()+1)).slice(-2)+("0"+date.getUTCDate()).slice(-2)},getPolicyDate:function(date,_minutesToAdd_){var pad,r,minutesToAdd=_minutesToAdd_||0;return date.setMinutes(date.getMinutes()+(minutesToAdd||0)),Date.prototype.toISOString?date.toISOString():(pad=function(number){return r=String(number),1===r.length&&(r="0"+r),r},date.getUTCFullYear()+"-"+pad(date.getUTCMonth()+1)+"-"+pad(date.getUTCDate())+"T"+pad(date.getUTCHours())+":"+pad(date.getUTCMinutes())+":"+pad(date.getUTCSeconds())+"."+String((date.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z")},parseIframeResponse:function(iframe){var doc=iframe.contentDocument||iframe.contentWindow.document,queryString=doc.location.search,match=/bucket=(.+)&key=(.+)&etag=(.+)/.exec(queryString);if(match)return{bucket:match[1],key:match[2],etag:match[3].replace(/%22/g,"")}},getSuccessRedirectAbsoluteUrl:function(successRedirectUrl){if(successRedirectUrl){var targetAnchor,targetAnchorContainer=document.createElement("div");return qq.ie7()?(targetAnchorContainer.innerHTML="<a href='"+successRedirectUrl+"'></a>",targetAnchor=targetAnchorContainer.firstChild,targetAnchor.href):(targetAnchor=document.createElement("a"),targetAnchor.href=successRedirectUrl,targetAnchor.href=targetAnchor.href,targetAnchor.href)}},getV4CredentialsString:function(spec){return spec.key+"/"+qq.s3.util.getCredentialsDate(spec.date)+"/"+spec.region+"/s3/aws4_request"},getV4PolicyDate:function(date,drift){var adjustedDate=new Date(date.getTime()+drift);return qq.s3.util.getCredentialsDate(adjustedDate)+"T"+("0"+adjustedDate.getUTCHours()).slice(-2)+("0"+adjustedDate.getUTCMinutes()).slice(-2)+("0"+adjustedDate.getUTCSeconds()).slice(-2)+"Z"},encodeQueryStringParam:function(param){var percentEncoded=encodeURIComponent(param);return percentEncoded=percentEncoded.replace(/[!'()]/g,escape),percentEncoded=percentEncoded.replace(/\*/g,"%2A"),percentEncoded.replace(/%20/g,"+")},uriEscape:function(string){var output=encodeURIComponent(string);return output=output.replace(/[^A-Za-z0-9_.~\-%]+/g,escape),output=output.replace(/[*]/g,function(ch){return"%"+ch.charCodeAt(0).toString(16).toUpperCase()})},uriEscapePath:function(path){var parts=[];return qq.each(path.split("/"),function(idx,item){parts.push(qq.s3.util.uriEscape(item))}),parts.join("/")}}}(),function(){"use strict";qq.nonTraditionalBasePublicApi={setUploadSuccessParams:function(params,id){this._uploadSuccessParamsStore.set(params,id)},setUploadSuccessEndpoint:function(endpoint,id){this._uploadSuccessEndpointStore.set(endpoint,id)}},qq.nonTraditionalBasePrivateApi={_onComplete:function(id,name,result,xhr){var submitSuccessRequest,successAjaxRequester,success=!!result.success,self=this,onCompleteArgs=arguments,successEndpoint=this._uploadSuccessEndpointStore.get(id),successCustomHeaders=this._options.uploadSuccess.customHeaders,successMethod=this._options.uploadSuccess.method,cors=this._options.cors,promise=new qq.Promise,uploadSuccessParams=this._uploadSuccessParamsStore.get(id),fileParams=this._paramsStore.get(id),onSuccessFromServer=function(successRequestResult){delete self._failedSuccessRequestCallbacks[id],qq.extend(result,successRequestResult),qq.FineUploaderBasic.prototype._onComplete.apply(self,onCompleteArgs),promise.success(successRequestResult)},onFailureFromServer=function(successRequestResult){var callback=submitSuccessRequest;qq.extend(result,successRequestResult),result&&result.reset&&(callback=null),callback?self._failedSuccessRequestCallbacks[id]=callback:delete self._failedSuccessRequestCallbacks[id],self._onAutoRetry(id,name,result,xhr,callback)||(qq.FineUploaderBasic.prototype._onComplete.apply(self,onCompleteArgs),promise.failure(successRequestResult))};return success&&successEndpoint?(successAjaxRequester=new qq.UploadSuccessAjaxRequester({endpoint:successEndpoint,method:successMethod,customHeaders:successCustomHeaders,cors:cors,log:qq.bind(this.log,this)}),qq.extend(uploadSuccessParams,self._getEndpointSpecificParams(id,result,xhr),!0),fileParams&&qq.extend(uploadSuccessParams,fileParams,!0),submitSuccessRequest=qq.bind(function(){successAjaxRequester.sendSuccessRequest(id,uploadSuccessParams).then(onSuccessFromServer,onFailureFromServer)},self),submitSuccessRequest(),promise):qq.FineUploaderBasic.prototype._onComplete.apply(this,arguments)},_manualRetry:function(id){var successRequestCallback=this._failedSuccessRequestCallbacks[id];return qq.FineUploaderBasic.prototype._manualRetry.call(this,id,successRequestCallback)}}}(),function(){"use strict";qq.s3.FineUploaderBasic=function(o){var options={request:{accessKey:null,clockDrift:0},objectProperties:{acl:"private",bucket:qq.bind(function(id){return qq.s3.util.getBucket(this.getEndpoint(id))},this),host:qq.bind(function(id){return/(?:http|https):\/\/(.+)(?:\/.+)?/.exec(this._endpointStore.get(id))[1]},this),key:"uuid",reducedRedundancy:!1,region:"us-east-1",serverSideEncryption:!1},credentials:{accessKey:null,secretKey:null,expiration:null,sessionToken:null},signature:{customHeaders:{},endpoint:null,version:2},uploadSuccess:{endpoint:null,method:"POST",params:{},customHeaders:{}},iframeSupport:{localBlankPagePath:null},chunking:{partSize:5242880},cors:{allowXdr:!0},callbacks:{onCredentialsExpired:function(){}}};qq.extend(options,o,!0),this.setCredentials(options.credentials,!0)||(this._currentCredentials.accessKey=options.request.accessKey),this._aclStore=this._createStore(options.objectProperties.acl),qq.FineUploaderBasic.call(this,options),this._uploadSuccessParamsStore=this._createStore(this._options.uploadSuccess.params),this._uploadSuccessEndpointStore=this._createStore(this._options.uploadSuccess.endpoint),this._failedSuccessRequestCallbacks={},this._cannedKeys={},this._cannedBuckets={},this._buckets={},this._hosts={}},qq.extend(qq.s3.FineUploaderBasic.prototype,qq.basePublicApi),qq.extend(qq.s3.FineUploaderBasic.prototype,qq.basePrivateApi),qq.extend(qq.s3.FineUploaderBasic.prototype,qq.nonTraditionalBasePublicApi),qq.extend(qq.s3.FineUploaderBasic.prototype,qq.nonTraditionalBasePrivateApi),qq.extend(qq.s3.FineUploaderBasic.prototype,{getBucket:function(id){return null==this._cannedBuckets[id]?this._buckets[id]:this._cannedBuckets[id]},getKey:function(id){return null==this._cannedKeys[id]?this._handler.getThirdPartyFileId(id):this._cannedKeys[id]},reset:function(){qq.FineUploaderBasic.prototype.reset.call(this),this._failedSuccessRequestCallbacks=[],this._buckets={},this._hosts={}},setCredentials:function(credentials,ignoreEmpty){if(credentials&&credentials.secretKey){if(!credentials.accessKey)throw new qq.Error("Invalid credentials: no accessKey");if(!credentials.expiration)throw new qq.Error("Invalid credentials: no expiration");return this._currentCredentials=qq.extend({},credentials),qq.isString(credentials.expiration)&&(this._currentCredentials.expiration=new Date(credentials.expiration)),!0}if(!ignoreEmpty)throw new qq.Error("Invalid credentials parameter!");this._currentCredentials={}},setAcl:function(acl,id){this._aclStore.set(acl,id)},_createUploadHandler:function(){var self=this,additionalOptions={aclStore:this._aclStore,getBucket:qq.bind(this._determineBucket,this),getHost:qq.bind(this._determineHost,this),getKeyName:qq.bind(this._determineKeyName,this),iframeSupport:this._options.iframeSupport,objectProperties:this._options.objectProperties,signature:this._options.signature,clockDrift:this._options.request.clockDrift,validation:{minSizeLimit:this._options.validation.minSizeLimit,maxSizeLimit:this._options.validation.sizeLimit}};return qq.override(this._endpointStore,function(super_){return{get:function(id){var endpoint=super_.get(id);return endpoint.indexOf("http")<0?"http://"+endpoint:endpoint}}}),qq.override(this._paramsStore,function(super_){return{get:function(id){var oldParams=super_.get(id),modifiedParams={};return qq.each(oldParams,function(name,val){var paramName=name;qq.indexOf(qq.s3.util.CASE_SENSITIVE_PARAM_NAMES,paramName)<0&&(paramName=paramName.toLowerCase()),modifiedParams[paramName]=qq.isFunction(val)?val():val}),modifiedParams}}}),additionalOptions.signature.credentialsProvider={get:function(){return self._currentCredentials},onExpired:function(){var updateCredentials=new qq.Promise,callbackRetVal=self._options.callbacks.onCredentialsExpired();return qq.isGenericPromise(callbackRetVal)?callbackRetVal.then(function(credentials){try{self.setCredentials(credentials),updateCredentials.success()}catch(error){self.log("Invalid credentials returned from onCredentialsExpired callback! ("+error.message+")","error"),updateCredentials.failure("onCredentialsExpired did not return valid credentials.")}},function(errorMsg){self.log("onCredentialsExpired callback indicated failure! ("+errorMsg+")","error"),updateCredentials.failure("onCredentialsExpired callback failed.")}):(self.log("onCredentialsExpired callback did not return a promise!","error"),updateCredentials.failure("Unexpected return value for onCredentialsExpired.")),updateCredentials}},qq.FineUploaderBasic.prototype._createUploadHandler.call(this,additionalOptions,"s3")},_determineObjectPropertyValue:function(id,property){var maybe=this._options.objectProperties[property],promise=new qq.Promise,self=this;return qq.isFunction(maybe)?(maybe=maybe(id),qq.isGenericPromise(maybe)?promise=maybe:promise.success(maybe)):qq.isString(maybe)&&promise.success(maybe),promise.then(function(value){self["_"+property+"s"][id]=value},function(errorMsg){qq.log("Problem determining "+property+" for ID "+id+" ("+errorMsg+")","error")}),promise},_determineBucket:function(id){return this._determineObjectPropertyValue(id,"bucket")},_determineHost:function(id){return this._determineObjectPropertyValue(id,"host")},_determineKeyName:function(id,filename){var promise=new qq.Promise,keynameLogic=this._options.objectProperties.key,extension=qq.getExtension(filename),onGetKeynameFailure=promise.failure,onGetKeynameSuccess=function(keyname,extension){var keynameToUse=keyname;void 0!==extension&&(keynameToUse+="."+extension),promise.success(keynameToUse)};switch(keynameLogic){case"uuid":onGetKeynameSuccess(this.getUuid(id),extension);break;case"filename":onGetKeynameSuccess(filename);break;default:qq.isFunction(keynameLogic)?this._handleKeynameFunction(keynameLogic,id,onGetKeynameSuccess,onGetKeynameFailure):(this.log(keynameLogic+" is not a valid value for the s3.keyname option!","error"),onGetKeynameFailure())}return promise},_handleKeynameFunction:function(keynameFunc,id,successCallback,failureCallback){var self=this,onSuccess=function(keyname){successCallback(keyname)},onFailure=function(reason){self.log(qq.format("Failed to retrieve key name for {}.  Reason: {}",id,reason||"null"),"error"),failureCallback(reason)},keyname=keynameFunc.call(this,id);qq.isGenericPromise(keyname)?keyname.then(onSuccess,onFailure):null==keyname?onFailure():onSuccess(keyname)},_getEndpointSpecificParams:function(id,response,maybeXhr){var params={key:this.getKey(id),uuid:this.getUuid(id),name:this.getName(id),bucket:this.getBucket(id)};return maybeXhr&&maybeXhr.getResponseHeader("ETag")?params.etag=maybeXhr.getResponseHeader("ETag"):response.etag&&(params.etag=response.etag),params},_onSubmitDelete:function(id,onSuccessCallback){var additionalMandatedParams={key:this.getKey(id),bucket:this.getBucket(id)};return qq.FineUploaderBasic.prototype._onSubmitDelete.call(this,id,onSuccessCallback,additionalMandatedParams)},_addCannedFile:function(sessionData){var id;if(null==sessionData.s3Key)throw new qq.Error("Did not find s3Key property in server session response.  This is required!");return id=qq.FineUploaderBasic.prototype._addCannedFile.apply(this,arguments),this._cannedKeys[id]=sessionData.s3Key,this._cannedBuckets[id]=sessionData.s3Bucket,id}})}(),window.Uint8ClampedArray||(window.Uint8ClampedArray=function(){}),qq.s3.RequestSigner=function(o){"use strict";function handleSignatureReceived(id,xhrOrXdr,isError){var errorMessage,response,responseJson=xhrOrXdr.responseText,pendingSignatureData=pendingSignatures[id],promise=pendingSignatureData.promise,signatureConstructor=pendingSignatureData.signatureConstructor;if(delete pendingSignatures[id],responseJson)try{response=qq.parseJson(responseJson)}catch(error){options.log("Error attempting to parse signature response: "+error,"error")}response&&response.error?(isError=!0,errorMessage=response.error):response&&response.invalid?(isError=!0,errorMessage="Invalid policy document or request headers!"):response?options.expectingPolicy&&!response.policy?(isError=!0,errorMessage="Response does not include the base64 encoded policy!"):response.signature||(isError=!0,errorMessage="Response does not include the signature!"):(isError=!0,errorMessage="Received an empty or invalid response from the server!"),isError?(errorMessage&&options.log(errorMessage,"error"),promise.failure(errorMessage)):signatureConstructor?generateHeaders(signatureConstructor,response.signature,promise):promise.success(response)}function getStringToSignArtifacts(id,version,requestInfo){var endOfUrl,signatureSpec,toSign,promise=new qq.Promise,method="POST",headerNames=[],headersStr="",now=new Date,generateStringToSign=function(requestInfo){
var contentMd5,headerIndexesToRemove=[];return qq.each(requestInfo.headers,function(name){headerNames.push(name)}),headerNames.sort(),qq.each(headerNames,function(idx,headerName){qq.indexOf(qq.s3.util.UNSIGNABLE_REST_HEADER_NAMES,headerName)<0?headersStr+=headerName.toLowerCase()+":"+requestInfo.headers[headerName].trim()+"\n":"Content-MD5"===headerName?contentMd5=requestInfo.headers[headerName]:headerIndexesToRemove.unshift(idx)}),qq.each(headerIndexesToRemove,function(idx,headerIdx){headerNames.splice(headerIdx,1)}),signatureSpec={bucket:requestInfo.bucket,contentMd5:contentMd5,contentType:requestInfo.contentType,date:now,drift:options.signatureSpec.drift,endOfUrl:endOfUrl,hashedContent:requestInfo.hashedContent,headerNames:headerNames,headersStr:headersStr,method:method},toSign=2===version?v2.getStringToSign(signatureSpec):v4.getStringToSign(signatureSpec),{date:now,endOfUrl:endOfUrl,signedHeaders:4===version?v4.getSignedHeaders(signatureSpec.headerNames):null,toSign:4===version?toSign.hashed:toSign,toSignRaw:4===version?toSign.raw:toSign}};switch(requestInfo.type){case thisSignatureRequester.REQUEST_TYPE.MULTIPART_ABORT:method="DELETE",endOfUrl=qq.format("uploadId={}",requestInfo.uploadId);break;case thisSignatureRequester.REQUEST_TYPE.MULTIPART_INITIATE:endOfUrl="uploads";break;case thisSignatureRequester.REQUEST_TYPE.MULTIPART_COMPLETE:endOfUrl=qq.format("uploadId={}",requestInfo.uploadId);break;case thisSignatureRequester.REQUEST_TYPE.MULTIPART_UPLOAD:method="PUT",endOfUrl=qq.format("partNumber={}&uploadId={}",requestInfo.partNum,requestInfo.uploadId)}return endOfUrl=requestInfo.key+"?"+endOfUrl,4===version?v4.getEncodedHashedPayload(requestInfo.content).then(function(hashedContent){requestInfo.headers["x-amz-content-sha256"]=hashedContent,requestInfo.headers.Host=requestInfo.host,requestInfo.headers["x-amz-date"]=qq.s3.util.getV4PolicyDate(now,options.signatureSpec.drift),requestInfo.hashedContent=hashedContent,promise.success(generateStringToSign(requestInfo))},function(err){promise.failure(err)}):promise.success(generateStringToSign(requestInfo)),promise}function determineSignatureClientSide(id,toBeSigned,signatureEffort,updatedAccessKey,updatedSessionToken){var updatedHeaders;toBeSigned.signatureConstructor?(updatedSessionToken&&(updatedHeaders=toBeSigned.signatureConstructor.getHeaders(),updatedHeaders[qq.s3.util.SESSION_TOKEN_PARAM_NAME]=updatedSessionToken,toBeSigned.signatureConstructor.withHeaders(updatedHeaders)),toBeSigned.signatureConstructor.getToSign(id).then(function(signatureArtifacts){signApiRequest(toBeSigned.signatureConstructor,signatureArtifacts.stringToSign,signatureEffort)},function(err){signatureEffort.failure(err)})):(updatedSessionToken&&qq.s3.util.refreshPolicyCredentials(toBeSigned,updatedSessionToken),signPolicy(toBeSigned,signatureEffort,updatedAccessKey,updatedSessionToken))}function signPolicy(policy,signatureEffort,updatedAccessKey,updatedSessionToken){4===options.signatureSpec.version?v4.signPolicy(policy,signatureEffort,updatedAccessKey,updatedSessionToken):v2.signPolicy(policy,signatureEffort,updatedAccessKey,updatedSessionToken)}function signApiRequest(signatureConstructor,headersStr,signatureEffort){4===options.signatureSpec.version?v4.signApiRequest(signatureConstructor,headersStr,signatureEffort):v2.signApiRequest(signatureConstructor,headersStr,signatureEffort)}var requester,credentialsProvider,thisSignatureRequester=this,pendingSignatures={},options={expectingPolicy:!1,method:"POST",signatureSpec:{drift:0,credentialsProvider:{},endpoint:null,customHeaders:{},version:2},maxConnections:3,endpointStore:{},paramsStore:{},cors:{expected:!1,sendCredentials:!1},log:function(str,level){}},generateHeaders=function(signatureConstructor,signature,promise){var headers=signatureConstructor.getHeaders();4===options.signatureSpec.version?headers.Authorization=qq.s3.util.V4_ALGORITHM_PARAM_VALUE+" Credential="+options.signatureSpec.credentialsProvider.get().accessKey+"/"+qq.s3.util.getCredentialsDate(signatureConstructor.getRequestDate())+"/"+options.signatureSpec.region+"/s3/aws4_request,SignedHeaders="+signatureConstructor.getSignedHeaders()+",Signature="+signature:headers.Authorization="AWS "+options.signatureSpec.credentialsProvider.get().accessKey+":"+signature,promise.success(headers,signatureConstructor.getEndOfUrl())},v2={getStringToSign:function(signatureSpec){return qq.format("{}\n{}\n{}\n\n{}/{}/{}",signatureSpec.method,signatureSpec.contentMd5||"",signatureSpec.contentType||"",signatureSpec.headersStr||"\n",signatureSpec.bucket,signatureSpec.endOfUrl)},signApiRequest:function(signatureConstructor,headersStr,signatureEffort){var headersWordArray=qq.CryptoJS.enc.Utf8.parse(headersStr),headersHmacSha1=qq.CryptoJS.HmacSHA1(headersWordArray,credentialsProvider.get().secretKey),headersHmacSha1Base64=qq.CryptoJS.enc.Base64.stringify(headersHmacSha1);generateHeaders(signatureConstructor,headersHmacSha1Base64,signatureEffort)},signPolicy:function(policy,signatureEffort,updatedAccessKey,updatedSessionToken){var policyStr=JSON.stringify(policy),policyWordArray=qq.CryptoJS.enc.Utf8.parse(policyStr),base64Policy=qq.CryptoJS.enc.Base64.stringify(policyWordArray),policyHmacSha1=qq.CryptoJS.HmacSHA1(base64Policy,credentialsProvider.get().secretKey),policyHmacSha1Base64=qq.CryptoJS.enc.Base64.stringify(policyHmacSha1);signatureEffort.success({policy:base64Policy,signature:policyHmacSha1Base64},updatedAccessKey,updatedSessionToken)}},v4={getCanonicalQueryString:function(endOfUri){var encodedQueryParams,encodedQueryParamNames,queryStrings,queryParamIdx=endOfUri.indexOf("?"),canonicalQueryString="";return queryParamIdx>=0&&(encodedQueryParams={},queryStrings=endOfUri.substr(queryParamIdx+1).split("&"),qq.each(queryStrings,function(idx,queryString){var nameAndVal=queryString.split("="),paramVal=nameAndVal[1];null==paramVal&&(paramVal=""),encodedQueryParams[encodeURIComponent(nameAndVal[0])]=encodeURIComponent(paramVal)}),encodedQueryParamNames=Object.keys(encodedQueryParams).sort(),encodedQueryParamNames.forEach(function(encodedQueryParamName,idx){canonicalQueryString+=encodedQueryParamName+"="+encodedQueryParams[encodedQueryParamName],idx<encodedQueryParamNames.length-1&&(canonicalQueryString+="&")})),canonicalQueryString},getCanonicalRequest:function(signatureSpec){return qq.format("{}\n{}\n{}\n{}\n{}\n{}",signatureSpec.method,v4.getCanonicalUri(signatureSpec.endOfUrl),v4.getCanonicalQueryString(signatureSpec.endOfUrl),signatureSpec.headersStr||"\n",v4.getSignedHeaders(signatureSpec.headerNames),signatureSpec.hashedContent)},getCanonicalUri:function(endOfUri){var path=endOfUri,queryParamIdx=endOfUri.indexOf("?");return queryParamIdx>0&&(path=endOfUri.substr(0,queryParamIdx)),"/"+path},getEncodedHashedPayload:function(body){var reader,promise=new qq.Promise;return qq.isBlob(body)?(reader=new FileReader,reader.onloadend=function(e){if(e.target.readyState===FileReader.DONE)if(e.target.error)promise.failure(e.target.error);else{var wordArray=qq.CryptoJS.lib.WordArray.create(e.target.result);promise.success(qq.CryptoJS.SHA256(wordArray).toString())}},reader.readAsArrayBuffer(body)):(body=body||"",promise.success(qq.CryptoJS.SHA256(body).toString())),promise},getScope:function(date,region){return qq.s3.util.getCredentialsDate(date)+"/"+region+"/s3/aws4_request"},getStringToSign:function(signatureSpec){var canonicalRequest=v4.getCanonicalRequest(signatureSpec),date=qq.s3.util.getV4PolicyDate(signatureSpec.date,signatureSpec.drift),hashedRequest=qq.CryptoJS.SHA256(canonicalRequest).toString(),scope=v4.getScope(signatureSpec.date,options.signatureSpec.region);return{hashed:qq.format("AWS4-HMAC-SHA256\n{}\n{}\n{}",date,scope,hashedRequest),raw:qq.format("AWS4-HMAC-SHA256\n{}\n{}\n{}",date,scope,canonicalRequest)}},getSignedHeaders:function(headerNames){var signedHeaders="";return headerNames.forEach(function(headerName,idx){signedHeaders+=headerName.toLowerCase(),idx<headerNames.length-1&&(signedHeaders+=";")}),signedHeaders},signApiRequest:function(signatureConstructor,headersStr,signatureEffort){var dateKey,dateRegionKey,dateRegionServiceKey,signingKey,secretKey=credentialsProvider.get().secretKey,headersPattern=/.+\n.+\n(\d+)\/(.+)\/s3\/.+\n(.+)/,matches=headersPattern.exec(headersStr);dateKey=qq.CryptoJS.HmacSHA256(matches[1],"AWS4"+secretKey),dateRegionKey=qq.CryptoJS.HmacSHA256(matches[2],dateKey),dateRegionServiceKey=qq.CryptoJS.HmacSHA256("s3",dateRegionKey),signingKey=qq.CryptoJS.HmacSHA256("aws4_request",dateRegionServiceKey),generateHeaders(signatureConstructor,qq.CryptoJS.HmacSHA256(headersStr,signingKey),signatureEffort)},signPolicy:function(policy,signatureEffort,updatedAccessKey,updatedSessionToken){var matches,dateKey,dateRegionKey,dateRegionServiceKey,signingKey,policyStr=JSON.stringify(policy),policyWordArray=qq.CryptoJS.enc.Utf8.parse(policyStr),base64Policy=qq.CryptoJS.enc.Base64.stringify(policyWordArray),secretKey=credentialsProvider.get().secretKey,credentialPattern=/.+\/(.+)\/(.+)\/s3\/aws4_request/,credentialCondition=function(){var credential=null;return qq.each(policy.conditions,function(key,condition){var val=condition["x-amz-credential"];if(val)return credential=val,!1}),credential}();matches=credentialPattern.exec(credentialCondition),dateKey=qq.CryptoJS.HmacSHA256(matches[1],"AWS4"+secretKey),dateRegionKey=qq.CryptoJS.HmacSHA256(matches[2],dateKey),dateRegionServiceKey=qq.CryptoJS.HmacSHA256("s3",dateRegionKey),signingKey=qq.CryptoJS.HmacSHA256("aws4_request",dateRegionServiceKey),signatureEffort.success({policy:base64Policy,signature:qq.CryptoJS.HmacSHA256(base64Policy,signingKey).toString()},updatedAccessKey,updatedSessionToken)}};qq.extend(options,o,!0),credentialsProvider=options.signatureSpec.credentialsProvider,requester=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",method:options.method,contentType:"application/json; charset=utf-8",endpointStore:{get:function(){return options.signatureSpec.endpoint}},paramsStore:options.paramsStore,maxConnections:options.maxConnections,customHeaders:options.signatureSpec.customHeaders,log:options.log,onComplete:handleSignatureReceived,cors:options.cors})),qq.extend(this,{getSignature:function(id,toBeSigned){var queryParams,params=toBeSigned,signatureConstructor=toBeSigned.signatureConstructor,signatureEffort=new qq.Promise;return 4===options.signatureSpec.version&&(queryParams={v4:!0}),credentialsProvider.get().secretKey&&qq.CryptoJS?credentialsProvider.get().expiration.getTime()>Date.now()?determineSignatureClientSide(id,toBeSigned,signatureEffort):credentialsProvider.onExpired().then(function(){determineSignatureClientSide(id,toBeSigned,signatureEffort,credentialsProvider.get().accessKey,credentialsProvider.get().sessionToken)},function(errorMsg){options.log("Attempt to update expired credentials apparently failed! Unable to sign request.  ","error"),signatureEffort.failure("Unable to sign request - expired credentials.")}):(options.log("Submitting S3 signature request for "+id),signatureConstructor?signatureConstructor.getToSign(id).then(function(signatureArtifacts){params={headers:signatureArtifacts.stringToSignRaw},requester.initTransport(id).withParams(params).withQueryParams(queryParams).send()},function(err){options.log("Failed to construct signature. ","error"),signatureEffort.failure("Failed to construct signature.")}):requester.initTransport(id).withParams(params).withQueryParams(queryParams).send(),pendingSignatures[id]={promise:signatureEffort,signatureConstructor:signatureConstructor}),signatureEffort},constructStringToSign:function(type,bucket,host,key){var uploadId,content,contentType,partNum,artifacts,headers={};return{withHeaders:function(theHeaders){return headers=theHeaders,this},withUploadId:function(theUploadId){return uploadId=theUploadId,this},withContent:function(theContent){return content=theContent,this},withContentType:function(theContentType){return contentType=theContentType,this},withPartNum:function(thePartNum){return partNum=thePartNum,this},getToSign:function(id){var sessionToken=credentialsProvider.get().sessionToken,promise=new qq.Promise,adjustedDate=new Date(Date.now()+options.signatureSpec.drift);return headers["x-amz-date"]=adjustedDate.toUTCString(),sessionToken&&(headers[qq.s3.util.SESSION_TOKEN_PARAM_NAME]=sessionToken),getStringToSignArtifacts(id,options.signatureSpec.version,{bucket:bucket,content:content,contentType:contentType,headers:headers,host:host,key:key,partNum:partNum,type:type,uploadId:uploadId}).then(function(_artifacts_){artifacts=_artifacts_,promise.success({headers:function(){return contentType&&(headers["Content-Type"]=contentType),delete headers.Host,headers}(),date:artifacts.date,endOfUrl:artifacts.endOfUrl,signedHeaders:artifacts.signedHeaders,stringToSign:artifacts.toSign,stringToSignRaw:artifacts.toSignRaw})},function(err){promise.failure(err)}),promise},getHeaders:function(){return qq.extend({},headers)},getEndOfUrl:function(){return artifacts&&artifacts.endOfUrl},getRequestDate:function(){return artifacts&&artifacts.date},getSignedHeaders:function(){return artifacts&&artifacts.signedHeaders}}}})},qq.s3.RequestSigner.prototype.REQUEST_TYPE={MULTIPART_INITIATE:"multipart_initiate",MULTIPART_COMPLETE:"multipart_complete",MULTIPART_ABORT:"multipart_abort",MULTIPART_UPLOAD:"multipart_upload"},qq.UploadSuccessAjaxRequester=function(o){"use strict";function handleSuccessResponse(id,xhrOrXdr,isError){var parsedResponse,promise=pendingRequests[id],responseJson=xhrOrXdr.responseText,successIndicator={success:!0},failureIndicator={success:!1};delete pendingRequests[id],options.log(qq.format("Received the following response body to an upload success request for id {}: {}",id,responseJson));try{parsedResponse=qq.parseJson(responseJson),isError||parsedResponse&&(parsedResponse.error||!1===parsedResponse.success)?(options.log("Upload success request was rejected by the server.","error"),promise.failure(qq.extend(parsedResponse,failureIndicator))):(options.log("Upload success was acknowledged by the server."),promise.success(qq.extend(parsedResponse,successIndicator)))}catch(error){isError?(options.log(qq.format("Your server indicated failure in its upload success request response for id {}!",id),"error"),promise.failure(failureIndicator)):(options.log("Upload success was acknowledged by the server."),promise.success(successIndicator))}}var requester,pendingRequests=[],options={method:"POST",endpoint:null,maxConnections:3,customHeaders:{},paramsStore:{},cors:{expected:!1,sendCredentials:!1},log:function(str,level){}};qq.extend(options,o),requester=qq.extend(this,new qq.AjaxRequester({acceptHeader:"application/json",method:options.method,endpointStore:{get:function(){return options.endpoint}},paramsStore:options.paramsStore,maxConnections:options.maxConnections,customHeaders:options.customHeaders,log:options.log,onComplete:handleSuccessResponse,cors:options.cors})),qq.extend(this,{sendSuccessRequest:function(id,spec){var promise=new qq.Promise;return options.log("Submitting upload success request/notification for "+id),requester.initTransport(id).withParams(spec).send(),pendingRequests[id]=promise,promise}})},qq.s3.InitiateMultipartAjaxRequester=function(o){"use strict";function getHeaders(id){var signatureConstructor,bucket=options.getBucket(id),host=options.getHost(id),headers={},promise=new qq.Promise,key=options.getKey(id);return headers["x-amz-acl"]=options.aclStore.get(id),options.reducedRedundancy&&(headers[qq.s3.util.REDUCED_REDUNDANCY_PARAM_NAME]=qq.s3.util.REDUCED_REDUNDANCY_PARAM_VALUE),options.serverSideEncryption&&(headers[qq.s3.util.SERVER_SIDE_ENCRYPTION_PARAM_NAME]=qq.s3.util.SERVER_SIDE_ENCRYPTION_PARAM_VALUE),headers[qq.s3.util.AWS_PARAM_PREFIX+options.filenameParam]=encodeURIComponent(options.getName(id)),qq.each(options.paramsStore.get(id),function(name,val){qq.indexOf(qq.s3.util.UNPREFIXED_PARAM_NAMES,name)>=0?headers[name]=val:headers[qq.s3.util.AWS_PARAM_PREFIX+name]=encodeURIComponent(val)}),signatureConstructor=getSignatureAjaxRequester.constructStringToSign(getSignatureAjaxRequester.REQUEST_TYPE.MULTIPART_INITIATE,bucket,host,key).withContentType(options.getContentType(id)).withHeaders(headers),getSignatureAjaxRequester.getSignature(id,{signatureConstructor:signatureConstructor}).then(promise.success,promise.failure),promise}function handleInitiateRequestComplete(id,xhr,isError){var uploadIdElements,messageElements,uploadId,errorMessage,status,promise=pendingInitiateRequests[id],domParser=new DOMParser,responseDoc=domParser.parseFromString(xhr.responseText,"application/xml");delete pendingInitiateRequests[id],isError?(status=xhr.status,messageElements=responseDoc.getElementsByTagName("Message"),messageElements.length>0&&(errorMessage=messageElements[0].textContent)):(uploadIdElements=responseDoc.getElementsByTagName("UploadId"),uploadIdElements.length>0?uploadId=uploadIdElements[0].textContent:errorMessage="Upload ID missing from request"),void 0===uploadId?(errorMessage?options.log(qq.format("Specific problem detected initiating multipart upload request for {}: '{}'.",id,errorMessage),"error"):options.log(qq.format("Unexplained error with initiate multipart upload request for {}.  Status code {}.",id,status),"error"),promise.failure("Problem initiating upload request.",xhr)):(options.log(qq.format("Initiate multipart upload request successful for {}.  Upload ID is {}",id,uploadId)),promise.success(uploadId,xhr))}var requester,getSignatureAjaxRequester,pendingInitiateRequests={},options={filenameParam:"qqfilename",method:"POST",endpointStore:null,paramsStore:null,signatureSpec:null,aclStore:null,reducedRedundancy:!1,serverSideEncryption:!1,maxConnections:3,getContentType:function(id){},getBucket:function(id){},getHost:function(id){},getKey:function(id){},getName:function(id){},log:function(str,level){}};qq.extend(options,o),getSignatureAjaxRequester=new qq.s3.RequestSigner({endpointStore:options.endpointStore,signatureSpec:options.signatureSpec,cors:options.cors,log:options.log}),requester=qq.extend(this,new qq.AjaxRequester({method:options.method,contentType:null,endpointStore:options.endpointStore,maxConnections:options.maxConnections,allowXRequestedWithAndCacheControl:!1,log:options.log,onComplete:handleInitiateRequestComplete,successfulResponseCodes:{POST:[200]}})),qq.extend(this,{send:function(id){var promise=new qq.Promise;return getHeaders(id).then(function(headers,endOfUrl){options.log("Submitting S3 initiate multipart upload request for "+id),pendingInitiateRequests[id]=promise,requester.initTransport(id).withPath(endOfUrl).withHeaders(headers).send()},promise.failure),promise}})},qq.s3.CompleteMultipartAjaxRequester=function(o){"use strict";function getHeaders(id,uploadId,body){var promise=new qq.Promise,bucket=options.getBucket(id),host=options.getHost(id),signatureConstructor=getSignatureAjaxRequester.constructStringToSign(getSignatureAjaxRequester.REQUEST_TYPE.MULTIPART_COMPLETE,bucket,host,options.getKey(id)).withUploadId(uploadId).withContent(body).withContentType("application/xml; charset=UTF-8");return getSignatureAjaxRequester.getSignature(id,{signatureConstructor:signatureConstructor}).then(promise.success,promise.failure),promise}function handleCompleteRequestComplete(id,xhr,isError){var promise=pendingCompleteRequests[id],domParser=new DOMParser,bucket=options.getBucket(id),responseDoc=(options.getKey(id),domParser.parseFromString(xhr.responseText,"application/xml")),bucketEls=responseDoc.getElementsByTagName("Bucket"),keyEls=responseDoc.getElementsByTagName("Key");delete pendingCompleteRequests[id],options.log(qq.format("Complete response status {}, body = {}",xhr.status,xhr.responseText)),isError?options.log(qq.format("Complete Multipart Upload request for {} failed with status {}.",id,xhr.status),"error"):bucketEls.length&&keyEls.length?bucketEls[0].textContent!==bucket&&(isError=!0,options.log(qq.format("Wrong bucket in response to Complete Multipart Upload request for {}.",id),"error")):(isError=!0,options.log(qq.format("Missing bucket and/or key in response to Complete Multipart Upload request for {}.",id),"error")),isError?promise.failure("Problem combining the file parts!",xhr):promise.success({},xhr)}function getCompleteRequestBody(etagEntries){var doc=document.implementation.createDocument(null,"CompleteMultipartUpload",null);return etagEntries.sort(function(a,b){return a.part-b.part}),qq.each(etagEntries,function(idx,etagEntry){var part=etagEntry.part,etag=etagEntry.etag,partEl=doc.createElement("Part"),partNumEl=doc.createElement("PartNumber"),partNumTextEl=doc.createTextNode(part),etagTextEl=doc.createTextNode(etag),etagEl=doc.createElement("ETag");etagEl.appendChild(etagTextEl),partNumEl.appendChild(partNumTextEl),partEl.appendChild(partNumEl),partEl.appendChild(etagEl),qq(doc).children()[0].appendChild(partEl)}),(new XMLSerializer).serializeToString(doc)}var requester,getSignatureAjaxRequester,pendingCompleteRequests={},options={method:"POST",contentType:"text/xml",endpointStore:null,signatureSpec:null,maxConnections:3,getBucket:function(id){},getHost:function(id){},getKey:function(id){},log:function(str,level){}};qq.extend(options,o),getSignatureAjaxRequester=new qq.s3.RequestSigner({endpointStore:options.endpointStore,signatureSpec:options.signatureSpec,cors:options.cors,log:options.log}),requester=qq.extend(this,new qq.AjaxRequester({method:options.method,contentType:"application/xml; charset=UTF-8",endpointStore:options.endpointStore,maxConnections:options.maxConnections,allowXRequestedWithAndCacheControl:!1,log:options.log,onComplete:handleCompleteRequestComplete,successfulResponseCodes:{POST:[200]}})),qq.extend(this,{send:function(id,uploadId,etagEntries){var promise=new qq.Promise,body=getCompleteRequestBody(etagEntries);return getHeaders(id,uploadId,body).then(function(headers,endOfUrl){options.log("Submitting S3 complete multipart upload request for "+id),pendingCompleteRequests[id]=promise,delete headers["Content-Type"],requester.initTransport(id).withPath(endOfUrl).withHeaders(headers).withPayload(body).send()},promise.failure),promise}})},qq.s3.AbortMultipartAjaxRequester=function(o){"use strict";function getHeaders(id,uploadId){var promise=new qq.Promise,bucket=options.getBucket(id),host=options.getHost(id),signatureConstructor=getSignatureAjaxRequester.constructStringToSign(getSignatureAjaxRequester.REQUEST_TYPE.MULTIPART_ABORT,bucket,host,options.getKey(id)).withUploadId(uploadId);return getSignatureAjaxRequester.getSignature(id,{signatureConstructor:signatureConstructor}).then(promise.success,promise.failure),promise}function handleAbortRequestComplete(id,xhr,isError){var awsErrorMsg,domParser=new DOMParser,responseDoc=domParser.parseFromString(xhr.responseText,"application/xml"),errorEls=responseDoc.getElementsByTagName("Error");options.log(qq.format("Abort response status {}, body = {}",xhr.status,xhr.responseText)),isError?options.log(qq.format("Abort Multipart Upload request for {} failed with status {}.",id,xhr.status),"error"):errorEls.length?(isError=!0,awsErrorMsg=responseDoc.getElementsByTagName("Message")[0].textContent,options.log(qq.format("Failed to Abort Multipart Upload request for {}.  Error: {}",id,awsErrorMsg),"error")):options.log(qq.format("Abort MPU request succeeded for file ID {}.",id))}var requester,getSignatureAjaxRequester,options={method:"DELETE",endpointStore:null,signatureSpec:null,maxConnections:3,getBucket:function(id){},getHost:function(id){},getKey:function(id){},log:function(str,level){}};qq.extend(options,o),getSignatureAjaxRequester=new qq.s3.RequestSigner({endpointStore:options.endpointStore,signatureSpec:options.signatureSpec,cors:options.cors,log:options.log}),requester=qq.extend(this,new qq.AjaxRequester({validMethods:["DELETE"],method:options.method,contentType:null,endpointStore:options.endpointStore,maxConnections:options.maxConnections,allowXRequestedWithAndCacheControl:!1,log:options.log,onComplete:handleAbortRequestComplete,successfulResponseCodes:{DELETE:[204]}})),qq.extend(this,{send:function(id,uploadId){getHeaders(id,uploadId).then(function(headers,endOfUrl){options.log("Submitting S3 Abort multipart upload request for "+id),requester.initTransport(id).withPath(endOfUrl).withHeaders(headers).send()})}})},qq.s3.XhrUploadHandler=function(spec,proxy){"use strict";var getName=proxy.getName,log=proxy.log,clockDrift=spec.clockDrift,onGetBucket=spec.getBucket,onGetHost=spec.getHost,onGetKeyName=spec.getKeyName,filenameParam=spec.filenameParam,paramsStore=spec.paramsStore,endpointStore=spec.endpointStore,aclStore=spec.aclStore,reducedRedundancy=spec.objectProperties.reducedRedundancy,region=spec.objectProperties.region,serverSideEncryption=spec.objectProperties.serverSideEncryption,validation=spec.validation,signature=qq.extend({region:region,drift:clockDrift},spec.signature),handler=this,credentialsProvider=spec.signature.credentialsProvider,chunked={combine:function(id){var uploadId=handler._getPersistableData(id).uploadId,etagMap=handler._getPersistableData(id).etags,result=new qq.Promise;return requesters.completeMultipart.send(id,uploadId,etagMap).then(result.success,function(reason,xhr){result.failure(upload.done(id,xhr).response,xhr)}),result},done:function(id,xhr,chunkIdx){var etag,response=upload.response.parse(id,xhr);response.success&&(etag=xhr.getResponseHeader("ETag"),handler._getPersistableData(id).etags||(handler._getPersistableData(id).etags=[]),handler._getPersistableData(id).etags.push({part:chunkIdx+1,etag:etag}))},initHeaders:function(id,chunkIdx,blob){var bucket=upload.bucket.getName(id),host=upload.host.getName(id),key=upload.key.urlSafe(id),promise=new qq.Promise,signatureConstructor=requesters.restSignature.constructStringToSign(requesters.restSignature.REQUEST_TYPE.MULTIPART_UPLOAD,bucket,host,key).withPartNum(chunkIdx+1).withContent(blob).withUploadId(handler._getPersistableData(id).uploadId);return requesters.restSignature.getSignature(id+"."+chunkIdx,{signatureConstructor:signatureConstructor}).then(promise.success,promise.failure),promise},put:function(id,chunkIdx){var xhr=handler._createXhr(id,chunkIdx),chunkData=handler._getChunkData(id,chunkIdx),domain=spec.endpointStore.get(id),promise=new qq.Promise;return chunked.initHeaders(id,chunkIdx,chunkData.blob).then(function(headers,endOfUrl){if(xhr._cancelled)log(qq.format("Upload of item {}.{} cancelled. Upload will not start after successful signature request.",id,chunkIdx)),promise.failure({error:"Chunk upload cancelled"});else{var url=domain+"/"+endOfUrl;handler._registerProgressHandler(id,chunkIdx,chunkData.size),upload.track(id,xhr,chunkIdx).then(promise.success,promise.failure),xhr.open("PUT",url,!0),qq.each(headers,function(name,val){xhr.setRequestHeader(name,val)}),xhr.send(chunkData.blob)}},function(){promise.failure({error:"Problem signing the chunk!"},xhr)}),promise},send:function(id,chunkIdx){var promise=new qq.Promise;return chunked.setup(id).then(function(){chunked.put(id,chunkIdx).then(promise.success,promise.failure)},function(errorMessage,xhr){promise.failure({error:errorMessage},xhr)}),promise},setup:function(id){var promise=new qq.Promise,uploadId=handler._getPersistableData(id).uploadId,uploadIdPromise=new qq.Promise;return uploadId?uploadId instanceof qq.Promise?uploadId.then(function(uploadId){promise.success(uploadId)}):promise.success(uploadId):(handler._getPersistableData(id).uploadId=uploadIdPromise,requesters.initiateMultipart.send(id).then(function(uploadId){handler._getPersistableData(id).uploadId=uploadId,uploadIdPromise.success(uploadId),promise.success(uploadId)},function(errorMsg,xhr){handler._getPersistableData(id).uploadId=null,promise.failure(errorMsg,xhr),uploadIdPromise.failure(errorMsg,xhr)})),promise}},requesters={abortMultipart:new qq.s3.AbortMultipartAjaxRequester({endpointStore:endpointStore,signatureSpec:signature,cors:spec.cors,log:log,getBucket:function(id){return upload.bucket.getName(id)},getHost:function(id){return upload.host.getName(id)},getKey:function(id){return upload.key.urlSafe(id)}}),completeMultipart:new qq.s3.CompleteMultipartAjaxRequester({endpointStore:endpointStore,signatureSpec:signature,cors:spec.cors,log:log,getBucket:function(id){return upload.bucket.getName(id)},getHost:function(id){return upload.host.getName(id)},getKey:function(id){return upload.key.urlSafe(id)}}),initiateMultipart:new qq.s3.InitiateMultipartAjaxRequester({filenameParam:filenameParam,endpointStore:endpointStore,paramsStore:paramsStore,signatureSpec:signature,aclStore:aclStore,reducedRedundancy:reducedRedundancy,serverSideEncryption:serverSideEncryption,cors:spec.cors,log:log,getContentType:function(id){return handler._getMimeType(id)},getBucket:function(id){return upload.bucket.getName(id)},getHost:function(id){return upload.host.getName(id)},getKey:function(id){return upload.key.urlSafe(id)},getName:function(id){return getName(id)}}),policySignature:new qq.s3.RequestSigner({expectingPolicy:!0,signatureSpec:signature,cors:spec.cors,log:log}),restSignature:new qq.s3.RequestSigner({endpointStore:endpointStore,signatureSpec:signature,cors:spec.cors,log:log})},simple={initParams:function(id){var customParams=paramsStore.get(id);return customParams[filenameParam]=getName(id),qq.s3.util.generateAwsParams({endpoint:endpointStore.get(id),clockDrift:clockDrift,params:customParams,type:handler._getMimeType(id),bucket:upload.bucket.getName(id),key:handler.getThirdPartyFileId(id),accessKey:credentialsProvider.get().accessKey,sessionToken:credentialsProvider.get().sessionToken,acl:aclStore.get(id),expectedStatus:200,minFileSize:validation.minSizeLimit,maxFileSize:validation.maxSizeLimit,reducedRedundancy:reducedRedundancy,region:region,serverSideEncryption:serverSideEncryption,signatureVersion:signature.version,log:log},qq.bind(requesters.policySignature.getSignature,this,id))},send:function(id){var promise=new qq.Promise,xhr=handler._createXhr(id),fileOrBlob=handler.getFile(id);return handler._registerProgressHandler(id),upload.track(id,xhr).then(promise.success,promise.failure),simple.setup(id,xhr,fileOrBlob).then(function(toSend){log("Sending upload request for "+id),xhr.send(toSend)},promise.failure),promise},setup:function(id,xhr,fileOrBlob){var formData=new FormData,endpoint=endpointStore.get(id),url=endpoint,promise=new qq.Promise;return simple.initParams(id).then(function(awsParams){xhr.open("POST",url,!0),qq.obj2FormData(awsParams,formData),formData.append("file",fileOrBlob),promise.success(formData)},function(errorMessage){promise.failure({error:errorMessage})}),promise}},upload={bucket:{promise:function(id){var promise=new qq.Promise,cachedBucket=handler._getFileState(id).bucket;return cachedBucket?promise.success(cachedBucket):onGetBucket(id).then(function(bucket){handler._getFileState(id).bucket=bucket,promise.success(bucket)},promise.failure),promise},getName:function(id){return handler._getFileState(id).bucket}},host:{promise:function(id){var promise=new qq.Promise,cachedHost=handler._getFileState(id).host;return cachedHost?promise.success(cachedHost):onGetHost(id).then(function(host){handler._getFileState(id).host=host,promise.success(host)},promise.failure),promise},getName:function(id){return handler._getFileState(id).host}},done:function(id,xhr){var response=upload.response.parse(id,xhr),isError=!0!==response.success;return isError&&upload.response.shouldReset(response.code)&&(log("This is an unrecoverable error, we must restart the upload entirely on the next retry attempt.","error"),response.reset=!0),{success:!isError,response:response}},key:{promise:function(id){var promise=new qq.Promise,key=handler.getThirdPartyFileId(id);return null==key?(handler._setThirdPartyFileId(id,promise),onGetKeyName(id,getName(id)).then(function(keyName){handler._setThirdPartyFileId(id,keyName),promise.success(keyName)},function(errorReason){handler._setThirdPartyFileId(id,null),promise.failure(errorReason)})):qq.isGenericPromise(key)?key.then(promise.success,promise.failure):promise.success(key),
promise},urlSafe:function(id){var encodedKey=handler.getThirdPartyFileId(id);return qq.s3.util.uriEscapePath(encodedKey)}},response:{parse:function(id,xhr){var parsedErrorProps,response={};try{log(qq.format("Received response status {} with body: {}",xhr.status,xhr.responseText)),200===xhr.status?response.success=!0:(parsedErrorProps=upload.response.parseError(xhr.responseText))&&(response.error=parsedErrorProps.message,response.code=parsedErrorProps.code)}catch(error){log("Error when attempting to parse xhr response text ("+error.message+")","error")}return response},parseError:function(awsResponseXml){var codeEls,messageEls,parser=new DOMParser,parsedDoc=parser.parseFromString(awsResponseXml,"application/xml"),errorEls=parsedDoc.getElementsByTagName("Error"),errorDetails={};if(errorEls.length)return codeEls=parsedDoc.getElementsByTagName("Code"),messageEls=parsedDoc.getElementsByTagName("Message"),messageEls.length&&(errorDetails.message=messageEls[0].textContent),codeEls.length&&(errorDetails.code=codeEls[0].textContent),errorDetails},shouldReset:function(errorCode){return"EntityTooSmall"===errorCode||"InvalidPart"===errorCode||"InvalidPartOrder"===errorCode||"NoSuchUpload"===errorCode}},start:function(id,optChunkIdx){var promise=new qq.Promise;return upload.key.promise(id).then(function(){upload.bucket.promise(id).then(function(){upload.host.promise(id).then(function(){null==optChunkIdx?simple.send(id).then(promise.success,promise.failure):chunked.send(id,optChunkIdx).then(promise.success,promise.failure)})})},function(errorReason){promise.failure({error:errorReason})}),promise},track:function(id,xhr,optChunkIdx){var promise=new qq.Promise;return xhr.onreadystatechange=function(){if(4===xhr.readyState){var result;null==optChunkIdx?(result=upload.done(id,xhr),promise[result.success?"success":"failure"](result.response,xhr)):(chunked.done(id,xhr,optChunkIdx),result=upload.done(id,xhr),promise[result.success?"success":"failure"](result.response,xhr))}},promise}};qq.extend(this,{uploadChunk:upload.start,uploadFile:upload.start}),qq.extend(this,new qq.XhrUploadHandler({options:qq.extend({namespace:"s3"},spec),proxy:qq.extend({getEndpoint:spec.endpointStore.get},proxy)})),qq.override(this,function(super_){return{expunge:function(id){var uploadId=handler._getPersistableData(id)&&handler._getPersistableData(id).uploadId,existedInLocalStorage=handler._maybeDeletePersistedChunkData(id);void 0!==uploadId&&existedInLocalStorage&&requesters.abortMultipart.send(id,uploadId),super_.expunge(id)},finalizeChunks:function(id){return chunked.combine(id)},_getLocalStorageId:function(id){return super_._getLocalStorageId(id)+"-"+upload.bucket.getName(id)}}})},qq.s3.FormUploadHandler=function(options,proxy){"use strict";function isValidResponse(id,iframe){var doc,responseData,bucket=(options.endpointStore.get(id),handler._getFileState(id).bucket);try{if(doc=iframe.contentDocument||iframe.contentWindow.document,doc.body.innerHTML,responseData=qq.s3.util.parseIframeResponse(iframe),responseData.bucket===bucket&&responseData.key===qq.s3.util.encodeQueryStringParam(handler.getThirdPartyFileId(id)))return!0;log("Response from AWS included an unexpected bucket or key name.","error")}catch(error){log("Error when attempting to parse form upload response ("+error.message+")","error")}return!1}function generateAwsParams(id){var customParams=paramsStore.get(id);return customParams[filenameParam]=getName(id),qq.s3.util.generateAwsParams({endpoint:endpointStore.get(id),clockDrift:clockDrift,params:customParams,bucket:handler._getFileState(id).bucket,key:handler.getThirdPartyFileId(id),accessKey:credentialsProvider.get().accessKey,sessionToken:credentialsProvider.get().sessionToken,acl:aclStore.get(id),minFileSize:validation.minSizeLimit,maxFileSize:validation.maxSizeLimit,successRedirectUrl:successRedirectUrl,reducedRedundancy:reducedRedundancy,region:region,serverSideEncryption:serverSideEncryption,signatureVersion:signature.version,log:log},qq.bind(getSignatureAjaxRequester.getSignature,this,id))}function createForm(id,iframe){var promise=new qq.Promise,endpoint=options.endpointStore.get(id);getName(id);return generateAwsParams(id).then(function(params){var form=handler._initFormForUpload({method:"POST",endpoint:endpoint,params:params,paramsInBody:!0,targetName:iframe.name});promise.success(form)},function(errorMessage){promise.failure(errorMessage),handleFinishedUpload(id,iframe)}),promise}function handleUpload(id){var iframe=handler._createIframe(id),input=handler.getInput(id),promise=new qq.Promise;return createForm(id,iframe).then(function(form){form.appendChild(input),handler._attachLoadEvent(iframe,function(response){log("iframe loaded"),response?!1===response.success&&(log("Amazon likely rejected the upload request","error"),promise.failure(response)):(response={},response.success=isValidResponse(id,iframe),!1===response.success?(log("A success response was received by Amazon, but it was invalid in some way.","error"),promise.failure(response)):(qq.extend(response,qq.s3.util.parseIframeResponse(iframe)),promise.success(response))),handleFinishedUpload(id,iframe)}),log("Sending upload request for "+id),form.submit(),qq(form).remove()},promise.failure),promise}function handleFinishedUpload(id,iframe){handler._detachLoadEvent(id),iframe&&qq(iframe).remove()}var handler=this,clockDrift=options.clockDrift,onUuidChanged=proxy.onUuidChanged,getName=proxy.getName,getUuid=proxy.getUuid,log=proxy.log,onGetBucket=options.getBucket,onGetKeyName=options.getKeyName,filenameParam=options.filenameParam,paramsStore=options.paramsStore,endpointStore=options.endpointStore,aclStore=options.aclStore,reducedRedundancy=options.objectProperties.reducedRedundancy,region=options.objectProperties.region,serverSideEncryption=options.objectProperties.serverSideEncryption,validation=options.validation,signature=options.signature,successRedirectUrl=options.iframeSupport.localBlankPagePath,credentialsProvider=options.signature.credentialsProvider,getSignatureAjaxRequester=new qq.s3.RequestSigner({signatureSpec:signature,cors:options.cors,log:log});if(void 0===successRedirectUrl)throw new Error("successRedirectEndpoint MUST be defined if you intend to use browsers that do not support the File API!");qq.extend(this,new qq.FormUploadHandler({options:{isCors:!1,inputName:"file"},proxy:{onCancel:options.onCancel,onUuidChanged:onUuidChanged,getName:getName,getUuid:getUuid,log:log}})),qq.extend(this,{uploadFile:function(id){var name=getName(id),promise=new qq.Promise;return handler.getThirdPartyFileId(id)?handler._getFileState(id).bucket?handleUpload(id).then(promise.success,promise.failure):onGetBucket(id).then(function(bucket){handler._getFileState(id).bucket=bucket,handleUpload(id).then(promise.success,promise.failure)}):onGetKeyName(id,name).then(function(key){onGetBucket(id).then(function(bucket){handler._getFileState(id).bucket=bucket,handler._setThirdPartyFileId(id,key),handleUpload(id).then(promise.success,promise.failure)},function(errorReason){promise.failure({error:errorReason})})},function(errorReason){promise.failure({error:errorReason})}),promise}})},qq.DragAndDrop=function(o){"use strict";function uploadDroppedFiles(files,uploadDropZone){var filesAsArray=Array.prototype.slice.call(files);options.callbacks.dropLog("Grabbed "+files.length+" dropped files."),uploadDropZone.dropDisabled(!1),options.callbacks.processingDroppedFilesComplete(filesAsArray,uploadDropZone.getElement())}function traverseFileTree(entry){var parseEntryPromise=new qq.Promise;return entry.isFile?entry.file(function(file){var name=entry.name,fullPath=entry.fullPath,indexOfNameInFullPath=fullPath.indexOf(name);fullPath=fullPath.substr(0,indexOfNameInFullPath),"/"===fullPath.charAt(0)&&(fullPath=fullPath.substr(1)),file.qqPath=fullPath,droppedFiles.push(file),parseEntryPromise.success()},function(fileError){options.callbacks.dropLog("Problem parsing '"+entry.fullPath+"'.  FileError code "+fileError.code+".","error"),parseEntryPromise.failure()}):entry.isDirectory&&getFilesInDirectory(entry).then(function(entries){var entriesLeft=entries.length;qq.each(entries,function(idx,entry){traverseFileTree(entry).done(function(){0===(entriesLeft-=1)&&parseEntryPromise.success()})}),entries.length||parseEntryPromise.success()},function(fileError){options.callbacks.dropLog("Problem parsing '"+entry.fullPath+"'.  FileError code "+fileError.code+".","error"),parseEntryPromise.failure()}),parseEntryPromise}function getFilesInDirectory(entry,reader,accumEntries,existingPromise){var promise=existingPromise||new qq.Promise,dirReader=reader||entry.createReader();return dirReader.readEntries(function(entries){var newEntries=accumEntries?accumEntries.concat(entries):entries;entries.length?setTimeout(function(){getFilesInDirectory(entry,dirReader,newEntries,promise)},0):promise.success(newEntries)},promise.failure),promise}function handleDataTransfer(dataTransfer,uploadDropZone){var pendingFolderPromises=[],handleDataTransferPromise=new qq.Promise;return options.callbacks.processingDroppedFiles(),uploadDropZone.dropDisabled(!0),dataTransfer.files.length>1&&!options.allowMultipleItems?(options.callbacks.processingDroppedFilesComplete([]),options.callbacks.dropError("tooManyFilesError",""),uploadDropZone.dropDisabled(!1),handleDataTransferPromise.failure()):(droppedFiles=[],qq.isFolderDropSupported(dataTransfer)?qq.each(dataTransfer.items,function(idx,item){var entry=item.webkitGetAsEntry();entry&&(entry.isFile?droppedFiles.push(item.getAsFile()):pendingFolderPromises.push(traverseFileTree(entry).done(function(){pendingFolderPromises.pop(),0===pendingFolderPromises.length&&handleDataTransferPromise.success()})))}):droppedFiles=dataTransfer.files,0===pendingFolderPromises.length&&handleDataTransferPromise.success()),handleDataTransferPromise}function setupDropzone(dropArea){var dropZone=new qq.UploadDropZone({HIDE_ZONES_EVENT_NAME:HIDE_ZONES_EVENT_NAME,element:dropArea,onEnter:function(e){qq(dropArea).addClass(options.classes.dropActive),e.stopPropagation()},onLeaveNotDescendants:function(e){qq(dropArea).removeClass(options.classes.dropActive)},onDrop:function(e){handleDataTransfer(e.dataTransfer,dropZone).then(function(){uploadDroppedFiles(droppedFiles,dropZone)},function(){options.callbacks.dropLog("Drop event DataTransfer parsing failed.  No files will be uploaded.","error")})}});return disposeSupport.addDisposer(function(){dropZone.dispose()}),qq(dropArea).hasAttribute(HIDE_BEFORE_ENTER_ATTR)&&qq(dropArea).hide(),uploadDropZones.push(dropZone),dropZone}function isFileDrag(dragEvent){var fileDrag;return qq.each(dragEvent.dataTransfer.types,function(key,val){if("Files"===val)return fileDrag=!0,!1}),fileDrag}function leavingDocumentOut(e){return qq.firefox()?!e.relatedTarget:qq.safari()?e.x<0||e.y<0:0===e.x&&0===e.y}var options,HIDE_ZONES_EVENT_NAME="qq-hidezones",HIDE_BEFORE_ENTER_ATTR="qq-hide-dropzone",uploadDropZones=[],droppedFiles=[],disposeSupport=new qq.DisposeSupport;options={dropZoneElements:[],allowMultipleItems:!0,classes:{dropActive:null},callbacks:new qq.DragAndDrop.callbacks},qq.extend(options,o,!0),function(){var dropZones=options.dropZoneElements,maybeHideDropZones=function(){setTimeout(function(){qq.each(dropZones,function(idx,dropZone){qq(dropZone).hasAttribute(HIDE_BEFORE_ENTER_ATTR)&&qq(dropZone).hide(),qq(dropZone).removeClass(options.classes.dropActive)})},10)};qq.each(dropZones,function(idx,dropZone){var uploadDropZone=setupDropzone(dropZone);dropZones.length&&qq.supportedFeatures.fileDrop&&disposeSupport.attach(document,"dragenter",function(e){!uploadDropZone.dropDisabled()&&isFileDrag(e)&&qq.each(dropZones,function(idx,dropZone){dropZone instanceof HTMLElement&&qq(dropZone).hasAttribute(HIDE_BEFORE_ENTER_ATTR)&&qq(dropZone).css({display:"block"})})})}),disposeSupport.attach(document,"dragleave",function(e){leavingDocumentOut(e)&&maybeHideDropZones()}),disposeSupport.attach(qq(document).children()[0],"mouseenter",function(e){maybeHideDropZones()}),disposeSupport.attach(document,"drop",function(e){e.preventDefault(),maybeHideDropZones()}),disposeSupport.attach(document,HIDE_ZONES_EVENT_NAME,maybeHideDropZones)}(),qq.extend(this,{setupExtraDropzone:function(element){options.dropZoneElements.push(element),setupDropzone(element)},removeDropzone:function(element){var i,dzs=options.dropZoneElements;for(i in dzs)if(dzs[i]===element)return dzs.splice(i,1)},dispose:function(){disposeSupport.dispose(),qq.each(uploadDropZones,function(idx,dropZone){dropZone.dispose()})}})},qq.DragAndDrop.callbacks=function(){"use strict";return{processingDroppedFiles:function(){},processingDroppedFilesComplete:function(files,targetEl){},dropError:function(code,errorSpecifics){qq.log("Drag & drop error code '"+code+" with these specifics: '"+errorSpecifics+"'","error")},dropLog:function(message,level){qq.log(message,level)}}},qq.UploadDropZone=function(o){"use strict";function dragoverShouldBeCanceled(){return qq.safari()||qq.firefox()&&qq.windows()}function isValidFileDrag(e){if(!qq.supportedFeatures.fileDrop)return!1;var effectTest,dt=e.dataTransfer,isSafari=qq.safari();return effectTest=!(!qq.ie()||!qq.supportedFeatures.fileDrop)||"none"!==dt.effectAllowed,dt&&effectTest&&(dt.files||!isSafari&&dt.types.contains&&dt.types.contains("Files"))}function isOrSetDropDisabled(isDisabled){return void 0!==isDisabled&&(preventDrop=isDisabled),preventDrop}function triggerHidezonesEvent(){function triggerUsingOldApi(){hideZonesEvent=document.createEvent("Event"),hideZonesEvent.initEvent(options.HIDE_ZONES_EVENT_NAME,!0,!0)}var hideZonesEvent;if(window.CustomEvent)try{hideZonesEvent=new CustomEvent(options.HIDE_ZONES_EVENT_NAME)}catch(err){triggerUsingOldApi()}else triggerUsingOldApi();document.dispatchEvent(hideZonesEvent)}var options,element,preventDrop,dropOutsideDisabled,disposeSupport=new qq.DisposeSupport;options={element:null,onEnter:function(e){},onLeave:function(e){},onLeaveNotDescendants:function(e){},onDrop:function(e){}},qq.extend(options,o),element=options.element,function(e){dropOutsideDisabled||(dragoverShouldBeCanceled?disposeSupport.attach(document,"dragover",function(e){e.preventDefault()}):disposeSupport.attach(document,"dragover",function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="none",e.preventDefault())}),dropOutsideDisabled=!0)}(),function(){disposeSupport.attach(element,"dragover",function(e){if(isValidFileDrag(e)){var effect=qq.ie()&&qq.supportedFeatures.fileDrop?null:e.dataTransfer.effectAllowed;e.dataTransfer.dropEffect="move"===effect||"linkMove"===effect?"move":"copy",e.stopPropagation(),e.preventDefault()}}),disposeSupport.attach(element,"dragenter",function(e){if(!isOrSetDropDisabled()){if(!isValidFileDrag(e))return;options.onEnter(e)}}),disposeSupport.attach(element,"dragleave",function(e){if(isValidFileDrag(e)){options.onLeave(e);var relatedTarget=document.elementFromPoint(e.clientX,e.clientY);qq(this).contains(relatedTarget)||options.onLeaveNotDescendants(e)}}),disposeSupport.attach(element,"drop",function(e){if(!isOrSetDropDisabled()){if(!isValidFileDrag(e))return;e.preventDefault(),e.stopPropagation(),options.onDrop(e),triggerHidezonesEvent()}})}(),qq.extend(this,{dropDisabled:function(isDisabled){return isOrSetDropDisabled(isDisabled)},dispose:function(){disposeSupport.dispose()},getElement:function(){return element}})},function(){"use strict";qq.uiPublicApi={addInitialFiles:function(cannedFileList){this._parent.prototype.addInitialFiles.apply(this,arguments),this._templating.addCacheToDom()},clearStoredFiles:function(){this._parent.prototype.clearStoredFiles.apply(this,arguments),this._templating.clearFiles()},addExtraDropzone:function(element){this._dnd&&this._dnd.setupExtraDropzone(element)},removeExtraDropzone:function(element){if(this._dnd)return this._dnd.removeDropzone(element)},getItemByFileId:function(id){if(!this._templating.isHiddenForever(id))return this._templating.getFileContainer(id)},reset:function(){this._parent.prototype.reset.apply(this,arguments),this._templating.reset(),!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton(),title:this._options.text.fileInputTitle}).getButtonId()),this._dnd&&(this._dnd.dispose(),this._dnd=this._setupDragAndDrop()),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0,this._setupClickAndEditEventHandlers()},setName:function(id,newName){var formattedFilename=this._options.formatFileName(newName);this._parent.prototype.setName.apply(this,arguments),this._templating.updateFilename(id,formattedFilename)},pauseUpload:function(id){var paused=this._parent.prototype.pauseUpload.apply(this,arguments);return paused&&this._templating.uploadPaused(id),paused},continueUpload:function(id){var continued=this._parent.prototype.continueUpload.apply(this,arguments);return continued&&this._templating.uploadContinued(id),continued},getId:function(fileContainerOrChildEl){return this._templating.getFileId(fileContainerOrChildEl)},getDropTarget:function(fileId){return this.getFile(fileId).qqDropTarget}},qq.uiPrivateApi={_getButton:function(buttonId){var button=this._parent.prototype._getButton.apply(this,arguments);return button||buttonId===this._defaultButtonId&&(button=this._templating.getButton()),button},_removeFileItem:function(fileId){this._templating.removeFile(fileId)},_setupClickAndEditEventHandlers:function(){this._fileButtonsClickHandler=qq.FileButtonsClickHandler&&this._bindFileButtonsClickEvent(),this._focusinEventSupported=!qq.firefox(),this._isEditFilenameEnabled()&&(this._filenameClickHandler=this._bindFilenameClickEvent(),this._filenameInputFocusInHandler=this._bindFilenameInputFocusInEvent(),this._filenameInputFocusHandler=this._bindFilenameInputFocusEvent())},_setupDragAndDrop:function(){var self=this,dropZoneElements=this._options.dragAndDrop.extraDropzones,templating=this._templating,defaultDropZone=templating.getDropZone();return defaultDropZone&&dropZoneElements.push(defaultDropZone),new qq.DragAndDrop({dropZoneElements:dropZoneElements,allowMultipleItems:this._options.multiple,classes:{dropActive:this._options.classes.dropActive},callbacks:{processingDroppedFiles:function(){templating.showDropProcessing()},processingDroppedFilesComplete:function(files,targetEl){templating.hideDropProcessing(),qq.each(files,function(idx,file){file.qqDropTarget=targetEl}),files.length&&self.addFiles(files,null,null)},dropError:function(code,errorData){self._itemError(code,errorData)},dropLog:function(message,level){self.log(message,level)}}})},_bindFileButtonsClickEvent:function(){var self=this;return new qq.FileButtonsClickHandler({templating:this._templating,log:function(message,lvl){self.log(message,lvl)},onDeleteFile:function(fileId){self.deleteFile(fileId)},onCancel:function(fileId){self.cancel(fileId)},onRetry:function(fileId){self.retry(fileId)},onPause:function(fileId){self.pauseUpload(fileId)},onContinue:function(fileId){self.continueUpload(fileId)},onGetName:function(fileId){return self.getName(fileId)}})},_isEditFilenameEnabled:function(){return this._templating.isEditFilenamePossible()&&!this._options.autoUpload&&qq.FilenameClickHandler&&qq.FilenameInputFocusHandler&&qq.FilenameInputFocusHandler},_filenameEditHandler:function(){var self=this,templating=this._templating;return{templating:templating,log:function(message,lvl){self.log(message,lvl)},onGetUploadStatus:function(fileId){return self.getUploads({id:fileId}).status},onGetName:function(fileId){return self.getName(fileId)},onSetName:function(id,newName){self.setName(id,newName)},onEditingStatusChange:function(id,isEditing){var qqInput=qq(templating.getEditInput(id)),qqFileContainer=qq(templating.getFileContainer(id));isEditing?(qqInput.addClass("qq-editing"),templating.hideFilename(id),templating.hideEditIcon(id)):(qqInput.removeClass("qq-editing"),templating.showFilename(id),templating.showEditIcon(id)),qqFileContainer.addClass("qq-temp").removeClass("qq-temp")}}},_onUploadStatusChange:function(id,oldStatus,newStatus){this._parent.prototype._onUploadStatusChange.apply(this,arguments),this._isEditFilenameEnabled()&&this._templating.getFileContainer(id)&&newStatus!==qq.status.SUBMITTED&&(this._templating.markFilenameEditable(id),this._templating.hideEditIcon(id)),oldStatus===qq.status.UPLOAD_RETRYING&&newStatus===qq.status.UPLOADING?(this._templating.hideRetry(id),this._templating.setStatusText(id),qq(this._templating.getFileContainer(id)).removeClass(this._classes.retrying)):newStatus===qq.status.UPLOAD_FAILED&&this._templating.hidePause(id)},_bindFilenameInputFocusInEvent:function(){var spec=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusInHandler(spec)},_bindFilenameInputFocusEvent:function(){var spec=qq.extend({},this._filenameEditHandler());return new qq.FilenameInputFocusHandler(spec)},_bindFilenameClickEvent:function(){var spec=qq.extend({},this._filenameEditHandler());return new qq.FilenameClickHandler(spec)},_storeForLater:function(id){this._parent.prototype._storeForLater.apply(this,arguments),this._templating.hideSpinner(id)},_onAllComplete:function(successful,failed){this._parent.prototype._onAllComplete.apply(this,arguments),this._templating.resetTotalProgress()},_onSubmit:function(id,name){var file=this.getFile(id);file&&file.qqPath&&this._options.dragAndDrop.reportDirectoryPaths&&this._paramsStore.addReadOnly(id,{qqpath:file.qqPath}),this._parent.prototype._onSubmit.apply(this,arguments),this._addToList(id,name)},_onSubmitted:function(id){this._isEditFilenameEnabled()&&(this._templating.markFilenameEditable(id),this._templating.showEditIcon(id),this._focusinEventSupported||this._filenameInputFocusHandler.addHandler(this._templating.getEditInput(id)))},_onProgress:function(id,name,loaded,total){this._parent.prototype._onProgress.apply(this,arguments),this._templating.updateProgress(id,loaded,total),0===total||100===Math.round(loaded/total*100)?(this._templating.hideCancel(id),this._templating.hidePause(id),this._templating.hideProgress(id),this._templating.setStatusText(id,this._options.text.waitingForResponse),this._displayFileSize(id)):this._displayFileSize(id,loaded,total)},_onTotalProgress:function(loaded,total){this._parent.prototype._onTotalProgress.apply(this,arguments),this._templating.updateTotalProgress(loaded,total)},_onComplete:function(id,name,result,xhr){function completeUpload(result){fileContainer&&(templating.setStatusText(id),qq(fileContainer).removeClass(self._classes.retrying),templating.hideProgress(id),self.getUploads({id:id}).status!==qq.status.UPLOAD_FAILED&&templating.hideCancel(id),templating.hideSpinner(id),result.success?self._markFileAsSuccessful(id):(qq(fileContainer).addClass(self._classes.fail),templating.showCancel(id),templating.isRetryPossible()&&!self._preventRetries[id]&&(qq(fileContainer).addClass(self._classes.retryable),templating.showRetry(id)),self._controlFailureTextDisplay(id,result)))}var parentRetVal=this._parent.prototype._onComplete.apply(this,arguments),templating=this._templating,fileContainer=templating.getFileContainer(id),self=this;return parentRetVal instanceof qq.Promise?parentRetVal.done(function(newResult){completeUpload(newResult)}):completeUpload(result),parentRetVal},_markFileAsSuccessful:function(id){var templating=this._templating;this._isDeletePossible()&&templating.showDeleteButton(id),qq(templating.getFileContainer(id)).addClass(this._classes.success),this._maybeUpdateThumbnail(id)},_onUploadPrep:function(id){this._parent.prototype._onUploadPrep.apply(this,arguments),this._templating.showSpinner(id)},_onUpload:function(id,name){var parentRetVal=this._parent.prototype._onUpload.apply(this,arguments);return this._templating.showSpinner(id),parentRetVal},_onUploadChunk:function(id,chunkData){this._parent.prototype._onUploadChunk.apply(this,arguments),chunkData.partIndex>0&&this._handler.isResumable(id)&&this._templating.allowPause(id)},_onCancel:function(id,name){this._parent.prototype._onCancel.apply(this,arguments),this._removeFileItem(id),0===this._getNotFinished()&&this._templating.resetTotalProgress()},_onBeforeAutoRetry:function(id){var retryNumForDisplay,maxAuto,retryNote;this._parent.prototype._onBeforeAutoRetry.apply(this,arguments),this._showCancelLink(id),this._options.retry.showAutoRetryNote&&(retryNumForDisplay=this._autoRetries[id],maxAuto=this._options.retry.maxAutoAttempts,retryNote=this._options.retry.autoRetryNote.replace(/\{retryNum\}/g,retryNumForDisplay),retryNote=retryNote.replace(/\{maxAuto\}/g,maxAuto),this._templating.setStatusText(id,retryNote),qq(this._templating.getFileContainer(id)).addClass(this._classes.retrying))},_onBeforeManualRetry:function(id){return this._parent.prototype._onBeforeManualRetry.apply(this,arguments)?(this._templating.resetProgress(id),qq(this._templating.getFileContainer(id)).removeClass(this._classes.fail),this._templating.setStatusText(id),this._templating.showSpinner(id),this._showCancelLink(id),!0):(qq(this._templating.getFileContainer(id)).addClass(this._classes.retryable),this._templating.showRetry(id),!1)},_onSubmitDelete:function(id){var onSuccessCallback=qq.bind(this._onSubmitDeleteSuccess,this);this._parent.prototype._onSubmitDelete.call(this,id,onSuccessCallback)},_onSubmitDeleteSuccess:function(id,uuid,additionalMandatedParams){this._options.deleteFile.forceConfirm?this._showDeleteConfirm.apply(this,arguments):this._sendDeleteRequest.apply(this,arguments)},_onDeleteComplete:function(id,xhr,isError){this._parent.prototype._onDeleteComplete.apply(this,arguments),this._templating.hideSpinner(id),isError?(this._templating.setStatusText(id,this._options.deleteFile.deletingFailedText),this._templating.showDeleteButton(id)):this._removeFileItem(id)},_sendDeleteRequest:function(id,uuid,additionalMandatedParams){this._templating.hideDeleteButton(id),this._templating.showSpinner(id),this._templating.setStatusText(id,this._options.deleteFile.deletingStatusText),this._deleteHandler.sendDelete.apply(this,arguments)},_showDeleteConfirm:function(id,uuid,mandatedParams){var retVal,fileName=this.getName(id),confirmMessage=this._options.deleteFile.confirmMessage.replace(/\{filename\}/g,fileName),deleteRequestArgs=(this.getUuid(id),arguments),self=this;retVal=this._options.showConfirm(confirmMessage),qq.isGenericPromise(retVal)?retVal.then(function(){self._sendDeleteRequest.apply(self,deleteRequestArgs)}):!1!==retVal&&self._sendDeleteRequest.apply(self,deleteRequestArgs)},_addToList:function(id,name,canned){var prependData,record,prependIndex=0,dontDisplay=this._handler.isProxied(id)&&this._options.scaling.hideScaled;this._options.display.prependFiles&&(this._totalFilesInBatch>1&&this._filesInBatchAddedToUi>0&&(prependIndex=this._filesInBatchAddedToUi-1),prependData={index:prependIndex}),canned||(this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading&&this._templating.disableCancel(),this._options.multiple||(record=this.getUploads({id:id}),this._handledProxyGroup=this._handledProxyGroup||record.proxyGroupId,record.proxyGroupId===this._handledProxyGroup&&record.proxyGroupId||(this._handler.cancelAll(),this._clearList(),this._handledProxyGroup=null))),canned?(this._templating.addFileToCache(id,this._options.formatFileName(name),prependData,dontDisplay),this._templating.updateThumbnail(id,this._thumbnailUrls[id],!0,this._options.thumbnails.customResizer)):(this._templating.addFile(id,this._options.formatFileName(name),prependData,dontDisplay),this._templating.generatePreview(id,this.getFile(id),this._options.thumbnails.customResizer)),this._filesInBatchAddedToUi+=1,(canned||this._options.display.fileSizeOnSubmit&&qq.supportedFeatures.ajaxUploading)&&this._displayFileSize(id)},_clearList:function(){this._templating.clearFiles(),this.clearStoredFiles()},_displayFileSize:function(id,loadedSize,totalSize){var size=this.getSize(id),sizeForDisplay=this._formatSize(size);size>=0&&(void 0!==loadedSize&&void 0!==totalSize&&(sizeForDisplay=this._formatProgress(loadedSize,totalSize)),this._templating.updateSize(id,sizeForDisplay))},_formatProgress:function(uploadedSize,totalSize){function r(name,replacement){message=message.replace(name,replacement)}var message=this._options.text.formatProgress;return r("{percent}",Math.round(uploadedSize/totalSize*100)),r("{total_size}",this._formatSize(totalSize)),message},_controlFailureTextDisplay:function(id,response){var mode,responseProperty,failureReason;mode=this._options.failedUploadTextDisplay.mode,responseProperty=this._options.failedUploadTextDisplay.responseProperty,"custom"===mode?(failureReason=response[responseProperty],failureReason||(failureReason=this._options.text.failUpload),this._templating.setStatusText(id,failureReason),this._options.failedUploadTextDisplay.enableTooltip&&this._showTooltip(id,failureReason)):"default"===mode?this._templating.setStatusText(id,this._options.text.failUpload):"none"!==mode&&this.log("failedUploadTextDisplay.mode value of '"+mode+"' is not valid","warn")},_showTooltip:function(id,text){this._templating.getFileContainer(id).title=text},_showCancelLink:function(id){this._options.disableCancelForFormUploads&&!qq.supportedFeatures.ajaxUploading||this._templating.showCancel(id)},_itemError:function(code,name,item){var message=this._parent.prototype._itemError.apply(this,arguments);this._options.showMessage(message)},_batchError:function(message){this._parent.prototype._batchError.apply(this,arguments),this._options.showMessage(message)},_setupPastePrompt:function(){var self=this;this._options.callbacks.onPasteReceived=function(){var message=self._options.paste.namePromptMessage,defaultVal=self._options.paste.defaultName;return self._options.showPrompt(message,defaultVal)}},_fileOrBlobRejected:function(id,name){this._totalFilesInBatch-=1,this._parent.prototype._fileOrBlobRejected.apply(this,arguments)},_prepareItemsForUpload:function(items,params,endpoint){this._totalFilesInBatch=items.length,this._filesInBatchAddedToUi=0,this._parent.prototype._prepareItemsForUpload.apply(this,arguments)},_maybeUpdateThumbnail:function(fileId){var thumbnailUrl=this._thumbnailUrls[fileId];this.getUploads({id:fileId}).status===qq.status.DELETED||!thumbnailUrl&&!this._options.thumbnails.placeholders.waitUntilResponse&&qq.supportedFeatures.imagePreviews||this._templating.updateThumbnail(fileId,thumbnailUrl,this._options.thumbnails.customResizer)},_addCannedFile:function(sessionData){var id=this._parent.prototype._addCannedFile.apply(this,arguments);return this._addToList(id,this.getName(id),!0),this._templating.hideSpinner(id),this._templating.hideCancel(id),this._markFileAsSuccessful(id),id},_setSize:function(id,newSize){this._parent.prototype._setSize.apply(this,arguments),this._templating.updateSize(id,this._formatSize(newSize))},_sessionRequestComplete:function(){this._templating.addCacheToDom(),this._parent.prototype._sessionRequestComplete.apply(this,arguments)}}}(),qq.FineUploader=function(o,namespace){"use strict";var self=this;this._parent=namespace?qq[namespace].FineUploaderBasic:qq.FineUploaderBasic,this._parent.apply(this,arguments),qq.extend(this._options,{element:null,button:null,listElement:null,dragAndDrop:{extraDropzones:[],reportDirectoryPaths:!1},text:{formatProgress:"{percent}% of {total_size}",failUpload:"Upload failed",waitingForResponse:"Processing...",paused:"Paused"},template:"qq-template",classes:{retrying:"qq-upload-retrying",retryable:"qq-upload-retryable",success:"qq-upload-success",fail:"qq-upload-fail",editable:"qq-editable",hide:"qq-hide",dropActive:"qq-upload-drop-area-active"},failedUploadTextDisplay:{mode:"default",responseProperty:"error",enableTooltip:!0},messages:{tooManyFilesError:"You may only drop one file",unsupportedBrowser:"Unrecoverable error - this browser does not permit file uploading of any kind."},retry:{showAutoRetryNote:!0,autoRetryNote:"Retrying {retryNum}/{maxAuto}..."},deleteFile:{forceConfirm:!1,confirmMessage:"Are you sure you want to delete {filename}?",deletingStatusText:"Deleting...",
deletingFailedText:"Delete failed"},display:{fileSizeOnSubmit:!1,prependFiles:!1},paste:{promptForName:!1,namePromptMessage:"Please name this image"},thumbnails:{customResizer:null,maxCount:0,placeholders:{waitUntilResponse:!1,notAvailablePath:null,waitingPath:null},timeBetweenThumbs:750},scaling:{hideScaled:!1},showMessage:function(message){if(self._templating.hasDialog("alert"))return self._templating.showDialog("alert",message);setTimeout(function(){window.alert(message)},0)},showConfirm:function(message){return self._templating.hasDialog("confirm")?self._templating.showDialog("confirm",message):window.confirm(message)},showPrompt:function(message,defaultValue){return self._templating.hasDialog("prompt")?self._templating.showDialog("prompt",message,defaultValue):window.prompt(message,defaultValue)}},!0),qq.extend(this._options,o,!0),this._templating=new qq.Templating({log:qq.bind(this.log,this),templateIdOrEl:this._options.template,containerEl:this._options.element,fileContainerEl:this._options.listElement,button:this._options.button,imageGenerator:this._imageGenerator,classes:{hide:this._options.classes.hide,editable:this._options.classes.editable},limits:{maxThumbs:this._options.thumbnails.maxCount,timeBetweenThumbs:this._options.thumbnails.timeBetweenThumbs},placeholders:{waitUntilUpdate:this._options.thumbnails.placeholders.waitUntilResponse,thumbnailNotAvailable:this._options.thumbnails.placeholders.notAvailablePath,waitingForThumbnail:this._options.thumbnails.placeholders.waitingPath},text:this._options.text}),this._options.workarounds.ios8SafariUploads&&qq.ios800()&&qq.iosSafari()?this._templating.renderFailure(this._options.messages.unsupportedBrowserIos8Safari):!qq.supportedFeatures.uploading||this._options.cors.expected&&!qq.supportedFeatures.uploadCors?this._templating.renderFailure(this._options.messages.unsupportedBrowser):(this._wrapCallbacks(),this._templating.render(),this._classes=this._options.classes,!this._options.button&&this._templating.getButton()&&(this._defaultButtonId=this._createUploadButton({element:this._templating.getButton(),title:this._options.text.fileInputTitle}).getButtonId()),this._setupClickAndEditEventHandlers(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop&&(this._dnd=this._setupDragAndDrop()),this._options.paste.targetElement&&this._options.paste.promptForName&&(qq.PasteSupport?this._setupPastePrompt():this.log("Paste support module not found.","error")),this._totalFilesInBatch=0,this._filesInBatchAddedToUi=0)},qq.extend(qq.FineUploader.prototype,qq.basePublicApi),qq.extend(qq.FineUploader.prototype,qq.basePrivateApi),qq.extend(qq.FineUploader.prototype,qq.uiPublicApi),qq.extend(qq.FineUploader.prototype,qq.uiPrivateApi),qq.Templating=function(spec){"use strict";var log,isEditElementsExist,isRetryElementExist,templateHtml,container,fileList,showThumbnails,serverScale,fileBatch={content:document.createDocumentFragment(),map:{}},isCancelDisabled=!1,generatedThumbnails=0,thumbnailQueueMonitorRunning=!1,thumbGenerationQueue=[],thumbnailMaxSize=-1,options={log:null,limits:{maxThumbs:0,timeBetweenThumbs:750},templateIdOrEl:"qq-template",containerEl:null,fileContainerEl:null,button:null,imageGenerator:null,classes:{hide:"qq-hide",editable:"qq-editable"},placeholders:{waitUntilUpdate:!1,thumbnailNotAvailable:null,waitingForThumbnail:null},text:{paused:"Paused"}},selectorClasses={button:"qq-upload-button-selector",alertDialog:"qq-alert-dialog-selector",dialogCancelButton:"qq-cancel-button-selector",confirmDialog:"qq-confirm-dialog-selector",dialogMessage:"qq-dialog-message-selector",dialogOkButton:"qq-ok-button-selector",promptDialog:"qq-prompt-dialog-selector",uploader:"qq-uploader-selector",drop:"qq-upload-drop-area-selector",list:"qq-upload-list-selector",progressBarContainer:"qq-progress-bar-container-selector",progressBar:"qq-progress-bar-selector",totalProgressBarContainer:"qq-total-progress-bar-container-selector",totalProgressBar:"qq-total-progress-bar-selector",file:"qq-upload-file-selector",spinner:"qq-upload-spinner-selector",size:"qq-upload-size-selector",cancel:"qq-upload-cancel-selector",pause:"qq-upload-pause-selector",continueButton:"qq-upload-continue-selector",deleteButton:"qq-upload-delete-selector",retry:"qq-upload-retry-selector",statusText:"qq-upload-status-text-selector",editFilenameInput:"qq-edit-filename-selector",editNameIcon:"qq-edit-filename-icon-selector",dropText:"qq-upload-drop-area-text-selector",dropProcessing:"qq-drop-processing-selector",dropProcessingSpinner:"qq-drop-processing-spinner-selector",thumbnail:"qq-thumbnail-selector"},previewGeneration={},cachedThumbnailNotAvailableImg=new qq.Promise,cachedWaitingForThumbnailImg=new qq.Promise,displayWaitingImg=function(thumbnail){var waitingImgPlacement=new qq.Promise;return cachedWaitingForThumbnailImg.then(function(img){maybeScalePlaceholderViaCss(img,thumbnail),thumbnail.src?waitingImgPlacement.success():(thumbnail.src=img.src,thumbnail.onload=function(){thumbnail.onload=null,show(thumbnail),waitingImgPlacement.success()})},function(){hide(thumbnail),waitingImgPlacement.success()}),waitingImgPlacement},generateNewPreview=function(id,blob,spec){var thumbnail=getThumbnail(id);return log("Generating new thumbnail for "+id),blob.qqThumbnailId=id,options.imageGenerator.generate(blob,thumbnail,spec).then(function(){generatedThumbnails++,show(thumbnail),previewGeneration[id].success()},function(){previewGeneration[id].failure(),options.placeholders.waitUntilUpdate||maybeSetDisplayNotAvailableImg(id,thumbnail)})},generateNextQueuedPreview=function(){if(thumbGenerationQueue.length){thumbnailQueueMonitorRunning=!0;var queuedThumbRequest=thumbGenerationQueue.shift();queuedThumbRequest.update?processUpdateQueuedPreviewRequest(queuedThumbRequest):processNewQueuedPreviewRequest(queuedThumbRequest)}else thumbnailQueueMonitorRunning=!1},getCancel=function(id){return getTemplateEl(getFile(id),selectorClasses.cancel)},getContinue=function(id){return getTemplateEl(getFile(id),selectorClasses.continueButton)},getDialog=function(type){return getTemplateEl(container,selectorClasses[type+"Dialog"])},getDelete=function(id){return getTemplateEl(getFile(id),selectorClasses.deleteButton)},getDropProcessing=function(){return getTemplateEl(container,selectorClasses.dropProcessing)},getEditIcon=function(id){return getTemplateEl(getFile(id),selectorClasses.editNameIcon)},getFile=function(id){return fileBatch.map[id]||qq(fileList).getFirstByClass("qq-file-id-"+id)},getFilename=function(id){return getTemplateEl(getFile(id),selectorClasses.file)},getPause=function(id){return getTemplateEl(getFile(id),selectorClasses.pause)},getProgress=function(id){return null==id?getTemplateEl(container,selectorClasses.totalProgressBarContainer)||getTemplateEl(container,selectorClasses.totalProgressBar):getTemplateEl(getFile(id),selectorClasses.progressBarContainer)||getTemplateEl(getFile(id),selectorClasses.progressBar)},getRetry=function(id){return getTemplateEl(getFile(id),selectorClasses.retry)},getSize=function(id){return getTemplateEl(getFile(id),selectorClasses.size)},getSpinner=function(id){return getTemplateEl(getFile(id),selectorClasses.spinner)},getTemplateEl=function(context,cssClass){return context&&qq(context).getFirstByClass(cssClass)},getThumbnail=function(id){return showThumbnails&&getTemplateEl(getFile(id),selectorClasses.thumbnail)},hide=function(el){el&&qq(el).addClass(options.classes.hide)},maybeScalePlaceholderViaCss=function(placeholder,thumbnail){var maxWidth=placeholder.style.maxWidth,maxHeight=placeholder.style.maxHeight;maxHeight&&maxWidth&&!thumbnail.style.maxWidth&&!thumbnail.style.maxHeight&&qq(thumbnail).css({maxWidth:maxWidth,maxHeight:maxHeight})},maybeSetDisplayNotAvailableImg=function(id,thumbnail){var previewing=previewGeneration[id]||(new qq.Promise).failure(),notAvailableImgPlacement=new qq.Promise;return cachedThumbnailNotAvailableImg.then(function(img){previewing.then(function(){notAvailableImgPlacement.success()},function(){maybeScalePlaceholderViaCss(img,thumbnail),thumbnail.onload=function(){thumbnail.onload=null,notAvailableImgPlacement.success()},thumbnail.src=img.src,show(thumbnail)})}),notAvailableImgPlacement},prependFile=function(el,index,fileList){var parentEl=fileList,beforeEl=parentEl.firstChild;index>0&&(beforeEl=qq(parentEl).children()[index].nextSibling),parentEl.insertBefore(el,beforeEl)},processNewQueuedPreviewRequest=function(queuedThumbRequest){var id=queuedThumbRequest.id,optFileOrBlob=queuedThumbRequest.optFileOrBlob,relatedThumbnailId=optFileOrBlob&&optFileOrBlob.qqThumbnailId,thumbnail=getThumbnail(id),spec={customResizeFunction:queuedThumbRequest.customResizeFunction,maxSize:thumbnailMaxSize,orient:!0,scale:!0};qq.supportedFeatures.imagePreviews?thumbnail?options.limits.maxThumbs&&options.limits.maxThumbs<=generatedThumbnails?(maybeSetDisplayNotAvailableImg(id,thumbnail),generateNextQueuedPreview()):displayWaitingImg(thumbnail).done(function(){previewGeneration[id]=new qq.Promise,previewGeneration[id].done(function(){setTimeout(generateNextQueuedPreview,options.limits.timeBetweenThumbs)}),null!=relatedThumbnailId?useCachedPreview(id,relatedThumbnailId):generateNewPreview(id,optFileOrBlob,spec)}):generateNextQueuedPreview():thumbnail&&(displayWaitingImg(thumbnail),generateNextQueuedPreview())},processUpdateQueuedPreviewRequest=function(queuedThumbRequest){var id=queuedThumbRequest.id,thumbnailUrl=queuedThumbRequest.thumbnailUrl,showWaitingImg=queuedThumbRequest.showWaitingImg,thumbnail=getThumbnail(id),spec={customResizeFunction:queuedThumbRequest.customResizeFunction,scale:serverScale,maxSize:thumbnailMaxSize};if(thumbnail)if(thumbnailUrl){if(!(options.limits.maxThumbs&&options.limits.maxThumbs<=generatedThumbnails))return showWaitingImg&&displayWaitingImg(thumbnail),options.imageGenerator.generate(thumbnailUrl,thumbnail,spec).then(function(){show(thumbnail),generatedThumbnails++,setTimeout(generateNextQueuedPreview,options.limits.timeBetweenThumbs)},function(){maybeSetDisplayNotAvailableImg(id,thumbnail),setTimeout(generateNextQueuedPreview,options.limits.timeBetweenThumbs)});maybeSetDisplayNotAvailableImg(id,thumbnail),generateNextQueuedPreview()}else maybeSetDisplayNotAvailableImg(id,thumbnail),generateNextQueuedPreview()},setProgressBarWidth=function(id,percent){var bar=getProgress(id),progressBarSelector=null==id?selectorClasses.totalProgressBar:selectorClasses.progressBar;bar&&!qq(bar).hasClass(progressBarSelector)&&(bar=qq(bar).getFirstByClass(progressBarSelector)),bar&&(qq(bar).css({width:percent+"%"}),bar.setAttribute("aria-valuenow",percent))},show=function(el){el&&qq(el).removeClass(options.classes.hide)},useCachedPreview=function(targetThumbnailId,cachedThumbnailId){var targetThumbnail=getThumbnail(targetThumbnailId),cachedThumbnail=getThumbnail(cachedThumbnailId);log(qq.format("ID {} is the same file as ID {}.  Will use generated thumbnail from ID {} instead.",targetThumbnailId,cachedThumbnailId,cachedThumbnailId)),previewGeneration[cachedThumbnailId].then(function(){generatedThumbnails++,previewGeneration[targetThumbnailId].success(),log(qq.format("Now using previously generated thumbnail created for ID {} on ID {}.",cachedThumbnailId,targetThumbnailId)),targetThumbnail.src=cachedThumbnail.src,show(targetThumbnail)},function(){previewGeneration[targetThumbnailId].failure(),options.placeholders.waitUntilUpdate||maybeSetDisplayNotAvailableImg(targetThumbnailId,targetThumbnail)})};qq.extend(options,spec),log=options.log,qq.supportedFeatures.imagePreviews||(options.limits.timeBetweenThumbs=0,options.limits.maxThumbs=0),container=options.containerEl,showThumbnails=void 0!==options.imageGenerator,templateHtml=function(){var scriptEl,scriptHtml,fileListNode,tempTemplateEl,fileListHtml,defaultButton,dropArea,thumbnail,dropProcessing,dropTextEl,uploaderEl;if(log("Parsing template"),null==options.templateIdOrEl)throw new Error("You MUST specify either a template element or ID!");if(qq.isString(options.templateIdOrEl)){if(null===(scriptEl=document.getElementById(options.templateIdOrEl)))throw new Error(qq.format("Cannot find template script at ID '{}'!",options.templateIdOrEl));scriptHtml=scriptEl.innerHTML}else{if(void 0===options.templateIdOrEl.innerHTML)throw new Error("You have specified an invalid value for the template option!  It must be an ID or an Element.");scriptHtml=options.templateIdOrEl.innerHTML}if(scriptHtml=qq.trimStr(scriptHtml),tempTemplateEl=document.createElement("div"),tempTemplateEl.appendChild(qq.toElement(scriptHtml)),uploaderEl=qq(tempTemplateEl).getFirstByClass(selectorClasses.uploader),options.button&&(defaultButton=qq(tempTemplateEl).getFirstByClass(selectorClasses.button))&&qq(defaultButton).remove(),qq.DragAndDrop&&qq.supportedFeatures.fileDrop||(dropProcessing=qq(tempTemplateEl).getFirstByClass(selectorClasses.dropProcessing))&&qq(dropProcessing).remove(),dropArea=qq(tempTemplateEl).getFirstByClass(selectorClasses.drop),dropArea&&!qq.DragAndDrop&&(log("DnD module unavailable.","info"),qq(dropArea).remove()),qq.supportedFeatures.fileDrop?qq(uploaderEl).hasAttribute("qq-drop-area-text")&&dropArea&&(dropTextEl=qq(dropArea).getFirstByClass(selectorClasses.dropText))&&qq(dropTextEl).remove():(uploaderEl.removeAttribute("qq-drop-area-text"),dropArea&&qq(dropArea).hasAttribute("qq-hide-dropzone")&&qq(dropArea).css({display:"none"})),thumbnail=qq(tempTemplateEl).getFirstByClass(selectorClasses.thumbnail),showThumbnails?thumbnail&&(thumbnailMaxSize=parseInt(thumbnail.getAttribute("qq-max-size")),thumbnailMaxSize=thumbnailMaxSize>0?thumbnailMaxSize:null,serverScale=qq(thumbnail).hasAttribute("qq-server-scale")):thumbnail&&qq(thumbnail).remove(),showThumbnails=showThumbnails&&thumbnail,isEditElementsExist=qq(tempTemplateEl).getByClass(selectorClasses.editFilenameInput).length>0,isRetryElementExist=qq(tempTemplateEl).getByClass(selectorClasses.retry).length>0,null==(fileListNode=qq(tempTemplateEl).getFirstByClass(selectorClasses.list)))throw new Error("Could not find the file list container in the template!");return fileListHtml=fileListNode.innerHTML,fileListNode.innerHTML="",tempTemplateEl.getElementsByTagName("DIALOG").length&&document.createElement("dialog"),log("Template parsing complete"),{template:qq.trimStr(tempTemplateEl.innerHTML),fileTemplate:qq.trimStr(fileListHtml)}}(),function(){var notAvailableUrl=options.placeholders.thumbnailNotAvailable,waitingUrl=options.placeholders.waitingForThumbnail,spec={maxSize:thumbnailMaxSize,scale:serverScale};showThumbnails&&(notAvailableUrl?options.imageGenerator.generate(notAvailableUrl,new Image,spec).then(function(updatedImg){cachedThumbnailNotAvailableImg.success(updatedImg)},function(){cachedThumbnailNotAvailableImg.failure(),log("Problem loading 'not available' placeholder image at "+notAvailableUrl,"error")}):cachedThumbnailNotAvailableImg.failure(),waitingUrl?options.imageGenerator.generate(waitingUrl,new Image,spec).then(function(updatedImg){cachedWaitingForThumbnailImg.success(updatedImg)},function(){cachedWaitingForThumbnailImg.failure(),log("Problem loading 'waiting for thumbnail' placeholder image at "+waitingUrl,"error")}):cachedWaitingForThumbnailImg.failure())}(),qq.extend(this,{render:function(){log("Rendering template in DOM."),generatedThumbnails=0,container.innerHTML=templateHtml.template,hide(getDropProcessing()),this.hideTotalProgress(),fileList=options.fileContainerEl||getTemplateEl(container,selectorClasses.list),log("Template rendering complete")},renderFailure:function(message){var cantRenderEl=qq.toElement(message);container.innerHTML="",container.appendChild(cantRenderEl)},reset:function(){this.render()},clearFiles:function(){fileList.innerHTML=""},disableCancel:function(){isCancelDisabled=!0},addFile:function(id,name,prependInfo,hideForever,batch){var thumb,fileEl=qq.toElement(templateHtml.fileTemplate),fileNameEl=getTemplateEl(fileEl,selectorClasses.file),uploaderEl=getTemplateEl(container,selectorClasses.uploader),fileContainer=batch?fileBatch.content:fileList;batch&&(fileBatch.map[id]=fileEl),qq(fileEl).addClass("qq-file-id-"+id),uploaderEl.removeAttribute("qq-drop-area-text"),fileNameEl&&(qq(fileNameEl).setText(name),fileNameEl.setAttribute("title",name)),fileEl.setAttribute("qq-file-id",id),prependInfo?prependFile(fileEl,prependInfo.index,fileContainer):fileContainer.appendChild(fileEl),hideForever?(fileEl.style.display="none",qq(fileEl).addClass("qq-hidden-forever")):(hide(getProgress(id)),hide(getSize(id)),hide(getDelete(id)),hide(getRetry(id)),hide(getPause(id)),hide(getContinue(id)),isCancelDisabled&&this.hideCancel(id),(thumb=getThumbnail(id))&&!thumb.src&&cachedWaitingForThumbnailImg.then(function(waitingImg){thumb.src=waitingImg.src,waitingImg.style.maxHeight&&waitingImg.style.maxWidth&&qq(thumb).css({maxHeight:waitingImg.style.maxHeight,maxWidth:waitingImg.style.maxWidth}),show(thumb)}))},addFileToCache:function(id,name,prependInfo,hideForever){this.addFile(id,name,prependInfo,hideForever,!0)},addCacheToDom:function(){fileList.appendChild(fileBatch.content),fileBatch.content=document.createDocumentFragment(),fileBatch.map={}},removeFile:function(id){qq(getFile(id)).remove()},getFileId:function(el){var currentNode=el;if(currentNode){for(;null==currentNode.getAttribute("qq-file-id");)currentNode=currentNode.parentNode;return parseInt(currentNode.getAttribute("qq-file-id"))}},getFileList:function(){return fileList},markFilenameEditable:function(id){var filename=getFilename(id);filename&&qq(filename).addClass(options.classes.editable)},updateFilename:function(id,name){var filenameEl=getFilename(id);filenameEl&&(qq(filenameEl).setText(name),filenameEl.setAttribute("title",name))},hideFilename:function(id){hide(getFilename(id))},showFilename:function(id){show(getFilename(id))},isFileName:function(el){return qq(el).hasClass(selectorClasses.file)},getButton:function(){return options.button||getTemplateEl(container,selectorClasses.button)},hideDropProcessing:function(){hide(getDropProcessing())},showDropProcessing:function(){show(getDropProcessing())},getDropZone:function(){return getTemplateEl(container,selectorClasses.drop)},isEditFilenamePossible:function(){return isEditElementsExist},hideRetry:function(id){hide(getRetry(id))},isRetryPossible:function(){return isRetryElementExist},showRetry:function(id){show(getRetry(id))},getFileContainer:function(id){return getFile(id)},showEditIcon:function(id){var icon=getEditIcon(id);icon&&qq(icon).addClass(options.classes.editable)},isHiddenForever:function(id){return qq(getFile(id)).hasClass("qq-hidden-forever")},hideEditIcon:function(id){var icon=getEditIcon(id);icon&&qq(icon).removeClass(options.classes.editable)},isEditIcon:function(el){return qq(el).hasClass(selectorClasses.editNameIcon,!0)},getEditInput:function(id){return getTemplateEl(getFile(id),selectorClasses.editFilenameInput)},isEditInput:function(el){return qq(el).hasClass(selectorClasses.editFilenameInput,!0)},updateProgress:function(id,loaded,total){var percent,bar=getProgress(id);bar&&total>0&&(percent=Math.round(loaded/total*100),100===percent?hide(bar):show(bar),setProgressBarWidth(id,percent))},updateTotalProgress:function(loaded,total){this.updateProgress(null,loaded,total)},hideProgress:function(id){var bar=getProgress(id);bar&&hide(bar)},hideTotalProgress:function(){this.hideProgress()},resetProgress:function(id){setProgressBarWidth(id,0),this.hideTotalProgress(id)},resetTotalProgress:function(){this.resetProgress()},showCancel:function(id){if(!isCancelDisabled){var cancel=getCancel(id);cancel&&qq(cancel).removeClass(options.classes.hide)}},hideCancel:function(id){hide(getCancel(id))},isCancel:function(el){return qq(el).hasClass(selectorClasses.cancel,!0)},allowPause:function(id){show(getPause(id)),hide(getContinue(id))},uploadPaused:function(id){this.setStatusText(id,options.text.paused),this.allowContinueButton(id),hide(getSpinner(id))},hidePause:function(id){hide(getPause(id))},isPause:function(el){return qq(el).hasClass(selectorClasses.pause,!0)},isContinueButton:function(el){return qq(el).hasClass(selectorClasses.continueButton,!0)},allowContinueButton:function(id){show(getContinue(id)),hide(getPause(id))},uploadContinued:function(id){this.setStatusText(id,""),this.allowPause(id),show(getSpinner(id))},showDeleteButton:function(id){show(getDelete(id))},hideDeleteButton:function(id){hide(getDelete(id))},isDeleteButton:function(el){return qq(el).hasClass(selectorClasses.deleteButton,!0)},isRetry:function(el){return qq(el).hasClass(selectorClasses.retry,!0)},updateSize:function(id,text){var size=getSize(id);size&&(show(size),qq(size).setText(text))},setStatusText:function(id,text){var textEl=getTemplateEl(getFile(id),selectorClasses.statusText);textEl&&(null==text?qq(textEl).clearText():qq(textEl).setText(text))},hideSpinner:function(id){qq(getFile(id)).removeClass("qq-in-progress"),hide(getSpinner(id))},showSpinner:function(id){qq(getFile(id)).addClass("qq-in-progress"),show(getSpinner(id))},generatePreview:function(id,optFileOrBlob,customResizeFunction){this.isHiddenForever(id)||(thumbGenerationQueue.push({id:id,customResizeFunction:customResizeFunction,optFileOrBlob:optFileOrBlob}),!thumbnailQueueMonitorRunning&&generateNextQueuedPreview())},updateThumbnail:function(id,thumbnailUrl,showWaitingImg,customResizeFunction){this.isHiddenForever(id)||(thumbGenerationQueue.push({customResizeFunction:customResizeFunction,update:!0,id:id,thumbnailUrl:thumbnailUrl,showWaitingImg:showWaitingImg}),!thumbnailQueueMonitorRunning&&generateNextQueuedPreview())},hasDialog:function(type){return qq.supportedFeatures.dialogElement&&!!getDialog(type)},showDialog:function(type,message,defaultValue){var dialog=getDialog(type),messageEl=getTemplateEl(dialog,selectorClasses.dialogMessage),inputEl=dialog.getElementsByTagName("INPUT")[0],cancelBtn=getTemplateEl(dialog,selectorClasses.dialogCancelButton),okBtn=getTemplateEl(dialog,selectorClasses.dialogOkButton),promise=new qq.Promise,closeHandler=function(){cancelBtn.removeEventListener("click",cancelClickHandler),okBtn&&okBtn.removeEventListener("click",okClickHandler),promise.failure()},cancelClickHandler=function(){cancelBtn.removeEventListener("click",cancelClickHandler),dialog.close()},okClickHandler=function(){dialog.removeEventListener("close",closeHandler),okBtn.removeEventListener("click",okClickHandler),dialog.close(),promise.success(inputEl&&inputEl.value)};return dialog.addEventListener("close",closeHandler),cancelBtn.addEventListener("click",cancelClickHandler),okBtn&&okBtn.addEventListener("click",okClickHandler),inputEl&&(inputEl.value=defaultValue),messageEl.textContent=message,dialog.showModal(),promise}})},qq.UiEventHandler=function(s,protectedApi){"use strict";function addHandler(element){disposer.attach(element,spec.eventType,function(event){event=event||window.event;var target=event.target||event.srcElement;spec.onHandled(target,event)})}var disposer=new qq.DisposeSupport,spec={eventType:"click",attachTo:null,onHandled:function(target,event){}};qq.extend(this,{addHandler:function(element){addHandler(element)},dispose:function(){disposer.dispose()}}),qq.extend(protectedApi,{getFileIdFromItem:function(item){return item.qqFileId},getDisposeSupport:function(){return disposer}}),qq.extend(spec,s),spec.attachTo&&addHandler(spec.attachTo)},qq.FileButtonsClickHandler=function(s){"use strict";function examineEvent(target,event){qq.each(buttonHandlers,function(buttonType,handler){var fileId,firstLetterCapButtonType=buttonType.charAt(0).toUpperCase()+buttonType.slice(1);if(spec.templating["is"+firstLetterCapButtonType](target))return fileId=spec.templating.getFileId(target),qq.preventDefault(event),spec.log(qq.format("Detected valid file button click event on file '{}', ID: {}.",spec.onGetName(fileId),fileId)),handler(fileId),!1})}var inheritedInternalApi={},spec={templating:null,log:function(message,lvl){},onDeleteFile:function(fileId){},onCancel:function(fileId){},onRetry:function(fileId){},onPause:function(fileId){},onContinue:function(fileId){},onGetName:function(fileId){}},buttonHandlers={cancel:function(id){spec.onCancel(id)},retry:function(id){spec.onRetry(id)},deleteButton:function(id){spec.onDeleteFile(id)},pause:function(id){spec.onPause(id)},continueButton:function(id){spec.onContinue(id)}};qq.extend(spec,s),spec.eventType="click",spec.onHandled=examineEvent,spec.attachTo=spec.templating.getFileList(),qq.extend(this,new qq.UiEventHandler(spec,inheritedInternalApi))},qq.FilenameClickHandler=function(s){"use strict";function examineEvent(target,event){if(spec.templating.isFileName(target)||spec.templating.isEditIcon(target)){var fileId=spec.templating.getFileId(target);spec.onGetUploadStatus(fileId)===qq.status.SUBMITTED&&(spec.log(qq.format("Detected valid filename click event on file '{}', ID: {}.",spec.onGetName(fileId),fileId)),qq.preventDefault(event),inheritedInternalApi.handleFilenameEdit(fileId,target,!0))}}var inheritedInternalApi={},spec={templating:null,log:function(message,lvl){},classes:{file:"qq-upload-file",editNameIcon:"qq-edit-filename-icon"},onGetUploadStatus:function(fileId){},onGetName:function(fileId){}};qq.extend(spec,s),spec.eventType="click",spec.onHandled=examineEvent,qq.extend(this,new qq.FilenameEditHandler(spec,inheritedInternalApi))},qq.FilenameInputFocusInHandler=function(s,inheritedInternalApi){"use strict";function handleInputFocus(target,event){if(spec.templating.isEditInput(target)){var fileId=spec.templating.getFileId(target);spec.onGetUploadStatus(fileId)===qq.status.SUBMITTED&&(spec.log(qq.format("Detected valid filename input focus event on file '{}', ID: {}.",spec.onGetName(fileId),fileId)),inheritedInternalApi.handleFilenameEdit(fileId,target))}}var spec={templating:null,onGetUploadStatus:function(fileId){},log:function(message,lvl){}};inheritedInternalApi||(inheritedInternalApi={}),spec.eventType="focusin",spec.onHandled=handleInputFocus,qq.extend(spec,s),qq.extend(this,new qq.FilenameEditHandler(spec,inheritedInternalApi))},qq.FilenameInputFocusHandler=function(spec){"use strict";spec.eventType="focus",spec.attachTo=null,qq.extend(this,new qq.FilenameInputFocusInHandler(spec,{}))},qq.FilenameEditHandler=function(s,inheritedInternalApi){"use strict";function getFilenameSansExtension(fileId){var filenameSansExt=spec.onGetName(fileId),extIdx=filenameSansExt.lastIndexOf(".");return extIdx>0&&(filenameSansExt=filenameSansExt.substr(0,extIdx)),filenameSansExt}function getOriginalExtension(fileId){var origName=spec.onGetName(fileId);return qq.getExtension(origName)}function handleNameUpdate(newFilenameInputEl,fileId){var origExtension,newName=newFilenameInputEl.value;void 0!==newName&&qq.trimStr(newName).length>0&&(origExtension=getOriginalExtension(fileId),void 0!==origExtension&&(newName=newName+"."+origExtension),spec.onSetName(fileId,newName)),spec.onEditingStatusChange(fileId,!1)}function registerInputBlurHandler(inputEl,fileId){inheritedInternalApi.getDisposeSupport().attach(inputEl,"blur",function(){handleNameUpdate(inputEl,fileId)})}function registerInputEnterKeyHandler(inputEl,fileId){inheritedInternalApi.getDisposeSupport().attach(inputEl,"keyup",function(event){13===(event.keyCode||event.which)&&handleNameUpdate(inputEl,fileId)})}var spec={templating:null,log:function(message,lvl){},onGetUploadStatus:function(fileId){},onGetName:function(fileId){},onSetName:function(fileId,newName){},onEditingStatusChange:function(fileId,isEditing){}};qq.extend(spec,s),spec.attachTo=spec.templating.getFileList(),qq.extend(this,new qq.UiEventHandler(spec,inheritedInternalApi)),qq.extend(inheritedInternalApi,{handleFilenameEdit:function(id,target,focusInput){var newFilenameInputEl=spec.templating.getEditInput(id);spec.onEditingStatusChange(id,!0),newFilenameInputEl.value=getFilenameSansExtension(id),focusInput&&newFilenameInputEl.focus(),registerInputBlurHandler(newFilenameInputEl,id),registerInputEnterKeyHandler(newFilenameInputEl,id)}})},function(){"use strict";qq.s3.FineUploader=function(o){var options={failedUploadTextDisplay:{mode:"custom"}};qq.extend(options,o,!0),qq.FineUploader.call(this,options,"s3"),qq.supportedFeatures.ajaxUploading||void 0!==options.iframeSupport.localBlankPagePath||(this._options.element.innerHTML="<div>You MUST set the <code>localBlankPagePath</code> property of the <code>iframeSupport</code> option since this browser does not support the File API!</div>")},qq.extend(qq.s3.FineUploader.prototype,qq.s3.FineUploaderBasic.prototype),qq.extend(qq.s3.FineUploader.prototype,qq.uiPublicApi),qq.extend(qq.s3.FineUploader.prototype,qq.uiPrivateApi)}()}(window),define("mcq-editor",["text!../html/mcq-editor.html","css!../../bower_components/fine-uploader/dist/fine-uploader-gallery.min.css","css!../css/mcq-editor.css","jquery-ui","css!../../bower_components/jquery-ui/themes/base/jquery-ui.css","rivets","sightglass","fine-uploader"],function(mcqTemplateRef,A,qqcss,C,D,E,F,qq){mcqEditor=function(){"use strict";function init(elRoot,params,adaptor,htmlLayout,jsonContentObj,callback){if(activityAdaptor=adaptor,uniqueId=activityAdaptor.getId(),__editedJsonContent=jQuery.extend(!0,{},jsonContentObj),void 0===__editedJsonContent.content)return void(callback&&callback());mediaManager=params.mediaManager,__parseAndUpdateJSONForInteractions(),__parseAndUpdateJSONForRivets(),$(elRoot).html(__constants.TEMPLATES[htmlLayout]),__initRivets(),$(document).on("click",".editor label.checkbox",__handleCheckboxButtonClick),$(document).on("click",".editor label.radio",__handleRadioButtonClick),__bindSortable(),callback&&callback()}function getConfig(){return __config}function getStatus(){return __state.hasUnsavedChanges}function saveItemInEditor(){activityAdaptor.submitEditChanges(__transformJSONtoOriginialForm(),uniqueId)}function __parseAndUpdateJSONForInteractions(){for(var interactionTag,newArray=[],newObj={},i=0;i<__editedJsonContent.content.canvas.data.questiondata.length;i++){__parsedQuestionArray=$.parseHTML(__editedJsonContent.content.canvas.data.questiondata[i].text);$.each(__parsedQuestionArray,function(index,el){"http://www.comprodls.com/m1.0/interaction/mcq"===this.href&&(__interactionIds.push(this.childNodes[0].nodeValue.trim()),interactionTag=this.outerHTML,interactionTag=interactionTag.replace(/"/g,"'"),__interactionTags.push(interactionTag),__editedJsonContent.content.canvas.data.questiondata[i].text=__editedJsonContent.content.canvas.data.questiondata[i].text.replace(interactionTag,""))})}for(var key in __editedJsonContent.content.interactions)newObj=__editedJsonContent.content.interactions[key],newObj.key=key,newArray.push(newObj);__editedJsonContent.content.interactions=newArray}function __parseAndUpdateJSONForRivets(){__editedJsonContent.MCQMR=!1,__editedJsonContent.MCQSR=!1,__editedJsonContent.isInstructionEmpty=!0,__editedJsonContent.enableFeedBack=!1;for(var i=0;i<__interactionIds.length;i++){var processedArray=[],interaction=__editedJsonContent.content.interactions[i],type=interaction.type;__editedJsonContent[type]=!0,interaction[type].forEach(function(obj,index){var processedObj={};if(processedObj.customAttribs={},Object.keys(obj).forEach(function(key){var interactionid=__interactionIds[i];processedObj.customAttribs.key=key,processedObj.customAttribs.value=obj[key],processedObj.customAttribs.isEdited=!1,processedObj.customAttribs.index=index,processedObj.customAttribs.id=interactionid,void 0!==__editedJsonContent.feedback[interactionid]&&void 0!==__editedJsonContent.feedback[interactionid][key]&&(processedObj.customAttribs.feedback=__editedJsonContent.feedback[interactionid][key])}),"MCQSR"===type){var responseObj=__editedJsonContent.responses[__interactionIds[i]].correct;Object.keys(responseObj).length>0&&__editedJsonContent.responses[__interactionIds[i]].correct.indexOf(processedObj.customAttribs.key)>-1?processedObj.customAttribs.isCorrect=!0:processedObj.customAttribs.isCorrect=!1}if("MCQMR"===type){var responseObj=__editedJsonContent.responses[__interactionIds[i]].correct
;responseObj.length>0&&__editedJsonContent.responses[__interactionIds[i]].correct.indexOf(processedObj.customAttribs.key)>-1?processedObj.customAttribs.isCorrect=!0:processedObj.customAttribs.isCorrect=!1}processedArray.push(processedObj)}),__editedJsonContent.content.interactions[i].answeroptions=processedArray,__editedJsonContent.content.interactions[i].editlink={enabled:processedArray.length>=2,disabled:processedArray.length<2}}__parseQuestionTextJSONForRivets(),__parseInstructionTextJSONForRivets(),__parseGlobalFeedbackJSONForRivets(),__parseMediaJSONForRivets()}function __parseGlobalFeedbackJSONForRivets(){if(void 0==__editedJsonContent.feedback.global)return void(__editedJsonContent.feedback.global=[]);var tempObj=__editedJsonContent.feedback.global,tempArr=[];tempObj&&Object.keys(tempObj).length>0&&(Object.keys(tempObj).forEach(function(key,index){var processedObj={};processedObj.customAttribs={},processedObj.customAttribs.key=key,processedObj.customAttribs.value=tempObj[key],processedObj.customAttribs.index=index,"correct"===key&&"incorrect"===key||(processedObj.customAttribs.order=100,processedObj.customAttribs.icon=__icon.generic),"correct"==key&&(processedObj.customAttribs.order=1,__feedbackPresets[0].showDropdown=!1),"incorrect"==key&&(processedObj.customAttribs.order=2,__feedbackPresets[1].showDropdown=!1),processedObj.customAttribs.icon=__icon[key],tempArr.push(processedObj)}),tempArr.sort(function(a,b){return a.customAttribs.order-b.customAttribs.order}),__editedJsonContent.feedback.global=tempArr,__editedJsonContent.enableFeedBack=!0)}function __parseQuestionTextJSONForRivets(){__editedJsonContent.content.canvas.data.questiondata.forEach(function(element){""==element.text&&(element.text='Placeholder Question text. Update "Me" with a valid Question text'),element.customAttribs={},element.customAttribs.isEdited=!1})}function __parseInstructionTextJSONForRivets(){__editedJsonContent.content.instructions.forEach(function(element){""!=element.text&&""!=element.tag||(element.text='Placeholder Instruction text. Update "Me" with a valid Instruction text for this question'),element.customAttribs={},element.customAttribs.isEdited=!1}),__editedJsonContent.content.instructions.length>0?__editedJsonContent.isInstructionEmpty=!1:__editedJsonContent.isInstructionEmpty=!0}function __parseMediaJSONForRivets(){0===__editedJsonContent.content.stimulus.length?__editedJsonContent.enableMedia=!0:__editedJsonContent.enableMedia=!1}function __initRivets(){rivets.formatters.args=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(this,Array.prototype.concat.call(arguments,args))}},rivets.formatters.appendindex=function(obj,index){var array=[];return array.push(obj[index]),array},rivets.formatters.placeholderText=function(obj){var text="Enter inline feedback for option ";return text=text.concat(obj)},rivets.formatters.modalId=function(obj){var text="modal";return obj=obj.replace(/[\. ,:-]+/g,""),text=text.concat(obj)},rivets.formatters.idcreator=function(key,idvalue){return idvalue+key},rivets.formatters.btnId=function(obj){var text="btn";return obj=obj.replace(/[\. ,:-]+/g,""),text=text.concat(obj)},rivets.formatters.interactTypeVal=function(key){return{MCQMR:"Multiple Choice Question",MCQSR:"Single Choice Question"}[key]},rivets.binders["content-editable"]={bind:function(el){var that=this;el.setAttribute("contenteditable",!0),this.callback=function(e){that.publish()},el.addEventListener("blur",this.callback)},unbind:function(el){el.removeEventListener("blur",this.callback)},getValue:function(el){return el.innerText},routine:function(el,value){sendItemChangeNotification&&(activityAdaptor.autoResizeActivityIframe(),__handleItemChangedInEditor()),el.innerHTML=value}},rivets.binders.addclass=function(el,value){el.addedClass&&($(el).removeClass(el.addedClass),delete el.addedClass),value&&($(el).addClass(value),el.addedClass=value)},rivets.bind($("#mcq-editor"),{editorContent:__editedJsonContent,removeItem:__removeItem,addItem:__addItem,interactionIds:__interactionIds,feedback:__editedJsonContent.feedback,removeInstruction:__removeInstruction,addInstruction:__addInstruction,handleItemChanged:__handleItemChangedInEditor,isInstructionEmpty:__editedJsonContent.isInstructionEmpty,changeQuestionType:__changeQuestionType,showFeedBack:__showFeedBack,removeFeedback:__removeFeedback,addFeedback:__addFeedback,feedbackPresets:__feedbackPresets,enableFeedback:__enableFeedback})}function __changeQuestionType(event,selectedType,interaction){if(selectedType!==interaction.type){var key=interaction.key;__editedJsonContent[interaction.type]=!1,__editedJsonContent[selectedType]=!0,__editedJsonContent.responses[key].correct="MCQMR"==selectedType?[]:{},__editedJsonContent.content.interactions.forEach(function(element){element.key===key&&(element.type=selectedType,element.answeroptions.forEach(function(option){option.customAttribs.isCorrect=!1,option.customAttribs.isEdited=!1}))}),$("#answer-choice .dropdown .dropdown-toggle").dropdown("toggle"),__bindSortable(),activityAdaptor.autoResizeActivityIframe(),__handleItemChangedInEditor()}}function __addItem(event,interaction){var newObj={};newObj.customAttribs={},newObj.customAttribs.key=__guid(),newObj.customAttribs.value="",newObj.customAttribs.isEdited=!0,newObj.customAttribs.index=__editedJsonContent.content.interactions[interaction].answeroptions.length,__editedJsonContent.content.interactions[interaction].answeroptions.push(newObj),__editedJsonContent.content.interactions[interaction].answeroptions.length>1&&(__editedJsonContent.content.interactions[interaction].editlink.enabled=!0,__editedJsonContent.content.interactions[interaction].editlink.disabled=!1),__state.hasUnsavedChanges=!0,activityAdaptor.autoResizeActivityIframe(),activityAdaptor.itemChangedInEditor(__transformJSONtoOriginialForm(),uniqueId)}function __removeItem(event,element,interaction){var inputAttribId=(element.customAttribs.id,__editedJsonContent.content.interactions[interaction].type,element.customAttribs.key);__editedJsonContent.content.interactions[interaction].answeroptions.length>1&&(__editedJsonContent.content.interactions[interaction].answeroptions.forEach(function(attrib,idx){inputAttribId===attrib.customAttribs.key&&__editedJsonContent.content.interactions[interaction].answeroptions.splice(idx,1)}),__editedJsonContent.content.interactions[interaction].answeroptions.forEach(function(el,idx){__editedJsonContent.content.interactions[interaction].answeroptions[idx].customAttribs.index=idx}),__state.hasUnsavedChanges=!0,activityAdaptor.autoResizeActivityIframe(),activityAdaptor.itemChangedInEditor(__transformJSONtoOriginialForm(),uniqueId)),__editedJsonContent.content.interactions[interaction].answeroptions.length<=1&&(__editedJsonContent.content.interactions[interaction].editlink.enabled=!1,__editedJsonContent.content.interactions[interaction].editlink.disabled=!0)}function __addInstruction(){__editedJsonContent.content.instructions.push({tag:"text",text:'Placeholder Instruction text. Update "Me" with a valid Instruction text for this question',customAttribs:{isEdited:!1}}),__editedJsonContent.isInstructionEmpty=!1,$("#instructionLabel").show(),activityAdaptor.autoResizeActivityIframe()}function __removeInstruction(event,instruction,index){__editedJsonContent.content.instructions.splice(index,1),__editedJsonContent.content.instructions.length>0?(__editedJsonContent.isInstructionEmpty=!1,$("#instructionLabel").show()):(__editedJsonContent.isInstructionEmpty=!0,$("#instructionLabel").hide()),__state.hasUnsavedChanges=!0,activityAdaptor.autoResizeActivityIframe(),activityAdaptor.itemChangedInEditor(__transformJSONtoOriginialForm(),uniqueId)}function __bindSortable(){$(".sortable").sortable({handle:".drag-icon",axis:"y",containment:".main-container",stop:function(event,ui){var currentIndex,interactIndex,prevIndex=$(ui.item[0]).attr("elementIndex");$(ui.item[0]).parent(".sortable").children("li").each(function(index){if($(this).attr("elementIndex")==prevIndex)return currentIndex=index,interactIndex=parseInt($(this).attr("interactIndex")),!1}),prevIndex=parseInt(prevIndex),$(".sortable").sortable("cancel");var removedItem=(__editedJsonContent.content.interactions[interactIndex].type,__editedJsonContent.content.interactions[interactIndex].answeroptions.splice(prevIndex,1));__editedJsonContent.content.interactions[interactIndex].answeroptions.splice(currentIndex,0,removedItem[0]),$.each(__editedJsonContent.content.interactions[interactIndex].answeroptions,function(index,value){__editedJsonContent.content.interactions[interactIndex].answeroptions[index].customAttribs.index=index}),__state.hasUnsavedChanges=!0,activityAdaptor.itemChangedInEditor(__transformJSONtoOriginialForm(),uniqueId)}})}function __handleCheckboxButtonClick(event){var currentTarget=event.currentTarget,interactionIndex=parseInt($(currentTarget).closest("li").attr("interactIndex")),currentChoice=(__editedJsonContent.content.interactions[interactionIndex].type,$(currentTarget).attr("key")),currentChoice=($(currentTarget).attr("checked"),$(currentTarget).siblings("input").attr("key")),checked=$(currentTarget).siblings("input").prop("checked");__state.hasUnsavedChanges=!0,__editedJsonContent.content.interactions[interactionIndex].answeroptions.forEach(function(obj,index){if(__editedJsonContent.content.interactions[interactionIndex].answeroptions[index].customAttribs.key==currentChoice)if(checked){var idx=__editedJsonContent.responses[__interactionIds[interactionIndex]].correct.indexOf(currentChoice);__editedJsonContent.responses[__interactionIds[interactionIndex]].correct.splice(idx,1)}else{var idx=__editedJsonContent.responses[__interactionIds[interactionIndex]].correct.indexOf(currentChoice);idx<0&&__editedJsonContent.responses[__interactionIds[interactionIndex]].correct.push(currentChoice)}}),activityAdaptor.itemChangedInEditor(__transformJSONtoOriginialForm(),uniqueId)}function __handleRadioButtonClick(event){var currentTarget=event.currentTarget,interactionIndex=parseInt($(currentTarget).parent().parent("li").attr("interactIndex"));$("label.radio").parent("li").removeClass("highlight"),$(currentTarget).closest("li").addClass("highlight"),__state.hasUnsavedChanges=!0,__editedJsonContent.content.interactions[interactionIndex].answeroptions.forEach(function(obj,index){__editedJsonContent.content.interactions[interactionIndex].answeroptions[index].customAttribs.key==$(currentTarget).siblings("input").attr("key")?__editedJsonContent.content.interactions[interactionIndex].answeroptions[index].customAttribs.isCorrect=!0:__editedJsonContent.content.interactions[interactionIndex].answeroptions[index].customAttribs.isCorrect=!1}),__editedJsonContent.responses[__interactionIds[interactionIndex]].correct=$(currentTarget).siblings("input").attr("key"),activityAdaptor.itemChangedInEditor(__transformJSONtoOriginialForm(),uniqueId)}function __handleItemChangedInEditor(){activityAdaptor.itemChangedInEditor(__transformJSONtoOriginialForm(),uniqueId)}function __transformJSONtoOriginialForm(){__finalJSONContent=jQuery.extend(!0,{},__editedJsonContent);var optionsArr=[];__finalJSONContent.content.interactions.forEach(function(interaction,inx){var type=interaction.type,optionsArray=interaction.answeroptions,interactionid=interaction.key;optionsArray.forEach(function(each,idx){var newObj={},key=each.customAttribs.key,val=each.customAttribs.value;newObj[key]=val,optionsArr.push(newObj),delete optionsArray[idx]}),__finalJSONContent.content.interactions={},__finalJSONContent.content.interactions[interactionid]={},__finalJSONContent.content.interactions[interactionid].type=type,__finalJSONContent.content.interactions[interactionid][type]=optionsArr});var globalFeedback=__finalJSONContent.feedback.global;if(globalFeedback&&globalFeedback.length>0){var tempObj={};globalFeedback.forEach(function(obj){obj.customAttribs.value&&""!=obj.customAttribs.value&&(tempObj[obj.customAttribs.key]=obj.customAttribs.value)}),__finalJSONContent.feedback.global=tempObj}for(var i=0;i<__finalJSONContent.content.canvas.data.questiondata.length;i++)__finalJSONContent.content.canvas.data.questiondata[i].text+=__interactionTags[i];return __finalJSONContent.content.instructions.forEach(function(each,idx){each.text&&""===each.tag&&(__finalJSONContent.content.instructions[idx].tag="text")}),__finalJSONContent}function __showFeedBack(event){__editedJsonContent.feedback.global=[],__editedJsonContent.feedback.global.push({customAttribs:{key:"correct",value:"",index:0,icon:__icon.correct,order:1}},{customAttribs:{key:"incorrect",value:"",index:1,icon:__icon.incorrect,order:2}}),__editedJsonContent.enableFeedBack=!0,__feedbackPresets[0].showDropdown=!1,__feedbackPresets[1].showDropdown=!1,__feedbackPresets[2].showDropdown=!0}function __removeFeedback(event,index){"correct"==__editedJsonContent.feedback.global[index].customAttribs.key?__feedbackPresets[0].showDropdown=!0:"incorrect"==__editedJsonContent.feedback.global[index].customAttribs.key?__feedbackPresets[1].showDropdown=!0:__feedbackPresets[2].showDropdown=!0,__editedJsonContent.feedback.global.splice(index,1),__editedJsonContent.feedback.global.sort(function(a,b){a.customAttribs.order,b.customAttribs.order}),0==__editedJsonContent.feedback.global.length&&(__editedJsonContent.enableFeedBack=!1),__enableFeedback.hide=!1,__state.hasUnsavedChanges=!0,activityAdaptor.autoResizeActivityIframe(),activityAdaptor.itemChangedInEditor(__transformJSONtoOriginialForm(),uniqueId)}function __addFeedback(event,element,index){__editedJsonContent.feedback.global.push({customAttribs:{key:"generic"==element.key?__guid():element.key,value:"",index:element.order,icon:__icon[element.key],order:element.order}}),__editedJsonContent.feedback.global.sort(function(a,b){a.customAttribs.order,b.customAttribs.order}),__feedbackPresets[index].showDropdown=!1,__enableFeedback.hide=!__feedbackPresets.some(function(element){return element.showDropdown}),activityAdaptor.autoResizeActivityIframe(),activityAdaptor.itemChangedInEditor(__transformJSONtoOriginialForm(),uniqueId)}function __guid(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}function intializeUpload(){new qq.s3.FineUploader({element:document.getElementById("uploader"),request:{endpoint:__media.url,accessKey:__media.accessKey},signature:{endpoint:__media["signature-endpoint"]},objectProperties:{key:function(fileId){var filename=this.getName(fileId),uuid=this.getUuid(fileId),ext=filename.substr(filename.lastIndexOf(".")+1);return __media.folder+uuid+"."+ext}},callbacks:{onComplete:function(id,name,response){response.filePath,this.getItemByFileId(id)}}})}var activityAdaptor,mediaManager,__editedJsonContent,uniqueId,__config={RESIZE_MODE:"auto",RESIZE_HEIGHT:"580"},__icon={correct:"thumbs-o-up",incorrect:"thumbs-o-down",generic:"hand-o-right"},__media={url:"comprodlscontentprocessor.s3.amazonaws.com",bucket:"",accessKey:"AKIAJ7M7GQKI4M3BL35Q",folder:"testdata/mcq/",key:"","signature-endpoint":"http://sachin:3000/s3/signtureHandler"},__state={hasUnsavedChanges:!1},__constants={DOM_SEL_ACTIVITY_BODY:".activity-body",ADAPTOR_INSTANCE_IDENTIFIER:"data-objectid",TEMPLATES:{MCQ_EDITOR:mcqTemplateRef}},__parsedQuestionArray=[],__interactionIds=[],__interactionTags=[],__finalJSONContent={};var __enableFeedback={hide:!1},__feedbackPresets=[{key:"correct",value:"Show when Correct",showDropdown:!0,order:1},{key:"incorrect",value:"Show when Incorrect",showDropdown:!0,order:2},{key:"generic",value:"Show Always",showDropdown:!0,order:100}],sendItemChangeNotification=!1;return $(document).on("click","a.drag-icon",function(){}),$(document).ready(function(){if(mediaManager.getUploadsFolder)for(var key in mediaManager)mediaManager.hasOwnProperty(key)&&"getUploadsFolder"===key&&"function"==typeof mediaManager[key]&&(__media=mediaManager[key]().then(function(data){__media=data,intializeUpload()}));else intializeUpload();$("#instructionmenu a.dropdown-toggle").click(function(){$("#menu1").dropdown("toggle")}),$("#feedbackmenu a.dropdown-toggle").click(function(){$("#menu2").dropdown("toggle")}),sendItemChangeNotification=!0}),{init:init,getStatus:getStatus,getConfig:getConfig,saveItemInEditor:saveItemInEditor}}}),function(c){var d=document,a="appendChild",i="styleSheet",s=d.createElement("style");s.type="text/css",d.getElementsByTagName("head")[0][a](s),s[i]?s[i].cssText=c:s[a](d.createTextNode(c))
}('.qq-gallery .qq-btn{float:right;border:none;padding:0;margin:0;box-shadow:none}.qq-gallery .qq-upload-button{display:inline;width:105px;padding:7px 10px;float:left;text-align:center;background:#00ABC7;color:#FFF;border-radius:2px;border:1px solid #37B7CC;box-shadow:0 1px 1px rgba(255,255,255,.37) inset,1px 0 1px rgba(255,255,255,.07) inset,0 1px 0 rgba(0,0,0,.36),0 -2px 12px rgba(0,0,0,.08) inset}.qq-gallery .qq-upload-button-hover{background:#33B6CC}.qq-gallery .qq-upload-button-focus{outline:#000 dotted 1px}.qq-gallery.qq-uploader{position:relative;min-height:200px;max-height:490px;overflow-y:hidden;width:inherit;border-radius:6px;border:1px dashed #CCC;background-color:#FAFAFA;padding:20px}.qq-gallery.qq-uploader:before{content:attr(qq-drop-area-text) " ";position:absolute;font-size:200%;left:0;width:100%;text-align:center;top:45%;opacity:.25;filter:alpha(opacity=25)}.qq-gallery .qq-upload-drop-area,.qq-upload-extra-drop-area{position:absolute;top:0;left:0;width:100%;height:100%;min-height:30px;z-index:2;background:#F9F9F9;border-radius:4px;text-align:center}.qq-gallery .qq-upload-drop-area span{display:block;position:absolute;top:50%;width:100%;margin-top:-8px;font-size:16px}.qq-gallery .qq-upload-extra-drop-area{position:relative;margin-top:50px;font-size:16px;padding-top:30px;height:20px;min-height:40px}.qq-gallery .qq-upload-drop-area-active{background:#FDFDFD;border-radius:4px}.qq-gallery .qq-upload-list{margin:0;padding:10px 0 0;list-style:none;max-height:450px;overflow-y:auto;clear:both;box-shadow:none}.qq-gallery .qq-upload-list li{display:inline-block;position:relative;max-width:120px;margin:0 25px 25px 0;padding:0;line-height:16px;font-size:13px;color:#424242;background-color:#FFF;border-radius:2px;box-shadow:0 1px 1px 0 rgba(0,0,0,.22);vertical-align:top;height:186px}.qq-gallery .qq-upload-continue,.qq-gallery .qq-upload-delete,.qq-gallery .qq-upload-failed-text,.qq-gallery .qq-upload-pause,.qq-gallery .qq-upload-retry,.qq-gallery .qq-upload-size,.qq-gallery .qq-upload-spinner{display:inline}.qq-gallery .qq-upload-continue:hover,.qq-gallery .qq-upload-delete:hover,.qq-gallery .qq-upload-pause:hover,.qq-gallery .qq-upload-retry:hover{background-color:transparent}.qq-gallery .qq-upload-cancel,.qq-gallery .qq-upload-continue,.qq-gallery .qq-upload-delete,.qq-gallery .qq-upload-pause{cursor:pointer}.qq-gallery .qq-upload-continue,.qq-gallery .qq-upload-delete,.qq-gallery .qq-upload-pause{border:none;background:0 0;color:#00A0BA;font-size:12px;padding:0}.qq-gallery .qq-upload-status-text{color:#333;font-size:12px;padding-left:3px;padding-top:2px;display:none;width:108px}.qq-gallery .qq-upload-fail .qq-upload-status-text{text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden;display:block}.qq-gallery .qq-upload-retrying .qq-upload-status-text{display:inline-block}.qq-gallery .qq-upload-retrying .qq-progress-bar-container{display:none}.qq-gallery .qq-upload-cancel{background-color:#525252;color:#F7F7F7;font-weight:700;font-family:Arial,Helvetica,sans-serif;border-radius:12px;border:none;height:22px;width:22px;padding:4px;position:absolute;right:-5px;top:-6px;margin:0;line-height:17px}.qq-gallery .qq-upload-cancel:hover{background-color:#525252}.qq-gallery .qq-upload-retry{cursor:pointer;position:absolute;top:30px;left:50%;margin-left:-31px;box-shadow:0 1px 1px rgba(255,255,255,.37) inset,1px 0 1px rgba(255,255,255,.07) inset,0 4px 4px rgba(0,0,0,.5),0 -2px 12px rgba(0,0,0,.08) inset;padding:3px 4px;border:1px solid #d2ddc7;border-radius:2px;color:inherit;background-color:#EBF6E0;z-index:1}.qq-gallery .qq-upload-retry:hover{background-color:#f7ffec}.qq-gallery .qq-file-info{padding:10px 6px 4px;margin-top:-3px;border-radius:0 0 2px 2px;text-align:left;overflow:hidden}.qq-gallery .qq-file-info .qq-file-name{position:relative}.qq-gallery .qq-upload-file{display:block;margin-right:0;margin-bottom:3px;width:auto;text-overflow:ellipsis;white-space:nowrap;overflow-x:hidden}.qq-gallery .qq-upload-spinner{display:inline-block;background:url(../src/js/../../bower_components/fine-uploader/dist/loading.gif);position:absolute;left:50%;margin-left:-7px;top:53px;width:15px;height:15px;vertical-align:text-bottom}.qq-gallery .qq-drop-processing{display:block}.qq-gallery .qq-drop-processing-spinner{display:inline-block;background:url(../src/js/../../bower_components/fine-uploader/dist/processing.gif);width:24px;height:24px;vertical-align:text-bottom}.qq-gallery .qq-upload-failed-text{display:none;font-style:italic;font-weight:700}.qq-gallery .qq-upload-failed-icon{display:none;width:15px;height:15px;vertical-align:text-bottom}.qq-gallery .qq-upload-fail .qq-upload-failed-text,.qq-gallery .qq-upload-retrying .qq-upload-failed-text{display:inline}.qq-gallery .qq-upload-list li.qq-upload-success{background-color:#F2F7ED}.qq-gallery .qq-upload-list li.qq-upload-fail{background-color:#F5EDED;box-shadow:0 0 1px 0 red;border:0}.qq-gallery .qq-progress-bar{display:block;background:#00abc7;width:0;height:15px;border-radius:6px;margin-bottom:3px}.qq-gallery .qq-total-progress-bar{height:25px;border-radius:9px}.qq-gallery .qq-total-progress-bar-container{margin-left:9px;display:inline;float:right;width:500px}.qq-gallery .qq-upload-size{float:left;font-size:11px;color:#929292;margin-bottom:3px;margin-right:0;display:inline-block}.qq-gallery INPUT.qq-edit-filename{position:absolute;opacity:0;filter:alpha(opacity=0);z-index:-1;-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)"}.qq-gallery .qq-upload-file.qq-editable{cursor:pointer;margin-right:20px}.qq-gallery .qq-edit-filename-icon.qq-editable{display:inline-block;cursor:pointer;position:absolute;right:0;top:0}.qq-gallery INPUT.qq-edit-filename.qq-editing{position:static;height:28px;width:90px;width:-moz-available;padding:0 8px;margin-bottom:3px;border:1px solid #ccc;border-radius:2px;font-size:13px;opacity:1;filter:alpha(opacity=100);-ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=100)"}.qq-gallery .qq-edit-filename-icon{display:none;background:url(../src/js/../../bower_components/fine-uploader/dist/edit.gif);width:15px;height:15px;vertical-align:text-bottom}.qq-gallery .qq-continue-icon,.qq-gallery .qq-delete-icon,.qq-gallery .qq-pause-icon,.qq-gallery .qq-retry-icon{width:15px;height:15px;vertical-align:sub;display:inline-block}.qq-gallery .qq-delete-icon{background:url(../src/js/../../bower_components/fine-uploader/dist/trash.gif)}.qq-gallery .qq-retry-icon{background:url(../src/js/../../bower_components/fine-uploader/dist/retry.gif);float:none}.qq-gallery .qq-continue-icon{background:url(../src/js/../../bower_components/fine-uploader/dist/continue.gif)}.qq-gallery .qq-pause-icon{background:url(../src/js/../../bower_components/fine-uploader/dist/pause.gif)}.qq-gallery .qq-hide{display:none}.qq-gallery .qq-in-progress .qq-thumbnail-wrapper{opacity:.5;filter:alpha(opacity=50)}.qq-gallery .qq-thumbnail-wrapper{overflow:hidden;position:relative;height:120px;width:120px}.qq-gallery .qq-thumbnail-selector{border-radius:2px 2px 0 0;bottom:0;top:0;margin:auto;display:block}:root *>.qq-gallery .qq-thumbnail-selector{position:relative;top:50%;transform:translateY(-50%);-moz-transform:translateY(-50%);-ms-transform:translateY(-50%);-webkit-transform:translateY(-50%)}.qq-gallery.qq-uploader DIALOG{display:none}.qq-gallery.qq-uploader DIALOG[open]{display:block}.qq-gallery.qq-uploader DIALOG .qq-dialog-buttons{text-align:center;padding-top:10px}.qq-gallery.qq-uploader DIALOG .qq-dialog-buttons BUTTON{margin-left:5px;margin-right:5px}.qq-gallery.qq-uploader DIALOG .qq-dialog-message-selector{padding-bottom:10px}.qq-gallery .qq-uploader DIALOG::backdrop{background-color:rgba(0,0,0,.7)}/*# sourceMappingURL=fine-uploader-gallery.min.css.map *//*******************************************************\r\n * \r\n * ----------------------\r\n * Engine Editor Styles\r\n * ----------------------\r\n *\r\n * These styles do not include any product-specific branding\r\n * and/or layout / design. They represent minimal structural\r\n * CSS which is necessary for a default rendering of an\r\n * MCQSC activity\r\n *\r\n * The styles are linked/depending on the presence of\r\n * certain elements (classes / ids / tags) in the DOM (as would\r\n * be injected via a valid MCQSC layout HTML and/or dynamically\r\n * created by the MCQSC engine JS)\r\n *\r\n *\r\n *******************************************************/\r\n\r\n.global {\r\n    font-size: 1.3em;\r\n    font-family: "Open Sans";\r\n    color: #585858;\r\n    padding: 10px;\r\n}\r\n\r\n.outline-none {\r\n    outline: none;\r\n}\r\n\r\n.color-gray {\r\n    color: #343434;\r\n}\r\n\r\n.color-lightslategray {\r\n    color: #d5d5d5;\r\n}\r\n\r\n.color-lightgray {\r\n    color: #585858;\r\n}\r\n\r\n.bg-white {\r\n    background-color: #FFF;\r\n}\r\n\r\n.global-border {\r\n    border: 1px solid lightslategray;\r\n}\r\n\r\n.font-semibold {\r\n    font-weight: 600;\r\n}\r\n\r\n.font-normal {\r\n    font-weight: 400;\r\n}\r\n\r\n.noborder {\r\n    border: none;\r\n}\r\n\r\n.adjusted-width {\r\n    width: 96%;\r\n}\r\n\r\n.mt-sm {\r\n    margin-top: 15px;\r\n}\r\n\r\n.mt-md {\r\n    margin-top: 20px;\r\n}\r\n\r\n.ml-md {\r\n    margin-left: 20px;\r\n}\r\n\r\n.ml-xl {\r\n    margin-left: 40px;\r\n}\r\n\r\n.mt-xs {\r\n    margin-top: 5px;\r\n}\r\n\r\n.ml-xxl {\r\n    margin-left: 60px;\r\n}\r\n\r\n.ml-sm {\r\n    margin-left: 15px;\r\n}\r\n\r\n.mb-sm {\r\n    margin-bottom: 15px;\r\n}\r\n\r\n.mb-md {\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.mb-add-offset {\r\n    margin-bottom: 25px;\r\n}\r\n\r\n.mr-1em {\r\n    margin-right: 1em;\r\n}\r\n\r\n.pl-md {\r\n    padding-left: 25px;\r\n}\r\n\r\n.pl-sm {\r\n    padding-left: 15px;\r\n}\r\n\r\n.pr-3pc {\r\n    padding-right: 3%;\r\n}\r\n\r\n.pr-7pc {\r\n    padding-right: 3%;\r\n}\r\n\r\n.border-bottom-dashed {\r\n    border-bottom: 1px dashed #d5d5d5;\r\n    transition: border-color 0.5s ease-in-out;\r\n}\r\n\r\n.border-bottom-blue {\r\n    border-bottom: 1px solid #6778e3;\r\n    transition: border-color 0.5s ease-in-out;\r\n}\r\n\r\n.border-dashed {\r\n    border: 1px dashed;\r\n}\r\n\r\n.border-top {\r\n    border-top: 1px solid #d5d5d5;\r\n}\r\n\r\n.border-left {\r\n    border-left: 1px solid #d5d5d5;\r\n}\r\n\r\n.border-right {\r\n    border-right: 1px solid #d5d5d5;\r\n}\r\n\r\n.border-bottom {\r\n    border-bottom: 1px solid #d5d5d5;\r\n}\r\n\r\n.border-bottom-shadow {\r\n    border-bottom: 1px solid #f3f3f3;\r\n    box-shadow: 0 12px 15px -20px #333;\r\n}\r\n\r\n.fa-pencil:before {\r\n    color: lightslategray;\r\n}\r\n\r\n.font-medium {\r\n    font-size: 14px;\r\n}\r\n\r\n.text-underline {\r\n    text-decoration: underline;\r\n}\r\n\r\n.correct {\r\n    color: green;\r\n}\r\n\r\n.incorrect {\r\n    color: red;\r\n}\r\n\r\n[contentEditable=true]:empty:not(:focus):before {\r\n    content: attr(data-text)\r\n}\r\n\r\n.textEditable[contentEditable=true]:not(:focus) {\r\n    border-bottom: 1px dashed #d5d5d5;\r\n}\r\n\r\n[contentEditable=true]:focus {\r\n    border: none;\r\n    border-bottom: 1px solid #162375;\r\n    outline: none;\r\n}\r\n\r\n.option-div[contentEditable=true]:focus {\r\n    border: none;\r\n    border-bottom: 1px solid #162375;\r\n    outline: none;\r\n}\r\n\r\n.option-div {\r\n    line-height: 1.8em;\r\n    width: 94%;\r\n}\r\n\r\n.ribbon-adjustments {\r\n    margin: 0px 15px 0px 15px !important;\r\n}\r\n\r\n.icon-horizontal-align {\r\n    position: absolute;\r\n    right: 14px;\r\n}\r\n\r\na:hover {\r\n    text-decoration: none;\r\n    cursor: pointer;\r\n}\r\n\r\n.hide-option {\r\n    position: absolute;\r\n    left: -9999px;\r\n}\r\n\r\ni.choices {\r\n    height: 2.35em;\r\n    width: 2.35em;\r\n    position: absolute;\r\n    top: -30px;\r\n    left: 0;\r\n    display: block;\r\n    outline: 0;\r\n    border: 1px solid #BDBDBD;\r\n    background: #FFF;\r\n    padding: 10px;\r\n}\r\n\r\ni.choices:after {\r\n    opacity: 0;\r\n    background-color: #FFF;\r\n    content: "\\f00c";\r\n    color: green;\r\n    font-family: fontawesome;\r\n    font-size: 1.6em;\r\n    position: relative;\r\n    left: -4px;\r\n    top: -10px;\r\n    font-weight: 400;\r\n    font-style: normal;\r\n}\r\n\r\nli.highlight i.choices {\r\n    border-color: green;\r\n}\r\n\r\nli.highlight i.choices:after {\r\n    opacity: 0.7;\r\n}\r\n\r\ni.choices:hover {\r\n    cursor: pointer;\r\n}\r\n\r\n.round-icon {\r\n    border-radius: 50%;\r\n}\r\n\r\n.vertical-center-align {\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.vertical-bottom-align {\r\n    display: flex;\r\n    align-items: flex-end;\r\n}\r\n\r\n.vertical-align-self {\r\n    align-self: center;\r\n}\r\n\r\n.option-icon-pencil {\r\n    position: relative;\r\n    left: 15px;\r\n}\r\n\r\n.icon-box {\r\n    width: 7%;\r\n    position: absolute;\r\n    right: -25px;\r\n}\r\n\r\n.icon-pencil {\r\n    position: absolute;\r\n    bottom: 20px;\r\n}\r\n\r\n.bottom {\r\n    bottom: 0px;\r\n}\r\n\r\n.no-margin-left {\r\n    margin-left: 0;\r\n}\r\n\r\n@media (max-width: 1240px) {\r\n    .icon-box {\r\n        width: 7%;\r\n        right: -10px;\r\n    }\r\n    .option-div {\r\n        width: 92%;\r\n    }\r\n}\r\n\r\n@media (max-width: 980px) {\r\n    .icon-box {\r\n        width: 8%;\r\n        right: 0px;\r\n    }\r\n    .option-div {\r\n        width: 90%;\r\n    }\r\n}\r\n\r\n@media (max-width: 720px) {\r\n    .icon-box {\r\n        width: 10%;\r\n        right: -10px;\r\n    }\r\n    .option-div {\r\n        width: 86%;\r\n    }\r\n}\r\n\r\n.fa-thumbs-o-up:before {\r\n    content: "\\f087";\r\n}\r\n\r\ni.thumbs-o-down {\r\n    height: 2.35em;\r\n    width: 2.35em;\r\n    position: absolute;\r\n    top: -30px;\r\n    left: 0;\r\n    display: block;\r\n    outline: 0;\r\n    border: 1px solid red;\r\n    background: #FAE9E9;\r\n    padding: 10px;\r\n}\r\n\r\ni.thumbs-o-down:after {\r\n    opacity: 0.7;\r\n    background-color: #FAE9E9;\r\n    color: red;\r\n    content: "\\f088";\r\n    font-family: fontawesome;\r\n    font-size: 1.3em;\r\n    position: relative;\r\n    left: 0px;\r\n    top: -6px;\r\n    font-weight: 400;\r\n    font-style: normal;\r\n}\r\n\r\ni.thumbs-o-up {\r\n    height: 2.35em;\r\n    width: 2.35em;\r\n    position: absolute;\r\n    top: -30px;\r\n    left: 0;\r\n    display: block;\r\n    outline: 0;\r\n    border: 1px solid green;\r\n    background: #E0FFE0;\r\n    padding: 10px;\r\n}\r\n\r\ni.thumbs-o-up:after {\r\n    opacity: 0.7;\r\n    background-color: #E0FFE0;\r\n    color: green;\r\n    content: "\\f087";\r\n    font-family: fontawesome;\r\n    font-size: 1.3em;\r\n    position: relative;\r\n    left: 0px;\r\n    top: -6px;\r\n    font-weight: 400;\r\n    font-style: normal;\r\n}\r\n\r\n.linkenabled {\r\n    color: #585858;\r\n}\r\n\r\n.linkdisabled {\r\n    color: #DFDDDD;\r\n    pointer-events: none;\r\n    cursor: default;\r\n}\r\n\r\n\r\ni.hand-o-right {\r\n    height: 2.35em;\r\n    width: 2.35em;\r\n    position: absolute;\r\n    top: -30px;\r\n    left: 0;\r\n    display: block;\r\n    outline: 0;\r\n    border: 1px solid grey;\r\n    background-color: #FFF;\r\n    padding: 10px;\r\n}\r\n\r\ni.hand-o-right:after {\r\n    opacity: 0.7;\r\n    background-color: #FFF;\r\n    color: grey;\r\n    content: "\\f0e5";\r\n    font-family: fontawesome;\r\n    font-size: 1.3em;\r\n    position: relative;\r\n    left: -1px;\r\n    top: -7px;\r\n    font-weight: 400;\r\n    font-style: normal;\r\n}\r\n/*overriding upload UI */\r\n.qq-gallery .qq-progress-bar {\r\n    background: #d5d5d5;\r\n}\r\n.qq-gallery .qq-upload-button {\r\n    color: #333;\r\n    background-color: #fff;\r\n    \r\n    min-width: 150px;\r\n\r\n  \r\n    color: #333;\r\n    display: inline-block;\r\n    padding: 6px 12px;\r\n    font-size: 14px;\r\n    font-weight: 400;\r\n    line-height: 1.42857143;\r\n    text-align: center;\r\n    white-space: nowrap;\r\n    vertical-align: middle;\r\n    -ms-touch-action: manipulation;\r\n    touch-action: manipulation;\r\n    cursor: pointer;\r\n    -webkit-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    background-image: none;\r\n    border: 1px dashed #333;    \r\n    border-radius: 4px;\r\n    box-shadow: none;\r\n    outline: none;\r\n    font-weight: 600;\r\n    font-size: 1.1em;\r\n}/*! jQuery UI - v1.12.1 - 2016-09-14\r\n* http://jqueryui.com\r\n* Includes: core.css, accordion.css, autocomplete.css, menu.css, button.css, controlgroup.css, checkboxradio.css, datepicker.css, dialog.css, draggable.css, resizable.css, progressbar.css, selectable.css, selectmenu.css, slider.css, sortable.css, spinner.css, tabs.css, tooltip.css, theme.css\r\n* To view and modify this theme, visit http://jqueryui.com/themeroller/?ffDefault=Arial%2CHelvetica%2Csans-serif&fsDefault=1em&fwDefault=normal&cornerRadius=3px&bgColorHeader=e9e9e9&bgTextureHeader=flat&borderColorHeader=dddddd&fcHeader=333333&iconColorHeader=444444&bgColorContent=ffffff&bgTextureContent=flat&borderColorContent=dddddd&fcContent=333333&iconColorContent=444444&bgColorDefault=f6f6f6&bgTextureDefault=flat&borderColorDefault=c5c5c5&fcDefault=454545&iconColorDefault=777777&bgColorHover=ededed&bgTextureHover=flat&borderColorHover=cccccc&fcHover=2b2b2b&iconColorHover=555555&bgColorActive=007fff&bgTextureActive=flat&borderColorActive=003eff&fcActive=ffffff&iconColorActive=ffffff&bgColorHighlight=fffa90&bgTextureHighlight=flat&borderColorHighlight=dad55e&fcHighlight=777620&iconColorHighlight=777620&bgColorError=fddfdf&bgTextureError=flat&borderColorError=f1a899&fcError=5f3f3f&iconColorError=cc0000&bgColorOverlay=aaaaaa&bgTextureOverlay=flat&bgImgOpacityOverlay=0&opacityOverlay=30&bgColorShadow=666666&bgTextureShadow=flat&bgImgOpacityShadow=0&opacityShadow=30&thicknessShadow=5px&offsetTopShadow=0px&offsetLeftShadow=0px&cornerRadiusShadow=8px\r\n* Copyright jQuery Foundation and other contributors; Licensed MIT */\r\n\r\n/* Layout helpers\r\n----------------------------------*/\r\n.ui-helper-hidden {\r\n\tdisplay: none;\r\n}\r\n.ui-helper-hidden-accessible {\r\n\tborder: 0;\r\n\tclip: rect(0 0 0 0);\r\n\theight: 1px;\r\n\tmargin: -1px;\r\n\toverflow: hidden;\r\n\tpadding: 0;\r\n\tposition: absolute;\r\n\twidth: 1px;\r\n}\r\n.ui-helper-reset {\r\n\tmargin: 0;\r\n\tpadding: 0;\r\n\tborder: 0;\r\n\toutline: 0;\r\n\tline-height: 1.3;\r\n\ttext-decoration: none;\r\n\tfont-size: 100%;\r\n\tlist-style: none;\r\n}\r\n.ui-helper-clearfix:before,\r\n.ui-helper-clearfix:after {\r\n\tcontent: "";\r\n\tdisplay: table;\r\n\tborder-collapse: collapse;\r\n}\r\n.ui-helper-clearfix:after {\r\n\tclear: both;\r\n}\r\n.ui-helper-zfix {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tposition: absolute;\r\n\topacity: 0;\r\n\tfilter:Alpha(Opacity=0); /* support: IE8 */\r\n}\r\n\r\n.ui-front {\r\n\tz-index: 100;\r\n}\r\n\r\n\r\n/* Interaction Cues\r\n----------------------------------*/\r\n.ui-state-disabled {\r\n\tcursor: default !important;\r\n\tpointer-events: none;\r\n}\r\n\r\n\r\n/* Icons\r\n----------------------------------*/\r\n.ui-icon {\r\n\tdisplay: inline-block;\r\n\tvertical-align: middle;\r\n\tmargin-top: -.25em;\r\n\tposition: relative;\r\n\ttext-indent: -99999px;\r\n\toverflow: hidden;\r\n\tbackground-repeat: no-repeat;\r\n}\r\n\r\n.ui-widget-icon-block {\r\n\tleft: 50%;\r\n\tmargin-left: -8px;\r\n\tdisplay: block;\r\n}\r\n\r\n/* Misc visuals\r\n----------------------------------*/\r\n\r\n/* Overlays */\r\n.ui-widget-overlay {\r\n\tposition: fixed;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n.ui-accordion .ui-accordion-header {\r\n\tdisplay: block;\r\n\tcursor: pointer;\r\n\tposition: relative;\r\n\tmargin: 2px 0 0 0;\r\n\tpadding: .5em .5em .5em .7em;\r\n\tfont-size: 100%;\r\n}\r\n.ui-accordion .ui-accordion-content {\r\n\tpadding: 1em 2.2em;\r\n\tborder-top: 0;\r\n\toverflow: auto;\r\n}\r\n.ui-autocomplete {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tcursor: default;\r\n}\r\n.ui-menu {\r\n\tlist-style: none;\r\n\tpadding: 0;\r\n\tmargin: 0;\r\n\tdisplay: block;\r\n\toutline: 0;\r\n}\r\n.ui-menu .ui-menu {\r\n\tposition: absolute;\r\n}\r\n.ui-menu .ui-menu-item {\r\n\tmargin: 0;\r\n\tcursor: pointer;\r\n\t/* support: IE10, see #8844 */\r\n\tlist-style-image: url("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");\r\n}\r\n.ui-menu .ui-menu-item-wrapper {\r\n\tposition: relative;\r\n\tpadding: 3px 1em 3px .4em;\r\n}\r\n.ui-menu .ui-menu-divider {\r\n\tmargin: 5px 0;\r\n\theight: 0;\r\n\tfont-size: 0;\r\n\tline-height: 0;\r\n\tborder-width: 1px 0 0 0;\r\n}\r\n.ui-menu .ui-state-focus,\r\n.ui-menu .ui-state-active {\r\n\tmargin: -1px;\r\n}\r\n\r\n/* icon support */\r\n.ui-menu-icons {\r\n\tposition: relative;\r\n}\r\n.ui-menu-icons .ui-menu-item-wrapper {\r\n\tpadding-left: 2em;\r\n}\r\n\r\n/* left-aligned */\r\n.ui-menu .ui-icon {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tbottom: 0;\r\n\tleft: .2em;\r\n\tmargin: auto 0;\r\n}\r\n\r\n/* right-aligned */\r\n.ui-menu .ui-menu-icon {\r\n\tleft: auto;\r\n\tright: 0;\r\n}\r\n.ui-button {\r\n\tpadding: .4em 1em;\r\n\tdisplay: inline-block;\r\n\tposition: relative;\r\n\tline-height: normal;\r\n\tmargin-right: .1em;\r\n\tcursor: pointer;\r\n\tvertical-align: middle;\r\n\ttext-align: center;\r\n\t-webkit-user-select: none;\r\n\t-moz-user-select: none;\r\n\t-ms-user-select: none;\r\n\tuser-select: none;\r\n\r\n\t/* Support: IE <= 11 */\r\n\toverflow: visible;\r\n}\r\n\r\n.ui-button,\r\n.ui-button:link,\r\n.ui-button:visited,\r\n.ui-button:hover,\r\n.ui-button:active {\r\n\ttext-decoration: none;\r\n}\r\n\r\n/* to make room for the icon, a width needs to be set here */\r\n.ui-button-icon-only {\r\n\twidth: 2em;\r\n\tbox-sizing: border-box;\r\n\ttext-indent: -9999px;\r\n\twhite-space: nowrap;\r\n}\r\n\r\n/* no icon support for input elements */\r\ninput.ui-button.ui-button-icon-only {\r\n\ttext-indent: 0;\r\n}\r\n\r\n/* button icon element(s) */\r\n.ui-button-icon-only .ui-icon {\r\n\tposition: absolute;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\tmargin-top: -8px;\r\n\tmargin-left: -8px;\r\n}\r\n\r\n.ui-button.ui-icon-notext .ui-icon {\r\n\tpadding: 0;\r\n\twidth: 2.1em;\r\n\theight: 2.1em;\r\n\ttext-indent: -9999px;\r\n\twhite-space: nowrap;\r\n\r\n}\r\n\r\ninput.ui-button.ui-icon-notext .ui-icon {\r\n\twidth: auto;\r\n\theight: auto;\r\n\ttext-indent: 0;\r\n\twhite-space: normal;\r\n\tpadding: .4em 1em;\r\n}\r\n\r\n/* workarounds */\r\n/* Support: Firefox 5 - 40 */\r\ninput.ui-button::-moz-focus-inner,\r\nbutton.ui-button::-moz-focus-inner {\r\n\tborder: 0;\r\n\tpadding: 0;\r\n}\r\n.ui-controlgroup {\r\n\tvertical-align: middle;\r\n\tdisplay: inline-block;\r\n}\r\n.ui-controlgroup > .ui-controlgroup-item {\r\n\tfloat: left;\r\n\tmargin-left: 0;\r\n\tmargin-right: 0;\r\n}\r\n.ui-controlgroup > .ui-controlgroup-item:focus,\r\n.ui-controlgroup > .ui-controlgroup-item.ui-visual-focus {\r\n\tz-index: 9999;\r\n}\r\n.ui-controlgroup-vertical > .ui-controlgroup-item {\r\n\tdisplay: block;\r\n\tfloat: none;\r\n\twidth: 100%;\r\n\tmargin-top: 0;\r\n\tmargin-bottom: 0;\r\n\ttext-align: left;\r\n}\r\n.ui-controlgroup-vertical .ui-controlgroup-item {\r\n\tbox-sizing: border-box;\r\n}\r\n.ui-controlgroup .ui-controlgroup-label {\r\n\tpadding: .4em 1em;\r\n}\r\n.ui-controlgroup .ui-controlgroup-label span {\r\n\tfont-size: 80%;\r\n}\r\n.ui-controlgroup-horizontal .ui-controlgroup-label + .ui-controlgroup-item {\r\n\tborder-left: none;\r\n}\r\n.ui-controlgroup-vertical .ui-controlgroup-label + .ui-controlgroup-item {\r\n\tborder-top: none;\r\n}\r\n.ui-controlgroup-horizontal .ui-controlgroup-label.ui-widget-content {\r\n\tborder-right: none;\r\n}\r\n.ui-controlgroup-vertical .ui-controlgroup-label.ui-widget-content {\r\n\tborder-bottom: none;\r\n}\r\n\r\n/* Spinner specific style fixes */\r\n.ui-controlgroup-vertical .ui-spinner-input {\r\n\r\n\t/* Support: IE8 only, Android < 4.4 only */\r\n\twidth: 75%;\r\n\twidth: calc( 100% - 2.4em );\r\n}\r\n.ui-controlgroup-vertical .ui-spinner .ui-spinner-up {\r\n\tborder-top-style: solid;\r\n}\r\n\r\n.ui-checkboxradio-label .ui-icon-background {\r\n\tbox-shadow: inset 1px 1px 1px #ccc;\r\n\tborder-radius: .12em;\r\n\tborder: none;\r\n}\r\n.ui-checkboxradio-radio-label .ui-icon-background {\r\n\twidth: 16px;\r\n\theight: 16px;\r\n\tborder-radius: 1em;\r\n\toverflow: visible;\r\n\tborder: none;\r\n}\r\n.ui-checkboxradio-radio-label.ui-checkboxradio-checked .ui-icon,\r\n.ui-checkboxradio-radio-label.ui-checkboxradio-checked:hover .ui-icon {\r\n\tbackground-image: none;\r\n\twidth: 8px;\r\n\theight: 8px;\r\n\tborder-width: 4px;\r\n\tborder-style: solid;\r\n}\r\n.ui-checkboxradio-disabled {\r\n\tpointer-events: none;\r\n}\r\n.ui-datepicker {\r\n\twidth: 17em;\r\n\tpadding: .2em .2em 0;\r\n\tdisplay: none;\r\n}\r\n.ui-datepicker .ui-datepicker-header {\r\n\tposition: relative;\r\n\tpadding: .2em 0;\r\n}\r\n.ui-datepicker .ui-datepicker-prev,\r\n.ui-datepicker .ui-datepicker-next {\r\n\tposition: absolute;\r\n\ttop: 2px;\r\n\twidth: 1.8em;\r\n\theight: 1.8em;\r\n}\r\n.ui-datepicker .ui-datepicker-prev-hover,\r\n.ui-datepicker .ui-datepicker-next-hover {\r\n\ttop: 1px;\r\n}\r\n.ui-datepicker .ui-datepicker-prev {\r\n\tleft: 2px;\r\n}\r\n.ui-datepicker .ui-datepicker-next {\r\n\tright: 2px;\r\n}\r\n.ui-datepicker .ui-datepicker-prev-hover {\r\n\tleft: 1px;\r\n}\r\n.ui-datepicker .ui-datepicker-next-hover {\r\n\tright: 1px;\r\n}\r\n.ui-datepicker .ui-datepicker-prev span,\r\n.ui-datepicker .ui-datepicker-next span {\r\n\tdisplay: block;\r\n\tposition: absolute;\r\n\tleft: 50%;\r\n\tmargin-left: -8px;\r\n\ttop: 50%;\r\n\tmargin-top: -8px;\r\n}\r\n.ui-datepicker .ui-datepicker-title {\r\n\tmargin: 0 2.3em;\r\n\tline-height: 1.8em;\r\n\ttext-align: center;\r\n}\r\n.ui-datepicker .ui-datepicker-title select {\r\n\tfont-size: 1em;\r\n\tmargin: 1px 0;\r\n}\r\n.ui-datepicker select.ui-datepicker-month,\r\n.ui-datepicker select.ui-datepicker-year {\r\n\twidth: 45%;\r\n}\r\n.ui-datepicker table {\r\n\twidth: 100%;\r\n\tfont-size: .9em;\r\n\tborder-collapse: collapse;\r\n\tmargin: 0 0 .4em;\r\n}\r\n.ui-datepicker th {\r\n\tpadding: .7em .3em;\r\n\ttext-align: center;\r\n\tfont-weight: bold;\r\n\tborder: 0;\r\n}\r\n.ui-datepicker td {\r\n\tborder: 0;\r\n\tpadding: 1px;\r\n}\r\n.ui-datepicker td span,\r\n.ui-datepicker td a {\r\n\tdisplay: block;\r\n\tpadding: .2em;\r\n\ttext-align: right;\r\n\ttext-decoration: none;\r\n}\r\n.ui-datepicker .ui-datepicker-buttonpane {\r\n\tbackground-image: none;\r\n\tmargin: .7em 0 0 0;\r\n\tpadding: 0 .2em;\r\n\tborder-left: 0;\r\n\tborder-right: 0;\r\n\tborder-bottom: 0;\r\n}\r\n.ui-datepicker .ui-datepicker-buttonpane button {\r\n\tfloat: right;\r\n\tmargin: .5em .2em .4em;\r\n\tcursor: pointer;\r\n\tpadding: .2em .6em .3em .6em;\r\n\twidth: auto;\r\n\toverflow: visible;\r\n}\r\n.ui-datepicker .ui-datepicker-buttonpane button.ui-datepicker-current {\r\n\tfloat: left;\r\n}\r\n\r\n/* with multiple calendars */\r\n.ui-datepicker.ui-datepicker-multi {\r\n\twidth: auto;\r\n}\r\n.ui-datepicker-multi .ui-datepicker-group {\r\n\tfloat: left;\r\n}\r\n.ui-datepicker-multi .ui-datepicker-group table {\r\n\twidth: 95%;\r\n\tmargin: 0 auto .4em;\r\n}\r\n.ui-datepicker-multi-2 .ui-datepicker-group {\r\n\twidth: 50%;\r\n}\r\n.ui-datepicker-multi-3 .ui-datepicker-group {\r\n\twidth: 33.3%;\r\n}\r\n.ui-datepicker-multi-4 .ui-datepicker-group {\r\n\twidth: 25%;\r\n}\r\n.ui-datepicker-multi .ui-datepicker-group-last .ui-datepicker-header,\r\n.ui-datepicker-multi .ui-datepicker-group-middle .ui-datepicker-header {\r\n\tborder-left-width: 0;\r\n}\r\n.ui-datepicker-multi .ui-datepicker-buttonpane {\r\n\tclear: left;\r\n}\r\n.ui-datepicker-row-break {\r\n\tclear: both;\r\n\twidth: 100%;\r\n\tfont-size: 0;\r\n}\r\n\r\n/* RTL support */\r\n.ui-datepicker-rtl {\r\n\tdirection: rtl;\r\n}\r\n.ui-datepicker-rtl .ui-datepicker-prev {\r\n\tright: 2px;\r\n\tleft: auto;\r\n}\r\n.ui-datepicker-rtl .ui-datepicker-next {\r\n\tleft: 2px;\r\n\tright: auto;\r\n}\r\n.ui-datepicker-rtl .ui-datepicker-prev:hover {\r\n\tright: 1px;\r\n\tleft: auto;\r\n}\r\n.ui-datepicker-rtl .ui-datepicker-next:hover {\r\n\tleft: 1px;\r\n\tright: auto;\r\n}\r\n.ui-datepicker-rtl .ui-datepicker-buttonpane {\r\n\tclear: right;\r\n}\r\n.ui-datepicker-rtl .ui-datepicker-buttonpane button {\r\n\tfloat: left;\r\n}\r\n.ui-datepicker-rtl .ui-datepicker-buttonpane button.ui-datepicker-current,\r\n.ui-datepicker-rtl .ui-datepicker-group {\r\n\tfloat: right;\r\n}\r\n.ui-datepicker-rtl .ui-datepicker-group-last .ui-datepicker-header,\r\n.ui-datepicker-rtl .ui-datepicker-group-middle .ui-datepicker-header {\r\n\tborder-right-width: 0;\r\n\tborder-left-width: 1px;\r\n}\r\n\r\n/* Icons */\r\n.ui-datepicker .ui-icon {\r\n\tdisplay: block;\r\n\ttext-indent: -99999px;\r\n\toverflow: hidden;\r\n\tbackground-repeat: no-repeat;\r\n\tleft: .5em;\r\n\ttop: .3em;\r\n}\r\n.ui-dialog {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tpadding: .2em;\r\n\toutline: 0;\r\n}\r\n.ui-dialog .ui-dialog-titlebar {\r\n\tpadding: .4em 1em;\r\n\tposition: relative;\r\n}\r\n.ui-dialog .ui-dialog-title {\r\n\tfloat: left;\r\n\tmargin: .1em 0;\r\n\twhite-space: nowrap;\r\n\twidth: 90%;\r\n\toverflow: hidden;\r\n\ttext-overflow: ellipsis;\r\n}\r\n.ui-dialog .ui-dialog-titlebar-close {\r\n\tposition: absolute;\r\n\tright: .3em;\r\n\ttop: 50%;\r\n\twidth: 20px;\r\n\tmargin: -10px 0 0 0;\r\n\tpadding: 1px;\r\n\theight: 20px;\r\n}\r\n.ui-dialog .ui-dialog-content {\r\n\tposition: relative;\r\n\tborder: 0;\r\n\tpadding: .5em 1em;\r\n\tbackground: none;\r\n\toverflow: auto;\r\n}\r\n.ui-dialog .ui-dialog-buttonpane {\r\n\ttext-align: left;\r\n\tborder-width: 1px 0 0 0;\r\n\tbackground-image: none;\r\n\tmargin-top: .5em;\r\n\tpadding: .3em 1em .5em .4em;\r\n}\r\n.ui-dialog .ui-dialog-buttonpane .ui-dialog-buttonset {\r\n\tfloat: right;\r\n}\r\n.ui-dialog .ui-dialog-buttonpane button {\r\n\tmargin: .5em .4em .5em 0;\r\n\tcursor: pointer;\r\n}\r\n.ui-dialog .ui-resizable-n {\r\n\theight: 2px;\r\n\ttop: 0;\r\n}\r\n.ui-dialog .ui-resizable-e {\r\n\twidth: 2px;\r\n\tright: 0;\r\n}\r\n.ui-dialog .ui-resizable-s {\r\n\theight: 2px;\r\n\tbottom: 0;\r\n}\r\n.ui-dialog .ui-resizable-w {\r\n\twidth: 2px;\r\n\tleft: 0;\r\n}\r\n.ui-dialog .ui-resizable-se,\r\n.ui-dialog .ui-resizable-sw,\r\n.ui-dialog .ui-resizable-ne,\r\n.ui-dialog .ui-resizable-nw {\r\n\twidth: 7px;\r\n\theight: 7px;\r\n}\r\n.ui-dialog .ui-resizable-se {\r\n\tright: 0;\r\n\tbottom: 0;\r\n}\r\n.ui-dialog .ui-resizable-sw {\r\n\tleft: 0;\r\n\tbottom: 0;\r\n}\r\n.ui-dialog .ui-resizable-ne {\r\n\tright: 0;\r\n\ttop: 0;\r\n}\r\n.ui-dialog .ui-resizable-nw {\r\n\tleft: 0;\r\n\ttop: 0;\r\n}\r\n.ui-draggable .ui-dialog-titlebar {\r\n\tcursor: move;\r\n}\r\n.ui-draggable-handle {\r\n\t-ms-touch-action: none;\r\n\ttouch-action: none;\r\n}\r\n.ui-resizable {\r\n\tposition: relative;\r\n}\r\n.ui-resizable-handle {\r\n\tposition: absolute;\r\n\tfont-size: 0.1px;\r\n\tdisplay: block;\r\n\t-ms-touch-action: none;\r\n\ttouch-action: none;\r\n}\r\n.ui-resizable-disabled .ui-resizable-handle,\r\n.ui-resizable-autohide .ui-resizable-handle {\r\n\tdisplay: none;\r\n}\r\n.ui-resizable-n {\r\n\tcursor: n-resize;\r\n\theight: 7px;\r\n\twidth: 100%;\r\n\ttop: -5px;\r\n\tleft: 0;\r\n}\r\n.ui-resizable-s {\r\n\tcursor: s-resize;\r\n\theight: 7px;\r\n\twidth: 100%;\r\n\tbottom: -5px;\r\n\tleft: 0;\r\n}\r\n.ui-resizable-e {\r\n\tcursor: e-resize;\r\n\twidth: 7px;\r\n\tright: -5px;\r\n\ttop: 0;\r\n\theight: 100%;\r\n}\r\n.ui-resizable-w {\r\n\tcursor: w-resize;\r\n\twidth: 7px;\r\n\tleft: -5px;\r\n\ttop: 0;\r\n\theight: 100%;\r\n}\r\n.ui-resizable-se {\r\n\tcursor: se-resize;\r\n\twidth: 12px;\r\n\theight: 12px;\r\n\tright: 1px;\r\n\tbottom: 1px;\r\n}\r\n.ui-resizable-sw {\r\n\tcursor: sw-resize;\r\n\twidth: 9px;\r\n\theight: 9px;\r\n\tleft: -5px;\r\n\tbottom: -5px;\r\n}\r\n.ui-resizable-nw {\r\n\tcursor: nw-resize;\r\n\twidth: 9px;\r\n\theight: 9px;\r\n\tleft: -5px;\r\n\ttop: -5px;\r\n}\r\n.ui-resizable-ne {\r\n\tcursor: ne-resize;\r\n\twidth: 9px;\r\n\theight: 9px;\r\n\tright: -5px;\r\n\ttop: -5px;\r\n}\r\n.ui-progressbar {\r\n\theight: 2em;\r\n\ttext-align: left;\r\n\toverflow: hidden;\r\n}\r\n.ui-progressbar .ui-progressbar-value {\r\n\tmargin: -1px;\r\n\theight: 100%;\r\n}\r\n.ui-progressbar .ui-progressbar-overlay {\r\n\tbackground: url("data:image/gif;base64,R0lGODlhKAAoAIABAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAQABACwAAAAAKAAoAAACkYwNqXrdC52DS06a7MFZI+4FHBCKoDeWKXqymPqGqxvJrXZbMx7Ttc+w9XgU2FB3lOyQRWET2IFGiU9m1frDVpxZZc6bfHwv4c1YXP6k1Vdy292Fb6UkuvFtXpvWSzA+HycXJHUXiGYIiMg2R6W459gnWGfHNdjIqDWVqemH2ekpObkpOlppWUqZiqr6edqqWQAAIfkECQEAAQAsAAAAACgAKAAAApSMgZnGfaqcg1E2uuzDmmHUBR8Qil95hiPKqWn3aqtLsS18y7G1SzNeowWBENtQd+T1JktP05nzPTdJZlR6vUxNWWjV+vUWhWNkWFwxl9VpZRedYcflIOLafaa28XdsH/ynlcc1uPVDZxQIR0K25+cICCmoqCe5mGhZOfeYSUh5yJcJyrkZWWpaR8doJ2o4NYq62lAAACH5BAkBAAEALAAAAAAoACgAAAKVDI4Yy22ZnINRNqosw0Bv7i1gyHUkFj7oSaWlu3ovC8GxNso5fluz3qLVhBVeT/Lz7ZTHyxL5dDalQWPVOsQWtRnuwXaFTj9jVVh8pma9JjZ4zYSj5ZOyma7uuolffh+IR5aW97cHuBUXKGKXlKjn+DiHWMcYJah4N0lYCMlJOXipGRr5qdgoSTrqWSq6WFl2ypoaUAAAIfkECQEAAQAsAAAAACgAKAAAApaEb6HLgd/iO7FNWtcFWe+ufODGjRfoiJ2akShbueb0wtI50zm02pbvwfWEMWBQ1zKGlLIhskiEPm9R6vRXxV4ZzWT2yHOGpWMyorblKlNp8HmHEb/lCXjcW7bmtXP8Xt229OVWR1fod2eWqNfHuMjXCPkIGNileOiImVmCOEmoSfn3yXlJWmoHGhqp6ilYuWYpmTqKUgAAIfkECQEAAQAsAAAAACgAKAAAApiEH6kb58biQ3FNWtMFWW3eNVcojuFGfqnZqSebuS06w5V80/X02pKe8zFwP6EFWOT1lDFk8rGERh1TTNOocQ61Hm4Xm2VexUHpzjymViHrFbiELsefVrn6XKfnt2Q9G/+Xdie499XHd2g4h7ioOGhXGJboGAnXSBnoBwKYyfioubZJ2Hn0RuRZaflZOil56Zp6iioKSXpUAAAh+QQJAQABACwAAAAAKAAoAAACkoQRqRvnxuI7kU1a1UU5bd5tnSeOZXhmn5lWK3qNTWvRdQxP8qvaC+/yaYQzXO7BMvaUEmJRd3TsiMAgswmNYrSgZdYrTX6tSHGZO73ezuAw2uxuQ+BbeZfMxsexY35+/Qe4J1inV0g4x3WHuMhIl2jXOKT2Q+VU5fgoSUI52VfZyfkJGkha6jmY+aaYdirq+lQAACH5BAkBAAEALAAAAAAoACgAAAKWBIKpYe0L3YNKToqswUlvznigd4wiR4KhZrKt9Upqip61i9E3vMvxRdHlbEFiEXfk9YARYxOZZD6VQ2pUunBmtRXo1Lf8hMVVcNl8JafV38aM2/Fu5V16Bn63r6xt97j09+MXSFi4BniGFae3hzbH9+hYBzkpuUh5aZmHuanZOZgIuvbGiNeomCnaxxap2upaCZsq+1kAACH5BAkBAAEALAAAAAAoACgAAAKXjI8By5zf4kOxTVrXNVlv1X0d8IGZGKLnNpYtm8Lr9cqVeuOSvfOW79D9aDHizNhDJidFZhNydEahOaDH6nomtJjp1tutKoNWkvA6JqfRVLHU/QUfau9l2x7G54d1fl995xcIGAdXqMfBNadoYrhH+Mg2KBlpVpbluCiXmMnZ2Sh4GBqJ+ckIOqqJ6LmKSllZmsoq6wpQAAAh+QQJAQABACwAAAAAKAAoAAAClYx/oLvoxuJDkU1a1YUZbJ59nSd2ZXhWqbRa2/gF8Gu2DY3iqs7yrq+xBYEkYvFSM8aSSObE+ZgRl1BHFZNr7pRCavZ5BW2142hY3AN/zWtsmf12p9XxxFl2lpLn1rseztfXZjdIWIf2s5dItwjYKBgo9yg5pHgzJXTEeGlZuenpyPmpGQoKOWkYmSpaSnqKileI2FAAACH5BAkBAAEALAAAAAAoACgAAAKVjB+gu+jG4kORTVrVhRlsnn2dJ3ZleFaptFrb+CXmO9OozeL5VfP99HvAWhpiUdcwkpBH3825AwYdU8xTqlLGhtCosArKMpvfa1mMRae9VvWZfeB2XfPkeLmm18lUcBj+p5dnN8jXZ3YIGEhYuOUn45aoCDkp16hl5IjYJvjWKcnoGQpqyPlpOhr3aElaqrq56Bq7VAAAOw==");\r\n\theight: 100%;\r\n\tfilter: alpha(opacity=25); /* support: IE8 */\r\n\topacity: 0.25;\r\n}\r\n.ui-progressbar-indeterminate .ui-progressbar-value {\r\n\tbackground-image: none;\r\n}\r\n.ui-selectable {\r\n\t-ms-touch-action: none;\r\n\ttouch-action: none;\r\n}\r\n.ui-selectable-helper {\r\n\tposition: absolute;\r\n\tz-index: 100;\r\n\tborder: 1px dotted black;\r\n}\r\n.ui-selectmenu-menu {\r\n\tpadding: 0;\r\n\tmargin: 0;\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tdisplay: none;\r\n}\r\n.ui-selectmenu-menu .ui-menu {\r\n\toverflow: auto;\r\n\toverflow-x: hidden;\r\n\tpadding-bottom: 1px;\r\n}\r\n.ui-selectmenu-menu .ui-menu .ui-selectmenu-optgroup {\r\n\tfont-size: 1em;\r\n\tfont-weight: bold;\r\n\tline-height: 1.5;\r\n\tpadding: 2px 0.4em;\r\n\tmargin: 0.5em 0 0 0;\r\n\theight: auto;\r\n\tborder: 0;\r\n}\r\n.ui-selectmenu-open {\r\n\tdisplay: block;\r\n}\r\n.ui-selectmenu-text {\r\n\tdisplay: block;\r\n\tmargin-right: 20px;\r\n\toverflow: hidden;\r\n\ttext-overflow: ellipsis;\r\n}\r\n.ui-selectmenu-button.ui-button {\r\n\ttext-align: left;\r\n\twhite-space: nowrap;\r\n\twidth: 14em;\r\n}\r\n.ui-selectmenu-icon.ui-icon {\r\n\tfloat: right;\r\n\tmargin-top: 0;\r\n}\r\n.ui-slider {\r\n\tposition: relative;\r\n\ttext-align: left;\r\n}\r\n.ui-slider .ui-slider-handle {\r\n\tposition: absolute;\r\n\tz-index: 2;\r\n\twidth: 1.2em;\r\n\theight: 1.2em;\r\n\tcursor: default;\r\n\t-ms-touch-action: none;\r\n\ttouch-action: none;\r\n}\r\n.ui-slider .ui-slider-range {\r\n\tposition: absolute;\r\n\tz-index: 1;\r\n\tfont-size: .7em;\r\n\tdisplay: block;\r\n\tborder: 0;\r\n\tbackground-position: 0 0;\r\n}\r\n\r\n/* support: IE8 - See #6727 */\r\n.ui-slider.ui-state-disabled .ui-slider-handle,\r\n.ui-slider.ui-state-disabled .ui-slider-range {\r\n\tfilter: inherit;\r\n}\r\n\r\n.ui-slider-horizontal {\r\n\theight: .8em;\r\n}\r\n.ui-slider-horizontal .ui-slider-handle {\r\n\ttop: -.3em;\r\n\tmargin-left: -.6em;\r\n}\r\n.ui-slider-horizontal .ui-slider-range {\r\n\ttop: 0;\r\n\theight: 100%;\r\n}\r\n.ui-slider-horizontal .ui-slider-range-min {\r\n\tleft: 0;\r\n}\r\n.ui-slider-horizontal .ui-slider-range-max {\r\n\tright: 0;\r\n}\r\n\r\n.ui-slider-vertical {\r\n\twidth: .8em;\r\n\theight: 100px;\r\n}\r\n.ui-slider-vertical .ui-slider-handle {\r\n\tleft: -.3em;\r\n\tmargin-left: 0;\r\n\tmargin-bottom: -.6em;\r\n}\r\n.ui-slider-vertical .ui-slider-range {\r\n\tleft: 0;\r\n\twidth: 100%;\r\n}\r\n.ui-slider-vertical .ui-slider-range-min {\r\n\tbottom: 0;\r\n}\r\n.ui-slider-vertical .ui-slider-range-max {\r\n\ttop: 0;\r\n}\r\n.ui-sortable-handle {\r\n\t-ms-touch-action: none;\r\n\ttouch-action: none;\r\n}\r\n.ui-spinner {\r\n\tposition: relative;\r\n\tdisplay: inline-block;\r\n\toverflow: hidden;\r\n\tpadding: 0;\r\n\tvertical-align: middle;\r\n}\r\n.ui-spinner-input {\r\n\tborder: none;\r\n\tbackground: none;\r\n\tcolor: inherit;\r\n\tpadding: .222em 0;\r\n\tmargin: .2em 0;\r\n\tvertical-align: middle;\r\n\tmargin-left: .4em;\r\n\tmargin-right: 2em;\r\n}\r\n.ui-spinner-button {\r\n\twidth: 1.6em;\r\n\theight: 50%;\r\n\tfont-size: .5em;\r\n\tpadding: 0;\r\n\tmargin: 0;\r\n\ttext-align: center;\r\n\tposition: absolute;\r\n\tcursor: default;\r\n\tdisplay: block;\r\n\toverflow: hidden;\r\n\tright: 0;\r\n}\r\n/* more specificity required here to override default borders */\r\n.ui-spinner a.ui-spinner-button {\r\n\tborder-top-style: none;\r\n\tborder-bottom-style: none;\r\n\tborder-right-style: none;\r\n}\r\n.ui-spinner-up {\r\n\ttop: 0;\r\n}\r\n.ui-spinner-down {\r\n\tbottom: 0;\r\n}\r\n.ui-tabs {\r\n\tposition: relative;/* position: relative prevents IE scroll bug (element with position: relative inside container with overflow: auto appear as "fixed") */\r\n\tpadding: .2em;\r\n}\r\n.ui-tabs .ui-tabs-nav {\r\n\tmargin: 0;\r\n\tpadding: .2em .2em 0;\r\n}\r\n.ui-tabs .ui-tabs-nav li {\r\n\tlist-style: none;\r\n\tfloat: left;\r\n\tposition: relative;\r\n\ttop: 0;\r\n\tmargin: 1px .2em 0 0;\r\n\tborder-bottom-width: 0;\r\n\tpadding: 0;\r\n\twhite-space: nowrap;\r\n}\r\n.ui-tabs .ui-tabs-nav .ui-tabs-anchor {\r\n\tfloat: left;\r\n\tpadding: .5em 1em;\r\n\ttext-decoration: none;\r\n}\r\n.ui-tabs .ui-tabs-nav li.ui-tabs-active {\r\n\tmargin-bottom: -1px;\r\n\tpadding-bottom: 1px;\r\n}\r\n.ui-tabs .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor,\r\n.ui-tabs .ui-tabs-nav li.ui-state-disabled .ui-tabs-anchor,\r\n.ui-tabs .ui-tabs-nav li.ui-tabs-loading .ui-tabs-anchor {\r\n\tcursor: text;\r\n}\r\n.ui-tabs-collapsible .ui-tabs-nav li.ui-tabs-active .ui-tabs-anchor {\r\n\tcursor: pointer;\r\n}\r\n.ui-tabs .ui-tabs-panel {\r\n\tdisplay: block;\r\n\tborder-width: 0;\r\n\tpadding: 1em 1.4em;\r\n\tbackground: none;\r\n}\r\n.ui-tooltip {\r\n\tpadding: 8px;\r\n\tposition: absolute;\r\n\tz-index: 9999;\r\n\tmax-width: 300px;\r\n}\r\nbody .ui-tooltip {\r\n\tborder-width: 2px;\r\n}\r\n/* Component containers\r\n----------------------------------*/\r\n.ui-widget {\r\n\tfont-family: Arial,Helvetica,sans-serif;\r\n\tfont-size: 1em;\r\n}\r\n.ui-widget .ui-widget {\r\n\tfont-size: 1em;\r\n}\r\n.ui-widget input,\r\n.ui-widget select,\r\n.ui-widget textarea,\r\n.ui-widget button {\r\n\tfont-family: Arial,Helvetica,sans-serif;\r\n\tfont-size: 1em;\r\n}\r\n.ui-widget.ui-widget-content {\r\n\tborder: 1px solid #c5c5c5;\r\n}\r\n.ui-widget-content {\r\n\tborder: 1px solid #dddddd;\r\n\tbackground: #ffffff;\r\n\tcolor: #333333;\r\n}\r\n.ui-widget-content a {\r\n\tcolor: #333333;\r\n}\r\n.ui-widget-header {\r\n\tborder: 1px solid #dddddd;\r\n\tbackground: #e9e9e9;\r\n\tcolor: #333333;\r\n\tfont-weight: bold;\r\n}\r\n.ui-widget-header a {\r\n\tcolor: #333333;\r\n}\r\n\r\n/* Interaction states\r\n----------------------------------*/\r\n.ui-state-default,\r\n.ui-widget-content .ui-state-default,\r\n.ui-widget-header .ui-state-default,\r\n.ui-button,\r\n\r\n/* We use html here because we need a greater specificity to make sure disabled\r\nworks properly when clicked or hovered */\r\nhtml .ui-button.ui-state-disabled:hover,\r\nhtml .ui-button.ui-state-disabled:active {\r\n\tborder: 1px solid #c5c5c5;\r\n\tbackground: #f6f6f6;\r\n\tfont-weight: normal;\r\n\tcolor: #454545;\r\n}\r\n.ui-state-default a,\r\n.ui-state-default a:link,\r\n.ui-state-default a:visited,\r\na.ui-button,\r\na:link.ui-button,\r\na:visited.ui-button,\r\n.ui-button {\r\n\tcolor: #454545;\r\n\ttext-decoration: none;\r\n}\r\n.ui-state-hover,\r\n.ui-widget-content .ui-state-hover,\r\n.ui-widget-header .ui-state-hover,\r\n.ui-state-focus,\r\n.ui-widget-content .ui-state-focus,\r\n.ui-widget-header .ui-state-focus,\r\n.ui-button:hover,\r\n.ui-button:focus {\r\n\tborder: 1px solid #cccccc;\r\n\tbackground: #ededed;\r\n\tfont-weight: normal;\r\n\tcolor: #2b2b2b;\r\n}\r\n.ui-state-hover a,\r\n.ui-state-hover a:hover,\r\n.ui-state-hover a:link,\r\n.ui-state-hover a:visited,\r\n.ui-state-focus a,\r\n.ui-state-focus a:hover,\r\n.ui-state-focus a:link,\r\n.ui-state-focus a:visited,\r\na.ui-button:hover,\r\na.ui-button:focus {\r\n\tcolor: #2b2b2b;\r\n\ttext-decoration: none;\r\n}\r\n\r\n.ui-visual-focus {\r\n\tbox-shadow: 0 0 3px 1px rgb(94, 158, 214);\r\n}\r\n.ui-state-active,\r\n.ui-widget-content .ui-state-active,\r\n.ui-widget-header .ui-state-active,\r\na.ui-button:active,\r\n.ui-button:active,\r\n.ui-button.ui-state-active:hover {\r\n\tborder: 1px solid #003eff;\r\n\tbackground: #007fff;\r\n\tfont-weight: normal;\r\n\tcolor: #ffffff;\r\n}\r\n.ui-icon-background,\r\n.ui-state-active .ui-icon-background {\r\n\tborder: #003eff;\r\n\tbackground-color: #ffffff;\r\n}\r\n.ui-state-active a,\r\n.ui-state-active a:link,\r\n.ui-state-active a:visited {\r\n\tcolor: #ffffff;\r\n\ttext-decoration: none;\r\n}\r\n\r\n/* Interaction Cues\r\n----------------------------------*/\r\n.ui-state-highlight,\r\n.ui-widget-content .ui-state-highlight,\r\n.ui-widget-header .ui-state-highlight {\r\n\tborder: 1px solid #dad55e;\r\n\tbackground: #fffa90;\r\n\tcolor: #777620;\r\n}\r\n.ui-state-checked {\r\n\tborder: 1px solid #dad55e;\r\n\tbackground: #fffa90;\r\n}\r\n.ui-state-highlight a,\r\n.ui-widget-content .ui-state-highlight a,\r\n.ui-widget-header .ui-state-highlight a {\r\n\tcolor: #777620;\r\n}\r\n.ui-state-error,\r\n.ui-widget-content .ui-state-error,\r\n.ui-widget-header .ui-state-error {\r\n\tborder: 1px solid #f1a899;\r\n\tbackground: #fddfdf;\r\n\tcolor: #5f3f3f;\r\n}\r\n.ui-state-error a,\r\n.ui-widget-content .ui-state-error a,\r\n.ui-widget-header .ui-state-error a {\r\n\tcolor: #5f3f3f;\r\n}\r\n.ui-state-error-text,\r\n.ui-widget-content .ui-state-error-text,\r\n.ui-widget-header .ui-state-error-text {\r\n\tcolor: #5f3f3f;\r\n}\r\n.ui-priority-primary,\r\n.ui-widget-content .ui-priority-primary,\r\n.ui-widget-header .ui-priority-primary {\r\n\tfont-weight: bold;\r\n}\r\n.ui-priority-secondary,\r\n.ui-widget-content .ui-priority-secondary,\r\n.ui-widget-header .ui-priority-secondary {\r\n\topacity: .7;\r\n\tfilter:Alpha(Opacity=70); /* support: IE8 */\r\n\tfont-weight: normal;\r\n}\r\n.ui-state-disabled,\r\n.ui-widget-content .ui-state-disabled,\r\n.ui-widget-header .ui-state-disabled {\r\n\topacity: .35;\r\n\tfilter:Alpha(Opacity=35); /* support: IE8 */\r\n\tbackground-image: none;\r\n}\r\n.ui-state-disabled .ui-icon {\r\n\tfilter:Alpha(Opacity=35); /* support: IE8 - See #6059 */\r\n}\r\n\r\n/* Icons\r\n----------------------------------*/\r\n\r\n/* states and images */\r\n.ui-icon {\r\n\twidth: 16px;\r\n\theight: 16px;\r\n}\r\n.ui-icon,\r\n.ui-widget-content .ui-icon {\r\n\tbackground-image: url("../src/js/../../bower_components/jquery-ui/themes/base/images/ui-icons_444444_256x240.png");\r\n}\r\n.ui-widget-header .ui-icon {\r\n\tbackground-image: url("../src/js/../../bower_components/jquery-ui/themes/base/images/ui-icons_444444_256x240.png");\r\n}\r\n.ui-state-hover .ui-icon,\r\n.ui-state-focus .ui-icon,\r\n.ui-button:hover .ui-icon,\r\n.ui-button:focus .ui-icon {\r\n\tbackground-image: url("../src/js/../../bower_components/jquery-ui/themes/base/images/ui-icons_555555_256x240.png");\r\n}\r\n.ui-state-active .ui-icon,\r\n.ui-button:active .ui-icon {\r\n\tbackground-image: url("../src/js/../../bower_components/jquery-ui/themes/base/images/ui-icons_ffffff_256x240.png");\r\n}\r\n.ui-state-highlight .ui-icon,\r\n.ui-button .ui-state-highlight.ui-icon {\r\n\tbackground-image: url("../src/js/../../bower_components/jquery-ui/themes/base/images/ui-icons_777620_256x240.png");\r\n}\r\n.ui-state-error .ui-icon,\r\n.ui-state-error-text .ui-icon {\r\n\tbackground-image: url("../src/js/../../bower_components/jquery-ui/themes/base/images/ui-icons_cc0000_256x240.png");\r\n}\r\n.ui-button .ui-icon {\r\n\tbackground-image: url("../src/js/../../bower_components/jquery-ui/themes/base/images/ui-icons_777777_256x240.png");\r\n}\r\n\r\n/* positioning */\r\n.ui-icon-blank { background-position: 16px 16px; }\r\n.ui-icon-caret-1-n { background-position: 0 0; }\r\n.ui-icon-caret-1-ne { background-position: -16px 0; }\r\n.ui-icon-caret-1-e { background-position: -32px 0; }\r\n.ui-icon-caret-1-se { background-position: -48px 0; }\r\n.ui-icon-caret-1-s { background-position: -65px 0; }\r\n.ui-icon-caret-1-sw { background-position: -80px 0; }\r\n.ui-icon-caret-1-w { background-position: -96px 0; }\r\n.ui-icon-caret-1-nw { background-position: -112px 0; }\r\n.ui-icon-caret-2-n-s { background-position: -128px 0; }\r\n.ui-icon-caret-2-e-w { background-position: -144px 0; }\r\n.ui-icon-triangle-1-n { background-position: 0 -16px; }\r\n.ui-icon-triangle-1-ne { background-position: -16px -16px; }\r\n.ui-icon-triangle-1-e { background-position: -32px -16px; }\r\n.ui-icon-triangle-1-se { background-position: -48px -16px; }\r\n.ui-icon-triangle-1-s { background-position: -65px -16px; }\r\n.ui-icon-triangle-1-sw { background-position: -80px -16px; }\r\n.ui-icon-triangle-1-w { background-position: -96px -16px; }\r\n.ui-icon-triangle-1-nw { background-position: -112px -16px; }\r\n.ui-icon-triangle-2-n-s { background-position: -128px -16px; }\r\n.ui-icon-triangle-2-e-w { background-position: -144px -16px; }\r\n.ui-icon-arrow-1-n { background-position: 0 -32px; }\r\n.ui-icon-arrow-1-ne { background-position: -16px -32px; }\r\n.ui-icon-arrow-1-e { background-position: -32px -32px; }\r\n.ui-icon-arrow-1-se { background-position: -48px -32px; }\r\n.ui-icon-arrow-1-s { background-position: -65px -32px; }\r\n.ui-icon-arrow-1-sw { background-position: -80px -32px; }\r\n.ui-icon-arrow-1-w { background-position: -96px -32px; }\r\n.ui-icon-arrow-1-nw { background-position: -112px -32px; }\r\n.ui-icon-arrow-2-n-s { background-position: -128px -32px; }\r\n.ui-icon-arrow-2-ne-sw { background-position: -144px -32px; }\r\n.ui-icon-arrow-2-e-w { background-position: -160px -32px; }\r\n.ui-icon-arrow-2-se-nw { background-position: -176px -32px; }\r\n.ui-icon-arrowstop-1-n { background-position: -192px -32px; }\r\n.ui-icon-arrowstop-1-e { background-position: -208px -32px; }\r\n.ui-icon-arrowstop-1-s { background-position: -224px -32px; }\r\n.ui-icon-arrowstop-1-w { background-position: -240px -32px; }\r\n.ui-icon-arrowthick-1-n { background-position: 1px -48px; }\r\n.ui-icon-arrowthick-1-ne { background-position: -16px -48px; }\r\n.ui-icon-arrowthick-1-e { background-position: -32px -48px; }\r\n.ui-icon-arrowthick-1-se { background-position: -48px -48px; }\r\n.ui-icon-arrowthick-1-s { background-position: -64px -48px; }\r\n.ui-icon-arrowthick-1-sw { background-position: -80px -48px; }\r\n.ui-icon-arrowthick-1-w { background-position: -96px -48px; }\r\n.ui-icon-arrowthick-1-nw { background-position: -112px -48px; }\r\n.ui-icon-arrowthick-2-n-s { background-position: -128px -48px; }\r\n.ui-icon-arrowthick-2-ne-sw { background-position: -144px -48px; }\r\n.ui-icon-arrowthick-2-e-w { background-position: -160px -48px; }\r\n.ui-icon-arrowthick-2-se-nw { background-position: -176px -48px; }\r\n.ui-icon-arrowthickstop-1-n { background-position: -192px -48px; }\r\n.ui-icon-arrowthickstop-1-e { background-position: -208px -48px; }\r\n.ui-icon-arrowthickstop-1-s { background-position: -224px -48px; }\r\n.ui-icon-arrowthickstop-1-w { background-position: -240px -48px; }\r\n.ui-icon-arrowreturnthick-1-w { background-position: 0 -64px; }\r\n.ui-icon-arrowreturnthick-1-n { background-position: -16px -64px; }\r\n.ui-icon-arrowreturnthick-1-e { background-position: -32px -64px; }\r\n.ui-icon-arrowreturnthick-1-s { background-position: -48px -64px; }\r\n.ui-icon-arrowreturn-1-w { background-position: -64px -64px; }\r\n.ui-icon-arrowreturn-1-n { background-position: -80px -64px; }\r\n.ui-icon-arrowreturn-1-e { background-position: -96px -64px; }\r\n.ui-icon-arrowreturn-1-s { background-position: -112px -64px; }\r\n.ui-icon-arrowrefresh-1-w { background-position: -128px -64px; }\r\n.ui-icon-arrowrefresh-1-n { background-position: -144px -64px; }\r\n.ui-icon-arrowrefresh-1-e { background-position: -160px -64px; }\r\n.ui-icon-arrowrefresh-1-s { background-position: -176px -64px; }\r\n.ui-icon-arrow-4 { background-position: 0 -80px; }\r\n.ui-icon-arrow-4-diag { background-position: -16px -80px; }\r\n.ui-icon-extlink { background-position: -32px -80px; }\r\n.ui-icon-newwin { background-position: -48px -80px; }\r\n.ui-icon-refresh { background-position: -64px -80px; }\r\n.ui-icon-shuffle { background-position: -80px -80px; }\r\n.ui-icon-transfer-e-w { background-position: -96px -80px; }\r\n.ui-icon-transferthick-e-w { background-position: -112px -80px; }\r\n.ui-icon-folder-collapsed { background-position: 0 -96px; }\r\n.ui-icon-folder-open { background-position: -16px -96px; }\r\n.ui-icon-document { background-position: -32px -96px; }\r\n.ui-icon-document-b { background-position: -48px -96px; }\r\n.ui-icon-note { background-position: -64px -96px; }\r\n.ui-icon-mail-closed { background-position: -80px -96px; }\r\n.ui-icon-mail-open { background-position: -96px -96px; }\r\n.ui-icon-suitcase { background-position: -112px -96px; }\r\n.ui-icon-comment { background-position: -128px -96px; }\r\n.ui-icon-person { background-position: -144px -96px; }\r\n.ui-icon-print { background-position: -160px -96px; }\r\n.ui-icon-trash { background-position: -176px -96px; }\r\n.ui-icon-locked { background-position: -192px -96px; }\r\n.ui-icon-unlocked { background-position: -208px -96px; }\r\n.ui-icon-bookmark { background-position: -224px -96px; }\r\n.ui-icon-tag { background-position: -240px -96px; }\r\n.ui-icon-home { background-position: 0 -112px; }\r\n.ui-icon-flag { background-position: -16px -112px; }\r\n.ui-icon-calendar { background-position: -32px -112px; }\r\n.ui-icon-cart { background-position: -48px -112px; }\r\n.ui-icon-pencil { background-position: -64px -112px; }\r\n.ui-icon-clock { background-position: -80px -112px; }\r\n.ui-icon-disk { background-position: -96px -112px; }\r\n.ui-icon-calculator { background-position: -112px -112px; }\r\n.ui-icon-zoomin { background-position: -128px -112px; }\r\n.ui-icon-zoomout { background-position: -144px -112px; }\r\n.ui-icon-search { background-position: -160px -112px; }\r\n.ui-icon-wrench { background-position: -176px -112px; }\r\n.ui-icon-gear { background-position: -192px -112px; }\r\n.ui-icon-heart { background-position: -208px -112px; }\r\n.ui-icon-star { background-position: -224px -112px; }\r\n.ui-icon-link { background-position: -240px -112px; }\r\n.ui-icon-cancel { background-position: 0 -128px; }\r\n.ui-icon-plus { background-position: -16px -128px; }\r\n.ui-icon-plusthick { background-position: -32px -128px; }\r\n.ui-icon-minus { background-position: -48px -128px; }\r\n.ui-icon-minusthick { background-position: -64px -128px; }\r\n.ui-icon-close { background-position: -80px -128px; }\r\n.ui-icon-closethick { background-position: -96px -128px; }\r\n.ui-icon-key { background-position: -112px -128px; }\r\n.ui-icon-lightbulb { background-position: -128px -128px; }\r\n.ui-icon-scissors { background-position: -144px -128px; }\r\n.ui-icon-clipboard { background-position: -160px -128px; }\r\n.ui-icon-copy { background-position: -176px -128px; }\r\n.ui-icon-contact { background-position: -192px -128px; }\r\n.ui-icon-image { background-position: -208px -128px; }\r\n.ui-icon-video { background-position: -224px -128px; }\r\n.ui-icon-script { background-position: -240px -128px; }\r\n.ui-icon-alert { background-position: 0 -144px; }\r\n.ui-icon-info { background-position: -16px -144px; }\r\n.ui-icon-notice { background-position: -32px -144px; }\r\n.ui-icon-help { background-position: -48px -144px; }\r\n.ui-icon-check { background-position: -64px -144px; }\r\n.ui-icon-bullet { background-position: -80px -144px; }\r\n.ui-icon-radio-on { background-position: -96px -144px; }\r\n.ui-icon-radio-off { background-position: -112px -144px; }\r\n.ui-icon-pin-w { background-position: -128px -144px; }\r\n.ui-icon-pin-s { background-position: -144px -144px; }\r\n.ui-icon-play { background-position: 0 -160px; }\r\n.ui-icon-pause { background-position: -16px -160px; }\r\n.ui-icon-seek-next { background-position: -32px -160px; }\r\n.ui-icon-seek-prev { background-position: -48px -160px; }\r\n.ui-icon-seek-end { background-position: -64px -160px; }\r\n.ui-icon-seek-start { background-position: -80px -160px; }\r\n/* ui-icon-seek-first is deprecated, use ui-icon-seek-start instead */\r\n.ui-icon-seek-first { background-position: -80px -160px; }\r\n.ui-icon-stop { background-position: -96px -160px; }\r\n.ui-icon-eject { background-position: -112px -160px; }\r\n.ui-icon-volume-off { background-position: -128px -160px; }\r\n.ui-icon-volume-on { background-position: -144px -160px; }\r\n.ui-icon-power { background-position: 0 -176px; }\r\n.ui-icon-signal-diag { background-position: -16px -176px; }\r\n.ui-icon-signal { background-position: -32px -176px; }\r\n.ui-icon-battery-0 { background-position: -48px -176px; }\r\n.ui-icon-battery-1 { background-position: -64px -176px; }\r\n.ui-icon-battery-2 { background-position: -80px -176px; }\r\n.ui-icon-battery-3 { background-position: -96px -176px; }\r\n.ui-icon-circle-plus { background-position: 0 -192px; }\r\n.ui-icon-circle-minus { background-position: -16px -192px; }\r\n.ui-icon-circle-close { background-position: -32px -192px; }\r\n.ui-icon-circle-triangle-e { background-position: -48px -192px; }\r\n.ui-icon-circle-triangle-s { background-position: -64px -192px; }\r\n.ui-icon-circle-triangle-w { background-position: -80px -192px; }\r\n.ui-icon-circle-triangle-n { background-position: -96px -192px; }\r\n.ui-icon-circle-arrow-e { background-position: -112px -192px; }\r\n.ui-icon-circle-arrow-s { background-position: -128px -192px; }\r\n.ui-icon-circle-arrow-w { background-position: -144px -192px; }\r\n.ui-icon-circle-arrow-n { background-position: -160px -192px; }\r\n.ui-icon-circle-zoomin { background-position: -176px -192px; }\r\n.ui-icon-circle-zoomout { background-position: -192px -192px; }\r\n.ui-icon-circle-check { background-position: -208px -192px; }\r\n.ui-icon-circlesmall-plus { background-position: 0 -208px; }\r\n.ui-icon-circlesmall-minus { background-position: -16px -208px; }\r\n.ui-icon-circlesmall-close { background-position: -32px -208px; }\r\n.ui-icon-squaresmall-plus { background-position: -48px -208px; }\r\n.ui-icon-squaresmall-minus { background-position: -64px -208px; }\r\n.ui-icon-squaresmall-close { background-position: -80px -208px; }\r\n.ui-icon-grip-dotted-vertical { background-position: 0 -224px; }\r\n.ui-icon-grip-dotted-horizontal { background-position: -16px -224px; }\r\n.ui-icon-grip-solid-vertical { background-position: -32px -224px; }\r\n.ui-icon-grip-solid-horizontal { background-position: -48px -224px; }\r\n.ui-icon-gripsmall-diagonal-se { background-position: -64px -224px; }\r\n.ui-icon-grip-diagonal-se { background-position: -80px -224px; }\r\n\r\n\r\n/* Misc visuals\r\n----------------------------------*/\r\n\r\n/* Corner radius */\r\n.ui-corner-all,\r\n.ui-corner-top,\r\n.ui-corner-left,\r\n.ui-corner-tl {\r\n\tborder-top-left-radius: 3px;\r\n}\r\n.ui-corner-all,\r\n.ui-corner-top,\r\n.ui-corner-right,\r\n.ui-corner-tr {\r\n\tborder-top-right-radius: 3px;\r\n}\r\n.ui-corner-all,\r\n.ui-corner-bottom,\r\n.ui-corner-left,\r\n.ui-corner-bl {\r\n\tborder-bottom-left-radius: 3px;\r\n}\r\n.ui-corner-all,\r\n.ui-corner-bottom,\r\n.ui-corner-right,\r\n.ui-corner-br {\r\n\tborder-bottom-right-radius: 3px;\r\n}\r\n\r\n/* Overlays */\r\n.ui-widget-overlay {\r\n\tbackground: #aaaaaa;\r\n\topacity: .3;\r\n\tfilter: Alpha(Opacity=30); /* support: IE8 */\r\n}\r\n.ui-widget-shadow {\r\n\t-webkit-box-shadow: 0px 0px 5px #666666;\r\n\tbox-shadow: 0px 0px 5px #666666;\r\n}\r\n');